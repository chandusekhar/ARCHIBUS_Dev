<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <title>
      </title>
   </head>
   <body>
      <p>
         //---------Global Variables ----------------------------------/// var
         arrMonthNames = new Array(&quot;January&quot;, &quot;February&quot;,
         &quot;March&quot;, &quot;April&quot;, &quot;May&quot;,
         &quot;June&quot;, &quot;July&quot;, &quot;August&quot;,
         &quot;September&quot;, &quot;October&quot;, &quot;November&quot;,
         &quot;December&quot;); var arrSMonthNames = new
         Array(&quot;Jan.&quot;, &quot;Feb.&quot;, &quot;Mar.&quot;,
         &quot;Apr.&quot;, &quot;May&quot;, &quot;Jun.&quot;, &quot;Jul.&quot;,
         &quot;Aug.&quot;, &quot;Sep.&quot;, &quot;Oct.&quot;,
         &quot;Nov.&quot;, &quot;Dec.&quot;); var arrName = new
         Array(&quot;S&quot;,&quot;M&quot;,&quot;T&quot;,&quot;W&quot;,&quot;T&quot;,&quot;F&quot;,&quot;S&quot;);
         function getDays(date1, date2) { var ONE_DAY = 1000 * 60 * 60 * 24;
         var date1Ms = date1.getTime(); var date2Ms = date2.getTime(); var
         dateDiff = Math.abs(date1Ms - date2Ms); var numDays =
         Math.round(dateDiff/ONE_DAY); // var numDays = date2-date1; //
         numDays=Math.round(numDays/1000/60/60/24) return numDays; } function
         returnDate(date) { var arrDte = date.split(&quot;/&quot;); //expects
         MM/DD/YYYY date = new Date(arrDte[2], arrDte[0]-1, arrDte[1]);; return
         date; } function stripChar(string, strChar) { //TODO: Allow variable
         char in regex var regex = /\,/g; return string.replace(regex,
         &#39;&#39;); } //------------Chart Header Functions
         --------------------------// function drawMainHeader(startDate,
         endDate, dayWidth, intScope) { switch (intScope) { case 0: return
         drawWeeks(startDate, endDate, dayWidth, intScope); //Weeks case 1:
         return drawMonths(startDate,endDate, dayWidth, intScope);//Months } }
         function drawSubHeader(startDate, endDate, dayWidth, intScope) {
         switch (intScope) { case 0: return drawDays(startDate, endDate,
         dayWidth); //Days case 1: return drawWeeks(startDate, endDate,
         dayWidth, intScope); //Weeks } } //-----------Calendar Functions
         ------------------------------// function drawMonths(startDate,
         endDate, dayWidth, intScope) { var diff = endDate-startDate;
         diff=Math.round(diff/1000/60/60/24); numDays=diff; var monthHeader =
         &#39;&#39;; var sd = new Date(startDate); for (i=0; i &lt; numDays;
         i++) { if (i == 0 &amp;&amp; sd.getDate() != 1) { var temp =
         (calcDaysInMonth(sd.getFullYear(), sd.getMonth() ) - sd.getDate());
         monthHeader += &#39;
      </p>
      <div class="\" style="\">
         <span class="\">temp-&#39; + temp + &#39;&nbsp;</span>
      </div>
      <p>
         &#39;; } if (sd.getDate() == 1) { monthHeader += &#39;
      </p>
      <div class="week" style="\">
         <span class="\">&#39; + calcMnW(dayWidth, sd.getFullYear(),
         (sd.getMonth())) + &#39;-&#39; + arrMonthNames[sd.getMonth()] + &#39;
         &#39; + sd.getFullYear() + &#39;</span>
      </div>
      <p>
         &#39;; } sd.setDate(sd.getDate() + 1); } return monthHeader; }
         function drawWeeks(startDate,endDate, dayWidth, intScope) { var diff =
         endDate-startDate; diff=Math.round(diff/1000/60/60/24) numDays=diff
         if(1==1){ var weekHeader = &#39;&#39;; var intDivWidth = 0; var sd =
         new Date(startDate); //var intExtraDays = (calcDaysInMonth
         (endDate.getFullYear(), endDate.getMonth()) -
         parseInt(endDate.getDate())); //var strWeekSuffix = &#39;
      </p>
      <div class="\" style="\">
         <span class="\">&nbsp;</span>
      </div>
      <p>
         &#39;; var strWeekStyle = &#39;weekheader&#39;; var blnIsIE = false;
         if (navigator.userAgent.toLowerCase().indexOf(&#39;msie&#39;) &gt; 0)
         blnIsIE = true; //IE renders borders differently // intScope=0; for
         (i=0; i &lt; numDays; i++) { if (i == 0 &amp;&amp; sd.getDay() != 6) {
         var temp = (6- sd.getDay()) intDivWidth += dayWidth; //Week of &#39; +
         arrMonthNames[sd.getMonth()] + &#39; &#39; + (sd.getDate()) + &#39;
         //weekHeader += &#39;
      </p>
      <div class="\" style="\" daywidth="">
         <span class="\">&nbsp;</span>
      </div>
      <p>
         &#39;; weekHeader += &#39;
      </p>
      &#39;; } if (sd.getDay() == 0) { if (intScope == 0) { weekHeader +=
      &#39;&#39;; } if (intScope == 1 &amp;&amp; dayWidth &gt;= 3) { weekHeader
      += &#39;&#39;; //weekHeader += &#39;
      <div class="\" style="\">
         <span class="\">&#39; + (sd.getMonth()+1) + &#39;/&#39; +
         (sd.getDate()) + &#39;</span>
      </div>
      &#39;; } // if (intScope == 1 &amp;&amp; dayWidth &lt; 3) // { //
      weekHeader += &#39;
      <div class="\" style="\">
         <span class="\">&#39; + (sd.getDate()) + &#39;</span>
      </div>
      &#39;; // } intDivWidth += calcWkW(dayWidth); } sd.setDate(sd.getDate() +
      1); } // return &#39;
      <div style="\">
         &#39; + weekHeader + &#39;
      </div>
      &#39; return weekHeader } } function drawDays(startDate, endDate,
      dayWidth) { var diff = endDate-startDate;
      diff=Math.round(diff/1000/60/60/24) var numDays=diff; var numDays=diff++;
      var dayHeader = &#39;&#39;; for (var i=0; i &lt; numDays; i++) {
      dayHeader += &#39;&#39;; startDate.setDate(startDate.getDate() + 1); }
      return dayHeader; } function calcWkW(dayWidth) { return (dayWidth * 7); }
      function calcMnW(dayWidth, year, month) { var temp =
      calcDaysInMonth(year, month); return (temp * dayWidth); } function
      calcDaysInMonth (year, month) { return 32 - new Date(year, month,
      32).getDate(); } function getActualDate(projStartDate, intDay) {
      actualDate = new Date(projStartDate.getDate() + intDay); return
      actualDate; } function getActualDate2(tempDate, intDay) { var tempDate =
      new Date(tempDate); tempDate.setDate(tempDate.getDate() + intDay); return
      tempDate } var dave=1; //------------Data Display Functions
      ------------------------------// function isTaskDay(projStartDate,
      taskStartDate, duration, intDay) { var intDateDiff =
      getDays(projStartDate, taskStartDate); intDateDiff=intDateDiff-1; // var
      actualDate = getActualDate(projStartDate, intDay);//new
      Date(projStartDate.getDate() + intDay); if (intDay &gt;= intDateDiff
      &amp;&amp; intDay &lt;= (intDateDiff + parseInt(duration)) )//&amp;&amp;
      actualDate.getDay() != 5 &amp;&amp; actualDate.getDay() != 6) return 1;
      //true else return 0; //false } function drawBar(projStartDate,
      taskStartDate, taskName, duration, dayWidth, numDays, intWorkingDays,
      intScope, intTaskStyle,overall_total_days) { // if (intScope==1) {
      //intWorkingDays=8; // } intWorkingDays=5; var strHTMLBar = &#39;&#39;;
      var strSpace = &#39;&nbsp;&#39;; var arrTaskStyle = new
      Array(&#39;projectday&#39;, &#39;workpkgday&#39;, &#39;taskday&#39;); var
      strTaskStyle = arrTaskStyle[intTaskStyle]; //alert(intTaskStyle);
      if(intTaskStyle==1)
      {imagefile=&quot;BlackBar.gif&quot;}else{imagefile=&quot;BlueBar.gif&quot;}
      for (i = 0; i &lt; overall_total_days; i++) { if
      (getActualDate2(projStartDate, i).getDay() !=6 &amp;&amp;
      getActualDate2(projStartDate, i).getDay() !=0) { //Weekday strHTMLBar +=
      &#39;&quot; } } return strHTMLBar; } //----------------------- Potential
      Future Functionality ------------// function convertMSProjDate(date) {
      var arrDte = date.substring(0,10).split(&quot;-&quot;); //typical
      MSProject date: 2005-04-20T08:00:00 date = new
      Date(arrDte[0],arrDte[1]-1, arrDte[2]); return date; } function
      convertMSProjDuration(duration, minsPerDay) { return
      parseInt(duration.substring(2,duration.indexOf(&#39;H&#39;)))/(parseInt(minsPerDay)/60);//
      typical MSProject duration PT80H0M0S }
      <table>
         <tr>
            <td colspan="&#39; + temp + &#39;" class="\">
               &nbsp;
            </td>
            <td colspan="7" align="center" class="\">
               &#39; + arrMonthNames[sd.getMonth()] + &#39; &#39; +
               (sd.getDate()) + &#39;
            </td>
            <td colspan="7" class="\">
               &#39; + (sd.getMonth()+1) + &#39;/&#39; + (sd.getDate()) + &#39;
            </td>
            <td class="\">
               <span class="\">&#39; + arrName[startDate.getDay()] + &#39;<img
               alt="error-file:tidyout.log" src="spacer.gif" height="1" width=
               "16"></span>
            </td>
            <td class="\">
               &#39; if (isTaskDay(projStartDate, taskStartDate, duration, i)
               == 1) { strHTMLBar += &#39;<img alt="error-file:tidyout.log"
               src="&#39; + imagefile + &#39;" height="8" width=
               "16">&#39;;//Normal work week task } else{ strHTMLBar
               +=&quot;&nbsp;&quot; //Normal work day no task } } else {
               //Weekend if (intWorkingDays==6) { strHTMLBar += &#39;
            </td>
            <td class="\">
               &#39; if (isTaskDay(projStartDate, taskStartDate, duration, i)
               == 1 &amp;&amp; getActualDate2(projStartDate, i).getDay() !=6) {
               //Work on Sat. strHTMLBar += &#39;<img alt=
               "error-file:tidyout.log" src="&#39; + imagefile + &#39;" height=
               "8" width="16">&#39;; } else { //Sunday no taskbar, normal
               weekend shading strHTMLBar +=&quot;&nbsp;&quot; //Normal work
               week } } else if(intWorkingDays==7) { strHTMLBar += &#39;
            </td>
            <td class="\">
               &#39; if (isTaskDay(projStartDate, taskStartDate, duration, i)
               == 1) { //Work on Sat. strHTMLBar += &#39;<img alt=
               "error-file:tidyout.log" src="&#39; + imagefile + &#39;" height=
               "8" width="16">&#39;;//Normal weekend day task } else {
               strHTMLBar += &quot;&nbsp;&quot; //Normal weekend day no task }
               } else if(intWorkingDays==8) { strHTMLBar += &#39;
            </td>
            <td class="\">
               &#39; if (isTaskDay(projStartDate, taskStartDate, duration, i)
               == 1) { //Work on Sat. strHTMLBar += &#39;<img alt=
               "error-file:tidyout.log" src="&#39; + imagefile + &#39;" height=
               "8" width="16">&#39;;//Normal weekend day task } else { //Sunday
               no taskbar, normal weekend shading strHTMLBar
               +=&quot;&nbsp;&quot; //Normal weekend day no task } } else {
               strHTMLBar += &#39;
            </td>
            <td class="\">
               &#39; strHTMLBar +=&quot;&nbsp;&quot; //Normal weekend day no
               task } strHTMLBar +=&quot;
            </td>
         </tr>
      </table>
   </body>
</html>

