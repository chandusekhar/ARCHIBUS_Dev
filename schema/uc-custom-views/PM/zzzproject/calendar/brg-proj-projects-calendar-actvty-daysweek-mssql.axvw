<?xml version="1.0" encoding="UTF-8"?>
<afmXmlView>
	<preferences>
		<viewTitleBar show="false"/>
	</preferences>
	<title translatable="true">Actions, Days by Week</title>
	<afmTableGroup type="report" format="table">
    <afmAction name="test" type="render" response="true" state="">
    	<title translatable="true">Edit Move</title>
    </afmAction>
		<title translatable="true">Actions, Days by Week</title>	
		<dataSource>
			<database>
				<tables>
					<table name="afm_cal_dates" role="main"/>
				</tables>
				<fields>
					<field name="cal_date" table="afm_cal_dates"/>
					<field name="day_type" table="afm_cal_dates"/>
				</fields>
					<restrictions>
          <restriction type="parsed">
            <message name="mssql" translatable="false" />
          </restriction>
        </restrictions> 
			</database>
			<mdx>
				<preferences dimensions="1" format="Table">
					<query>
						<queryParameters>
							<queryParameter name="stateid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="siteid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="cityid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="blid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="dvid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="dpid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="programid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="activitytype" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="apprvmgr1" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="projectid" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="projecttype" type="java.lang.String" value="ABCDEFG"/>
							<queryParameter name="sRestyear" type="java.lang.String" value="1979"/>
							<queryParameter name="sRestmonth" type="java.lang.String" value="01"/>
						</queryParameters>					
											<sql dialect="generic">
                        SELECT  CAST(DATEPART(mm,cal_date) AS VARCHAR) #Concat%%  '/' #Concat%%  CAST(DATEPART(dd, cal_date) AS VARCHAR) #Concat%%  '/' #Concat%%  CAST(DATEPART(yy, cal_date) AS VARCHAR) as dateformated, day_type,
						(SELECT TOP 1 activity_log_id FROM activity_log 
						WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
						ORDER BY activity_log_id
						) AS task1, 
	(SELECT TOP 1 * 
	FROM	(SELECT TOP 2 activity_log_id FROM activity_log 
		WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task2,
						(SELECT TOP 1 * 
	FROM	(SELECT TOP 3 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task3,
					(SELECT TOP 1 * 
	FROM	(SELECT TOP 4 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task4,
			(SELECT TOP 1 * 
	FROM	(SELECT TOP 5 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task5,
					(SELECT TOP 1 * 
	FROM	(SELECT TOP 6 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task6,
						(SELECT TOP 1 * 
	FROM	(SELECT TOP 7 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task7,
					(SELECT TOP 1 * 
	FROM	(SELECT TOP 8 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )	
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task8,
					(SELECT TOP 1 * 
	FROM	(SELECT TOP 9 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task9,
					(SELECT TOP 1 * 
	FROM	(SELECT TOP 10 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) AS task10,
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 activity_log_id FROM activity_log 
						WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
						ORDER BY activity_log_id
						) and project.project_id=activity_log.project_id) AS daysPerWeekProj1 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 2 activity_log_id FROM activity_log 
		WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj2 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 3 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj3 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 4 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj4 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 5 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj5 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 6 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj6 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 7 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj7 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 8 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )	
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj8 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 9 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj9 , 
						(SELECT project.days_per_week FROM activity_log,project 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 10 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and project.project_id=activity_log.project_id) AS daysPerWeekProj10 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs  
						 WHERE activity_log_id = (SELECT TOP 1 activity_log_id FROM activity_log 
						WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
						ORDER BY activity_log_id
						) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK1 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 2 activity_log_id FROM activity_log 
		WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK2 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 3 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK3 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 4 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK4 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 5 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK5 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 6 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK6 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 7 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK7 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 8 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )	
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK8 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 9 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK9 , 
						(SELECT work_pkgs.days_per_week FROM activity_log,work_pkgs 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 10 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC) and work_pkgs.project_id = activity_log.project_id AND work_pkgs.work_pkg_id=activity_log.work_pkg_id) AS daysPerWeekWPK10 , 
						  (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 activity_log_id FROM activity_log 
						WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
						ORDER BY activity_log_id
						)) AS desc1 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 2 activity_log_id FROM activity_log 
		WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc2 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 3 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc3 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 4 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc4 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 5 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc5 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 6 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc6 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 7 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc7 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 8 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )	
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc8 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 9 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc9 , 
						 (SELECT action_title FROM activity_log 
						 WHERE activity_log_id = (SELECT TOP 1 * 
	FROM	(SELECT TOP 10 activity_log_id FROM activity_log 
	WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
		ORDER BY activity_log_id ASC) AS foo
	ORDER BY activity_log_id DESC)) AS desc10,						
						(SELECT ( CASE WHEN COUNT(*) > 10 THEN COUNT(*)-10 ELSE 0 END ) FROM activity_log
						WHERE  date_scheduled &lt;= cal_date
						and cal_date &lt;= date_scheduled_end
						and exists (select 1 from project left outer join bl on bl.bl_id=project.bl_id WHERE project.project_id=activity_log.project_id
						and (  bl.state_id LIKE #SqlParameter%stateid% OR ( #SqlParameter%stateid% = '%' and bl.state_id IS NULL )  )
						and (  bl.city_id LIKE #SqlParameter%cityid% OR ( #SqlParameter%cityid% = '%' and  bl.city_id  IS NULL )  )
						and (  bl.site_id LIKE #SqlParameter%siteid% OR ( #SqlParameter%siteid% = '%' and bl.site_id IS NULL )  )
						and (  bl.bl_id LIKE #SqlParameter%blid% OR ( #SqlParameter%blid% = '%' and bl.bl_id IS NULL )  )
						and (  project.dv_id LIKE #SqlParameter%dvid% OR ( #SqlParameter%dvid% = '%' and project.dv_id IS NULL )  )
						and (  project.dp_id LIKE #SqlParameter%dpid% OR ( #SqlParameter%dpid% = '%' and project.dp_id IS NULL )  )
						and   project.project_id LIKE #SqlParameter%projectid%
						and ( project.project_type LIKE #SqlParameter%projecttype% OR ( #SqlParameter%projecttype% = '%' and project.project_type IS NULL )  )
						and (  project.apprv_mgr1 LIKE #SqlParameter%apprvmgr1% OR ( #SqlParameter%apprvmgr1% = '%' and project.apprv_mgr1 IS NULL )  )
						and ( activity_log.activity_type  LIKE #SqlParameter%activitytype% OR ( #SqlParameter%activitytype% = '%' and activity_log.activity_type IS NULL )  )
						and (  project.program_id LIKE #SqlParameter%programid% OR ( #SqlParameter%programid% = '%' and project.program_id IS NULL )  )  )
						) 
						 AS moretasks 						
                            FROM
                                afm_cal_dates 
					   WHERE DATEPART( month, cal_date ) =#SqlParameter%sRestmonth%
					   and DATEPART( year, cal_date ) = #SqlParameter%sRestyear%					   
                        </sql>
					</query>
					<dimensions>
						<dimension name="Date" table="afm_cal_dates" column="dateformated" type="calculated" hasAll="true"/>
					</dimensions>
					<measures>
						<measure name="day_type" aggregator="min" column="day_type" type="calculated" datatype="string" />
						<measure name="task1" aggregator="min" column="task1" type="calculated" decimals="0"/>
						<measure name="task2" aggregator="min" column="task2" type="calculated" decimals="0"/>
						<measure name="task3" aggregator="min" column="task3" type="calculated" decimals="0"/>
						<measure name="task4" aggregator="min" column="task4" type="calculated" decimals="0"/>
						<measure name="task5" aggregator="min" column="task5" type="calculated" decimals="0"/>
						<measure name="task6" aggregator="min" column="task6" type="calculated" decimals="0"/>
						<measure name="task7" aggregator="min" column="task7" type="calculated" decimals="0"/>
						<measure name="task8" aggregator="min" column="task8" type="calculated" decimals="0"/>
						<measure name="task9" aggregator="min" column="task9" type="calculated" decimals="0"/>
						<measure name="task10" aggregator="min" column="task10" type="calculated" decimals="0"/>
						<measure name="desc1" aggregator="min" column="desc1" type="calculated" datatype="string" />
						<measure name="desc2" aggregator="min" column="desc2" type="calculated" datatype="string" />
						<measure name="desc3" aggregator="min" column="desc3" type="calculated" datatype="string" />
						<measure name="desc4" aggregator="min" column="desc4" type="calculated" datatype="string" />
						<measure name="desc5" aggregator="min" column="desc5" type="calculated" datatype="string" />
						<measure name="desc6" aggregator="min" column="desc6" type="calculated" datatype="string" />
						<measure name="desc7" aggregator="min" column="desc7" type="calculated" datatype="string" />
						<measure name="desc8" aggregator="min" column="desc8" type="calculated" datatype="string" />
						<measure name="desc9" aggregator="min" column="desc9" type="calculated" datatype="string" />
						<measure name="desc10" aggregator="min" column="desc10" type="calculated" datatype="string" />
						<measure name="daysPerWeekWPK1" aggregator="min" column="daysPerWeekWPK1" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK2" aggregator="min" column="daysPerWeekWPK2" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK3" aggregator="min" column="daysPerWeekWPK3" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK4" aggregator="min" column="daysPerWeekWPK4" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK5" aggregator="min" column="daysPerWeekWPK5" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK6" aggregator="min" column="daysPerWeekWPK6" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK7" aggregator="min" column="daysPerWeekWPK7" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK8" aggregator="min" column="daysPerWeekWPK8" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK9" aggregator="min" column="daysPerWeekWPK9" type="calculated" decimals="0"/>
						<measure name="daysPerWeekWPK10" aggregator="min" column="daysPerWeekWPK10" type="calculated" decimals="0"/>		
						<measure name="daysPerWeekProj1" aggregator="min" column="daysPerWeekProj1" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj2" aggregator="min" column="daysPerWeekProj2" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj3" aggregator="min" column="daysPerWeekProj3" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj4" aggregator="min" column="daysPerWeekProj4" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj5" aggregator="min" column="daysPerWeekProj5" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj6" aggregator="min" column="daysPerWeekProj6" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj7" aggregator="min" column="daysPerWeekProj7" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj8" aggregator="min" column="daysPerWeekProj8" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj9" aggregator="min" column="daysPerWeekProj9" type="calculated" decimals="0"/>
						<measure name="daysPerWeekProj10" aggregator="min" column="daysPerWeekProj10" type="calculated" decimals="0"/>	
						<measure name="moretasks" aggregator="min" column="moretasks" type="calculated" decimals="0"/>									
					</measures>
				</preferences>
			</mdx>
		</dataSource>
	</afmTableGroup>
	<formatting>
		<xsl file="ab-proj-projects-calendar.xsl"/>
	</formatting>
	<message name="viewtype" translatable="false">Week</message>	
</afmXmlView>
