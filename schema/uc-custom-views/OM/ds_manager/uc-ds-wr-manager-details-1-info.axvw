<!-- Change Log -->
<!-- 2010/03/31 - JJYCHAN - ISSUE 30: Made account code description visible -->
<!-- 2010/03/31 - JJYCHAN - ISSUE 34: Hid paginated report action button -->
<!-- 2010/04/06 - JJYCHAN - ISSUE 35: changed the Enabled for Create-Subrequest to a binding expr -->
<!-- 2010/04/07 - EWONG - Added page security javascript. -->
<!-- 2010/04/07 - EWONG - ISSUE 29: Added onchange event for tr_id and required messages. -->
<!-- 2010/04/08 - JJYCHAN - ISSUE 67: Added Requestor Info button and dataSources -->
<!-- 2010/04/13 - JJYCHAN - ISSUE 84: Priority label changed from "Work Request Priority" to "Priority" -->
<!-- 2010/04/13 - JJYCHAN - ISSUE 85: "Work Request Code" label changed to "Work Request #" -->
<!-- 2010/04/13 - JJYCHAN - ISSUE 95: Changed "Equipment Code" to "Equipment Barcode" -->
<!-- 2010/04/15 - EWONG - ISSUE 29: Added a listener for the Select Value to call the onchange event. -->
<!-- 2010/04/15 - JJYCHAN - ISSUE 59: Added fields for the capture of error reports -->
<!-- 2010/04/19 - EWONG - ISSUE 83: Added id to the "Auto Select Account" button to allow for enable/disable. -->
<!-- 2010/05/10 - EWONG - ISSUE:153: Calls the updateAcctDesc function on change of any of the account code fields. -->
<!-- 2010/05/20 - JJYCHAN - Changed Affiliate to Activity -->
<!-- 2010/06/01 - JJYCHAN - Added error Account 99 -->
<!-- 2010/06/18 - JJYCHAN - Date requested made Read Only -->
<!-- 2010/07/07 - EWONG - ISSUE 231: Added Equipment Information Popup. -->
<!-- 2010/07/13 - EWONG - ISSUE 240: Fixed a formatting issue when ac description is overly long. -->
<!-- 2010/08/12 - EWONG - Added 'Create New Request' button (enabled for UC-CSC). -->
<!-- 2010/08/17 - EWONG - ISSUE 258: Fixed a formatting issue when ac description is overly long. Used a different method -->
<!--                       the previous method causes unintention formatting side-effects. -->
<!-- 2010/11/24 - EWONG - 18.2 Upgrade: Removed spaces from the visibleFieldNames in the custom selectValue (causing only first field displayed). -->
<!-- 2011/01/06 - JJYCHAN - Added Action "Create Records Request" -->
<!-- 2012/06/27 - ASO - WR171754 -Update the Print function so that it used the new DS2 printed view instead of old printed view -->
<!-- 2016/01/14 - MSHUSSAI - WR358933 - Update the javascript name to incorporate changes for email on FWC, as well as added two new fields for count to ds_wr_details10  -->
<!-- 2016/01/27 - MSHUSSAI - WR365449 - Updated the axvw file to show info for SLA screen -->
<!-- 2016/02/25 - MSHUSSAI - WR370782 - Updated the axvw file to show the Residence Unit No -->
<!-- 2016/06/27 - MSHUSSAI - Added new function called sendEmailOnHP() in the javascript in order to handle emailing On Hold for Parts -->
<!-- 2016/07/19 - MSHUSSAI - Updated name of javascript to uc-ds-wr-manager-details-2-costs_8.js -->
<!-- 2016/07/20 - MSHUSSAI - Added condition to saveWorkRequestCraftsperson() function to prompt user to Issue request when a new Craftsperson is added -->

<view version="2.0">

	<js file="uc-common-functions-ui.js" />
	<js file="uc-common-functions-data.js" />
	<js file="uc-page-security.js"/>
	<js file="uc-ds-wr-manager-details-1-info_9.js" />
	<js file="uc-ds-wr-manager-details-2-costs_11.js" />
 	<js file="brg-common.js"/>
    <js file="brg-common-ui.js"/>
	<script type="text/javascript" src="/resource/uc-psAccountCode.js"></script>
	<script type="text/javascript" src="/resource/uc-email.js"></script>

	<!--layout id="nested_center" containingLayout="main" region="center">
		<north id="row2col1" initialSize="33%" split="true"/>
		<center id="row3col1" />
	</layout-->

	<!-- 2012/06/27 - ASO - Update the Print function so that it used the new DS2 printed view instead of old printed view (WR171754)-->
	<js file="uc-wr-print-form.js"/>
	<js file="uc-print1_2.js"/>
	<js file="vann-barcode.js"/>
	<!--layout type="borderLayout" id="mainLayout">
        <center autoScroll="true" id="centerRegion"/>
        <east initialSize="0" id="PrintLayout"/>
    </layout-->
	<layout type="borderLayout" id="mainLayout">
        <center autoScroll="true" id="centerRegion"/>
        <east initialSize="0" id="PrintLayout"/>
    </layout>
	<layout  type="borderLayout" id="nestedLayout" containingLayout="mainLayout" region="center">
		<center id="docLayout"  autoScroll="true"/>
	</layout>
	<message name="formNameToGetWrId">nav_details_info</message> <!-- this is used as parameter for uc-wr-print-form.js -->

	<message name="wrArchivedMessage">The Work Requested has been Archived.</message>
	<message name="error_invalidAccount">The Account Code entered is invalid. </message>
	<message name="error_Account1">The Account Business Unit code entered is invalid.</message>
	<message name="error_Account2">The Account Fund code entered is invalid.</message>
	<message name="error_Account3">The Account Department Code entered is invalid.</message>
	<message name="error_Account4">The Account Code Acct entered is invalid.</message>
	<message name="error_Account5">The Account Program Code entered is invalid.</message>
	<message name="error_Account6">The Account Internal Code entered is invalid.</message>
	<message name="error_Account7">The Account Project Code entered is invalid.</message>
	<message name="error_Account8">The Account Activity Code entered is invalid.</message>
	<message name="subReqCreated">A sub-request has been successfully created.</message>
	<message name="error_Account99">There was a problem validating the account code. Please try saving again.</message>


	<message name="error_zeroCosts">This Work Request cannot be Completed until all Labor/Material costs are entered or fulfilled.</message>
	<message name="error_noParts">This Request can not be put on hold for parts if there are no parts requested.</message>
	<message name="trId_changed">Work Request Status will be reset to Requested due to Primary Trade change.</message>
	<message name="trId_status_invalid">The Primary Trade cannot be changed at this Work Request status (%1).</message>
	<message name="noDateToPerformForPriority">Date to Perform must be specified when setting Priority to Date Specific.</message>

	<message name="noRecordSelected">No Records Selected.</message>

	<!-- DataSource for Auditing any WR changes -->
	<dataSource id="ds_audit_log">
		<table name="audit_log" role="main"/>
		<field table="audit_log" name="table_name"/>
		<field table="audit_log" name="modified_by_username"/>
		<field table="audit_log" name="modified_on_date"/>
		<field table="audit_log" name="modified_at_time"/>
		<field table="audit_log" name="modification_type"/>
		<field table="audit_log" name="description"/>
	</dataSource>


	<dataSource id="ds_wr_details13">
	
		<query>
			<sql dialect="generic">
        select wr.wr_id, wr.wo_id, wr.activity_log_id, wr.status, wr.requestor, wr.prob_type, wr.location, wr.description, wr.date_requested, wr.time_requested, wr.date_assigned, wr.bl_id, wr.fl_id, wr.rm_id, wr.eq_id, wr.ac_id, wr.priority, wr.cf_notes,
        wr.tr_id, wr.charge_type, wr.cost_est_total, wr.block_id, wr.unit_id, wr.work_team_id, wr.cf_id, bl.zone_id, ac.description as acdesc, wo.qty_open_wr, eq.eq_std, wr.confined_space,
        (select count(wr_id) from wr wr1 where wr1.wo_id=wr.wo_id and status IN ('FWC', 'Com', 'Rej', 'Exp', 'Can', 'Clo', 'IR', 'IN')) as fwc_count, (select count(wr_id) from wr wr3 where wr3.wo_id=wr.wo_id) as total_count,
        (SELECT COUNT(*) FROM uc_env_hazard_by_room haz WHERE wr.bl_id = haz.bl_id AND wr.fl_id = haz.fl_id AND wr.rm_id = haz.rm_id) AS hazard_count,
        wr.doc1, wr.doc2, wr.doc3, wr.doc4
        from wr
        left join bl on wr.bl_id=bl.bl_id
        left join ac on wr.ac_id=ac.ac_id
        left join wo on wr.wo_id=wo.wo_id
        left join eq on wr.eq_id=eq.eq_id

      </sql>
		</query>
		
		<table name="wr" role="main" />
		<table name="bl" role="standard"/>
		<table name="ac" role="standard"/>
		<table name="wo" role="standard"/>
		<table name="eq" role="standard"/>
		
		<field table="wr" name="wr_id" />
		<field table="wr" name="wo_id" />
		<field table="wr" name="activity_log_id" />
		<field table="wr" name="status" />
		<field table="wr" name="requestor" />
		<field table="wr" name="prob_type" />
		<field table="wr" name="location"/>
		<field table="wr" name="description" />
		<field table="wr" name="date_requested" />
		<field table="wr" name="time_requested"/>
		<field table="wr" name="date_assigned"/>
		<field table="wr" name="bl_id" />
		<field table="wr" name="fl_id" />
		<field table="wr" name="rm_id" />
		<field table="wr" name="eq_id" />
		<field table="wr" name="ac_id" />
		<field table="wr" name="priority" />
		<field table="wr" name="cf_notes" />
		<field table="wr" name="tr_id"/>
		<field table="wr" name="charge_type"/>
    <field table="wr" name="cost_est_total"/>
		<field table="wr" name="block_id"/>
		<field table="wr" name="unit_id"/>
		<field table="wr" name="work_team_id"/>
		<field table="wr" name="cf_id"/>
		<field table="bl" name="zone_id"/>
		<!--field table="ac" name="description"/-->
		<field table="wo" name="qty_open_wr"/>
		<field table="eq" name="eq_std"/>
		<field table="ac" name="acdesc" dataType="text"/>
		<field table="wr" name="fwc_count" dataType="number" decimals="0" size="10"/>
		<field table="wr" name="total_count" dataType="number" decimals="0" size="10"/>
		<field table="wr" name="hazard_count" dataType="number" decimals="0" size="10"/>
		 <field table="wr" name="confined_space"/>
		<field table="wr" name="doc1"/>
		<field table="wr" name="doc2"/>
		<field table="wr" name="doc3"/>
		<field table="wr" name="doc4"/>

		
	</dataSource>



	<panel type="form" id="nav_details_info" dataSource="ds_wr_details13" columns="3" showOnLoad="false" labelsPosition="top"  layoutRegion="docLayout">
		<title translatable="true">Work Request</title>
		<action id="openEmailDialog">
			<title>Email WR</title>
		</action>

		<action id="createRecordsReq" hidden="${infoTabController.enableCreateRecordsReqBtn()}">
			<title>Create Records WR</title>
			<command type="openDialog" viewName="uc-wr-create-records-req.axvw" applyParentRestriction="false" newRecord="true" closeButton="false"/>


		</action>

		<action id="createNewReq" hidden="${infoTabController.enableCreateNewReqBtn()}">
			<title>Create New WR</title>
			<command type="openDialog" viewName="uc-wr-create-main.axvw" applyParentRestriction="false"/>
		</action>

		<action id="pageReport" hidden="${user.role} != 'UC-FACULTYENG'">
			<title>Print Invoice</title>
			<command type="callFunction" functionName="infoTabController.openPaginatedReport()" />
		</action>

		<!-- Print the Request for Craftspeople -commented out on 2012/06/27 to use the new print
		<action id="printCF">
			<title>Print WR</title>
			<command type="callFunction" functionName="openPrintWindow"/>
		</action-->
		<!-- 2012/06/27 - ASO - Update the Print function so that it used the new DS2 printed view instead of old printed view (WR171754)-->
		<action id="print">
			<title>Print</title>
		</action>

		<action id="createSubReq" enabled="${infoTabController.refreshCreateSubReqBtn()}">
			<title>Create Sub WR</title>
			<command type="callFunction" functionName="infoTabController.createSubReq()" />
		</action>

		<action id="reportError">
			<title>Report Error</title>
			<!--command type="openDialog" panelId="errorReportPanel" applyParentRestriction="true" newRecord="true" closeButton="false"/-->
			<!--command type="callFunction" functionName="fillErrorInfo" /-->
			<command type="openDialog" viewName="uc-wr-error-report.axvw" applyParentRestriction="false" newRecord="true" closeButton="false"/>
		</action>

		<action id="save" imageName="/schema/ab-core/graphics/save.gif">
			<title>Save</title>
			<tooltip>Save Changes</tooltip>
			<command type="callFunction" functionName="infoTabController.checkAcctAndSave()" />
			<!--command type="saveForm"/-->
			<!--command type="callFunction" functionName="afterSaveWorkflow" /-->
		</action>

        <!--Row1-->
		<field table="wr" name="wr_id" ><title>Work Request #</title></field>
		<field table="bl" name="zone_id" alias="bl.zone_id.display" required="false" readOnly="true" />
		<field table="wr" name="tr_id" >
			<action id="wrkUnitSelVal">
				<title>...</title>
				<tooltip>Select Value</tooltip>
				<command type="selectValue"
					fieldNames="wr.tr_id"
					selectFieldNames="tr.tr_id"
					visibleFieldNames="tr.tr_id,tr.description"
				/>
			</action>
		</field>

        <!--Row2-->
		<field table="wr" name="status" hidden="true" ><title>STATUS</title></field>
		<field table="wr" name="status" alias="wr.status.display" />
		<field table="wr" name="bl_id" required="false"  readOnly="true" hidden="false"/>
        <!--
		<field table="wr" name="rm_id" alias="wr.location.display" readOnly="true" hidden="true">
			<title>Location</title>

		</field>
        -->

		<!-- field>
		<title>Location</title>
			<html>
				<input id="location_value" readOnly="true" value="" class="defaulteditform_textareaabdata_readonly" style="width:98%;height:auto;border: 0;background-color:transparent;overflow:scroll;" />
				<action>
				<title>Info</title>
				<command type="callFunction" functionName="infoTabController.openEqInfo();"/>
			</action>
			</html>

		</field -->
		<field table="wr" name="work_team_id" readOnly="true"/>

        <!--Row3-->
		<field table="wr" name="requestor" readOnly="${1==1}" cssClass="defaulteditform_textareaabdata_readonly">
			<action id="selectReq" hidden="true" >
				<title>...</title>
				<tooltip>Select Requestor</tooltip>
				<command type="selectValue"
					fieldNames="wr.requestor"
					selectFieldNames="em.em_id"
					visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.email" />
			</action>
			<action id="showReqInfo">
				<title>Info</title>
				<command type="openDialog" panelId="requestorInfo" closeButton="true" height="400"/>
				<command type="callFunction" functionName="View.panels.get('nav_details_info').fields.get('wr.requestor').actions.get('showReqInfo').enableButton(true);" />
			</action>
		</field>
		<field table="wr" name="fl_id"  readOnly="false" hidden="false"/>
        <field table="wr" name="prob_type"  readOnly="true"/>

        <!--Row4-->
		<field table="wr" name="date_requested" readOnly="true" hidden="true"><title>Date Requested</title></field>
		<field table="wr" name="time_requested" readOnly="true" hidden="true"><title>Time Requested</title></field>
		<field table="wr" name="location" alias="wr.date_requested.display" readOnly="true"><title>Date Requested</title></field>
		
		<!--field table="wr" name="priority" alias="wr.priority.display"/-->

		<field table="wr" name="rm_id"  readOnly="false" hidden="false"/>
		<field table="wr" name="priority"><title>Priority</title>
			<action>
				<title>Info</title>
				<command type="openDialog" panelId="priorityInfo" closeButton="true" width="390" height="255"/>
			</action>
		</field>

        <!--Row5-->
		<field table="wr" name="date_assigned"/>
		<field table="wr" name="block_id"  readOnly="true" hidden="true"/>
		<!-- <field table="eq" name="eq_std" alias="eq.eq_std.display" required="false" showSelectValueAction="false" readOnly="${1==1}" style="width:98%;height:auto;border: 0;background-color:transparent"/> -->
		<!--field table="wr" name="location"/-->
        <field table="wr" name="unit_id" readOnly="true" hidden="false"/>
		<field table="wr" name="eq_id" >
			<title>Equipment Barcode</title>
			<action>
				<title>...</title>
				<tooltip>Select Equipment</tooltip>
				<command type="selectValue"
					fieldNames="wr.eq_id, eq.eq_std.display"
					selectFieldNames="eq.eq_id, eq.eq_std"
					visibleFieldNames="eq.eq_id,eq.eq_std" />
			</action>
			<action>
				<title>Info</title>
				<command type="callFunction" functionName="infoTabController.openEqInfo();"/>
			</action>
		</field>

		<!--Row6-->
		<field table="wr" name="charge_type" colspan="1"></field>
		<field id="hazard_icon">
            <title>Room Hazards</title>
            <html>
                <input id="hazard_icon" type="image" alt="" title="" hspace="1" border="0"
                       src="/archibus/schema/ab-system/graphics/warning.png" onclick="showHazardsByRoom(); return false;" />
            </html>
        </field>

        <field table="wr" name="confined_space"/>
    <!--Row7-->
    <field table="wr" name="cost_est_total" colspan="3" style="width:207px"></field>
		<!-- On Form Search Button -->
		<field colspan="3" hidden="true">
			<html>
				<body>
					<input type="button" id="autoSelAcctBtn" value="Auto-select Account" onclick="infoTabController.openAccountSelect()"/>
				</body>
			</html>
		</field>

		<field table="wr" name="ac_id" colspan="3" style="border: 0" showSelectValueAction="false" readOnly="true"><title>Account Code</title></field>
		<field table="ac" name="acdesc" required="false" colspan="3" rowspan="1" showSelectValueAction="false" readOnly="true" hidden="false" style="border: 0;" />
		<field alias="account_code_fld" colspan="3">
			<!--title>Account Description</title-->
			<html>
				<table border="0" style="margin-left:-4;width:98%;" cellpadding="0" cellspacing="0">
					<tr>
					<input id= "ac_desc_value" name="ac_desc_value" readOnly="true" hidden="true" value="" class="defaulteditform_textareaabdata_readonly" style="width:98%;height:auto;border: 0;background-color:transparent;overflow:scroll;" />
					</tr>
				</table>
				<table border="0" style="margin-left:-4;display:none" cellpadding="0" cellspacing="0">
					<tr>
						<td>Bus. Unit<br/><input type="text" name="ac_id_part1" id="ac_id_part1" maxlength="5" size="4" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Fund<br/><input type="text" id="ac_id_part2" maxlength="2" size="2" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Dept<br/><input type="text" id="ac_id_part3" maxlength="5" size="4" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Acct<br/><input type="text" id="ac_id_part4" maxlength="8" size="8" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Program<br/><input type="text" id="ac_id_part5" maxlength="8" size="8" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Internal<br/><input type="text" id="ac_id_part6" maxlength="10" size="10" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Proj<br/><input type="text" id="ac_id_part7" maxlength="10" size="10" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
						<td>Activity<br/><input type="text" id="ac_id_part8" maxlength="8" size="8" onChange="afm_form_values_changed=true;infoTabController.updateAcctDesc();"/></td>
					</tr>
				</table>
			</html>
		</field>

		<!--field table="ac" name="description" required="false" colspan="5" showSelectValueAction="false" readOnly="true" style="border: 0;background-color:transparent;"/-->
		<!--field table="ac" name="description" required="false" colspan="3" showSelectValueAction="false" readOnly="false" style="border: 0;background-color:transparent;"/-->


		<!--field table="wr" name="description" colspan="3"  rowspan="3" readOnly="${1==1}"/-->
		<field table="wr" name="description" colspan="3"  style="width:98%;height:200" readOnly="true"/>

		<field table="wr" name="cf_notes" alias="wr.cf_notes.new" colspan="1" rowspan="3">
			<title>Add additional Craftsperson Notes</title>
		</field>
		<!--field table="wr" name="cf_notes" colspan="2" rowspan="3" readOnly="${1==1}" /-->
		<field table="wr" name="cf_notes" colspan="2" rowspan="3" style="display:block;width:100.1%;" readOnly="true" />
		<field table="wr" name="wo_id" hidden="true" />
		<field colspan="4"/>

	</panel>

	<!-- *********************** DOCUMENTS GRID************************** -->
	<panel type="form" id="documentPanel" dataSource="ds_wr_details13" showOnLoad="false" layoutRegion="docLayout" columns="2">
		<title>Documents</title>
		<field table="wr" name="wr_id" hidden="true"/>
		<field table="wr" name="doc1"/>
		<field table="wr" name="doc2"/>
		<field table="wr" name="doc3"/>
		<field table="wr" name="doc4"/>
	</panel>


	<!-- ******************************************************** -->
	<!-- Report Equipment Error                                   -->
	<!-- ******************************************************** -->

	<dataSource id="errorDs1">
		<table name="uc_eq_error_report" role="main"/>
		<field table="uc_eq_error_report" name="wr_id"/>
		<!--field table="uc_eq_error_report" name="eq_id"/-->
		<field table="uc_eq_error_report" name="error_type"/>
		<field table="uc_eq_error_report" name="description"/>
		<field table="uc_eq_error_report" name="user_name"/>
		<field table="uc_eq_error_report" name="date_reported"/>

	</dataSource>

	<panel type="form" id="errorReportPanel" dataSource="errorDs1" labelsPosition="top" showOnLoad="false" layoutRegion="docLayout">
		<title>Report Data Error</title>
		<action id="save" imageName="/schema/ab-core/graphics/save.gif">
			<title>Send</title>
			<tooltip>Send Error</tooltip>
			<command type="saveForm"/>

			<command type="closeDialog"/>
		</action>
		<action id="errorCancel">
			<title>Cancel</title>
			<tooltip>Cancel Changes</tooltip>
			<command type="closeDialog" />
		</action>

		<field table="uc_eq_error_report" name="wr_id"/>
		<!--field table="uc_eq_error_report" name="eq_id" readOnly="true"/-->
		<field table="uc_eq_error_report" name="error_type"/>
		<field table="uc_eq_error_report" name="description" rowspan="3"/>
		<field table="uc_eq_error_report" name="user_name" hidden="true"/>
		<field table="uc_eq_error_report" name="date_reported" hidden="true"/>
	</panel>

	<!-- ****************************************************** -->
	<!-- Show Requestor Information								-->
	<!-- ****************************************************** -->

	<dataSource id="reqInfo_ds">
		<table name="wr" role="main"/>

		<field table="wr" name="requestor"/>
		<field table="wr" name="phone"/>
	</dataSource>
	<dataSource id="em_ds">
		<table name="em" role="main"/>
		<table name="dv" role="standard"/>
		<table name="dp" role="standard"/>
		<field table="em" name="em_id"/>
		<field table="em" name="name_first"/>
		<field table="em" name="name_last"/>
		<field table="em" name="email"/>
		<field table="em" name="phone"/>
		<field table="em" name="dp_id"/>
		<field table="em" name="dv_id"/>
		<field table="dp" name="name"/>
		<field table="dv" name="name"/>
	</dataSource>

	<panel type="form" id="requestorInfo" dataSource="reqInfo_ds" showOnLoad="false" layoutRegion="docLayout">
		<title>Requestor Info</title>

		<field table="wr" name="requestor" readOnly="true"/>


		<field alias="name_first" ><title>First Name:</title></field>
		<field alias="name_last" ><title>Last Name:</title></field>
		<field alias="email" ><title>Email:</title></field>
		<field table="wr" name="phone" readOnly="true"><title>Phone:</title></field>
		<field alias="dv_id" ><title>Division:</title></field>
		<field alias="dp_id" ><title>Department:</title></field>



	</panel>

	<!-- ****************************************************** -->
	<!-- Show Equipment Information		              			-->
	<!-- ****************************************************** -->

	<dataSource id="equipInfo_ds1">
		<table name="eq" role="main"/>
		<field table="eq" name="eq_id"/>
		<field table="eq" name="eq_std"/>
		<field table="eq" name="use1"/>
		<field table="eq" name="condition"/>
		<field table="eq" name="bl_id"/>
		<field table="eq" name="fl_id"/>
		<field table="eq" name="rm_id"/>
		<field table="eq" name="doc1"/>
		<field table="eq" name="comments"/>
	</dataSource>

	<panel type="form" id="eqInfo" dataSource="equipInfo_ds1" showOnLoad="false" layoutRegion="docLayout">
		<title>Equipment Info</title>

		<field table="eq" name="eq_id" readOnly="true" required="false"/>
		<field table="eq" name="eq_std" readOnly="true" required="false"/>
		<field table="eq" name="use1" readOnly="true" required="false"/>
		<field table="eq" name="condition" readOnly="true" required="false"/>
		<field table="eq" name="bl_id" readOnly="true" required="false"/>
		<field table="eq" name="fl_id" readOnly="true" required="false"/>
		<field table="eq" name="rm_id" readOnly="true" required="false"/>
		<field table="eq" name="doc1" readOnly="true"/>
		<field table="eq" name="comments" readOnly="true" required="false"/>
	</panel>
	
	<!-- ****************************************************** -->
	<!-- Show Priority Information								-->
	<!-- ****************************************************** -->

	<panel type="html" id="priorityInfo" showOnLoad="false">
		<title>Priority SLA Details</title>
		<html>
		<h6 align="left"><span style="font-weight:normal">1-Emergency/Safety - Immediate / Same day Response</span></h6>
		<h6 align="left"><span style="font-weight:normal">2-High - Up to 48 Hours Response</span></h6>
		<h6 align="left"><span style="font-weight:normal">3-Medium - Up to 10 Days Response</span></h6>
		<h6 align="left"><span style="font-weight:normal">4-Low - Up to 30 Days Response</span></h6>
		<h6 align="left"><span style="font-weight:normal">5-Scheduled - Date Sensitive</span></h6>
		</html>
	</panel>

	

	<message name="noRecordsSelect">No Records Selected.</message>
	<message name="confirmDelete">Are you sure you want to delete the selected records?</message>
	<message name="cannotDeleteCf">There is a cost associated with one or more of the selected Craftspeople.  These line items cannot be deleted.</message>
	<message name="cannotDeleteOther">One or more of the parts could not be deleted as they have already been processed.</message>
	<message name="quantityZero">Please enter a quantity (Quantity cannot be zero).</message>
	<message name="confirmSetOnHoldForParts">Do you want to put this request on hold for parts?</message>
	<message name="confirmSetIssued">Do you want to issue this request?</message>
	
	
	<!-- *************************************************************** -->
	<!-- PJHA Panels                                               	 	 -->
	<!-- *************************************************************** -->
	<dataSource id="ds_pjha" >
		<table name="uc_pjha_value" role="main" />
		<field table="uc_pjha_value" name="value_id" />
		<field table="uc_pjha_value" name="wr_id" />
		<field table="uc_pjha_value" name="pjha_submit_date" />
		<field table="uc_pjha_value" name="cf_id" />
		<field table="uc_pjha_value" name="hazcat_id" />
		<field table="uc_pjha_value" name="control_id" />
	</dataSource>
	
	<panel type="grid" id="pjhaReportGrid" dataSource="ds_pjha" showOnLoad="false" layoutRegion="docLayout">
		<title>PJHA</title>
		<action id="refreshPJHA">
			<title>Refresh</title>
			<command type="showPanel" panelId="pjhaReportGrid"/>
		</action>
		<field table="uc_pjha_value" name="value_id" hidden="true"/>
		<field table="uc_pjha_value" name="wr_id" hidden="true"/>
		<field table="uc_pjha_value" name="pjha_submit_date" />
		<field table="uc_pjha_value" name="cf_id" />
		<field table="uc_pjha_value" name="hazcat_id" />
		<field table="uc_pjha_value" name="control_id" />
	</panel>
	

	
	
	<!-- *************************************************************** -->
	<!-- Labour Panels                                                   -->
	<!-- *************************************************************** -->
	<dataSource id="ds_wrcf_assign" >
		<table name="wrcf" role="main" />
		<field table="wrcf" name="wr_id" />
		<field table="wrcf" name="cf_id" />
		<field table="wrcf" name="date_assigned" />
		<field table="wrcf" name="time_assigned" />
		<field table="wrcf" name="hours_straight" />
		<field table="wrcf" name="hours_over" />
		<field table="wrcf" name="hours_double" />
		<field table="wrcf" name="cost_total" />
		<field table="wrcf" name="entry_type" />
		<restriction type="sql" sql="entry_type = 'Assignment'"/>
	</dataSource>

	<panel type="grid" id="wrcfReportGrid" dataSource="ds_wrcf_assign"  multipleSelectionEnabled="true" showOnLoad="false"  layoutRegion="docLayout">
		<title>Craftspersons Assignment</title>

		<sortField table="wrcf" name="cf_id" ascending="true" />
		<sortField table="wrcf" name="date_assigned" ascending="false" />

		<action id="btnWrcfAdd" imageName="/schema/ab-core/graphics/add.gif">
			<title>Add</title>
			<tooltip>Add New Labour</tooltip>
			<command type="callFunction" functionName="clearchecks('wrcfReportGrid')" />
			<command type="openDialog" panelId="wrcfEditPanel" newRecord="true" closeButton="false" applyParentRestriction="true" />
			<command type="callFunction" functionName="fillRequiredInfo" />
		</action>
		<action type="javascript" onclick="deleteItems('wrcfReportGrid','wrcf')">
				<title>Delete</title>
				<tooltip>Delete Selected Labour</tooltip>
		</action>

		<field table="wrcf" name="wr_id" hidden="true" />
		<field table="wrcf" name="cf_id" controlType="link">
			<command type="openDialog" panelId="wrcfEditPanel" />
			<command type="callFunction" functionName="setShowHours(false)" />
		</field>
		<field table="wrcf" name="date_assigned" ><title>Date Assigned</title></field>
		<field table="wrcf" name="time_assigned" hidden="true" />
	</panel>

	<dataSource id="ds_wrcf_timecard" >
		<table name="wrcf" role="main" />
		<field table="wrcf" name="wr_id" />
		<field table="wrcf" name="cf_id" />
		<field table="wrcf" name="date_assigned" />
		<field table="wrcf" name="time_assigned" />
		<field table="wrcf" name="hours_straight" />
		<field table="wrcf" name="hours_over" />
		<field table="wrcf" name="hours_double" />
		<field table="wrcf" name="cost_total" />
		<field table="wrcf" name="entry_type" />
		<restriction type="sql" sql="entry_type = 'Timecard'"/>
	</dataSource>

	<panel type="grid" id="wrcfTimeReportGrid" dataSource="ds_wrcf_timecard"  multipleSelectionEnabled="true" showOnLoad="false"  layoutRegion="docLayout">
		<title>Craftsperson Timecards</title>

		<sortField table="wrcf" name="cf_id" ascending="true" />
		<sortField table="wrcf" name="date_assigned" ascending="false" />

		<action id="btnWrcfAddTime" imageName="/schema/ab-core/graphics/add.gif">
			<title>Add</title>
			<tooltip>Add New Labour</tooltip>
			<command type="callFunction" functionName="clearchecks('wrcfReportGrid')" />
			<command type="openDialog" panelId="wrcfEditPanel" newRecord="true" closeButton="false" applyParentRestriction="true" />
			<command type="callFunction" functionName="fillRequiredInfo" />
		</action>
		<action type="javascript" onclick="deleteItems('wrcfTimeReportGrid','wrcf')">
				<title>Delete</title>
				<tooltip>Delete Selected Labour</tooltip>
		</action>

		<field table="wrcf" name="wr_id" hidden="true" />
		<field table="wrcf" name="cf_id" controlType="link">
			<command type="openDialog" panelId="wrcfEditPanel" />
			<command type="callFunction" functionName="setShowHours(true)" />
		</field>
		<field table="wrcf" name="date_assigned" ><title>Date of Work</title></field>
		<field table="wrcf" name="time_assigned" hidden="true" />
		<field table="wrcf" name="hours_straight"><title>Regular Hours</title></field>
		<field table="wrcf" name="hours_over" />
		<field table="wrcf" name="hours_double" />
		<field table="wrcf" name="cost_total" />
	</panel>

	<dataSource id="ds_wrcf" >
		<table name="wrcf" role="main" />
		<field table="wrcf" name="wr_id" />
		<field table="wrcf" name="cf_id" />
		<field table="wrcf" name="date_assigned" />
		<field table="wrcf" name="time_assigned" />
		<field table="wrcf" name="hours_straight" />
		<field table="wrcf" name="hours_over" />
		<field table="wrcf" name="hours_double" />
		<field table="wrcf" name="cost_total" />
        <field table="wrcf" name="entry_type" />
	</dataSource>

	<!-- This panel only show up (in its own dialog) when Add button is clicked. -->
	<panel type="form" id="wrcfEditPanel" dataSource="ds_wrcf" showOnLoad="false">
		<title>Add/Edit Labour</title>
		<script>
			function setShowHours(showHours) {
				var panel = View.panels.get("wrcfEditPanel");
				panel.showField("wrcf.hours_straight",showHours);
				panel.showField("wrcf.hours_over",showHours);
				panel.showField("wrcf.hours_double",showHours);
				panel.showField("wrcf.cost_total",showHours);
			}
		</script>
		<action id="btnWrcfSave" imageName="/schema/ab-core/graphics/save.gif">
			<title>Save</title>
			<tooltip>Save Changes</tooltip>
			<command type="saveForm"/>
			<command type="callFunction" functionName="saveWorkRequestCraftsperson" />	<!-- Rolls up hours and costs. -->
			<command type="closeDialog" />
		</action>
		<action id="btnWrcfCancel">
			<title>Cancel</title>
			<tooltip>Cancel Changes</tooltip>
			<command type="closeDialog" />
		</action>

		<field table="wrcf" name="wr_id" readOnly="true" />
		<field table="wrcf" name="cf_id" >


			<action>
				<title>...</title>
				<tooltip>Select Value</tooltip>
                <command type="callFunction" functionName="selectCraftsperson()" />
			</action>
		</field>


		<field table="wrcf" name="date_assigned" ><title>Date of Work</title></field>
		<field table="wrcf" name="time_assigned" hidden="true" required="false"/> <!-- auto-filled, so not required. -->
		<field table="wrcf" name="hours_straight"><title>Regular Hours</title></field>
		<field table="wrcf" name="hours_over" />
		<field table="wrcf" name="hours_double" />
        <field table="wrcf" name="entry_type" readOnly="true"/>
	</panel>

	<!-- *************************************************************** -->
	<!-- Tools Panels                                                   -->
	<!-- *************************************************************** -->
	<dataSource id="ds_wrtl" >
		<table name="wrtl" role="main" />
		<field table="wrtl" name="wr_id" />
		<field table="wrtl" name="tool_id" />
		<field table="wrtl" name="date_assigned" />
		<field table="wrtl" name="time_assigned" />
		<field table="wrtl" name="hours_straight" />
		<field table="wrtl" name="hours_over" />
		<field table="wrtl" name="cost_total" />

	</dataSource>

	<panel type="grid" id="wrtlReportGrid" dataSource="ds_wrtl"  multipleSelectionEnabled="true" showOnLoad="false" layoutRegion="docLayout">
		<title>Rental Tools</title>

		<sortField table="wrtl" name="tool_id" ascending="true" />
		<sortField table="wrtl" name="date_assigned" ascending="false" />

		<action id="btnWrtlAdd" imageName="/schema/ab-core/graphics/add.gif">
			<title>Add</title>
			<tooltip>Add New Tools</tooltip>
			<command type="callFunction" functionName="clearchecks('wrtlReportGrid')" />
			<command type="openDialog" panelId="wrtlEditPanel" newRecord="true" closeButton="false"/>
			<command type="callFunction" functionName="fillRequiredInfo" />
		</action>
		<action type="javascript" onclick="deleteItems('wrtlReportGrid','wrtl')">
				<title>Delete</title>
				<tooltip>Delete Selected Tools</tooltip>
		</action>

		<field table="wrtl" name="wr_id" hidden="true" />
		<field table="wrtl" name="tool_id" controlType="link">
			<command type="openDialog" panelId="wrtlEditPanel" />
		</field>
		<field table="wrtl" name="date_assigned" />
		<field table="wrtl" name="time_assigned" hidden="true" />
		<field table="wrtl" name="hours_straight"><title>Hours Used</title></field>
		<field table="wrtl" name="hours_over" hidden="true" />
		<field table="wrtl" name="cost_total" />
	</panel>

	<!-- This panel only show up (in its own dialog) when Add button is clicked. -->
	<panel type="form" id="wrtlEditPanel" dataSource="ds_wrtl" showOnLoad="false" layoutRegion="docLayout">
		<title>Add/Edit Tools</title>
		<action id="btnWrtlSave" imageName="/schema/ab-core/graphics/save.gif">
			<title>Save</title>
			<tooltip>Save Changes</tooltip>
			<command type="saveForm"/>
			<command type="callFunction" functionName="saveWorkRequestTool"/>	<!-- Rolls up hours and costs. -->
			<command type="closeDialog" />
		</action>
		<action id="btnWrtlCancel">
			<title>Cancel</title>
			<tooltip>Cancel Changes</tooltip>
			<command type="closeDialog" />
		</action>

		<field table="wrtl" name="wr_id" readOnly="true" />
		<field table="wrtl" name="date_assigned" hidden="true" />
		<field table="wrtl" name="time_assigned" hidden="true" />
		<field table="wrtl" name="tool_id" >
			<title>Tool Code</title>
			<action>
				<title>...</title>
				<tooltip>Select Value</tooltip>
				<command type="selectValue"
					fieldNames="wrtl.tool_id"
					selectFieldNames="tl.tool_id"
					visibleFieldNames="tl.tool_id,tl.tool_type,tl.status"
					restriction="tl.status='A'"
					recordLimit="1000"/>
			</action>
		</field>
		<field table="wrtl" name="hours_straight" ><title>Hours used</title></field>
		<!--field table="wrtl" name="hours_over" /-->
	</panel>

	<!-- *************************************************************** -->
	<!-- Others/Contractors/Parts Panels                                 -->
	<!-- *************************************************************** -->
	<dataSource id="ds_wr_other2" >
		<table name="wr_other" role="main" />
		<field table="wr_other" name="wr_id" />
		<field table="wr_other" name="other_rs_type" />
		<field table="wr_other" name="date_used" />
		<field table="wr_other" name="description" />
		<field table="wr_other" name="qty_used" />
		<field table="wr_other" name="cost_total" />
		<field table="wr_other" name="fulfilled"/>
		<field table="wr_other" name="vn_id"/>
		
		<field table="wr_other" name="pr_num"/>
        <field table="wr_other" name="po_num"/>
        <field table="wr_other" name="po_line"/>
        <field table="wr_other" name="inv_num"/>
        <field table="wr_other" name="vo_num"/>
        <field table="wr_other" name="quote_num"/>
        <field table="wr_other" name="quote_amt"/>
		<field table="wr_other" name="doc1"/>
		<field table="wr_other" name="em_admin"/>
	</dataSource>

	<panel type="grid" id="wrOtherReportGrid" dataSource="ds_wr_other2"  multipleSelectionEnabled="true" showOnLoad="false" layoutRegion="docLayout">
		<title>Parts/Contractors/Other</title>

		<sortField table="wr_other" name="other_rs_type" ascending="true" />
		<sortField table="wr_other" name="date_used" ascending="false" />
		<action id="btnWrOtherCLRAdd" imageName="/schema/ab-core/graphics/add.gif">
			<title>Add CLR</title>
			<tooltip>Add Contractor Labor Request</tooltip>
			<command type="openDialog" panelId="wrOtherCLREditPanel" newRecord="true" closeButton="false"/>
			<command type="callFunction" functionName="fillRequiredInfo" />
		</action>

		<action id="btnWrOtherAdd" imageName="/schema/ab-core/graphics/add.gif">
			<title>Add</title>
			<tooltip>Add New Parts/Other Costs</tooltip>
			<command type="callFunction" functionName="clearchecks('wrOtherReportGrid')" />
			<command type="openDialog" panelId="wrOtherEditPanel" newRecord="true" closeButton="false"/>
			<command type="callFunction" functionName="fillRequiredInfo" />
		</action>
		<action type="javascript" onclick="deleteItems('wrOtherReportGrid','wr_other')">
				<title>Delete</title>
				<tooltip>Delete Selected Other Costs</tooltip>
		</action>

		<field id="edit" controlType="button">
            <title translatable="true">Edit CLR</title>
			<command type="openDialog" panelId="wrOtherCLREditPanel" />
        </field>
		<field table="wr_other" name="wr_id" hidden="true" />
		<field table="wr_other" name="fulfilled"><title>Fulfilled</title></field>
		<field table="wr_other" name="other_rs_type" controlType="link"><title>Type</title>
			<command type="openDialog" panelId="wrOtherEditPanel" />
		</field>

		<field table="wr_other" name="date_used" hidden="true"/>
		<field table="wr_other" name="description"><title>Description</title></field>
		<field table="wr_other" name="qty_used" ><title>Qty</title></field>
		<field table="wr_other" name="cost_total" />

		<field table="wr_other" name="pr_num"/>
		<field table="wr_other" name="po_num"/>
	</panel>

	<!-- This panel only show up (in its own dialog) when Add button is clicked. -->
	<panel type="form" id="wrOtherEditPanel" dataSource="ds_wr_other2" showOnLoad="false" beforeSave="wrOtherEditPanel_beforeSave" layoutRegion="docLayout">
		<title>Add/Edit Parts/Other Costs</title>
		<action id="btnWrOtherSave" imageName="/schema/ab-core/graphics/save.gif" hidden="${record['wr_other.fulfilled'] != '0'}">
			<title>Save</title>
			<tooltip>Save Changes</tooltip>
			<command type="saveForm" />
			<command type="callFunction" functionName="saveWorkRequestOther"/>	<!-- Rolls up hours and costs. -->
			<command type="closeDialog" />
		</action>
		<action id="btnWrOtherCancel">
			<title>Cancel</title>
			<tooltip>Cancel Changes</tooltip>
			<command type="closeDialog" />
		</action>

		<field table="wr_other" name="wr_id" readOnly="true"/>
		<field table="wr_other" name="fulfilled"  readOnly="true" />

		<field table="wr_other" name="other_rs_type" onchange="costTabController.onOtherChanged()" readOnly="${record['wr_other.fulfilled'] != '0'}">
			<title>Part/Other Type</title>
			<action id="otherSelVal">
				<title>...</title>
				<tooltip>Select Value</tooltip>
				<command type="selectValue"
					fieldNames="wr_other.other_rs_type"
					selectFieldNames="other_rs.other_rs_type"
					visibleFieldNames="other_rs.other_rs_type,other_rs.description"
					restriction="other_rs.other_rs_type not like 'LOAD%'"
					actionListener="onOtherSelect"
				/>
			</action>
		</field>

		<field table="wr_other" name="vn_id" enabled="false"/>
		<field table="wr_other" name="date_used" hidden="true" />
		<field table="wr_other" name="description" required="true" readOnly="${record['wr_other.fulfilled'] != '0'}">
			<title>Part/Other Description</title>
		</field>
		<field table="wr_other" name="qty_used" required="true" readOnly="${record['wr_other.fulfilled'] != '0'}">
			<title>Quantity</title>
		</field>
		<field table="wr_other" name="cost_total"><title>Total Cost</title></field>
	</panel>

	<panel type="form" id="wrOtherCLREditPanel" dataSource="ds_wr_other2" showOnLoad="false" labelsPosition="left" columns="1" region="center">
        <title translatable="true">Contract Labor Request</title>
        <action id="details_save">
            <title translatable="true">Save</title>
			<!--command type="callFunction" functionName="beforeSave()"/-->
            <command type="saveForm"/>
			<command type="callFunction" functionName="saveCLR"/>
			<!--command type="closeDialog" /-->
        </action>
  
        <field name="wr_id" table="wr_other" showSelectValueAction="" readOnly="true"/>

        <field name="vn_id" table="wr_other" showSelectValueAction="" required="true"/>
        <field name="description" table="wr_other" showSelectValueAction="" required="true"/>
        <field name="date_used" table="wr_other" showSelectValueAction=""/>
        <field name="pr_num" table="wr_other" showSelectValueAction=""/>
        <field name="po_num" table="wr_other" showSelectValueAction=""/>
        <field name="po_line" table="wr_other" showSelectValueAction=""/>
        <field name="inv_num" table="wr_other" showSelectValueAction=""/>
        <field name="vo_num" table="wr_other" showSelectValueAction=""/>
        <field name="quote_num" table="wr_other" showSelectValueAction=""/>
        <field name="quote_amt" table="wr_other" showSelectValueAction=""/>
		<field name="doc1" table="wr_other" showSelectValueAction=""/>
		<field name="em_assign" table="wr_other" showSelectValueAction=""/>
        <field name="qty_used" table="wr_other" showSelectValueAction="" hidden="true"/>
		<field table="wr_other" name="fulfilled" showSelectValueAction="" readOnly="false" hidden="false"/>
		<field name="other_rs_type" table="wr_other" showSelectValueAction="" readOnly="true" hidden="true"/>
    </panel>




	<panel type="form" id="sendEmailDialog" dataSource="ds_wr_other2" showOnLoad="false">
		<title>Send Email</title>
		<action id="sendWrEmail">
			<title>Send</title>
			<command type="callFunction" functionName="onSendWrEmail"/>
			<command type="closeDialog"/>
		</action>
		<instructions>Separate different email addresses with semi-colons.</instructions>
		<field table="wr_other" name="description"><title>Email Addresses</title></field>
	</panel>

	<!-- 2012/06/27 - ASO - Update the Print function so that it used the new DS2 printed view instead of old printed view (WR171754)-->
	<dataSource id="wrlist_ds">
		<table name="wr" role="main"/>
		<field table="wr" name="wr_id" />
	</dataSource>
	<panel type="view" id="defaultHTML" file="uc-discipline-supervisor-manager-report.axvw" dataSource="wrlist_ds" layoutRegion="PrintLayout" useFrame="false" />
</view>
