<view version="2.0">

  <js file="ab-viewdef-common-console.js"/>
  <js file="uc-manage-vehicle-grid_1.js"/>
  <js file="brg-common.js"/>
  <js file="brg-common-ui.js"/>
  <js file="uc-common-functions-data.js" />
  <js file="pro-radio-grid.js"/>
  <js file="pro-pms-cal.js"/>
  <script type="text/javascript" src="/resource/uc-psAccountCode.js"></script>

  <title translatable="true">Vehicle Details</title>
  <dataSource id="eqdet_ds">
    <table name="eq" role="main"/>
    <field table="eq" name="eq_id"/>
    <field table="eq" name="eq_std"/>
    <field table="eq" name="status"/>
    <field table="eq" name="use1"/>
    <field table="eq" name="option1"/>
    <field table="eq" name="option2"/>
    <field table="eq" name="meter"/>
    <field table="eq" name="meter_units"/>
    <field table="eq" name="comments"/>
    <field table="eq" name="dv_id"/>
    <field table="eq" name="bl_id"/>
    <field table="eq" name="dp_id"/>
    <restriction type="sql" sql="eq_std = 'VEHCL-XXXX-XXXXX'"/>
  </dataSource>

  <dataSource id="vehicle_log_ds">
    <table name="uc_vehicle_log" role="main"/>
    <field name="vehicle_id" table="uc_vehicle_log"/>
    <field name="hazmat_to" table="uc_vehicle_log"/>
    <field name="hazmat_from" table="uc_vehicle_log"/>
    <field name="hazmat_types" table="uc_vehicle_log"/>
    <field name="uc_vehicle_log_id" table="uc_vehicle_log"/>
    <field name="safety_quest" table="uc_vehicle_log"/>
    <field name="date_stamp" table="uc_vehicle_log"/>
    <field name="time_stamp" table="uc_vehicle_log"/>
    <field name="em_id" table="uc_vehicle_log"/>
  </dataSource>


  <dataSource id="vehicledet_ds27">
    <table name="vehicle" role="main"/>
    <field table="vehicle" name="ac_id"/>
    <field table="vehicle" name="age_acquired"/>
    <field table="vehicle" name="avail_fdo"/>
    <field table="vehicle" name="avail_fro"/>
    <field table="vehicle" name="eq_id"/>
    <field table="vehicle" name="battery"/>
    <field table="vehicle" name="color"/>
    <field table="vehicle" name="comments"/>
    <field table="vehicle" name="condition"/>
    <field table="vehicle" name="cost_ins_perils"/>
    <field table="vehicle" name="cost_ins_premium"/>
    <field table="vehicle" name="date_ins"/>
    <field table="vehicle" name="date_ins_cancelled"/>
    <field table="vehicle" name="meter_delivery"/>
    <field table="vehicle" name="cost_purchase"/>
    <field table="vehicle" name="inspected_by"/>
    <field table="vehicle" name="vn_id"/>
    <field table="vehicle" name="cost_mkt"/>
    <field table="vehicle" name="curb_weight"/>
    <field table="vehicle" name="date_assign"/>
    <field table="vehicle" name="date_assign_em"/>
    <field table="vehicle" name="date_excessed"/>
    <field table="vehicle" name="date_installed"/>
    <field table="vehicle" name="date_lease_ends"/>
    <field table="vehicle" name="date_lease_start"/>
    <field table="vehicle" name="date_manufactured"/>
    <field table="vehicle" name="date_meter_last_read"/>
    <field table="vehicle" name="date_mkt"/>
    <field table="vehicle" name="date_purchased"/>
    <field table="vehicle" name="description"/>
    <field table="vehicle" name="dp_id"/>
    <field table="vehicle" name="drive_type"/>
    <field table="vehicle" name="dv_id"/>
    <field table="vehicle" name="em_id"/>
    <field table="vehicle" name="engine"/>
    <field table="vehicle" name="engine_size"/>
    <field table="vehicle" name="front_tires" />
    <field table="vehicle" name="fuel_capacity"/>
    <field table="vehicle" name="fuel_type_id"/>
    <field table="vehicle" name="gvw"/>
    <field table="vehicle" name="hailstorm_repair"/>
    <field table="vehicle" name="hailstorm_writeoff"/>
    <field table="vehicle" name="haz_doc"/>
    <field table="vehicle" name="hazmat_from"/>
    <field table="vehicle" name="hazmat_to"/>
    <field table="vehicle" name="hazmat_types"/>
    <field table="vehicle" name="image_spec"/>
    <field table="vehicle" name="image_veh_assy"/>
    <field table="vehicle" name="image_veh_lub"/>
    <field table="vehicle" name="image_vehicle"/>
    <field table="vehicle" name="license"/>
    <field table="vehicle" name="loc_manual_maint"/>
    <field table="vehicle" name="loc_manual_other"/>
    <field table="vehicle" name="loc_manual_part"/>
    <field table="vehicle" name="loc_vehicle"/>
    <field table="vehicle" name="maint_prior"/>
    <field table="vehicle" name="meter"/>
    <field table="vehicle" name="meter_in_miles"/>
    <field table="vehicle" name="meter_units"/>
    <field table="vehicle" name="mfr_id"/>
    <field table="vehicle" name="model_id"/>
    <field table="vehicle" name="model_year"/>
    <field table="vehicle" name="num_lease"/>
    <field table="vehicle" name="cost_lease"/>
    <field table="vehicle" name="num_serial"/>
    <field table="vehicle" name="occ"/>
    <field table="vehicle" name="option1"/>
    <field table="vehicle" name="option2"/>
    <field table="vehicle" name="owned"/>
    <field table="vehicle" name="parking_id"/>
    <field table="vehicle" name="payload"/>
    <field table="vehicle" name="photo"/>
    <field table="vehicle" name="qty_life_expct"/>
    <field table="vehicle" name="qty_life_expct_units"/>
    <field table="vehicle" name="rear_tires" />
    <field table="vehicle" name="rem_acquisition"/>
    <field table="vehicle" name="rent_rate_day"/>
    <field table="vehicle" name="rent_rate_hour"/>
    <field table="vehicle" name="rent_rate_month"/>
    <field table="vehicle" name="rent_rate_mtr_unit"/>
    <field table="vehicle" name="risk_comments"/>
    <field table="vehicle" name="spec_height"/>
    <field table="vehicle" name="spec_length"/>
    <field table="vehicle" name="spec_width"/>
    <field table="vehicle" name="status"/>
    <field table="vehicle" name="transmission"/>
    <field table="vehicle" name="turning_rad"/>
    <field table="vehicle" name="vehicle_id"/>
    <field table="vehicle" name="vehicle_type_id"/>
    <field table="vehicle" name="org_contact"/>
    <field table="vehicle" name="org_admin"/>
    <field table="vehicle" name="budget_owner"/>

    <field table="vehicle" name="po_acq"/>
    <!--<field table="vehicle" name="po_doc"/>-->
    <field table="vehicle" name="reg_renew"/>
    <field table="vehicle" name="cost_register"/>
    <field table="vehicle" name="econ_city"/>
    <field table="vehicle" name="econ_highway"/>
    <field table="vehicle" name="emissions"/>
    <field table="vehicle" name="disposal_no"/>
    <field table="vehicle" name="salvage_value"/>
    <field table="vehicle" name="disposal_requestor"/>
    <field table="vehicle" name="disposal_authorizer"/>
    <field table="vehicle" name="date_reg_cancelled"/>
    <field table="vehicle" name="qty_pms"/>
    <field table="vehicle" name="vehicle_quest"/>
    <field table="vehicle" name="maint_agreement"/>
    <table name="eq" role="standard"/>
    <field table="eq" name="option1" dataType="text" size="20">
      <sql dialect="sqlserver">
        (case when vehicle.occ &gt; 10 then '&gt;10 Passengers' when vehicle.gvw &gt; 11794 then '&gt;11,794 kg' when vehicle.gvw &gt;= 4500 then '4,500 to 11,794 kg' else '&lt;4,500 kg' end)
      </sql>
    </field>

  </dataSource>

  <dataSource id="vehiclemaint_ds">

    <table name="uc_fleetmaintsched" role="main"/>
    <field table="uc_fleetmaintsched" name="maint_id"/>
    <field table="uc_fleetmaintsched" name="vehicle_id"/>
    <field table="uc_fleetmaintsched" name="date_next_maint"/>
    <field table="uc_fleetmaintsched" name="date_scheduled"/>
    <field table="uc_fleetmaintsched" name="meter_next_maint"/>
    <field table="uc_fleetmaintsched" name="pmp_id"/>
    <field table="uc_fleetmaintsched" name="status"/>
    <field table="uc_fleetmaintsched" name="wr_id"/>
    <field table="uc_fleetmaintsched" name="comments"/>
  </dataSource>


  <!-- DataSource Odometer Reading -->
  <dataSource type="grouping" id="odometerChartDS1">
    <table name="uc_fleet_odo" role="main"/>
    <field table="uc_fleet_odo" name="vehicle_id"/>
    <field table="uc_fleet_odo" name="month" baseField="uc_fleet_odo.date_odo" formula="month" dataType="text" groupBy="true"/>
    <field name="avg_odometer" formula="avg" baseField="uc_fleet_odo.odometer" dataType="number" decimals="2">
      <title translatable="true">Meter Reading</title>
    </field>
    <sortField table="uc_fleet_odo" name="month" ascending="true"/>
  </dataSource>


  <!--ViewDef-Chart-Popup-Begin-->
  <dataSource id="odometerChart_popupDS1">
    <table name="uc_fleet_odo" role="main" />
    <field table="uc_fleet_odo" name="date_odo"/>
    <field table="uc_fleet_odo" name="odometer"/>
    <parameter name="month" dataType="text" value=""/>
    <restriction type="sql" sql="${sql.yearMonthOf('uc_fleet_odo.date_odo')} &lt;= ${parameters['month']} AND ${sql.yearMonthOf('uc_fleet_odo.date_odo')} &gt;= ${parameters['month']}"/>
  </dataSource>


  <dataSource id="ds_activity_log1" >
    <table name="activity_log" role="main" />
    <field table="activity_log" name="wr_id" />
    <field table="activity_log" name="requestor" />
    <field table="activity_log" name="phone_requestor"/>
    <field table="activity_log" name="dv_id" />
    <field table="activity_log" name="dp_id" />
    <field table="activity_log" name="bl_id" />
    <field table="activity_log" name="fl_id" />
    <field table="activity_log" name="rm_id" />
    <field table="activity_log" name="prob_type" />
    <field table="activity_log" name="description" />
    <field table="activity_log" name="eq_id" />
    <field table="activity_log" name="date_requested" />
    <field table="activity_log" name="ac_id" />
    <field table="activity_log" name="activity_type" />
    <field table="activity_log" name="location"/>
    <field table="activity_log" name="tr_id"/>
    <field table="activity_log" name="block_id"/>
    <field table="activity_log" name="unit_id"/>
    <field table="activity_log" name="pmp_id"/>
    <field table="activity_log" name="budget_owner"/>
  </dataSource>


  <dataSource id="wr_ds6">
    <table name="wr" role="main"/>
    <field table="wr" name="wr_id"/>
    <field table="wr" name="date_requested"/>
    <field table="wr" name="status"/>
    <field table="wr" name="pmp_id"/>
    <field table="wr" name="prob_type"/>
    <field table="wr" name="requestor"/>
    <field table="wr" name="description"/>
    <field table="wr" name="cost_total"/>
    <field table="wr" name="date_assigned"/>
    <field table="wr" name="date_fwc"/>

    <parameter name="clientRestriction" dataType="verbatim" value=""/>
    <restriction type="sql" sql="wr.prob_type not in ('FLEET-FUEL') ${parameters['clientRestriction']}" />
  </dataSource>



  <dataSource id="hwr_ds7">
    <table name="hwr" role="main"/>
    <field table="hwr" name="wr_id"/>
    <field table="hwr" name="date_requested"/>
    <field table="hwr" name="status"/>
    <field table="hwr" name="pmp_id"/>
    <field table="hwr" name="prob_type"/>
    <field table="hwr" name="requestor"/>
    <field table="hwr" name="description"/>
    <field table="hwr" name="cost_total"/>
    <field table="hwr" name="date_assigned"/>
    <field table="hwr" name="date_fwc"/>

    <parameter name="clientRestriction" dataType="verbatim" value=""/>
    <restriction type="sql" sql="hwr.prob_type not in ('FLEET-FUEL')  ${parameters['clientRestriction']}" />
  </dataSource>

  <dataSource id="parts_ds1">
    <table name="uc_vehiclept" role="main"/>
    <field table="uc_vehiclept" name="vehicle_id"/>
    <field table="uc_vehiclept" name="part_id"/>
    <field table="uc_vehiclept" name="qty_a"/>
    <field table="uc_vehiclept" name="qty_b"/>
    <field table="uc_vehiclept" name="qty_c"/>
    <field table="uc_vehiclept" name="qty_d"/>
    <field table="uc_vehiclept" name="qty_e"/>
  </dataSource>

  <!-- ************** VEHICLE DETAILS PANEL ************************* -->


  <tabs workflow="free" id="vehicleManagementTabs" region="center">

    <tab name="fleetMGRTab" selected="true">
      <!--***************** VEHICLE DETAILS TAB ****************************-->
      <title translatable="true">Fleet Management</title>

      <!--***************** VEHICLE LOG PANEL ****************************-->
      <panel type="form" id="vehicle_log_panel" dataSource="vehicle_log_ds" hidden="true" columns="2" region="center" newRecord="true">
        <field name="vehicle_id" table="uc_vehicle_log" hidden="true"/>
        <field name="hazmat_to" table="uc_vehicle_log" hidden="true"/>
        <field name="hazmat_from" table="uc_vehicle_log" hidden="true"/>
        <field name="hazmat_types" table="uc_vehicle_log" hidden="true"/>
        <field name="uc_vehicle_log_id" table="uc_vehicle_log" hidden="true"/>
        <field name="safety_quest" table="uc_vehicle_log" hidden="true"/>
        <field name="date_stamp" table="uc_vehicle_log" hidden="true"/>
        <field name="time_stamp" table="uc_vehicle_log" hidden="true"/>
        <field name="em_id" table="uc_vehicle_log" hidden="true"/>
      </panel>


      <panel type="form" id="vehicle_details" dataSource="vehicledet_ds27" showOnLoad="true" columns="2" region="center">

        <title translatable="true">Vehicle Details</title>

        <action id="vehicle_save" hidden="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
          <title translatable="true">Save</title>
          <command type="callFunction" functionName="checkAcctSaveVehicleData" />
        </action>

        <fieldset colspan="1">
          <title>General Information</title>

          <field name="vehicle_id" table="vehicle" required="true" readOnly="${!panel.newRecord}">
            <title>Unit #</title>
          </field>
          <field table="vehicle" name="eq_id" required="true" showSelectValueAction="false" readOnly="${!panel.newRecord}">
            <title>FM Barcode</title>
          </field>

          <field table="vehicle" name="mfr_id" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" onchange="mfrOnchange('','','')">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.mfr_id"
								selectFieldNames="flt_mfr.mfr_id"
								visibleFieldNames="flt_mfr.mfr_id,flt_mfr.description"
								actionListener="mfrOnchange"
								applyFilter="true"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="status" hidden="true"/>
          <field table="vehicle" name="status" alias="vstatus" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>

          <field table="vehicle" name="model_id" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" onchange="modelOnchange()"/>
          <field table="vehicle" name="num_serial" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <title>VIN</title>
          </field>

          <field table="vehicle" name="model_year" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="color" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>

          <field table="vehicle" name="vehicle_type_id" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="license" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>

          <field></field>
          <field table="vehicle" name="option1">
            <title>Asset Tag</title>
          </field>
          <field table="vehicle" name="description" hidden="true"/>
          <field >
            <title>Vehicle Description</title>
            <html>
              <ui>
                <textarea maxlength="100" wrap="PHYSICAL" name="vehicle.description.new" id="vehicle.description.new" style="height:50;width:600" class="defaulteditform_textareaabdata"></textarea>
              </ui>
            </html>
          </field>
        </fieldset>
        <fieldset>
          <title>Technical Data</title>

          <field table="vehicle" name="meter" readOnly="true" enabled="false" controlType="link">

          </field>
          <field table="vehicle" name="date_meter_last_read" readOnly="true"/>
          <field >
            <action id="update_odo" >
              <title >Update Odometer</title>
              <command type="openDialog" panelId="odometerVehicleDetailsPanel" width="400" height="250" newRecord="true" closeButton="false"/>
            </action>
          </field>
          <field table="vehicle" name="meter_units" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="drive_type" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="transmission" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="occ" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" onchange="regType()"/>
          <field table="vehicle" name="gvw" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" onchange="regType()" required="false"/>
          <field table="vehicle" name="curb_weight" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="payload" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="spec_length" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="spec_width" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="spec_height" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="front_tires" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="rear_tires" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="engine" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="battery" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" />
          <field table="vehicle" name="engine_size" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="qty_life_expct_units" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="fuel_type_id" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="fuel_capacity" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="cost_mkt" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="date_mkt" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="eq" name="option1" required="false">
            <title>Registration Type</title>
          </field>
          
        </fieldset>
        <!--field/-->
        <fieldset colspan="2">
          <title>Account Information</title>
          <field table="vehicle" name="maint_agreement" />
          <field table="vehicle" name="ac_id" hidden="true"/>
          <field colspan="1">
            <title>Account Code</title>
            <html>
              <table border="0" style="margin-left:-4" cellpadding="0" cellspacing="0">
                <tr>
                  <td>
                    Bus. Unit<br/><input type="text" name="vac_id_part1" id="vac_id_part1" maxlength="5" size="4" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Fund<br/><input type="text" id="vac_id_part2" maxlength="2" size="2" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Dept<br/><input type="text" id="vac_id_part3" maxlength="5" size="4" onChange="afm_form_values_changed=true;v.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Acct<br/><input type="text" id="vac_id_part4" maxlength="8" size="8" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Program<br/><input type="text" id="vac_id_part5" maxlength="8" size="8" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Internal<br/><input type="text" id="vac_id_part6" maxlength="10" size="10" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Proj<br/><input type="text" id="vac_id_part7" maxlength="10" size="10" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                  <td>
                    Activity<br/><input type="text" id="vac_id_part8" maxlength="8" size="8" onChange="afm_form_values_changed=true;vehicleCreateBasicController.updateVehAcctDesc();"/>
                  </td>
                </tr>
              </table>
            </html>
          </field>
        </fieldset>

        <fieldset colspan="1">
          <title>Ownership Details</title>


          <field table="vehicle" name="avail_fdo" required="true" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="dv_id" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="dp_id" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>



          <field table="vehicle" name="em_id" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>


          <field table="vehicle" name="org_contact" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <title>Driver</title>
            <action>
              <command type="selectValue"
								fieldNames="vehicle.org_contact"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="true"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="budget_owner" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.budget_owner"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="false"/>
              <title>...</title>
            </action>
          </field>

          <field table="vehicle" name="org_admin" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.org_admin"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="true"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="owned" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="loc_vehicle" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>


          <field table="vehicle" name="comments" hidden="true"/>
          <field colspan="1">
            <title>Ownership Comments</title>
            <html>
              <ui>
                <textarea wrap="PHYSICAL" name="vehicle.comments.new" id="vehicle.comments.new" style="height:50;width:600" class="defaulteditform_textareaabdata"></textarea>
              </ui>
            </html>
          </field>


        </fieldset>

        <fieldset colspan="1">
          <title>Purchase Details</title>

          <field table="vehicle" name="date_installed" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <title>Delivery Date</title>
          </field>
          <field table="vehicle" name="meter_delivery" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="cost_purchase" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="vn_id" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="condition" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="inspected_by" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.inspected_by"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="false"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="po_acq" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="num_lease" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="cost_lease" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="date_lease_start" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="date_lease_ends" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        </fieldset>



        <fieldset colspan="1">
          <title>Environmental Impact Details</title>
          <field table="vehicle" name="econ_city" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="econ_highway" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="emissions" required="false" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field/>
        </fieldset>



        <fieldset colspan="1">
          <title>Disposal Details</title>
          <field table="vehicle" name="disposal_no" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="date_excessed" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>

          <field table="vehicle" name="disposal_requestor" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.disposal_requestor"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="false"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="disposal_authorizer" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
            <action>
              <command type="selectValue"
								fieldNames="vehicle.disposal_authorizer"
								selectFieldNames="em.em_id"
								visibleFieldNames="em.em_id,em.name_last,em.name_first,em.phone,em.cellular_number,em.email,em.dv_id,em.dp_id"
								sortFieldNames="em.em_id"
								applyFilter="false"/>
              <title>...</title>
            </action>
          </field>
          <field table="vehicle" name="date_reg_cancelled" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="date_ins_cancelled" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="salvage_value" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
          <field table="vehicle" name="haz_doc" readOnly="${!(View.user.role=='UC_FLEETMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}" >

          </field>
          <!--colspan=number of panel colums-->
        </fieldset>

      </panel>
    </tab>


    <tab name="riskMGRTab">
      <!--***************** RISK  TAB ****************************-->
      <title translatable="true">Risk Management</title>
      <panel type="form" id="vehiclerisk_details" dataSource="vehicledet_ds27" showOnLoad="true" columns="2" region="center">
        <title translatable="true">Vehicle Details</title>

        <action id="vehiclerisk_save" hidden="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
          <title translatable="true">Save</title>
          <command type="callFunction" functionName="saveVehicleRiskData"/>
          <command type="showPanel" panelId="vehicle_drilldown" applyParentRestriction="false"/>
          <command type="showPanel" panelId="vehicle_log_panel" applyParentRestriction="false" show="false"/>
        </action>
        <action id="send_fleet" hidden="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
          <title translatable="true">Notify Fleet Management</title>
          <command type="callFunction" functionName="saveVehicleRiskData"/>
          <command type="showPanel" panelId="vehicle_drilldown" applyParentRestriction="false"/>
          <command type="showPanel" panelId="vehicle_log_panel" applyParentRestriction="false" show="false"/>
        </action>



        <field name="vehicle_id" table="vehicle" readOnly="true"/>
        <field table="vehicle" name="eq_id" readOnly="true"/>

        <field table="vehicle" name="mfr_id" readOnly="true"/>
        <field table="vehicle" name="status" readOnly="true"/>

        <field table="vehicle" name="model_id" readOnly="true"/>
        <field table="vehicle" name="num_serial" readOnly="true">
          <title>VIN</title>
        </field>

        <field table="vehicle" name="model_year" readOnly="true"/>
        <field table="vehicle" name="color" readOnly="true"/>

        <field table="vehicle" name="vehicle_type_id" readOnly="true"/>
        <field table="vehicle" name="license" readOnly="true"/>

        <field table="vehicle" name="description" readOnly="true" colspan="2" rowspan="3"/>

        <!--colspan=number of panel colums-->
        <field colspan="4">
          <html>
            <!--Keep Name and ID as sectionLabels this is used by the JS-->
            <div class="x-toolbar x-small-editor panelToolbar " name="sectionLabels" id="sectionLabels" style="width: 100%">
              <table cellspacing="0">
                <tbody>
                  <tr>
                    <td style="background-color: transparent;border:none;height:auto;padding:0">
                      <!--Change Section Title here-->
                      <em unselectable="on">
                        <input type="checkbox" id="insCheckBox" onclick="showCheckedFields();">
                          <b>Insurance Required?</b>
                        </input>
                      </em>
                    </td>
                    <td style="width: 100%; background-color: transparent;border:none;height:auto;padding:0" id="ext-gen253">
                      <div class="ytb-spacer" id="ext-gen54"></div>
                    </td>


                  </tr>
                </tbody>
              </table>
            </div>
          </html>
        </field>
        <field table="vehicle" name="cost_ins_perils" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}">
          <title>Deductible ($)</title>
        </field>
        <field table="vehicle" name="cost_ins_premium" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="hailstorm_writeoff" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="hailstorm_repair" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="date_ins" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="date_ins_cancelled" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <!--colspan=number of panel colums-->
        <field colspan="4">
          <html>
            <!--Keep Name and ID as sectionLabels this is used by the JS-->
            <div class="x-toolbar x-small-editor panelToolbar " name="sectionLabels" id="sectionLabels" style="width: 100%">
              <table cellspacing="0">
                <tbody>
                  <tr>
                    <td style="background-color: transparent;border:none;height:auto;padding:0">
                      <!--Change Section Title here-->
                      <em unselectable="on">
                        <input type="checkbox" id="hazCheckBox" onclick="showCheckedFields();">
                          <b>Hazardous Material Carried?</b>
                        </input>
                      </em>
                    </td>
                    <td style="width: 100%; background-color: transparent;border:none;height:auto;padding:0" id="ext-gen253">
                      <div class="ytb-spacer" id="ext-gen54"></div>
                    </td>



                  </tr>
                </tbody>
              </table>
            </div>
          </html>
        </field>
        <field table="vehicle" name="hazmat_types" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="haz_doc" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="hazmat_from" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>
        <field table="vehicle" name="hazmat_to" readOnly="${!(View.user.role=='UC_FLEETRISKMANAGER' || View.user.role=='UC-SYSDEV' || View.user.role=='UC-SYSADMIN')}"/>

        <!--colspan=number of panel colums-->
        <field colspan="4">
          <html>
            <!--Keep Name and ID as sectionLabels this is used by the JS-->
            <div class="x-toolbar x-small-editor panelToolbar " name="sectionLabels" id="sectionLabels" style="width: 100%">
              <table cellspacing="0">
                <tbody>
                  <tr>
                    <td style="background-color: transparent;border:none;height:auto;padding:0">
                      <!--Change Section Title here-->
                      <span class="ytb-text" id="sectionLabels_title">Risk Comments</span>
                    </td>
                    <td style="width: 100%; background-color: transparent;border:none;height:auto;padding:0" id="ext-gen253">
                      <div class="ytb-spacer" id="ext-gen54"></div>
                    </td>

                  </tr>
                </tbody>
              </table>
            </div>
          </html>
        </field>



        <field table="vehicle" name="risk_comments" colspan="2" hidden="true"/>
        <field colspan="2">
          <title>Risk Manager Comments</title>
          <html>
            <ui>
              <textarea wrap="PHYSICAL" name="vehicle.risk_comments.old" id="vehicle.risk_comments.old" style="height:100;width:600" class="defaulteditform_textareaabdata"></textarea>
            </ui>
          </html>
        </field>
      </panel>


      <panel type="form" id="hidden_fields_panel" dataSource="vehicledet_ds27" showOnLoad="false" columns="2" formLabelWidth="20">
        <field name="vehicle_id" table="vehicle" readOnly="true"/>
        <field id="hazmat_to_old">
          <html>
            <ui>
              <input type="hidden" id="old_hazmat_to" name="old_hazmat_to"/>
            </ui>
          </html>
        </field>
        <field id="hazmat_types_old">
          <html>
            <ui>
              <input type="hidden" id="old_hazmat_types" name="old_hazmat_types"/>
            </ui>
          </html>
        </field>
        <field id="hazmat_from_old">
          <html>
            <ui>
              <input type="hidden" id="old_hazmat_from" name="old_hazmat_from"/>
            </ui>
          </html>
        </field>
        <field colspan="3">
          <title>update or insert</title>
          <html>
            <ui>
              <input name="update_or_insert" id="update_or_insert" type="hidden"/>
            </ui>
          </html>
        </field>
      </panel>
    </tab>


    <tab name="partsTab">
      <!--***************** PARTS TAB ****************************-->
      <title translatable="true">Parts</title>
      <panel type="grid" id="partsgrid" dataSource="parts_ds1" showOnLoad="true" region="center">
        <action id="parts_addnew">
          <title translatable="true">Add New</title>
          <command type="openDialog" newRecord="true" panelId="parts_popup" width="600" height="400"/>
        </action>
        <field table="uc_vehiclept" name="vehicle_id" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="part_id" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="qty_a" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="qty_b" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="qty_c" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="qty_d" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
        <field table="uc_vehiclept" name="qty_e" controlType="link">
          <command type="openDialog" panelId="parts_popup" width="800" height="400"/>
        </field>
      </panel>

      <panel type="form" id="parts_popup" labelsPosition="left" columns="1" dataSource="parts_ds1" showOnLoad="false">
        <title translatable="true">Vehicle Part</title>
        <action id="save_part">
          <title translatable="true">Save</title>
          <command type="saveForm"/>
          <command type="showPanel" panelId="partsgrid" applyParentRestriction="false"/>
          <command type="closeDialog"/>
        </action>
        <action id="delete_part">
          <title translatable="true">Delete</title>
          <command type="deleteRecord"/>
          <command type="showPanel" panelId="partsgrid" applyParentRestriction="false"/>
          <command type="closeDialog"/>
        </action>
        <action id="cancel_part">
          <title translatable="true">Cancel</title>
          <command type="closeDialog"/>
        </action>
        <field table="uc_vehiclept" name="vehicle_id" readOnly="true"/>
        <field table="uc_vehiclept" name="part_id"/>
        <field table="uc_vehiclept" name="qty_a"/>
        <field table="uc_vehiclept" name="qty_b"/>
        <field table="uc_vehiclept" name="qty_c"/>
        <field table="uc_vehiclept" name="qty_d"/>
        <field table="uc_vehiclept" name="qty_e"/>
      </panel>



    </tab>


    <tab name="scheduleTab">
      <!--***************** SCHEDULE TAB ****************************-->
      <title translatable="true">Schedule</title>
      <panel type="grid" id="schedulegrid" dataSource="vehiclemaint_ds" showOnLoad="true"  region="center">
        <action id="sched_addnew">
          <title translatable="true">Add New</title>
          <command type="openDialog" newRecord="true" panelId="schedule_popup" width="600" height="400"/>
        </action>
        <action id="scehdule_refresh">
          <title translatable="true">Refresh</title>
          <command type="showPanel" panelId="schedulegrid"/>
        </action>

        <field id="createWRButton" controlType="button" dataType="text">
          <title>Create WR</title>
        </field>

        <field id="ScheduleButton" controlType="button" dataType="text">
          <title translatable="true">Schedule</title>
          <command type="openDialog" panelId="schedule_date_popup" width="800" height="400"/>
        </field>


        <field table="uc_fleetmaintsched" name="maint_id" controlType="link" hidden="true">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>

        <field table="uc_fleetmaintsched" name="vehicle_id" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="status" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="pmp_id" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="meter_next_maint" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="date_next_maint" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="date_scheduled" controlType="link" required="true">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="wr_id" controlType="link">
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
        <field table="uc_fleetmaintsched" name="comments" controlType="link" >
          <command type="openDialog" panelId="schedule_popup" width="800" height="400"/>
        </field>
      </panel>

      <panel type="form" id="schedule_popup" labelsPosition="top" columns="2" dataSource="vehiclemaint_ds" showOnLoad="false">
        <title translatable="true">Schedule Vehicle</title>
        <action id="save_schedule">
          <title translatable="true">Save</title>
          <command type="saveForm"/>
          <command type="showPanel" panelId="schedulegrid" applyParentRestriction="false"/>
          <command type="closeDialog"/>
        </action>
        <action id="delete_schedule">
          <title translatable="true">Delete</title>
          <command type="deleteRecord"/>
          <command type="showPanel" panelId="schedulegrid" applyParentRestriction="false"/>
          <command type="closeDialog"/>
        </action>
        <action id="cancel_schedule">
          <title translatable="true">Cancel</title>
          <command type="closeDialog"/>
        </action>
        <field table="uc_fleetmaintsched" name="maint_id" hidden="true"/>

        <field table="uc_fleetmaintsched" name="vehicle_id" readOnly="true"/>
        <field/>
        <field table="uc_fleetmaintsched" name="date_next_maint"/>
        <field table="uc_fleetmaintsched" name="pmp_id"/>
        <field table="uc_fleetmaintsched" name="meter_next_maint"/>

        <field table="uc_fleetmaintsched" name="status"/>
        <field table="uc_fleetmaintsched" name="date_scheduled"/>
        <field table="uc_fleetmaintsched" name="wr_id"/>
        <field table="uc_fleetmaintsched" name="comments" />
      </panel>
    </tab>

    <panel type="form" id="schedule_date_popup" labelsPosition="top" columns="2" dataSource="vehiclemaint_ds" showOnLoad="false">
      <title translatable="true">Set Date for Maintenance</title>
      <action id="save_schedule">
        <title translatable="true">Save</title>
        <command type="saveForm"/>
        <command type="showPanel" panelId="schedulegrid" applyParentRestriction="false"/>
        <command type="closeDialog"/>
      </action>

      <field table="uc_fleetmaintsched" name="maint_id" hidden="true"/>

      <field table="uc_fleetmaintsched" name="vehicle_id" readOnly="true"/>
      <field/>
      <field table="uc_fleetmaintsched" name="date_next_maint" readOnly="true"/>
      <field table="uc_fleetmaintsched" name="pmp_id" readOnly="true"/>
      <field table="uc_fleetmaintsched" name="meter_next_maint" readOnly="true"/>

      <field table="uc_fleetmaintsched" name="status" readOnly="true"/>
      <field table="uc_fleetmaintsched" name="date_scheduled"/>
      <field table="uc_fleetmaintsched" name="wr_id" readOnly="true"/>
      <field table="uc_fleetmaintsched" name="comments" readOnly="false"/>
    </panel>



    <tab name="wrTab">
      <!--***************** WORK REQUEST  TAB ****************************-->
      <title>Work Requests</title>

      <panel type="grid" id="wr_grid" dataSource="wr_ds6" showOnLoad="true" region="center">
        <title>Active Work Requests</title>
        <action id="wr_refresh">
          <title translatable="true">Refresh</title>
          <command type="showPanel" panelId="wr_grid"/>
        </action>

        <action id="createDemandButton" >
          <title>Create Demand WR</title>
        </action>


        <action id="createDemand">
          <title>Create Demand Request</title>
          <command type="openDialog" viewName="uc-ondemand-fleet-request-create.axvw" width="800" height="800" newRecord="true" closeButton="false" />
        </action>

        <action id="wr_xls">
          <title>XLS</title>
          <command type="exportPanel" outputType="xls" panelId="wr_grid"/>
        </action>

        <field controlType="button" onclick="vehicleCreateBasicController.onViewRequest">
          <title>Edit</title>
        </field>

        <field table="wr" name="wr_id"/>
        <field table="wr" name="date_requested"/>
        <field table="wr" name="date_assigned"/>
        <field table="wr" name="date_fwc"/>
        <field table="wr" name="status"/>
        <field table="wr" name="pmp_id"/>
        <field table="wr" name="prob_type"/>
        <field table="wr" name="requestor"/>
        <field table="wr" name="description"/>
        <field table="wr" name="cost_total"/>
        <sortField name="wr_id" table="wr" ascending="false"/>
      </panel>


      <panel type="grid" id="hwr_grid" dataSource="hwr_ds7" showOnLoad="true" region="center">
        <title>Historic Work Requests</title>
        <action id="hwr_refresh">
          <title translatable="true">Refresh</title>
          <command type="showPanel" panelId="hwr_grid"/>
        </action>

        <action id="hwr_xls">
          <title>XLS</title>
          <command type="exportPanel" outputType="xls" panelId="hwr_grid"/>
        </action>

        <field table="hwr" name="wr_id"/>
        <field table="hwr" name="date_requested"/>
        <field table="hwr" name="date_assigned"/>
        <field table="hwr" name="date_fwc"/>
        <field table="hwr" name="status"/>
        <field table="hwr" name="pmp_id"/>
        <field table="hwr" name="prob_type"/>
        <field table="hwr" name="requestor"/>
        <field table="hwr" name="description"/>
        <field table="hwr" name="cost_total"/>
        <sortField name="wr_id" table="hwr" ascending="false"/>
      </panel>


    </tab>



    <tab name="veh_photographs">
      <!-- Vehicle Photographs -->

      <!--***************** PHOTOS  TAB ****************************-->
      <title translatable="true">Photographs</title>
      <panel type="form" id="photograph_Panel" dataSource="vehicledet_ds27">
        <field table="vehicle" name="vehicle_id"/>

        <field table="vehicle" name="image_spec" controlType="link"/>
        <field table="vehicle" name="image_veh_assy" controlType="link"/>
        <field table="vehicle" name="image_veh_lub" controlType="link"/>
        <field table="vehicle" name="image_vehicle" controlType="link"/>
      </panel>
    </tab>

    <tab name="odometerChart">
      <!-- ODOMETER LINE GRAPH -->
      <!--***************** ODOMETER  TAB ****************************-->
      <title translatable="true">Odometer</title>
      <panel type="chart" id="odometerChart_Panel" dataSource="odometerChartDS1" controlType="lineChart">
        <!--title translatable="true">Title for Panel</title-->
        <action id="abViewdefSummaryChartDrilldown_refresh">
          <title translatable="true">Refresh</title>
          <command type="showPanel" panelId="odometerChart_Panel"/>
        </action>

        <event type="onClickItem">
          <command type="callFunction" functionName="setDrilldownRestriction"/>
          <script language="javaScript">
            function setDrilldownRestriction(obj){
            if (obj.restriction.clauses.length > 0){
            var grid = View.getControl('', 'odometerChart_popup');
            grid.addParameter('month', obj.selectedChartData['uc_fleet_odo.month']);
            grid.refresh();
            grid.show(true);
            grid.showInWindow({
            width: 600,
            height: 400
            });
            }
            }
          </script>
        </event>
        <groupingAxis table="uc_fleet_odo" field="month" showLabel="true">
          <title translatable="true">Date (grouped by month)</title>
        </groupingAxis>
        <dataAxis table="uc_fleet_odo" field="avg_odometer" showLabel="true" labelRotation="0" autoCalculateTickSizeInterval="true">
          <title translatable="true">Current Equip.meter reading (Avg)</title>
        </dataAxis>
      </panel>
      <panel type="grid" id="odometerChart_popup" dataSource="odometerChart_popupDS1" hidden="true" showOnLoad="false">
        <action id="abViewdefSummaryChartDrilldown_refresh">
          <title translatable="true">Refresh</title>
          <command type="showPanel" panelId="odometerChart_popup"/>
        </action>
        <action id="abViewdefSummaryChartDrilldown_exportDOCX">
          <title>DOCX</title>
          <command type="exportPanel" outputType="docx" panelId="odometerChart_popup"/>
        </action>
        <action id="abViewdefSummaryChartDrilldown_exportXLS">
          <title>XLS</title>
          <command type="exportPanel" outputType="xls" panelId="odometerChart_popup"/>
        </action>
        <action id="abViewdefSummaryChartDrilldown_exportTXFR">
          <title>DATA</title>
          <command type="exportPanel" outputType="txfr" panelId="odometerChart_popup"/>
        </action>
      </panel>
      <!--ViewDef-Chart-Popup-End-->
    </tab>
  </tabs>



  <!-- ************** EQUIPMENT DETAILS PANEL ************************* -->
  <panel type="form" id="eq_details" dataSource="eqdet_ds" hidden="true" columns="2" >
    <field name="eq_id" table="eq" hidden="true" readOnly="${!panel.newRecord}"/>
    <field name="eq_std" table="eq" hidden="true" value="VEHCL-XXXX-XXXXX">
      <title>Standard</title>
    </field>
    <field table="eq" name="dv_id" hidden="true"/>
    <field table="eq" name="dp_id" hidden="true"/>
    <field name="use1" table="eq" hidden="true" value="FLEET VEHICLE">
      <title>Equipment Use1</title>
    </field>
    <field name="status" table="eq" hidden="true"/>
    <field name="option1" table="eq" hidden="true">
      <title>Manufacturer</title>
    </field>
    <field name="option2" table="eq" hidden="true">
      <title>Model</title>
    </field>
    <field table="eq" name="meter" hidden="true"/>
    <field table="eq" name="meter_units" hidden="true"/>
    <field table="eq" name="comments" hidden="true"/>
    <field table="eq" name="bl_id" value="PP" hidden="true"/>
  </panel>




  <!-- ************** CREATE WR PANEL ************************* -->
  <panel type="form" id="wr_create_details" dataSource="ds_activity_log1" newRecord="true" hidden="true" showOnLoad="false"  useParentRestriction="false" >
    <action id="submit" imageName="/schema/ab-core/graphics/save.gif">
      <title>Submit</title>
      <tooltip>Submit Request</tooltip>

    </action>


    <field table="activity_log" name="activity_log_id" hidden="true" />
    <field table="activity_log" name="activity_type" hidden="true" value="SERVICE DESK - MAINTENANCE" />

    <field table="activity_log" name="requestor" readOnly="true" />
    <field table="activity_log" name="date_requested" readOnly="true"/>


    <!--field table="activity_log" name="bl_id" required="true"/-->
    <field table="activity_log" name="bl_id" hidden="true" value="PP"/>
    <field table="activity_log" name="location" showSelectValueAction="false" hidden="true"/>


    <!--field table="activity_log" name="prob_type" /-->
    <field table="activity_log" name="description" required="true"/>

    <!-- HIDDEN FIELDS -->
    <field table="activity_log" name="prob_type" hidden="true" value="PREVENTIVE MAINT"/>
    <field table="activity_log" name="tr_id" hidden="true" value="FLEET MECHANIC"/>
    <field table="activity_log" name="phone_requestor" hidden="true"/>
    <field table="activity_log" name="ac_id" hidden="true" readOnly="true" showLabel="false" value="" />
    <field table="activity_log" name="dv_id" hidden="true"/>
    <field table="activity_log" name="dp_id" hidden="true"/>
    <field table="activity_log" name="budget_owner" hidden="true"/>
  </panel>

  <!-- ************** UPDATE ODOMETER ************************* -->
  <dataSource id="odometerVehicleDetails_ds">
    <table name="uc_fleet_odo" role="main" />
    <field table="uc_fleet_odo" name="vehicle_id"/>
    <field table="uc_fleet_odo" name="date_odo"/>
    <field table="uc_fleet_odo" name="time_odo"/>
    <field table="uc_fleet_odo" name="odometer"/>
  </dataSource>

	<panel type="form" id="odometerVehicleDetailsPanel" dataSource="odometerVehicleDetails_ds" showOnLoad="false" labelsPosition="top" columns="1">
		<title translatable="true">Enter Odometer Reading</title>
		<action id="odometer_save">
			<title translatable="true">Save</title>
			<command type="saveForm"/>

			<command type="closeDialog"/>
		</action>

		<action id="odometer_cancel">
			<title translatable="true">Cancel</title>
			<!--command type="showPanel" panelId="odometerDetailsPanel" show="false"/-->
			<command type="closeDialog"/>
		</action>
		<field name="vehicle_id" table="uc_fleet_odo" hidden="false" readOnly="true" showSelectValueAction=""/>
		<field name="date_odo" table="uc_fleet_odo" hidden="false"  showSelectValueAction="">
			<title>Date of Reading</title>
		</field>
		<field name="time_odo" table="uc_fleet_odo" hidden="false" showSelectValueAction="">
			<title>Time of Reading</title>
		</field>
		<field name="odometer" table="uc_fleet_odo" showSelectValueAction=""/>
	</panel>



</view>

