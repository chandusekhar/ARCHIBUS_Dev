<view version="2.0">
	<message name="exclude_bill_type_of_0" translatable="true">Exclude Bill</message>
	<message name="exclude_bill_type_of_1" translatable="true">Types of</message>
	<message name="show_bill_type_of_0" translatable="true">Include Bill</message>
	<message name="show_bill_type_of_1" translatable="true">Types of</message>
	<message name="add" translatable="true">Add</message>
	<message name="clear" translatable="true">Clear</message>
    
    
	<layout type="borderLayout" id="mainLayout">
		<west initialSize="300" split="true"/>
		<center autoScroll="true"/>
	</layout>
	<layout type="borderLayout" id="nestedLayout" containingLayout="mainLayout" region="center">
		<north split="true"/>
		<center autoScroll="true"/>
	</layout>
	<js file="ab-energy-utility-metrics.js"/>
	<js file="ab-energy-bill-archive-view-document.js"/>
	<title translatable="true">Utility Bill Metrics</title>
    
    <panel type="view" id="commonView" file="ab-energy-bill-common.axvw"/>
    
    
	<!-- Console -->
	<dataSource id="ds_utilityMetricsConsole">
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="time_period"/>
	</dataSource>
	<panel type="console" columns="3" id="panel_utilityMetricsConsole" showOnLoad="true" dataSource="ds_utilityMetricsConsole" layout="nestedLayout" region="north">
		<title translatable="true">Filter</title>
		<action id="filter">
			<title>Apply</title>
		</action>
		<action id="clear">
			<title translatable="true">Clear</title>
			<command type="clearPanel" panelId="panel_utilityMetricsConsole"/>
			<command type="callFunction" functionName="user_clearBillType_ex()"/>
			<command type="callFunction" functionName="user_clearBillType_sh()"/>			
			<command type="callFunction" functionName="selectLocation()"/>
		</action>
		<field table="bill_archive" name="time_period" alias="bill_archive.time_period.from" showSelectValueAction="true">
			<title translatable="true">Billing Period From</title>
			<action>
				<title>...</title>
				<tooltip>Select Value</tooltip>
				<command type="selectValue" fieldNames="bill_archive.time_period.from" selectFieldNames="energy_time_period.time_period" visibleFieldNames="energy_time_period.time_period" sortFieldNames="energy_time_period.time_period" showIndex="true">
                    <title>Billing Period From</title>
				</command>
			</action>
		</field>
		<field table="bill_archive" name="time_period" alias="bill_archive.time_period.to" showSelectValueAction="true">
			<title translatable="true">Billing Period To</title>
			<action>
				<title>...</title>
				<tooltip>Select Value</tooltip>
				<command type="selectValue" fieldNames="bill_archive.time_period.to" selectFieldNames="energy_time_period.time_period" visibleFieldNames="energy_time_period.time_period" sortFieldNames="energy_time_period.time_period" showIndex="true">
                    <title>Billing Period To</title>
				</command>
			</action>
		</field>
        <field id="vf_bill_units">
            <title translatable="true">Energy Units</title>
            <html>
                <select class="inputField_box" name="select_bill_units" id="select_bill_units">
                    <option id="select_bill_units_0" value="MMBTU" selected="true">MMBTU</option>
                </select>
            </html>
        </field>
		<field colspan="1" rowspan="2">
			<title translatable="true">
				<input type="checkbox" id="exclude_bill_type_check" name="excludeBillType" onClick="check_exclude()"/>
				<span id="exclude_bill_type_of_label"/>
			</title>
			<html>
				<table CELLPADDING="0" CELLSPACING="0" class="panel" style="width:100%;border:0 none;">
					<tr class="fieldRow">
						<td style="width:80%;border:0 none;">
							<textarea id="bill_type_storage_exclude" wrap="PHYSICAL" style="width: 200px; height:50px;" class="defaultEditForm_textareaABData_readonly" disabled="disabled"></textarea>
						</td>
						<td style="border:0 none;">
							<input id="excludeAddBillType" class="selectValue_AbActionButtonFormStdWidth" style="display:block" value="" type="button" onclick="user_addBillType_ex()"/>&#13;
							<input id="excludeClearBillType" class="selectValue_AbActionButtonFormStdWidth" style="display:block" value="" type="button" onclick="user_clearBillType_ex()"/>
						</td>
					</tr>
				</table>
			</html>
		</field>
		<field colspan="1" rowspan="2">
			<title translatable="true">
				<input type="checkbox" id="show_bill_type_check" name="showBillType" onClick="check_show()"/>
				<span id="show_bill_type_of_label"/>
			</title>
			<html>
				<table CELLPADDING="0" CELLSPACING="0" class="panel" style="width:100%;border:0 none;">
					<tr class="fieldRow">
						<td style="width:80%;border:0 none;">
							<textarea id="bill_type_storage_show" wrap="PHYSICAL" style="width: 200px; height:50px;" class="defaultEditForm_textareaABData_readonly" disabled="disabled"></textarea>
						</td>
						<td style="border:0 none;">
							<input id="showAddBillType" class="selectValue_AbActionButtonFormStdWidth" style="display:block" value="" type="button" onclick="user_addBillType_sh()"/>&#13;
							<input id="showClearBillType" class="selectValue_AbActionButtonFormStdWidth" style="display:block" value="" type="button" onclick="user_clearBillType_sh()"/>
						</td>
					</tr>
				</table>
			</html>
		</field>
        <field/>		
	</panel>
	<!-- Location tree -->
	<dataSource id="ds_utilityMetricsCtry">
		<table name="ctry"/>
		<field name="ctry_id"/>
		<field name="name"/>
		<sortField table="ctry" name="ctry_id" ascending="true"/>
		<restriction type="sql" sql="EXISTS (SELECT bl_id FROM bl WHERE bl.ctry_id = ctry.ctry_id)"/>
	</dataSource>
	<dataSource id="ds_utilityMetricsRegn">
		<table name="regn"/>
		<field name="regn_id"/>
		<field name="name"/>
		<sortField table="regn" name="regn_id" ascending="true"/>
		<restriction type="sql" sql="EXISTS (SELECT bl_id FROM bl WHERE bl.regn_id = regn.regn_id)"/>
	</dataSource>
	<dataSource id="ds_utilityMetricsState">
		<table name="state"/>
		<field name="state_id"/>
		<field name="name"/>
		<sortField table="state" name="state_id" ascending="true"/>
		<restriction type="sql" sql="EXISTS (SELECT bl_id FROM bl WHERE bl.state_id = state.state_id)"/>
	</dataSource>
	<dataSource id="ds_utilityMetricsCity">
		<table name="city"/>
		<field name="city_id"/>
		<field name="name"/>
		<sortField table="city" name="city_id" ascending="true"/>
		<restriction type="sql" sql="EXISTS (SELECT bl_id FROM bl WHERE bl.city_id = city.city_id)"/>
	</dataSource>
	<dataSource id="ds_utilityMetricsSite">
		<table name="site"/>
		<field name="site_id"/>
		<field name="name"/>
		<sortField table="site" name="site_id" ascending="true"/>
		<restriction type="sql" sql="EXISTS (SELECT bl_id FROM bl WHERE bl.site_id = site.site_id)"/>
	</dataSource>
	<dataSource id="ds_utilityMetricsBuilding">
		<table name="bl"/>
		<field name="bl_id"/>
		<field name="name"/>
		<sortField table="bl" name="bl_id" ascending="true"/>
	</dataSource>
	<panel type="tree" id="panel_utilityMetricsCtry" dataSource="ds_utilityMetricsCtry" layout="mainLayout" region="west">
		<title translatable="true">Select Location</title>
		<field table="ctry" name="ctry_id"/>
		<field table="ctry" name="name"/>
		<event type="onClickNode">
			<command type="callFunction" functionName="selectLocation"/>
		</event>
		<panel type="tree" id="panel_utilityMetricsRegn" dataSource="ds_utilityMetricsRegn">
			<field table="regn" name="regn_id"/>
			<field table="regn" name="name"/>
			<event type="onClickNode">
				<command type="callFunction" functionName="selectLocation"/>
			</event>
		</panel>
		<panel type="tree" id="panel_utilityMetricsState" dataSource="ds_utilityMetricsState">
			<field table="state" name="state_id"/>
			<field table="state" name="name"/>
			<event type="onClickNode">
				<command type="callFunction" functionName="selectLocation"/>
			</event>
		</panel>
		<panel type="tree" id="panel_utilityMetricsCity" dataSource="ds_utilityMetricsCity">
			<field table="city" name="city_id"/>
			<field table="city" name="name"/>
			<event type="onClickNode">
				<command type="callFunction" functionName="selectLocation"/>
			</event>
		</panel>
		<panel type="tree" id="panel_utilityMetricsSite" dataSource="ds_utilityMetricsSite">
			<field table="site" name="site_id"/>
			<field table="site" name="name"/>
			<event type="onClickNode">
				<command type="callFunction" functionName="selectLocation"/>
			</event>
		</panel>
		<panel type="tree" id="panel_utilityMetricsBuilding" dataSource="ds_utilityMetricsBuilding">
			<field table="bl" name="bl_id"/>
			<field table="bl" name="name"/>
			<event type="onClickNode">
				<command type="callFunction" functionName="selectLocation"/>
			</event>
		</panel>
	</panel>
	<!-- Crosstable data sources -->
	<dataSource id="ds_byBuildingBySiteChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">
                    SELECT site_id, bl_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive 
        			WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
				${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="site_id" groupBy="true"/>
		<field table="bill_archive" name="bl_id" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>

		<sortField table="bill_archive" name="site_id" ascending="true"/>
		<sortField table="bill_archive" name="bl_id" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byBuildingByBillTypeChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>				
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT bill_type_id, bl_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive 
        			WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="bill_type_id" groupBy="true"/>
		<field table="bill_archive" name="bl_id" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="bill_type_id" ascending="true"/>
		<sortField table="bill_archive" name="bl_id" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byBuildingByVendorChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>			
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT vn_id, bl_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="vn_id" groupBy="true"/>
		<field table="bill_archive" name="bl_id" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="vn_id" ascending="true"/>
		<sortField table="bill_archive" name="bl_id" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byBuildingByBuildingUseChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>				
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT bl.use1, bill_archive.bl_id, bill_archive.time_period, bill_archive.bill_id, bill_archive.amount_expense, 
        			(bill_archive.qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                    bill_archive.qty_power, bill_archive.qty_volume 
        			FROM bill_archive 
        				LEFT OUTER JOIN bl 
        				ON bill_archive.bl_id=bl.bl_id
        			WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="use1" groupBy="true">
			<title translatable="true">Building Use</title>
		</field>
		<field table="bill_archive" name="bl_id" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="use1" ascending="true"/>
		<sortField table="bill_archive" name="bl_id" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byPeriodByBuildingChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>			
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT bl_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="bl_id" groupBy="true"/>
		<field table="bill_archive" name="time_period" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="bl_id" ascending="true"/>
		<sortField table="bill_archive" name="time_period" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byPeriodByBillTypeChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>				
		<parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
        <!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT bill_type_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
       		</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="bill_type_id" groupBy="true"/>
		<field table="bill_archive" name="time_period" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="bill_type_id" ascending="true"/>
		<sortField table="bill_archive" name="time_period" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byPeriodByVendorChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>				
		<parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
        <!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT vn_id, time_period, bill_id, amount_expense,
                        (qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        qty_power, qty_volume 
        			FROM bill_archive WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="vn_id" groupBy="true"/>
		<field table="bill_archive" name="time_period" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="vn_id" ascending="true"/>
		<sortField table="bill_archive" name="time_period" ascending="true"/>
	</dataSource>
	<dataSource id="ds_byPeriodByBuildingUseChart" type="grouping">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>				
		<parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
        <!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT bl.use1, bill_archive.time_period, bill_archive.bill_id, bill_archive.amount_expense, 
        			(bill_archive.qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                    bill_archive.qty_power, bill_archive.qty_volume 
        			FROM bill_archive 
        				LEFT OUTER JOIN bl 
        				ON bill_archive.bl_id=bl.bl_id
        			WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))
        			${parameters['billTypeEx']}
				${parameters['billTypeSh']}        					
        	</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="use1" groupBy="true">
			<title translatable="true">Building Use</title>
		</field>
		<field table="bill_archive" name="time_period" groupBy="true"/>
		<field name="sum_amount_expense" formula="sum" baseField="bill_archive.amount_expense" dataType="number" size="12" decimals="2">
			<title translatable="true">Utility Cost (Sum)</title>
		</field>
		<field name="sum_qty_energy" formula="sum" baseField="bill_archive.qty_energy" dataType="number" size="12" decimals="2">
			<title translatable="true">Consumption(${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')}) (Sum)</title>
		</field>
		<field name="sum_qty_volume" formula="sum" baseField="bill_archive.qty_volume" dataType="number" size="12" decimals="2">
			<title translatable="true">Volume(CCF) (Sum)</title>
		</field>
		<field name="max_qty_power" formula="max" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Max)</title>
		</field>
		<field name="avg_qty_power" formula="avg" baseField="bill_archive.qty_power" dataType="number" size="12" decimals="2">
			<title translatable="true">Demand(kW) (Avg)</title>
		</field>
		<field name="count_bill_id" formula="count" baseField="bill_archive.bill_id" dataType="number" size="12" decimals="0">
			<title translatable="true">Bills (Count)</title>
		</field>
		<sortField table="bill_archive" name="use1" ascending="true"/>
		<sortField table="bill_archive" name="time_period" ascending="true"/>
	</dataSource>
	<dataSource id="selectValueBillType_ds" distinct="true">
		<table name="bill_archive"/>
		<field name="bill_type_id"/>
	</dataSource>	
	<panel type="grid" id="formSelectValueMultiple_grid" dataSource="selectValueBillType_ds" recordLimit="200" multipleSelectionEnabled="true" showOnLoad="false" hidden="true">
		<action id="addSelected">
			<title>Add Selected</title>
		</action>   
	</panel>	
	<!-- Crosstable tabs -->
	<tabs workflow="enforced" id="tabs" layout="nestedLayout" region="center" tabRefreshPolicy="never">
		<tab name="byBuildingBySiteChart" selected="true" useFrame="false">
			<title translatable="true">By Building By Site</title>
			<panel id="panel_byBuildingBySiteChart" type="crossTable" dataSource="ds_byBuildingBySiteChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Building by Site</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byBuildingBySiteChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byBuildingBySiteChart"/>
				</action>
				<action id="panel_byBuildingBySiteChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byBuildingBySiteChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byBuildingByBillTypeChart" selected="false" useFrame="false">
			<title translatable="true">By Building By Bill Type</title>
			<panel id="panel_byBuildingByBillTypeChart" type="crossTable" dataSource="ds_byBuildingByBillTypeChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Building by Bill Type</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byBuildingByBillTypeChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byBuildingByBillTypeChart"/>
				</action>
				<action id="panel_byBuildingByBillTypeChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byBuildingByBillTypeChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byBuildingByVendorChart" selected="false" useFrame="false">
			<title translatable="true">By Building By Vendor</title>
			<panel id="panel_byBuildingByVendorChart" type="crossTable" dataSource="ds_byBuildingByVendorChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Building by Vendor</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byBuildingByVendorChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byBuildingByVendorChart"/>
				</action>
				<action id="panel_byBuildingByVendorChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byBuildingByVendorChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byBuildingByBuildingUseChart" selected="false" useFrame="false">
			<title translatable="true">By Building By Building Use</title>
			<panel id="panel_byBuildingByBuildingUseChart" type="crossTable" dataSource="ds_byBuildingByBuildingUseChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Building by Building Use</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byBuildingByBuildingUseChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byBuildingByBuildingUseChart"/>
				</action>
				<action id="panel_byBuildingByBuildingUseChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byBuildingByBuildingUseChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
				<field table="bill_archive" name="use1" groupBy="true"/>
				<title translatable="true">Building Use</title>
			</panel>
		</tab>
		<tab name="byPeriodByBuildingChart" selected="false" useFrame="false">
			<title translatable="true">By Period By Building</title>
			<panel id="panel_byPeriodByBuildingChart" type="crossTable" dataSource="ds_byPeriodByBuildingChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Period by Building</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byPeriodByBuildingChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byPeriodByBuildingChart"/>
				</action>
				<action id="panel_byPeriodByBuildingChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byPeriodByBuildingChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byPeriodByBillTypeChart" selected="false" useFrame="false">
			<title translatable="true">By Period By Bill Type</title>
			<panel id="panel_byPeriodByBillTypeChart" type="crossTable" dataSource="ds_byPeriodByBillTypeChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Period by Bill Type</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byPeriodByBillTypeChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byPeriodByBillTypeChart"/>
				</action>
				<action id="panel_byPeriodByBillTypeChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byPeriodByBillTypeChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byPeriodByVendorChart" selected="false" useFrame="false">
			<title translatable="true">By Period By Vendor</title>
			<panel id="panel_byPeriodByVendorChart" type="crossTable" dataSource="ds_byPeriodByVendorChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Period by Vendor</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byPeriodByVendorChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byPeriodByVendorChart"/>
				</action>
				<action id="panel_byPeriodByVendorChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byPeriodByVendorChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
		<tab name="byPeriodByBuildingUseChart" selected="false" useFrame="false">
			<title translatable="true">By Period By Building Use</title>
			<panel id="panel_byPeriodByBuildingUseChart" type="crossTable" dataSource="ds_byPeriodByBuildingUseChart" showOnLoad="false">
				<title translatable="true">Utility Metrics by Period by Building Use</title>
				<action id="data">
					<title translatable="true">Data</title>
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</action>
				<action id="exportXLS">
					<title>XLS</title>
					<command type="exportPanel" outputType="xls" panelId="panel_byPeriodByBuildingUseChart"/>
				</action>
				<action id="exportDOC">
					<title>DOC</title>
					<command type="exportPanel" outputType="docx" panelId="panel_byPeriodByBuildingUseChart"/>
				</action>
				<action id="panel_byPeriodByBuildingUseChart_refresh">
					<title translatable="true">Refresh</title>
					<command type="showPanel" panelId="panel_byPeriodByBuildingUseChart"/>
				</action>
				<event type="onClickItem">
					<command type="openDialog" panelId="panel_bill_archive_popup"/>
				</event>
			</panel>
		</tab>
	</tabs>
	<!-- Pop-up -->
	<dataSource id="ds_bill_archive_popup">
		<!-- Define parameters for the custom SQL query -->
		<parameter name="locationField" dataType="verbatim" value="ctry_id"/>
		<parameter name="locationValue" dataType="text" value="USA"/>
		<parameter name="billTypeEx" dataType="verbatim" value=""/>
		<parameter name="billTypeSh" dataType="verbatim" value=""/>
        <parameter name="unitsConversionFactor" dataType="verbatim" value=""/>
		<!-- Define a custom SQL query that can be restricted by various location values -->
		<sql dialect="generic">SELECT
                        bl.use1,
                        bill_archive.site_id,
                        bill_archive.bl_id,
                        bill_archive.vn_id,
                        bill_archive.bill_id,
                        bill_archive.vn_ac_id,
                        bill_archive.bill_type_id,
                        bill_archive.time_period,
                        bill_archive.date_service_start,
                        bill_archive.date_service_end,
                        bill_archive.amount_expense,
                        bill_archive.amount_income,
                        (bill_archive.qty_energy / ${parameters['unitsConversionFactor']}) ${sql.as} qty_energy,
                        bill_archive.qty_power,
                        bill_archive.qty_volume,
                        bill_archive.qty_kwh,
                        bill_archive.cost_kwh,
                        bill_archive.cost_mmbtu,
                        bill_archive.count_lines,
                        bill_archive.description,
                        bill_archive.doc
        			FROM bill_archive 
        				LEFT OUTER JOIN bl 
        				ON bill_archive.bl_id=bl.bl_id
				WHERE bill_archive.vn_id IN 
        				(SELECT vn_id FROM vn 
        					WHERE vendor_type = 'Energ')
        			AND bill_archive.bl_id IN 
        				(SELECT bl_id FROM bl 
        					WHERE ${parameters['locationField']} = ${parameters['locationValue']})
                    AND ((bill_archive.prorated_aggregated = 'NO' AND bill_archive.reference_bill_id IS NULL AND NOT EXISTS (SELECT 1 FROM bill_archive b WHERE b.reference_bill_id = bill_archive.bill_id)) OR (bill_archive.prorated_aggregated &lt;&gt; 'NO'))     				
				${parameters['billTypeEx']}
				${parameters['billTypeSh']}
		</sql>
		<table name="bill_archive" role="main"/>
		<field table="bill_archive" name="site_id"/>
		<field table="bill_archive" name="bl_id"/>
		<field table="bill_archive" name="use1" dataType="text"/>		
		<field table="bill_archive" name="vn_id"/>
		<field table="bill_archive" name="bill_id"/>
		<field table="bill_archive" name="vn_ac_id"/>
		<field table="bill_archive" name="bill_type_id"/>
		<field table="bill_archive" name="time_period"/>
		<field table="bill_archive" name="date_service_start"/>
		<field table="bill_archive" name="date_service_end"/>
		<field table="bill_archive" name="amount_expense" showTotals="true"/>
		<field table="bill_archive" name="amount_income" showTotals="true"/>
		<field table="bill_archive" name="qty_energy" showTotals="true"/>
		<field table="bill_archive" name="qty_power" showTotals="true"/>
		<field table="bill_archive" name="qty_volume" showTotals="true"/>
		<field table="bill_archive" name="qty_kwh" showTotals="true"/>
		<field table="bill_archive" name="cost_kwh" showTotals="true"/>
		<field table="bill_archive" name="cost_mmbtu" showTotals="true"/>
		<field table="bill_archive" name="count_lines"/>
		<field table="bill_archive" name="description"/>
		<field table="bill_archive" name="doc"/>
	</dataSource>
	<panel type="grid" id="panel_bill_archive_popup" dataSource="ds_bill_archive_popup" hidden="true" showOnLoad="false" showCounts="true">
		<title translatable="true">Archived Bills</title>
		<action id="exportXLS">
			<title>XLS</title>
			<command type="exportPanel" outputType="xls" panelId="panel_bill_archive_popup"/>
		</action>
	    <action id="exportDOC">
	      <title translatable="true">DOC</title>
	      <command type="exportPanel" outputType="docx" panelId="panel_bill_archive_popup"/>
	    </action>		
		<field controlType="button" id="view" enabled="${record['bill_archive.doc'] != ''}">
			<title translatable="true">Document</title>
		</field>
		<field controlType="button">
			<command type="openDialog" viewName="ab-energy-archive-bill-line-list.axvw" applySelectionRestriction="true"/>
			<title translatable="true">Lines</title>
		</field>
		
		<field table="bill_archive" name="site_id"/>
		<field table="bill_archive" name="bl_id"/>
		<field table="bill_archive" name="use1" dataType="text">
			<title translatable="true">Building Use</title>
		</field>
		<field table="bill_archive" name="vn_id"/>
		<field table="bill_archive" name="bill_id"/>
		<field table="bill_archive" name="vn_ac_id"/>
		<field table="bill_archive" name="bill_type_id"/>
		<field table="bill_archive" name="time_period"/>
		<field table="bill_archive" name="date_service_start"/>
		<field table="bill_archive" name="date_service_end"/>
		<field table="bill_archive" name="amount_expense" showTotals="true"/>
		<field table="bill_archive" name="amount_income" showTotals="true"/>
		<field table="bill_archive" name="qty_energy" showTotals="true">
            <title>Energy / Consumption (${view.dataSources.get('abEnergyBillCommon_ds').getRecord().getValue('bill_unit.vf_qty_energy_unit')})</title>
        </field>
		<field table="bill_archive" name="qty_power" showTotals="true"/>
		<field table="bill_archive" name="qty_volume" showTotals="true"/>
		<field table="bill_archive" name="qty_kwh" showTotals="true"/>
		<field table="bill_archive" name="cost_kwh" showTotals="true"/>
		<field table="bill_archive" name="cost_mmbtu" showTotals="true"/>
		<field table="bill_archive" name="count_lines"/>
		<field table="bill_archive" name="description"/>
		<field table="bill_archive" name="doc"/>
		
		<sortField table="bill_archive" name="vn_id" ascending="true"/>
		<sortField table="bill_archive" name="bill_id" ascending="true"/>
		<indexField table="bill_archive" name="bill_id"/>
	</panel>
</view>
