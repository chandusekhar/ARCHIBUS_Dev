<view version="2.0">
	<js file="ab-bim-rplm-pfadmin-manage-bldgs-tree.js"/>
	<js file="ab-bim-rplm-pfadmin-by-loc-wiz.js"/>
	<message name="msg_not_geocoded" translatable="true">Not Geocoded</message>
	<message name="error_noselection" translatable="true">You must first make a selection</message>
	<message name="error_max_no_selected_items" translatable="true">You asked to present a large number of items on the map: (number of items). This may take a long time. Proceed?</message>

	<dataSource id="dsBldgCtry">
		<table name="ctry" role="main"/>
		<field table="ctry" name="ctry_id"/>
		<field table="ctry" name="name"/>
		<restriction type="sql" sql="EXISTS(SELECT 1 FROM city WHERE city.ctry_id = ctry.ctry_id AND EXISTS(SELECT 1 FROM bl WHERE bl.city_id = city.city_id AND bl.ctry_id = ctry.ctry_id AND ${parameters['activeClause']} ${parameters['filterRestriction']}))"/>
		<parameter name="filterRestriction" dataType="verbatim" value=""/>
		<parameter name="activeClause" dataType="verbatim" value=""/>
		<sortField table="ctry" name="ctry_id" ascending="true"/>
	</dataSource>
	<dataSource id="dsBldgCity">
		<table name="city" role="main"/>
		<field table="city" name="city_id"/>
		<field table="city" name="name"/>
		<field table="city" name="state_id" hidden="true"/>
		<restriction type="sql" sql="EXISTS(SELECT 1 FROM bl WHERE bl.city_id = city.city_id AND bl.state_id = city.state_id AND ${parameters['activeClause']} ${parameters['filterRestriction']})"/>
		<parameter name="filterRestriction" dataType="verbatim" value=""/>
		<parameter name="activeClause" dataType="verbatim" value=""/>
		<sortField table="city" name="city_id" ascending="true"/>
	</dataSource>
	<dataSource id="dsBldgBuildings">
		<table name="bl" role="main"/>
		<field table="bl" name="bl_id"/>
		<field table="bl" name="lat" hidden="true"/>
		<field table="bl" name="lon" hidden="true"/>
		<field table="bl" name="address1" hidden="true"/>
		<field table="bl" name="address2" hidden="true"/>
		<field table="bl" name="state_id" hidden="true"/>
		<restriction type="sql" sql="${parameters['activeClause']} ${parameters['filterRestriction']}"/>
		<parameter name="filterRestriction" dataType="verbatim" value=""/>
		<parameter name="activeClause" dataType="verbatim" value=""/>
		<sortField table="bl" name="bl_id" ascending="true"/>
	</dataSource>
	
	<panel type="tree" id="ctryTree" dataSource="dsBldgCtry">
		<action id="unselectAll">
			<title translatable="true">Unselect All</title>
		</action>
		<action id="showSelected">
			<title translatable="true">Show Selected</title>
		</action>
		<action id="filter" imageName="/schema/ab-system/graphics/ab-filter-run.gif">
 			<tooltip>Filter</tooltip>
		</action>
		<panel type="tree" id="cityTree" dataSource="dsBldgCity">
		</panel>
		<panel type="tree" id="bldgTree" dataSource="dsBldgBuildings">
		</panel>
	</panel>

</view>
