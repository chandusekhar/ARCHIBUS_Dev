var Ab=window.Ab||{};Ab.namespace=function(C){if(!C||!C.length){return null}var D=C.split(".");var B=Ab;for(var A=(D[0]=="Ab")?1:0;A<D.length;++A){B[D[A]]=B[D[A]]||{};B=B[D[A]]}return B};function valueExists(A){return(typeof (A)!="undefined"&&A!=null)}function getValueIfExists(B,A){return valueExists(B)?B:A}function valueExistsNotEmpty(A){return(valueExists(A)&&(typeof A!="string"||$.trim(A)!=""))}function endsWith(B,A){return B.indexOf(A,B.length-A.length)!==-1}function getLocalizedString(C){var A=C;if(typeof (Ab.localization)!="undefined"){for(var B=0,D;D=Ab.localization.Localization.localizedStrings[B];B++){if(D.key3==C){(D.value=="")?A="*"+D.key3:A=D.value;return A}}}if(valueExistsNotEmpty(A)){A=convertFromXMLValue(A)}return A}function convertFromXMLValue(A){if(typeof A!="undefined"&&A!=null){A=A.replace(/&amp;/g,"&");A=A.replace(/&gt;/g,">");A=A.replace(/&lt;/g,"<");A=A.replace(/&apos;/g,"'");A=A.replace(/&quot;/g,'"');return A}return""}$.extend(Function.prototype,{createCallback:function(){var A=arguments;var B=this;return function(){return B.apply(window,A)}},createDelegate:function(C,B,A){var D=this;return function(){var F=B||arguments;if(A===true){F=Array.prototype.slice.call(arguments,0);F=F.concat(B)}else{if(typeof A=="number"){F=Array.prototype.slice.call(arguments,0);var E=[A,0].concat(B);Array.prototype.splice.apply(F,E)}}return D.apply(C||window,F)}},defer:function(C,E,B,A){var D=this.createDelegate(E,B,A);if(C){return setTimeout(D,C)}D();return 0}});Ab.namespace("workflow");Ab.workflow.Workflow=Base.extend({},{sessionTimeoutDetected:false,DEFAULT_TIMEOUT:10,ERROR_SCRIPT_SESSION:"Attempt to fix script session",ERROR_NO_DATA:"No data received from server",z_MESSAGE_RULE_EXECUTED:"Workflow rule executed",z_MESSAGE_RULE_FAILED:"Workflow rule failed",z_MESSAGE_RULE_NOT_FOUND:"Workflow rule not found",z_MESSAGE_RULE_NOT_PERMITTED:"Workflow rule not permitted",z_MESSAGE_CONTAINER_FAILED:"Workflow rules container failed",z_MESSAGE_SESSION_TIMEOUT_TITLE:"Session Timeout",z_MESSAGE_SESSION_TIMEOUT:"Your session has expired, and you have been signed out of WebCentral. To continue working, please sign in again.",runRule:function(A,H,D,E,F){try{if(!valueExists(F)){F=Ab.workflow.Workflow.DEFAULT_TIMEOUT}var B=new Ab.workflow.Callback(D,E);var G=B.afterRuleExecuted.createDelegate(B);var I={callback:G,async:false,timeout:F*1000};this.prapareParameters(H);workflow.runWorkflowRule(A,H,I)}catch(C){C.description="Workflow rule failed";throw C}},runRuleAndReturnResult:function(H,D,E){try{if(!valueExists(E)){E=Ab.workflow.Workflow.DEFAULT_TIMEOUT}var B=new Ab.workflow.Callback(null,null);var G=B.afterRuleExecuted.createDelegate(B);var C={callback:G,async:false,timeout:E*1000};this.prapareParameters(D);workflow.runWorkflowRule(H,D,null,C);var A=B.result;if(!A){A={};A.code="ruleFailed"}else{if(!valueExists(A.message)){A.message="Workflow rule executed"}}return A}catch(F){F.description="Workflow rule failed";throw F}},runRuleWithUpload:function(A,I,B,E,F,G){try{if(!valueExists(G)){G=Ab.workflow.Workflow.DEFAULT_TIMEOUT}var C=new Ab.workflow.Callback(E,F);var H=C.afterRuleExecuted.createDelegate(C);var J={callback:H,timeout:G*1000};this.prapareParameters(I);workflow.runWorkflowRule(A,I,B,J)}catch(D){D.description="Workflow rule failed";throw D}},call:function(D,B,C){if(!valueExists(B)){B={}}if(B.constructor==Ab.data.Record){B={record:toJSON(B)}}else{if(B.constructor==Ab.data.DataSetList){B={records:toJSON(B)}}else{if(B.constructor==Array){B={records:toJSON(B)}}}}var A=this.runRuleAndReturnResult(D,B,C);if(A.code=="sessionTimeout"){this.handleSessionTimeout(A.message)}else{if(A.code!="executed"){throw A}}return A},callMethod:function(D){var C=[];for(var B=1;B<arguments.length;B++){C.push(arguments[B])}var A=this.call(D,{methodParameters:toJSON(C)});return A},callMethodWithParameters:function(B,A){return this.call(B,A)},handleError:function(A,C,B){alert("Error "+A.message)},handleSessionTimeout:function(A){this.sessionTimeoutDetected=true},handleDwrError:function(B,A){alert("Workflow error "+B)},handleDwrWarning:function(B,A){alert("Workflow warning "+B)},resultCodeToMessage:function(B){var A="Workflow rule executed";if(B=="ruleFailed"){A="Workflow rule failed"}else{if(B=="ruleNotFound"){A="Workflow rule not found"}else{if(B=="containerFailed"){A="Workflow container failed"}else{if(B=="ruleNotPermitted"){A="Workflow rule not permitted"}else{if(B=="sessionTimeout"){A="Workflow session timeout"}}}}}return A},startJob:function(D){var C=[];for(var B=1;B<arguments.length;B++){C.push(arguments[B])}C=toJSON(C);var A=this.call(D,{methodParameters:C,startAsJob:true},null,arguments[1]);return A.message},startJobWithUpload:function(G,B,C,E){var F=[];for(var D=4;D<arguments.length;D++){F.push(arguments[D])}var A=this.runRuleWithUpload(G,{methodParameters:toJSON(F),startAsJob:true},B,C,E)},getJobStatus:function(B){try{var A=Workflow.call("AbCommonResources-getJobStatus",{jobId:B});var D=A.data;if(valueExists(D.data)){D.dataSet=Ab.data.createDataSet(D.data)}return D}catch(C){Workflow.handleError(C)}},stopJob:function(B){try{var A=Workflow.call("AbCommonResources-stopJob",{jobId:B});return A.data}catch(C){Workflow.handleError(C)}},terminateJob:function(B){try{var A=Workflow.call("AbCommonResources-terminateJob",{jobId:B});return A}catch(C){Workflow.handleError(C)}},getJobStatusesForUser:function(){try{var A=Workflow.call("AbCommonResources-getJobStatusesForUser");return A.data}catch(B){Workflow.handleError(B)}},prapareParameters:function(A){if(valueExists(A)&&!valueExists(A.version)){A.version="2.0"}if(valueExists(A)&&valueExists(A.restriction)&&A.restriction.constructor===String&&A.restriction.length>0&&A.restriction.charAt(0)!=="{"&&A.restriction.charAt(0)!=="["){A.restriction=doSecure(A.restriction)}}});Workflow=Ab.workflow.Workflow;Ab.workflow.Callback=Base.extend({callbackFunction:null,callbackObject:null,result:null,constructor:function(A,B){this.callbackFunction=A;this.callbackObject=B},afterRuleExecuted:function(result){this.result=result;result.data=null;result.dataSet=null;if(valueExists(result.jsonExpression)&&result.jsonExpression!=""){result.data=eval("("+result.jsonExpression+")");if(valueExists(result.data.type)){result.dataSet=Ab.data.createDataSet(result.data)}else{if(valueExists(result.data.records)){result.dataSet=new Ab.data.DataSetList(result.data)}}}var fn=this.callbackFunction;if(valueExists(fn)){if(valueExists(this.callbackObject)){fn.call(this.callbackObject,result)}else{fn.call(window,result)}}}});var hovertipMouseX;var hovertipMouseY;function hovertipMouseUpdate(B){var A=hovertipMouseXY(B);hovertipMouseX=A[0]-25;hovertipMouseY=A[1]+15}function hovertipMouseXY(D){if(!D){if(window.event){D=window.event}else{return }}if(typeof (D.pageX)=="number"){var C=D.pageX;var A=D.pageY}else{if(typeof (D.clientX)=="number"){var C=D.clientX;var A=D.clientY;var B=(window.navigator.userAgent.indexOf("Opera")+1)||(window.ScriptEngine&&ScriptEngine().indexOf("InScript")+1)||(navigator.vendor=="KDE");if(!B){if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){C+=document.body.scrollLeft;A+=document.body.scrollTop}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){C+=document.documentElement.scrollLeft;A+=document.documentElement.scrollTop}}}}else{return }}return[C,A]}targetSelectById=function(C,B){var D;var A;if(D=C.getAttribute("id")){A="*["+B.attribute+"='"+D+"']";return jQuery(A)}};targetSelectByTargetAttribute=function(C,B){target_list=C.getAttribute("target");if(target_list){target_ids=target_list.split(" ");var A="#"+target_ids.join(",#");return jQuery(A)}};targetSelectByPrevious=function(B,A){return jQuery(B.previousSibling)};targetSelectBySiblings=function(B,A){return jQuery(B).siblings()};clicktipPrepareWithCloseLink=function(B,A){return B.append("<a class='clicktip_close'><span>close</span></a>").find("a.clicktip_close").click(function(C){B.hide();return false}).end()};hovertipPrepare=function(B,A){return B.hover(function(){hovertipHideCancel(this)},function(){hovertipHideLater(this)}).css("position","absolute").each(hovertipPosition)};hovertipPrepareNoOp=function(B,A){return B};hovertipPosition=function(A){document.body.appendChild(this)};hovertipIsVisible=function(A){return(jQuery.css(A,"display")!="none")};hovertipShowUnderMouse=function(A){hovertipHideCancel(A);if(!hovertipIsVisible(A)){A.ht.showing=window.setTimeout(function(){A.ht.tip.css({position:"absolute",top:hovertipMouseY+"px",left:hovertipMouseX+"px","z-index":1200}).show()},A.ht.config.showDelay)}};hovertipHideCancel=function(A){if(A.ht.hiding){window.clearTimeout(A.ht.hiding);A.ht.hiding=null}};hovertipHideLater=function(A){if(A.ht.showing){window.clearTimeout(A.ht.showing);A.ht.showing=null}if(A.ht.hiding){window.clearTimeout(A.ht.hiding);A.ht.hiding=null}A.ht.hiding=window.setTimeout(function(){if(A.ht.hiding){A.ht.tip.hide()}},A.ht.config.hideDelay)};clicktipTargetPrepare=function(C,B,A){return C.addClass(A.attribute+"_target").click(function(){B.ht.tip.toggle();return false})};hovertipTargetPrepare=function(C,B,A){return C.addClass(A.attribute+"_target").hover(function(){hovertipShowUnderMouse(B)},function(){hovertipHideLater(B)})};jQuery.fn.hovertipActivate=function(C,A,D,B){return this.css("display","block").hide().each(function(){if(!this.ht){this.ht=new Object()}this.ht.config=C;var E=A(this,C);if(E&&E.size()){if(!this.ht.targets){this.ht.targets=B(E,this,C)}else{this.ht.targets.add(B(E,this,C))}E.mousemove(hovertipMouseUpdate);if(!this.ht.tip){this.ht.tip=D(jQuery(this),C)}}})};function hovertipInit(){var A={attribute:"clicktip"};window.setTimeout(function(){jQuery(".clicktip").hovertipActivate(A,targetSelectById,clicktipPrepareWithCloseLink,clicktipTargetPrepare)},0);window.setTimeout(function(){jQuery(".clicktip").hovertipActivate(A,targetSelectByTargetAttribute,clicktipPrepareWithCloseLink,clicktipTargetPrepare)},0);var E={attribute:"hovertip",showDelay:300,hideDelay:700};var D="div.hovertip";var C=jQuery(D);jQuery(D).css("display","block").addClass("hovertip_wrap3").wrap("<div class='hovertip_wrap0'><div class='hovertip_wrap1'><div class='hovertip_wrap2'></div></div></div>").each(function(){var G=this.parentNode.parentNode.parentNode;if(this.getAttribute("target")){G.setAttribute("target",this.getAttribute("target"))}if(this.getAttribute("id")){var H=this.getAttribute("id");this.removeAttribute("id");G.setAttribute("id",H)}});jQuery("div.hovertip_wrap3").before('<div class="hovertip-arrow"></div>');var B=jQuery("div.hovertip_wrap3").length;D="div.hovertip_wrap0";window.setTimeout(function(){jQuery(D).hovertipActivate(E,targetSelectById,hovertipPrepare,hovertipTargetPrepare)},0);window.setTimeout(function(){jQuery(D).hovertipActivate(E,targetSelectByTargetAttribute,hovertipPrepare,hovertipTargetPrepare)},0);var F="span.hovertip";jQuery(F).css("display","block").addClass("hovertip_wrap3").wrap("<span class='hovertip_wrap0'><span class='hovertip_wrap1'><span class='hovertip_wrap2'></span></span></span>").each(function(){var G=this.parentNode.parentNode.parentNode;if(this.getAttribute("target")){G.setAttribute("target",this.getAttribute("target"))}if(this.getAttribute("id")){var H=this.getAttribute("id");this.removeAttribute("id");G.setAttribute("id",H)}});F="span.hovertip_wrap0";window.setTimeout(function(){jQuery(F).hovertipActivate(E,targetSelectByPrevious,hovertipPrepare,hovertipTargetPrepare)},0)}(function(J,M,E){var K={},H,C,I;K.Util={};K.Util.log=function(O){if(K.logging&&J.console&&J.console.log){J.console.log(O)}};K.Util.trimText=(function(O){return function(P){return O?O.apply(P):((P||"")+"").replace(/^\s+|\s+$/g,"")}})(String.prototype.trim);K.Util.asFloat=function(O){return parseFloat(O)};(function(){var P=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;var O=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;K.Util.parseTextShadows=function(U){if(!U||U==="none"){return[]}var T=U.match(P),R=[];for(var Q=0;T&&(Q<T.length);Q++){var S=T[Q].match(O);R.push({color:S[0],offsetX:S[1]?S[1].replace("px",""):0,offsetY:S[2]?S[2].replace("px",""):0,blur:S[3]?S[3].replace("px",""):0})}return R}})();K.Util.parseBackgroundImage=function(Z){var Q=" \r\n\t",P,R,W,f,S,U=[],Y,V=0,b=0,O,X;var e=function(){if(P){if(R.substr(0,1)==='"'){R=R.substr(1,R.length-2)}if(R){X.push(R)}if(P.substr(0,1)==="-"&&(f=P.indexOf("-",1)+1)>0){W=P.substr(0,f);P=P.substr(f)}U.push({prefix:W,method:P.toLowerCase(),value:S,args:X})}X=[];P=W=R=S=""};e();for(var T=0,d=Z.length;T<d;T++){Y=Z[T];if(V===0&&Q.indexOf(Y)>-1){continue}switch(Y){case'"':if(!O){O=Y}else{if(O===Y){O=null}}break;case"(":if(O){break}else{if(V===0){V=1;S+=Y;continue}else{b++}}break;case")":if(O){break}else{if(V===1){if(b===0){V=0;S+=Y;e();continue}else{b--}}}break;case",":if(O){break}else{if(V===0){e();continue}else{if(V===1){if(b===0&&!P.match(/^url$/i)){X.push(R);R="";S+=Y;continue}}}}break}S+=Y;if(V===0){P+=Y}else{R+=Y}}e();return U};K.Util.Bounds=function(O){var Q,P={};if(O.getBoundingClientRect){Q=O.getBoundingClientRect();P.top=Q.top;P.bottom=Q.bottom||(Q.top+Q.height);P.left=Q.left;P.width=O.offsetWidth;P.height=O.offsetHeight}return P};K.Util.OffsetBounds=function(O){var P=O.offsetParent?K.Util.OffsetBounds(O.offsetParent):{top:0,left:0};return{top:O.offsetTop+P.top,bottom:O.offsetTop+O.offsetHeight+P.top,left:O.offsetLeft+P.left,width:O.offsetWidth,height:O.offsetHeight}};function D(P,R,S){var O=P.runtimeStyle&&P.runtimeStyle[R],T,Q=P.style;if(!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(S)&&/^-?\d/.test(S)){T=Q.left;if(O){P.runtimeStyle.left=P.currentStyle.left}Q.left=R==="fontSize"?"1em":(S||0);S=Q.pixelLeft+"px";Q.left=T;if(O){P.runtimeStyle.left=O}}if(!/^(thin|medium|thick)$/i.test(S)){return Math.round(parseFloat(S))+"px"}return S}function B(O){return parseInt(O,10)}function N(R,P,Q,O){R=(R||"").split(",");R=R[O||0]||R[0]||"auto";R=K.Util.trimText(R).split(" ");if(Q==="backgroundSize"&&(!R[0]||R[0].match(/cover|contain|auto/))){}else{R[0]=(R[0].indexOf("%")===-1)?D(P,Q+"X",R[0]):R[0];if(R[1]===E){if(Q==="backgroundSize"){R[1]="auto";return R}else{R[1]=R[0]}}R[1]=(R[1].indexOf("%")===-1)?D(P,Q+"Y",R[1]):R[1]}return R}K.Util.getCSS=function(Q,R,P){if(H!==Q){C=M.defaultView.getComputedStyle(Q,null)}var S=C[R];if(/^background(Size|Position)$/.test(R)){return N(S,Q,R,P)}else{if(/border(Top|Bottom)(Left|Right)Radius/.test(R)){var O=S.split(" ");if(O.length<=1){O[1]=O[0]}return O.map(B)}}return S};K.Util.resizeBounds=function(T,O,U,V,W){var R=U/V,Q=T/O,P,S;if(!W||W==="auto"){P=U;S=V}else{if(R<Q^W==="contain"){S=V;P=V*Q}else{P=U;S=U/Q}}return{width:P,height:S}};function G(P,R,O,V,Q,Y){var T=K.Util.getCSS(R,P,Q),X,U,Z,S;if(T.length===1){S=T[0];T=[];T[0]=S;T[1]=S}if(T[0].toString().indexOf("%")!==-1){Z=(parseFloat(T[0])/100);U=O.width*Z;if(P!=="backgroundSize"){U-=(Y||V).width*Z}}else{if(P==="backgroundSize"){if(T[0]==="auto"){U=V.width}else{if(/contain|cover/.test(T[0])){var W=K.Util.resizeBounds(V.width,V.height,O.width,O.height,T[0]);U=W.width;X=W.height}else{U=parseInt(T[0],10)}}}else{U=parseInt(T[0],10)}}if(T[1]==="auto"){X=U/V.width*V.height}else{if(T[1].toString().indexOf("%")!==-1){Z=(parseFloat(T[1])/100);X=O.height*Z;if(P!=="backgroundSize"){X-=(Y||V).height*Z}}else{X=parseInt(T[1],10)}}return[U,X]}K.Util.BackgroundPosition=function(R,S,T,P,Q){var O=G("backgroundPosition",R,S,T,P,Q);return{left:O[0],top:O[1]}};K.Util.BackgroundSize=function(Q,R,S,P){var O=G("backgroundSize",Q,R,S,P);return{width:O[0],height:O[1]}};K.Util.Extend=function(O,Q){for(var P in O){if(O.hasOwnProperty(P)){Q[P]=O[P]}}return Q};K.Util.Children=function(Q){var P;try{P=(Q.nodeName&&Q.nodeName.toUpperCase()==="IFRAME")?Q.contentDocument||Q.contentWindow.document:(function(S){var R=[];if(S!==null){(function(X,V){var W=X.length,U=0;if(typeof V.length==="number"){for(var T=V.length;U<T;U++){X[W++]=V[U]}}else{while(V[U]!==E){X[W++]=V[U++]}}X.length=W;return X})(R,S)}return R})(Q.childNodes)}catch(O){K.Util.log("html2canvas.Util.Children failed with exception: "+O.message);P=[]}return P};K.Util.isTransparent=function(O){return(O==="transparent"||O==="rgba(0, 0, 0, 0)")};K.Util.Font=(function(){var O={};return function(R,Y,V){if(O[R+"-"+Y]!==E){return O[R+"-"+Y]}var P=V.createElement("div"),S=V.createElement("img"),W=V.createElement("span"),Q="Hidden Text",U,X,T;P.style.visibility="hidden";P.style.fontFamily=R;P.style.fontSize=Y;P.style.margin=0;P.style.padding=0;V.body.appendChild(P);S.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=";S.width=1;S.height=1;S.style.margin=0;S.style.padding=0;S.style.verticalAlign="baseline";W.style.fontFamily=R;W.style.fontSize=Y;W.style.margin=0;W.style.padding=0;W.appendChild(V.createTextNode(Q));P.appendChild(W);P.appendChild(S);U=(S.offsetTop-W.offsetTop)+1;P.removeChild(W);P.appendChild(V.createTextNode(Q));P.style.lineHeight="normal";S.style.verticalAlign="super";X=(S.offsetTop-P.offsetTop)+1;T={baseline:U,lineWidth:1,middle:X};O[R+"-"+Y]=T;V.body.removeChild(P);return T}})();(function(){var Q=K.Util,O={};K.Generate=O;var R=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];O.parseGradient=function(X,S){var c,W,Y=R.length,h,b,e,T,V,d,g,Z,f,U;for(W=0;W<Y;W+=1){h=X.match(R[W]);if(h){break}}if(h){switch(h[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":c={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]};e=h[2].match(/\w+/g);if(e){T=e.length;for(W=0;W<T;W+=1){switch(e[W]){case"top":c.y0=0;c.y1=S.height;break;case"right":c.x0=S.width;c.x1=0;break;case"bottom":c.y0=S.height;c.y1=0;break;case"left":c.x0=0;c.x1=S.width;break}}}if(c.x0===null&&c.x1===null){c.x0=c.x1=S.width/2}if(c.y0===null&&c.y1===null){c.y0=c.y1=S.height/2}e=h[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g);if(e){T=e.length;V=1/Math.max(T-1,1);for(W=0;W<T;W+=1){d=e[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/);if(d[2]){b=parseFloat(d[2]);if(d[3]==="%"){b/=100}else{b/=S.width}}else{b=W*V}c.colorStops.push({color:d[1],stop:b})}}break;case"-webkit-gradient":c={type:h[2]==="radial"?"circle":h[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]};e=h[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/);if(e){c.x0=(e[1]*S.width)/100;c.y0=(e[2]*S.height)/100;c.x1=(e[3]*S.width)/100;c.y1=(e[4]*S.height)/100}e=h[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g);if(e){T=e.length;for(W=0;W<T;W+=1){d=e[W].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/);b=parseFloat(d[2]);if(d[1]==="from"){b=0}if(d[1]==="to"){b=1}c.colorStops.push({color:d[3],stop:b})}}break;case"-moz-linear-gradient":c={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]};e=h[2].match(/(\d{1,3})%?\s(\d{1,3})%?/);if(e){c.x0=(e[1]*S.width)/100;c.y0=(e[2]*S.height)/100;c.x1=S.width-c.x0;c.y1=S.height-c.y0}e=h[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g);if(e){T=e.length;V=1/Math.max(T-1,1);for(W=0;W<T;W+=1){d=e[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/);if(d[2]){b=parseFloat(d[2]);if(d[3]){b/=100}}else{b=W*V}c.colorStops.push({color:d[1],stop:b})}}break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":c={type:"circle",x0:0,y0:0,x1:S.width,y1:S.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]};e=h[2].match(/(\d{1,3})%?\s(\d{1,3})%?/);if(e){c.cx=(e[1]*S.width)/100;c.cy=(e[2]*S.height)/100}e=h[3].match(/\w+/);d=h[4].match(/[a-z\-]*/);if(e&&d){switch(d[0]){case"farthest-corner":case"cover":case"":g=Math.sqrt(Math.pow(c.cx,2)+Math.pow(c.cy,2));Z=Math.sqrt(Math.pow(c.cx,2)+Math.pow(c.y1-c.cy,2));f=Math.sqrt(Math.pow(c.x1-c.cx,2)+Math.pow(c.y1-c.cy,2));U=Math.sqrt(Math.pow(c.x1-c.cx,2)+Math.pow(c.cy,2));c.rx=c.ry=Math.max(g,Z,f,U);break;case"closest-corner":g=Math.sqrt(Math.pow(c.cx,2)+Math.pow(c.cy,2));Z=Math.sqrt(Math.pow(c.cx,2)+Math.pow(c.y1-c.cy,2));f=Math.sqrt(Math.pow(c.x1-c.cx,2)+Math.pow(c.y1-c.cy,2));U=Math.sqrt(Math.pow(c.x1-c.cx,2)+Math.pow(c.cy,2));c.rx=c.ry=Math.min(g,Z,f,U);break;case"farthest-side":if(e[0]==="circle"){c.rx=c.ry=Math.max(c.cx,c.cy,c.x1-c.cx,c.y1-c.cy)}else{c.type=e[0];c.rx=Math.max(c.cx,c.x1-c.cx);c.ry=Math.max(c.cy,c.y1-c.cy)}break;case"closest-side":case"contain":if(e[0]==="circle"){c.rx=c.ry=Math.min(c.cx,c.cy,c.x1-c.cx,c.y1-c.cy)}else{c.type=e[0];c.rx=Math.min(c.cx,c.x1-c.cx);c.ry=Math.min(c.cy,c.y1-c.cy)}break}}e=h[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g);if(e){T=e.length;V=1/Math.max(T-1,1);for(W=0;W<T;W+=1){d=e[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/);if(d[2]){b=parseFloat(d[2]);if(d[3]==="%"){b/=100}else{b/=S.width}}else{b=W*V}c.colorStops.push({color:d[1],stop:b})}}break}}return c};function P(S){return function(T){try{S.addColorStop(T.stop,T.color)}catch(U){Q.log(["failed to add color stop: ",U,"; tried to add: ",T])}}}O.Gradient=function(S,T){if(T.width===0||T.height===0){return }var V=M.createElement("canvas"),c=V.getContext("2d"),Z,b;V.width=T.width;V.height=T.height;Z=K.Generate.parseGradient(S,T);if(Z){switch(Z.type){case"linear":b=c.createLinearGradient(Z.x0,Z.y0,Z.x1,Z.y1);Z.colorStops.forEach(P(b));c.fillStyle=b;c.fillRect(0,0,T.width,T.height);break;case"circle":b=c.createRadialGradient(Z.cx,Z.cy,0,Z.cx,Z.cy,Z.rx);Z.colorStops.forEach(P(b));c.fillStyle=b;c.fillRect(0,0,T.width,T.height);break;case"ellipse":var W=M.createElement("canvas"),U=W.getContext("2d"),Y=Math.max(Z.rx,Z.ry),X=Y*2;W.width=W.height=X;b=U.createRadialGradient(Z.rx,Z.ry,0,Z.rx,Z.ry,Y);Z.colorStops.forEach(P(b));U.fillStyle=b;U.fillRect(0,0,X,X);c.fillStyle=Z.colorStops[Z.colorStops.length-1].color;c.fillRect(0,0,V.width,V.height);c.drawImage(W,Z.cx-Z.rx,Z.cy-Z.ry,2*Z.rx,2*Z.ry);break}}return V};O.ListAlpha=function(U){var T="",S;do{S=U%26;T=String.fromCharCode((S)+64)+T;U=U/26}while((U*26)>26);return T};O.ListRoman=function(W){var V=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],T=[1000,900,500,400,100,90,50,40,10,9,5,4,1],X="",U,S=V.length;if(W<=0||W>=4000){return W}for(U=0;U<S;U+=1){while(W>=T[U]){W-=T[U];X+=V[U]}}return X}})();function F(P,O){var Q=[];return{storage:Q,width:P,height:O,clip:function(){Q.push({type:"function",name:"clip","arguments":arguments})},translate:function(){Q.push({type:"function",name:"translate","arguments":arguments})},fill:function(){Q.push({type:"function",name:"fill","arguments":arguments})},save:function(){Q.push({type:"function",name:"save","arguments":arguments})},restore:function(){Q.push({type:"function",name:"restore","arguments":arguments})},fillRect:function(){Q.push({type:"function",name:"fillRect","arguments":arguments})},createPattern:function(){Q.push({type:"function",name:"createPattern","arguments":arguments})},drawShape:function(){var R=[];Q.push({type:"function",name:"drawShape","arguments":R});return{moveTo:function(){R.push({name:"moveTo","arguments":arguments})},lineTo:function(){R.push({name:"lineTo","arguments":arguments})},arcTo:function(){R.push({name:"arcTo","arguments":arguments})},bezierCurveTo:function(){R.push({name:"bezierCurveTo","arguments":arguments})},quadraticCurveTo:function(){R.push({name:"quadraticCurveTo","arguments":arguments})}}},drawImage:function(){Q.push({type:"function",name:"drawImage","arguments":arguments})},fillText:function(){Q.push({type:"function",name:"fillText","arguments":arguments})},setVariable:function(R,S){Q.push({type:"variable",name:R,"arguments":S});return S}}}K.Parse=function(W,AE){J.scroll(0,0);var o=((AE.elements===E)?M.body:AE.elements[0]),X=0,b=o.ownerDocument,S=K.Util,AS=S.Support(AE,b),AO=new RegExp("("+AE.ignoreElements+")"),AB=b.body,z=S.getCSS,s="___html2canvas___pseudoelement",r=b.createElement("style");r.innerHTML="."+s+'-before:before { content: "" !important; display: none !important; }.'+s+'-after:after { content: "" !important; display: none !important; }';AB.appendChild(r);W=W||{};function AQ(){return Math.max(Math.max(b.body.scrollWidth,b.documentElement.scrollWidth),Math.max(b.body.offsetWidth,b.documentElement.offsetWidth),Math.max(b.body.clientWidth,b.documentElement.clientWidth))}function m(){return Math.max(Math.max(b.body.scrollHeight,b.documentElement.scrollHeight),Math.max(b.body.offsetHeight,b.documentElement.offsetHeight),Math.max(b.body.clientHeight,b.documentElement.clientHeight))}function AA(Ag,Ah){var Ai=parseInt(z(Ag,Ah),10);return(isNaN(Ai))?0:Ai}function Ac(Aj,Ag,Al,Ai,Ak,Ah){if(Ah!=="transparent"){Aj.setVariable("fillStyle",Ah);Aj.fillRect(Ag,Al,Ai,Ak);X+=1}}function AG(Ag,Ai,Ah){if(Ag.length>0){return Ai+Ah.toUpperCase()}}function Z(Ah,Ag){switch(Ag){case"lowercase":return Ah.toLowerCase();case"capitalize":return Ah.replace(/(^|\s|:|-|\(|\))([a-z])/g,AG);case"uppercase":return Ah.toUpperCase();default:return Ah}}function AL(Ag){return(/^(normal|none|0px)$/.test(Ag))}function O(Ai,Ag,Aj,Ah){if(Ai!==null&&S.trimText(Ai).length>0){Ah.fillText(Ai,Ag,Aj);X+=1}}function u(An,Ah,Ag,Ai){var Al=false,Am=z(Ah,"fontWeight"),Ak=z(Ah,"fontFamily"),Ao=z(Ah,"fontSize"),Aj=S.parseTextShadows(z(Ah,"textShadow"));switch(parseInt(Am,10)){case 401:Am="bold";break;case 400:Am="normal";break}An.setVariable("fillStyle",Ai);An.setVariable("font",[z(Ah,"fontStyle"),z(Ah,"fontVariant"),Am,Ao,Ak].join(" "));An.setVariable("textAlign",(Al)?"right":"left");if(Aj.length){An.setVariable("shadowColor",Aj[0].color);An.setVariable("shadowOffsetX",Aj[0].offsetX);An.setVariable("shadowOffsetY",Aj[0].offsetY);An.setVariable("shadowBlur",Aj[0].blur)}if(Ag!=="none"){return S.Font(Ak,Ao,b)}}function p(Ag,Ak,Aj,Ai,Ah){switch(Ak){case"underline":Ac(Ag,Aj.left,Math.round(Aj.top+Ai.baseline+Ai.lineWidth),Aj.width,1,Ah);break;case"overline":Ac(Ag,Aj.left,Math.round(Aj.top),Aj.width,1,Ah);break;case"line-through":Ac(Ag,Aj.left,Math.ceil(Aj.top+Ai.middle+Ai.lineWidth),Aj.width,1,Ah);break}}function AH(Ak,Am,Al,Aj,Ag){var Ai;if(AS.rangeBounds&&!Ag){if(Al!=="none"||S.trimText(Am).length!==0){Ai=AF(Am,Ak.node,Ak.textOffset)}Ak.textOffset+=Am.length}else{if(Ak.node&&typeof Ak.node.nodeValue==="string"){var Ah=(Aj)?Ak.node.splitText(Am.length):null;Ai=AK(Ak.node,Ag);Ak.node=Ah}}return Ai}function AF(Aj,Ai,Ah){var Ag=b.createRange();Ag.setStart(Ai,Ah);Ag.setEnd(Ai,Ah+Aj.length);return Ag.getBoundingClientRect()}function AK(Ah,Ag){var Ai=Ah.parentNode,Al=b.createElement("wrapper"),Ak=Ah.cloneNode(true);Al.appendChild(Ah.cloneNode(true));Ai.replaceChild(Al,Ah);var Aj=Ag?S.OffsetBounds(Al):S.Bounds(Al);Ai.replaceChild(Ak,Al);return Aj}function AZ(Ai,Aj,An){var Ao=An.ctx,Ak=z(Ai,"color"),Ap=z(Ai,"textDecoration"),Ah=z(Ai,"textAlign"),Am,Al,Ag={node:Aj,textOffset:0};if(S.trimText(Aj.nodeValue).length>0){Aj.nodeValue=Z(Aj.nodeValue,z(Ai,"textTransform"));Ah=Ah.replace(["-webkit-auto"],["auto"]);Al=(!AE.letterRendering&&/^(left|right|justify|auto)$/.test(Ah)&&AL(z(Ai,"letterSpacing")))?Aj.nodeValue.split(/(\b| )/):Aj.nodeValue.split("");Am=u(Ao,Ai,Ap,Ak);if(AE.chinese){Al.forEach(function(Ar,Aq){if(/.*[\u4E00-\u9FA5].*$/.test(Ar)){Ar=Ar.split("");Ar.unshift(Aq,1);Al.splice.apply(Al,Ar)}})}Al.forEach(function(As,Aq){var Ar=AH(Ag,As,Ap,(Aq<Al.length-1),An.transform.matrix);if(Ar){O(As,Ar.left,Ar.bottom,Ao);p(Ao,Ap,Ar,Am,Ak)}})}}function AJ(Ag,Ak){var Aj=b.createElement("boundelement"),Ah,Ai;Aj.style.display="inline";Ah=Ag.style.listStyleType;Ag.style.listStyleType="none";Aj.appendChild(b.createTextNode(Ak));Ag.insertBefore(Aj,Ag.firstChild);Ai=S.Bounds(Aj);Ag.removeChild(Aj);Ag.style.listStyleType=Ah;return Ai}function v(Ah){var Ag=-1,Ai=1,Aj=Ah.parentNode.childNodes;if(Ah.parentNode){while(Aj[++Ag]!==Ah){if(Aj[Ag].nodeType===1){Ai++}}return Ai}else{return -1}}function R(Ah,Ai){var Ag=v(Ah),Aj;switch(Ai){case"decimal":Aj=Ag;break;case"decimal-leading-zero":Aj=(Ag.toString().length===1)?Ag="0"+Ag.toString():Ag.toString();break;case"upper-roman":Aj=K.Generate.ListRoman(Ag);break;case"lower-roman":Aj=K.Generate.ListRoman(Ag).toLowerCase();break;case"lower-alpha":Aj=K.Generate.ListAlpha(Ag).toLowerCase();break;case"upper-alpha":Aj=K.Generate.ListAlpha(Ag);break}return Aj+". "}function AP(Aj,Ah,Am){var Ag,An,Ai=Ah.ctx,Ak=z(Aj,"listStyleType"),Al;if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(Ak)){An=R(Aj,Ak);Al=AJ(Aj,An);u(Ai,Aj,"none",z(Aj,"color"));if(z(Aj,"listStylePosition")==="inside"){Ai.setVariable("textAlign","left");Ag=Am.left}else{return }O(An,Ag,Al.bottom,Ai)}}function x(Ah){var Ag=W[Ah];return(Ag&&Ag.succeeded===true)?Ag.img:false}function e(Aj,Al){var Ag=Math.max(Aj.left,Al.left),Ak=Math.max(Aj.top,Al.top),Ah=Math.min((Aj.left+Aj.width),(Al.left+Al.width)),Ai=Math.min((Aj.top+Aj.height),(Al.top+Al.height));return{left:Ag,top:Ak,width:Ah-Ag,height:Ai-Ak}}function AR(Al,Aj,Ai){var An,Ah=Aj.cssPosition!=="static",Am=Ah?z(Al,"zIndex"):"auto",Ak=z(Al,"opacity"),Ag=z(Al,"cssFloat")!=="none";Aj.zIndex=An=A(Am);An.isPositioned=Ah;An.isFloated=Ag;An.opacity=Ak;An.ownStacking=(Am!=="auto"||Ak<1);if(Ai){Ai.zIndex.children.push(Aj)}}function w(Ao,Al,Ak,Ag,Am){var Aj=AA(Al,"paddingLeft"),An=AA(Al,"paddingTop"),Ai=AA(Al,"paddingRight"),Ah=AA(Al,"paddingBottom");Q(Ao,Ak,0,0,Ak.width,Ak.height,Ag.left+Aj+Am[3].width,Ag.top+An+Am[0].width,Ag.width-(Am[1].width+Am[3].width+Aj+Ai),Ag.height-(Am[0].width+Am[2].width+An+Ah))}function c(Ag){return["Top","Right","Bottom","Left"].map(function(Ah){return{width:AA(Ag,"border"+Ah+"Width"),color:z(Ag,"border"+Ah+"Color")}})}function P(Ag){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(Ah){return z(Ag,"border"+Ah+"Radius")})}var h=(function(Ag){return function(Ai,Ao,Am,Ak){var Al=(Am)*Ag,Aj=(Ak)*Ag,An=Ai+Am,Ah=Ao+Ak;return{topLeft:Af({x:Ai,y:Ah},{x:Ai,y:Ah-Aj},{x:An-Al,y:Ao},{x:An,y:Ao}),topRight:Af({x:Ai,y:Ao},{x:Ai+Al,y:Ao},{x:An,y:Ah-Aj},{x:An,y:Ah}),bottomRight:Af({x:An,y:Ao},{x:An,y:Ao+Aj},{x:Ai+Al,y:Ah},{x:Ai,y:Ah}),bottomLeft:Af({x:An,y:Ah},{x:An-Al,y:Ah},{x:Ai,y:Ao+Aj},{x:Ai,y:Ao})}}})(4*((Math.sqrt(2)-1)/3));function Af(Ak,Aj,Ai,Ag){var Ah=function(Am,Al,An){return{x:Am.x+(Al.x-Am.x)*An,y:Am.y+(Al.y-Am.y)*An}};return{start:Ak,startControl:Aj,endControl:Ai,end:Ag,subdivide:function(An){var Ap=Ah(Ak,Aj,An),Aq=Ah(Aj,Ai,An),Ar=Ah(Ai,Ag,An),Ao=Ah(Ap,Aq,An),Al=Ah(Aq,Ar,An),Am=Ah(Ao,Al,An);return[Af(Ak,Ap,Ao,Am),Af(Am,Al,Ar,Ag)]},curveTo:function(Al){Al.push(["bezierCurve",Aj.x,Aj.y,Ai.x,Ai.y,Ag.x,Ag.y])},curveToReversed:function(Al){Al.push(["bezierCurve",Ai.x,Ai.y,Aj.x,Aj.y,Ak.x,Ak.y])}}}function Ae(Ak,Al,Aj,Ai,Ah,Ag,Am){if(Al[0]>0||Al[1]>0){Ak.push(["line",Ai[0].start.x,Ai[0].start.y]);Ai[0].curveTo(Ak);Ai[1].curveTo(Ak)}else{Ak.push(["line",Ag,Am])}if(Aj[0]>0||Aj[1]>0){Ak.push(["line",Ah[0].start.x,Ah[0].start.y])}}function AW(Am,Ak,Aj,An,Ah,Al,Ag){var Ai=[];if(Ak[0]>0||Ak[1]>0){Ai.push(["line",An[1].start.x,An[1].start.y]);An[1].curveTo(Ai)}else{Ai.push(["line",Am.c1[0],Am.c1[1]])}if(Aj[0]>0||Aj[1]>0){Ai.push(["line",Al[0].start.x,Al[0].start.y]);Al[0].curveTo(Ai);Ai.push(["line",Ag[0].end.x,Ag[0].end.y]);Ag[0].curveToReversed(Ai)}else{Ai.push(["line",Am.c2[0],Am.c2[1]]);Ai.push(["line",Am.c3[0],Am.c3[1]])}if(Ak[0]>0||Ak[1]>0){Ai.push(["line",Ah[1].end.x,Ah[1].end.y]);Ah[1].curveToReversed(Ai)}else{Ai.push(["line",Am.c4[0],Am.c4[1]])}return Ai}function V(Aj,Ag,Ai){var An=Aj.left,Ak=Aj.top,As=Aj.width,Ar=Aj.height,At=Ag[0][0],Am=Ag[0][1],Aw=Ag[1][0],Ap=Ag[1][1],Ax=Ag[2][0],Aq=Ag[2][1],Av=Ag[3][0],Ao=Ag[3][1],Al=As-Aw,Ay=Ar-Aq,Ah=As-Ax,Au=Ar-Ao;return{topLeftOuter:h(An,Ak,At,Am).topLeft.subdivide(0.5),topLeftInner:h(An+Ai[3].width,Ak+Ai[0].width,Math.max(0,At-Ai[3].width),Math.max(0,Am-Ai[0].width)).topLeft.subdivide(0.5),topRightOuter:h(An+Al,Ak,Aw,Ap).topRight.subdivide(0.5),topRightInner:h(An+Math.min(Al,As+Ai[3].width),Ak+Ai[0].width,(Al>As+Ai[3].width)?0:Aw-Ai[3].width,Ap-Ai[0].width).topRight.subdivide(0.5),bottomRightOuter:h(An+Ah,Ak+Ay,Ax,Aq).bottomRight.subdivide(0.5),bottomRightInner:h(An+Math.min(Ah,As+Ai[3].width),Ak+Math.min(Ay,Ar+Ai[0].width),Math.max(0,Ax-Ai[1].width),Math.max(0,Aq-Ai[2].width)).bottomRight.subdivide(0.5),bottomLeftOuter:h(An,Ak+Au,Av,Ao).bottomLeft.subdivide(0.5),bottomLeftInner:h(An+Ai[3].width,Ak+Au,Math.max(0,Av-Ai[3].width),Math.max(0,Ao-Ai[2].width)).bottomLeft.subdivide(0.5)}}function Aa(Aj,Al,Am,Ag,Ak){var Ai=z(Aj,"backgroundClip"),Ah=[];switch(Ai){case"content-box":case"padding-box":Ae(Ah,Ag[0],Ag[1],Al.topLeftInner,Al.topRightInner,Ak.left+Am[3].width,Ak.top+Am[0].width);Ae(Ah,Ag[1],Ag[2],Al.topRightInner,Al.bottomRightInner,Ak.left+Ak.width-Am[1].width,Ak.top+Am[0].width);Ae(Ah,Ag[2],Ag[3],Al.bottomRightInner,Al.bottomLeftInner,Ak.left+Ak.width-Am[1].width,Ak.top+Ak.height-Am[2].width);Ae(Ah,Ag[3],Ag[0],Al.bottomLeftInner,Al.topLeftInner,Ak.left+Am[3].width,Ak.top+Ak.height-Am[2].width);break;default:Ae(Ah,Ag[0],Ag[1],Al.topLeftOuter,Al.topRightOuter,Ak.left,Ak.top);Ae(Ah,Ag[1],Ag[2],Al.topRightOuter,Al.bottomRightOuter,Ak.left+Ak.width,Ak.top);Ae(Ah,Ag[2],Ag[3],Al.bottomRightOuter,Al.bottomLeftOuter,Ak.left+Ak.width,Ak.top+Ak.height);Ae(Ah,Ag[3],Ag[0],Al.bottomLeftOuter,Al.topLeftOuter,Ak.left,Ak.top+Ak.height);break}return Ah}function AD(Am,Ah,Ap){var At=Ah.left,As=Ah.top,Aj=Ah.width,Av=Ah.height,Ai,Aq,Ao,Ar,Al,Ag,Ak=P(Am),An=V(Ah,Ak,Ap),Au={clip:Aa(Am,An,Ap,Ak,Ah),borders:[]};for(Ai=0;Ai<4;Ai++){if(Ap[Ai].width>0){Aq=At;Ao=As;Ar=Aj;Al=Av-(Ap[2].width);switch(Ai){case 0:Al=Ap[0].width;Ag=AW({c1:[Aq,Ao],c2:[Aq+Ar,Ao],c3:[Aq+Ar-Ap[1].width,Ao+Al],c4:[Aq+Ap[3].width,Ao+Al]},Ak[0],Ak[1],An.topLeftOuter,An.topLeftInner,An.topRightOuter,An.topRightInner);break;case 1:Aq=At+Aj-(Ap[1].width);Ar=Ap[1].width;Ag=AW({c1:[Aq+Ar,Ao],c2:[Aq+Ar,Ao+Al+Ap[2].width],c3:[Aq,Ao+Al],c4:[Aq,Ao+Ap[0].width]},Ak[1],Ak[2],An.topRightOuter,An.topRightInner,An.bottomRightOuter,An.bottomRightInner);break;case 2:Ao=(Ao+Av)-(Ap[2].width);Al=Ap[2].width;Ag=AW({c1:[Aq+Ar,Ao+Al],c2:[Aq,Ao+Al],c3:[Aq+Ap[3].width,Ao],c4:[Aq+Ar-Ap[3].width,Ao]},Ak[2],Ak[3],An.bottomRightOuter,An.bottomRightInner,An.bottomLeftOuter,An.bottomLeftInner);break;case 3:Ar=Ap[3].width;Ag=AW({c1:[Aq,Ao+Al+Ap[2].width],c2:[Aq,Ao],c3:[Aq+Ar,Ao+Ap[0].width],c4:[Aq+Ar,Ao+Al]},Ak[3],Ak[0],An.bottomLeftOuter,An.bottomLeftInner,An.topLeftOuter,An.topLeftInner);break}Au.borders.push({args:Ag,color:Ap[Ai].color})}}return Au}function T(Ag,Ai){var Ah=Ag.drawShape();Ai.forEach(function(Ak,Aj){Ah[(Aj===0)?"moveTo":Ak[0]+"To"].apply(null,Ak.slice(1))});return Ah}function l(Ag,Ai,Ah){if(Ah!=="transparent"){Ag.setVariable("fillStyle",Ah);T(Ag,Ai);Ag.fill();X+=1}}function AU(Aj,Ak,Ah){var Am=b.createElement("valuewrap"),Ai=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"],Ag,Al;Ai.forEach(function(An){try{Am.style[An]=z(Aj,An)}catch(Ao){S.log("html2canvas: Parse: Exception caught in renderFormValue: "+Ao.message)}});Am.style.borderColor="black";Am.style.borderStyle="solid";Am.style.display="block";Am.style.position="absolute";if(/^(submit|reset|button|text|password)$/.test(Aj.type)||Aj.nodeName==="SELECT"){Am.style.lineHeight=z(Aj,"height")}Am.style.top=Ak.top+"px";Am.style.left=Ak.left+"px";Ag=(Aj.nodeName==="SELECT")?(Aj.options[Aj.selectedIndex]||0).text:Aj.value;if(!Ag){Ag=Aj.placeholder}Al=b.createTextNode(Ag);Am.appendChild(Al);AB.appendChild(Am);AZ(Aj,Al,Ah);AB.removeChild(Am)}function Q(Ag){Ag.drawImage.apply(Ag,Array.prototype.slice.call(arguments,1));X+=1}function n(Ai,Al){var Ah=J.getComputedStyle(Ai,Al);if(!Ah||!Ah.content||Ah.content==="none"||Ah.content==="-moz-alt-content"||Ah.display==="none"){return }var Aj=Ah.content+"",Ak=Aj.substr(0,1);if(Ak===Aj.substr(Aj.length-1)&&Ak.match(/'|"/)){Aj=Aj.substr(1,Aj.length-2)}var Am=Aj.substr(0,3)==="url",Ag=M.createElement(Am?"img":"span");Ag.className=s+"-before "+s+"-after";Object.keys(Ah).filter(i).forEach(function(Ao){try{Ag.style[Ao]=Ah[Ao]}catch(An){S.log(["Tried to assign readonly property ",Ao,"Error:",An])}});if(Am){Ag.src=S.parseBackgroundImage(Aj)[0].args[0]}else{Ag.innerHTML=Aj}return Ag}function i(Ag){return(isNaN(J.parseInt(Ag,10)))}function U(Ah,Ag){var Ai=n(Ah,":before"),Aj=n(Ah,":after");if(!Ai&&!Aj){return }if(Ai){Ah.className+=" "+s+"-before";Ah.parentNode.insertBefore(Ai,Ah);AC(Ai,Ag,true);Ah.parentNode.removeChild(Ai);Ah.className=Ah.className.replace(s+"-before","").trim()}if(Aj){Ah.className+=" "+s+"-after";Ah.appendChild(Aj);AC(Aj,Ag,true);Ah.removeChild(Aj);Ah.className=Ah.className.replace(s+"-after","").trim()}}function AN(Ah,Ak,Ai,Aj){var Ag=Math.round(Aj.left+Ai.left),Al=Math.round(Aj.top+Ai.top);Ah.createPattern(Ak);Ah.translate(Ag,Al);Ah.fill();Ah.translate(-Ag,-Al)}function AT(Ao,Ak,Ai,Ag,Aj,Am,Ah,An){var Al=[];Al.push(["line",Math.round(Aj),Math.round(Am)]);Al.push(["line",Math.round(Aj+Ah),Math.round(Am)]);Al.push(["line",Math.round(Aj+Ah),Math.round(An+Am)]);Al.push(["line",Math.round(Aj),Math.round(An+Am)]);T(Ao,Al);Ao.save();Ao.clip();AN(Ao,Ak,Ai,Ag);Ao.restore()}function t(Ah,Ai,Ag){Ac(Ah,Ai.left,Ai.top,Ai.width,Ai.height,Ag)}function Y(Ak,Al,Ah,An,Ag){var Ai=S.BackgroundSize(Ak,Al,An,Ag),Aj=S.BackgroundPosition(Ak,Al,An,Ag,Ai),Am=z(Ak,"backgroundRepeat").split(",").map(S.trimText);An=j(An,Ai);Am=Am[Ag]||Am[0];switch(Am){case"repeat-x":AT(Ah,An,Aj,Al,Al.left,Al.top+Aj.top,99999,An.height);break;case"repeat-y":AT(Ah,An,Aj,Al,Al.left+Aj.left,Al.top,An.width,99999);break;case"no-repeat":AT(Ah,An,Aj,Al,Al.left+Aj.left,Al.top+Aj.top,An.width,An.height);break;default:AN(Ah,An,Aj,{top:Al.top,left:Al.left,width:An.width,height:An.height});break}}function Ad(Ak,Al,Ai){var An=z(Ak,"backgroundImage"),Ah=S.parseBackgroundImage(An),Am,Ag=Ah.length;while(Ag--){An=Ah[Ag];if(!An.args||An.args.length===0){continue}var Aj=An.method==="url"?An.args[0]:An.value;Am=x(Aj);if(Am){Y(Ak,Al,Ai,Am,Ag)}else{S.log("html2canvas: Error loading background:",An)}}}function j(Aj,Ai){if(Aj.width===Ai.width&&Aj.height===Ai.height){return Aj}var Ag,Ah=b.createElement("canvas");Ah.width=Ai.width;Ah.height=Ai.height;Ag=Ah.getContext("2d");Q(Ag,Aj,0,0,Aj.width,Aj.height,0,0,Ai.width,Ai.height);return Ah}function AV(Ah,Ai,Ag){return Ah.setVariable("globalAlpha",z(Ai,"opacity")*((Ag)?Ag.opacity:1))}function y(Ag){return Ag.replace("px","")}var AX=/(matrix)\((.+)\)/;function AM(Al,Ag){var Ak=z(Al,"transform")||z(Al,"-webkit-transform")||z(Al,"-moz-transform")||z(Al,"-ms-transform")||z(Al,"-o-transform");var Aj=z(Al,"transform-origin")||z(Al,"-webkit-transform-origin")||z(Al,"-moz-transform-origin")||z(Al,"-ms-transform-origin")||z(Al,"-o-transform-origin")||"0px 0px";Aj=Aj.split(" ").map(y).map(S.asFloat);var Ah;if(Ak&&Ak!=="none"){var Ai=Ak.match(AX);if(Ai){switch(Ai[1]){case"matrix":Ah=Ai[2].split(",").map(S.trimText).map(S.asFloat);break}}}return{origin:Aj,matrix:Ah}}function d(Ak,Ah,Al,Aj){var Ai=F((!Ah)?AQ():Al.width,(!Ah)?m():Al.height),Ag={ctx:Ai,opacity:AV(Ai,Ak,Ah),cssPosition:z(Ak,"position"),borders:c(Ak),transform:Aj,clip:(Ah&&Ah.clip)?S.Extend({},Ah.clip):null};AR(Ak,Ag,Ah);if(AE.useOverflow===true&&/(hidden|scroll|auto)/.test(z(Ak,"overflow"))===true&&/(BODY)/i.test(Ak.nodeName)===false){Ag.clip=(Ag.clip)?e(Ag.clip,Al):Al}return Ag}function g(Aj,Ah,Ag){var Ai={left:Ah.left+Aj[3].width,top:Ah.top+Aj[0].width,width:Ah.width-(Aj[1].width+Aj[3].width),height:Ah.height-(Aj[0].width+Aj[2].width)};if(Ag){Ai=e(Ai,Ag)}return Ai}function f(Ah,Ag){var Ai=(Ag.matrix)?S.OffsetBounds(Ah):S.Bounds(Ah);Ag.origin[0]+=Ai.left;Ag.origin[1]+=Ai.top;return Ai}function k(Al,Am,Ak,Ao){var Ah=AM(Al,Am),Ag=f(Al,Ah),Aj,Ap=d(Al,Am,Ag,Ah),An=Ap.borders,As=Ap.ctx,Ai=g(An,Ag,Ap.clip),Ar=AD(Al,Ag,An),Aq=(AO.test(Al.nodeName))?"#efefef":z(Al,"backgroundColor");T(As,Ar.clip);As.save();As.clip();if(Ai.height>0&&Ai.width>0&&!Ao){t(As,Ag,Aq);Ad(Al,Ai,As)}else{if(Ao){Ap.backgroundColor=Aq}}As.restore();Ar.borders.forEach(function(At){l(As,At.args,At.color)});if(!Ak){U(Al,Ap)}switch(Al.nodeName){case"IMG":if((Aj=x(Al.getAttribute("src")))){w(As,Al,Aj,Ag,An)}else{S.log("html2canvas: Error loading <img>:"+Al.getAttribute("src"))}break;case"INPUT":if(/^(text|url|email|submit|button|reset)$/.test(Al.type)&&(Al.value||Al.placeholder||"").length>0){AU(Al,Ag,Ap)}break;case"TEXTAREA":if((Al.value||Al.placeholder||"").length>0){AU(Al,Ag,Ap)}break;case"SELECT":if((Al.options||Al.placeholder||"").length>0){AU(Al,Ag,Ap)}break;case"LI":AP(Al,Ap,Ai);break;case"CANVAS":w(As,Al,Al,Ag,An);break}return Ap}function AI(Ag){return(z(Ag,"display")!=="none"&&z(Ag,"visibility")!=="hidden"&&!Ag.hasAttribute("data-html2canvas-ignore"))}function AC(Ah,Ag,Ai){if(AI(Ah)){Ag=k(Ah,Ag,Ai,false)||Ag;if(!AO.test(Ah.nodeName)){q(Ah,Ag,Ai)}}}function q(Ah,Ag,Ai){S.Children(Ah).forEach(function(Aj){if(Aj.nodeType===Aj.ELEMENT_NODE){AC(Aj,Ag,Ai)}else{if(Aj.nodeType===Aj.TEXT_NODE){AZ(Ah,Aj,Ag)}}})}function AY(){var Ai=z(M.documentElement,"backgroundColor"),Ah=(S.isTransparent(Ai)&&o===M.body),Ag=k(o,null,false,Ah);q(o,Ag);if(Ah){Ai=Ag.backgroundColor}AB.removeChild(r);return{backgroundColor:Ai,stack:Ag}}return AY()};function A(O){return{zindex:O,children:[]}}K.Preload=function(R){var b={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:false},k,T=K.Util,l,j,U=0,P=R.elements[0]||M.body,n=P.ownerDocument,Z=P.getElementsByTagName("img"),c=Z.length,V=n.createElement("a"),Y=(function(i){return(i.crossOrigin!==E)})(new Image()),e;V.href=J.location.href;k=V.protocol+V.host;function m(o){V.href=o;V.href=V.href;var i=V.protocol+V.host;return(i===k)}function S(){T.log("html2canvas: start: images: "+b.numLoaded+" / "+b.numTotal+" (failed: "+b.numFailed+")");if(!b.firstRun&&b.numLoaded>=b.numTotal){T.log("Finished loading images: # "+b.numTotal+" (failed: "+b.numFailed+")");if(typeof R.complete==="function"){R.complete(b)}}}function d(q,p,r){var i,s=R.proxy,o;V.href=q;q=V.href;i="html2canvas_"+(U++);r.callbackname=i;if(s.indexOf("?")>-1){s+="&"}else{s+="?"}s+="url="+encodeURIComponent(q)+"&callback="+i;o=n.createElement("script");J[i]=function(t){if(t.substring(0,6)==="error:"){r.succeeded=false;b.numLoaded++;b.numFailed++;S()}else{h(p,r);p.src=t}J[i]=E;try{delete J[i]}catch(u){}o.parentNode.removeChild(o);o=null;delete r.script;delete r.callbackname};o.setAttribute("type","text/javascript");o.setAttribute("src",s);r.script=o;J.document.body.appendChild(o)}function X(i,p){var o=J.getComputedStyle(i,p),q=o.content;if(q.substr(0,3)==="url"){l.loadImage(K.Util.parseBackgroundImage(q)[0].args[0])}g(o.backgroundImage,i)}function f(i){X(i,":before");X(i,":after")}function Q(p,o){var i=K.Generate.Gradient(p,o);if(i!==E){b[p]={img:i,succeeded:true};b.numTotal++;b.numLoaded++;S()}}function O(i){return(i&&i.method&&i.args&&i.args.length>0)}function g(o,i){var p;K.Util.parseBackgroundImage(o).filter(O).forEach(function(q){if(q.method==="url"){l.loadImage(q.args[0])}else{if(q.method.match(/\-?gradient$/)){if(p===E){p=K.Util.Bounds(i)}Q(q.value,p)}}})}function W(p){var i=false;try{T.Children(p).forEach(W)}catch(q){}try{i=p.nodeType}catch(o){i=false;T.log("html2canvas: failed to access some element's nodeType - Exception: "+o.message)}if(i===1||i===E){f(p);try{g(T.getCSS(p,"backgroundImage"),p)}catch(q){T.log("html2canvas: failed to get background-image - Exception: "+q.message)}g(p)}}function h(i,o){i.onload=function(){if(o.timer!==E){J.clearTimeout(o.timer)}b.numLoaded++;o.succeeded=true;i.onerror=i.onload=null;S()};i.onerror=function(){if(i.crossOrigin==="anonymous"){J.clearTimeout(o.timer);if(R.proxy){var p=i.src;i=new Image();o.img=i;i.src=p;d(i.src,i,o);return }}b.numLoaded++;b.numFailed++;o.succeeded=false;i.onerror=i.onload=null;S()}}l={loadImage:function(p){var i,o;if(p&&b[p]===E){i=new Image();if(p.match(/data:image\/.*;base64,/i)){i.src=p.replace(/url\(['"]{0,}|['"]{0,}\)$/ig,"");o=b[p]={img:i};b.numTotal++;h(i,o)}else{if(m(p)||R.allowTaint===true){o=b[p]={img:i};b.numTotal++;h(i,o);i.src=p}else{if(Y&&!R.allowTaint&&R.useCORS){i.crossOrigin="anonymous";o=b[p]={img:i};b.numTotal++;h(i,o);i.src=p}else{if(R.proxy){o=b[p]={img:i};b.numTotal++;d(p,i,o)}}}}}},cleanupDOM:function(p){var i,q;if(!b.cleanupDone){if(p&&typeof p==="string"){T.log("html2canvas: Cleanup because: "+p)}else{T.log("html2canvas: Cleanup after timeout: "+R.timeout+" ms.")}for(q in b){if(b.hasOwnProperty(q)){i=b[q];if(typeof i==="object"&&i.callbackname&&i.succeeded===E){J[i.callbackname]=E;try{delete J[i.callbackname]}catch(o){}if(i.script&&i.script.parentNode){i.script.setAttribute("src","about:blank");i.script.parentNode.removeChild(i.script)}b.numLoaded++;b.numFailed++;T.log("html2canvas: Cleaned up failed img: '"+q+"' Steps: "+b.numLoaded+" / "+b.numTotal)}}}if(J.stop!==E){J.stop()}else{if(M.execCommand!==E){M.execCommand("Stop",false)}}if(M.close!==E){M.close()}b.cleanupDone=true;if(!(p&&typeof p==="string")){S()}}},renderingDone:function(){if(e){J.clearTimeout(e)}}};if(R.timeout>0){e=J.setTimeout(l.cleanupDOM,R.timeout)}T.log("html2canvas: Preload starts: finding background-images");b.firstRun=true;W(P);T.log("html2canvas: Preload: Finding images");for(j=0;j<c;j+=1){l.loadImage(Z[j].getAttribute("src"))}b.firstRun=false;T.log("html2canvas: Preload: Done.");if(b.numTotal===b.numLoaded){S()}return l};K.Renderer=function(R,Q){function O(V){var T=[],S;S=(function U(Y){var X={};function Z(b,d,h){var j=(d.zIndex.zindex==="auto")?0:Number(d.zIndex.zindex),f=b,i=d.zIndex.isPositioned,e=d.zIndex.isFloated,c={node:d},g=h;if(d.zIndex.ownStacking){f=c.context={"!":[{node:d,children:[]}]};g=E}else{if(i||e){g=c.children=[]}}if(j===0&&h){h.push(c)}else{if(!b[j]){b[j]=[]}b[j].push(c)}d.zIndex.children.forEach(function(k){Z(f,k,g)})}Z(X,Y);return X})(V);function W(X){Object.keys(X).sort().forEach(function(c){var Z=[],e=[],b=[],d=[];X[c].forEach(function(f){if(f.node.zIndex.isPositioned||f.node.zIndex.opacity<1){b.push(f)}else{if(f.node.zIndex.isFloated){e.push(f)}else{Z.push(f)}}});(function Y(f){f.forEach(function(g){d.push(g);if(g.children){Y(g.children)}})})(Z.concat(e,b));d.forEach(function(f){if(f.context){W(f.context)}else{T.push(f.node)}})})}W(S);return T}function P(S){var T;if(typeof Q.renderer==="string"&&K.Renderer[S]!==E){T=K.Renderer[S](Q)}else{if(typeof S==="function"){T=S(Q)}else{throw new Error("Unknown renderer")}}if(typeof T!=="function"){throw new Error("Invalid renderer defined")}return T}return P(Q.renderer)(R,Q,M,O(R.stack),K)};K.Util.Support=function(P,R){function O(){var T=new Image(),U=R.createElement("canvas"),S=(U.getContext===E)?false:U.getContext("2d");if(S===false){return false}U.width=U.height=10;T.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{S.drawImage(T,0,0);U.toDataURL()}catch(V){return false}K.Util.log("html2canvas: Parse: SVG powered rendering available");return true}function Q(){var U,W,V,S,T=false;if(R.createRange){U=R.createRange();if(U.getBoundingClientRect){W=R.createElement("boundtest");W.style.height="123px";W.style.display="block";R.body.appendChild(W);U.selectNode(W);V=U.getBoundingClientRect();S=V.height;if(S===123){T=true}R.body.removeChild(W)}}return T}return{rangeBounds:Q(),svgRendering:P.svgRendering&&O()}};J.html2canvas=function(S,R){S=(S.length)?S:[S];var O,Q,P={logging:false,elements:S,background:"#fff",proxy:null,timeout:0,useCORS:false,allowTaint:false,svgRendering:false,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:true,letterRendering:false,chinese:false,width:null,height:null,taintTest:true,renderer:"Canvas"};P=K.Util.Extend(R,P);K.logging=P.logging;P.complete=function(T){if(typeof P.onpreloaded==="function"){if(P.onpreloaded(T)===false){return }}O=K.Parse(T,P);if(typeof P.onparsed==="function"){if(P.onparsed(O)===false){return }}Q=K.Renderer(O,P);if(typeof P.onrendered==="function"){P.onrendered(Q)}};J.setTimeout(function(){K.Preload(P)},0);return{render:function(T,U){return K.Renderer(T,K.Util.Extend(U,P))},parse:function(T,U){return K.Parse(T,K.Util.Extend(U,P))},preload:function(T){return K.Preload(K.Util.Extend(T,P))},log:K.Util.log}};J.html2canvas.log=K.Util.log;J.html2canvas.Renderer={Canvas:E};K.Renderer.Canvas=function(X){X=X||{};var V=M,R=[],W=M.createElement("canvas"),S=W.getContext("2d"),U=K.Util,O=X.canvas||V.createElement("canvas");function Q(Y,Z){Y.beginPath();Z.forEach(function(b){Y[b.name].apply(Y,b["arguments"])});Y.closePath()}function T(Y){if(R.indexOf(Y["arguments"][0].src)===-1){S.drawImage(Y["arguments"][0],0,0);try{S.getImageData(0,0,1,1)}catch(Z){W=V.createElement("canvas");S=W.getContext("2d");return false}R.push(Y["arguments"][0].src)}return true}function P(Y,Z){switch(Z.type){case"variable":Y[Z.name]=Z["arguments"];break;case"function":switch(Z.name){case"createPattern":if(Z["arguments"][0].width>0&&Z["arguments"][0].height>0){try{Y.fillStyle=Y.createPattern(Z["arguments"][0],"repeat")}catch(b){U.log("html2canvas: Renderer: Error creating pattern",b.message)}}break;case"drawShape":Q(Y,Z["arguments"]);break;case"drawImage":if(Z["arguments"][8]>0&&Z["arguments"][7]>0){if(!X.taintTest||(X.taintTest&&T(Z))){Y.drawImage.apply(Y,Z["arguments"])}}break;default:Y[Z.name].apply(Y,Z["arguments"])}break}}return function(i,k,g,c,f){var j=O.getContext("2d"),Z,Y,b,h=i.stack;O.width=O.style.width=k.width||h.ctx.width;O.height=O.style.height=k.height||h.ctx.height;b=j.fillStyle;j.fillStyle=(U.isTransparent(h.backgroundColor)&&k.background!==E)?k.background:i.backgroundColor;j.fillRect(0,0,O.width,O.height);j.fillStyle=b;c.forEach(function(e){j.textBaseline="bottom";j.save();if(e.transform.matrix){j.translate(e.transform.origin[0],e.transform.origin[1]);j.transform.apply(j,e.transform.matrix);j.translate(-e.transform.origin[0],-e.transform.origin[1])}if(e.clip){j.beginPath();j.rect(e.clip.left,e.clip.top,e.clip.width,e.clip.height);j.clip()}if(e.ctx.storage){e.ctx.storage.forEach(function(l){P(j,l)})}j.restore()});U.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj");if(k.elements.length===1){if(typeof k.elements[0]==="object"&&k.elements[0].nodeName!=="BODY"){Y=f.Util.Bounds(k.elements[0]);Z=g.createElement("canvas");Z.width=Math.ceil(Y.width);Z.height=Math.ceil(Y.height);j=Z.getContext("2d");try{j.drawImage(O,Y.left,Y.top,Y.width,Y.height,0,0,Y.width,Y.height)}catch(d){console.log("html2canvas err.")}O=null;return Z}}return O}}})(window,document);(function(C,D){C.support.htmlMenuitem=("HTMLMenuItemElement" in window);C.support.htmlCommand=("HTMLCommandElement" in window);C.support.eventSelectstart=("onselectstart" in document.documentElement);if(!C.ui||!C.ui.widget){var R=C.cleanData;C.cleanData=function(T){for(var U=0,V;(V=T[U])!=null;U++){try{C(V).triggerHandler("remove")}catch(W){}}R(T)}}var Q=null,B=false,O=C(window),H=0,G={},M={},K={},I={selector:null,appendTo:null,trigger:"right",autoHide:false,delay:200,reposition:true,determinePosition:function(T){if(C.ui&&C.ui.position){T.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")}else{var U=this.offset();U.top+=this.outerHeight();U.left+=this.outerWidth()/2-T.outerWidth()/2;T.css(U)}},position:function(V,Z,Y){var X=this,W;if(!Z&&!Y){V.determinePosition.call(this,V.$menu);return }else{if(Z==="maintain"&&Y==="maintain"){W=V.$menu.position()}else{W={top:Y,left:Z}}}var T=O.scrollTop()+O.height(),b=O.scrollLeft()+O.width(),c=V.$menu.height(),U=V.$menu.width();if(W.top+c>T){W.top-=c}if(W.left+U>b){W.left-=U}V.$menu.css(W)},positionSubmenu:function(T){if(C.ui&&C.ui.position){T.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","")}else{var U={top:0,left:this.outerWidth()};T.css(U)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:C.noop,hide:C.noop},callback:null,items:{}},J={timer:null,pageX:null,pageY:null},E=function(V){var U=0,T=V;while(true){U=Math.max(U,parseInt(T.css("z-index"),10)||0);T=T.parent();if(!T||!T.length||"html body".indexOf(T.prop("nodeName").toLowerCase())>-1){break}}return U},S={abortevent:function(T){T.preventDefault();T.stopImmediatePropagation()},contextmenu:function(V){var U=C(this);V.preventDefault();V.stopImmediatePropagation();if(V.data.trigger!="right"&&V.originalEvent){return }if(U.hasClass("context-menu-active")){return }if(!U.hasClass("context-menu-disabled")){Q=U;if(V.data.build){var T=V.data.build(Q,V);if(T===false){return }V.data=C.extend(true,{},I,V.data,T||{});if(!V.data.items||C.isEmptyObject(V.data.items)){if(window.console){(console.error||console.log)("No items specified to show in contextMenu")}throw new Error("No Items specified")}V.data.$trigger=Q;F.create(V.data)}F.show.call(U,V.data,V.pageX,V.pageY)}},click:function(T){T.preventDefault();T.stopImmediatePropagation();C(this).trigger(C.Event("contextmenu",{data:T.data,pageX:T.pageX,pageY:T.pageY}))},mousedown:function(U){var T=C(this);if(Q&&Q.length&&!Q.is(T)){Q.data("contextMenu").$menu.trigger("contextmenu:hide")}if(U.button==2){Q=T.data("contextMenuActive",true)}},mouseup:function(U){var T=C(this);if(T.data("contextMenuActive")&&Q&&Q.length&&Q.is(T)&&!T.hasClass("context-menu-disabled")){U.preventDefault();U.stopImmediatePropagation();Q=T;T.trigger(C.Event("contextmenu",{data:U.data,pageX:U.pageX,pageY:U.pageY}))}T.removeData("contextMenuActive")},mouseenter:function(V){var U=C(this),T=C(V.relatedTarget),W=C(document);if(T.is(".context-menu-list")||T.closest(".context-menu-list").length){return }if(Q&&Q.length){return }J.pageX=V.pageX;J.pageY=V.pageY;J.data=V.data;W.on("mousemove.contextMenuShow",S.mousemove);J.timer=setTimeout(function(){J.timer=null;W.off("mousemove.contextMenuShow");Q=U;U.trigger(C.Event("contextmenu",{data:J.data,pageX:J.pageX,pageY:J.pageY}))},V.data.delay)},mousemove:function(T){J.pageX=T.pageX;J.pageY=T.pageY},mouseleave:function(U){var T=C(U.relatedTarget);if(T.is(".context-menu-list")||T.closest(".context-menu-list").length){return }try{clearTimeout(J.timer)}catch(U){}J.timer=null},layerClick:function(W){var Y=C(this),b=Y.data("contextMenuRoot"),U=false,V=W.button,c=W.pageX,Z=W.pageY,X,T,d;W.preventDefault();W.stopImmediatePropagation();setTimeout(function(){var h,g,f;var e=((b.trigger=="left"&&V===0)||(b.trigger=="right"&&V===2));if(document.elementFromPoint){b.$layer.hide();X=document.elementFromPoint(c-O.scrollLeft(),Z-O.scrollTop());b.$layer.show()}if(b.reposition&&e){if(document.elementFromPoint){if(b.$trigger.is(X)||b.$trigger.has(X).length){b.position.call(b.$trigger,b,c,Z);return }}else{T=b.$trigger.offset();h=C(window);T.top+=h.scrollTop();if(T.top<=W.pageY){T.left+=h.scrollLeft();if(T.left<=W.pageX){T.bottom=T.top+b.$trigger.outerHeight();if(T.bottom>=W.pageY){T.right=T.left+b.$trigger.outerWidth();if(T.right>=W.pageX){b.position.call(b.$trigger,b,c,Z);return }}}}}}if(X&&e){b.$trigger.one("contextmenu:hidden",function(){C(X).contextMenu({x:c,y:Z})})}b.$menu.trigger("contextmenu:hide")},50)},keyStop:function(U,T){if(!T.isInput){U.preventDefault()}U.stopPropagation()},key:function(X){var V=Q.data("contextMenu")||{};switch(X.keyCode){case 9:case 38:S.keyStop(X,V);if(V.isInput){if(X.keyCode==9&&X.shiftKey){X.preventDefault();V.$selected&&V.$selected.find("input, textarea, select").blur();V.$menu.trigger("prevcommand");return }else{if(X.keyCode==38&&V.$selected.find("input, textarea, select").prop("type")=="checkbox"){X.preventDefault();return }}}else{if(X.keyCode!=9||X.shiftKey){V.$menu.trigger("prevcommand");return }}case 40:S.keyStop(X,V);if(V.isInput){if(X.keyCode==9){X.preventDefault();V.$selected&&V.$selected.find("input, textarea, select").blur();V.$menu.trigger("nextcommand");return }else{if(X.keyCode==40&&V.$selected.find("input, textarea, select").prop("type")=="checkbox"){X.preventDefault();return }}}else{V.$menu.trigger("nextcommand");return }break;case 37:S.keyStop(X,V);if(V.isInput||!V.$selected||!V.$selected.length){break}if(!V.$selected.parent().hasClass("context-menu-root")){var W=V.$selected.parent().parent();V.$selected.trigger("contextmenu:blur");V.$selected=W;return }break;case 39:S.keyStop(X,V);if(V.isInput||!V.$selected||!V.$selected.length){break}var U=V.$selected.data("contextMenu")||{};if(U.$menu&&V.$selected.hasClass("context-menu-submenu")){V.$selected=null;U.$selected=null;U.$menu.trigger("nextcommand");return }break;case 35:case 36:if(V.$selected&&V.$selected.find("input, textarea, select").length){return }else{(V.$selected&&V.$selected.parent()||V.$menu).children(":not(.disabled, .not-selectable)")[X.keyCode==36?"first":"last"]().trigger("contextmenu:focus");X.preventDefault();return }break;case 13:S.keyStop(X,V);if(V.isInput){if(V.$selected&&!V.$selected.is("textarea, select")){X.preventDefault();return }break}V.$selected&&V.$selected.trigger("mouseup");return ;case 32:case 33:case 34:S.keyStop(X,V);return ;case 27:S.keyStop(X,V);V.$menu.trigger("contextmenu:hide");return ;default:var T=(String.fromCharCode(X.keyCode)).toUpperCase();if(V.accesskeys[T]){V.accesskeys[T].$node.trigger(V.accesskeys[T].$menu?"contextmenu:focus":"mouseup");return }break}X.stopPropagation();V.$selected&&V.$selected.trigger(X)},prevItem:function(X){X.stopPropagation();var W=C(this).data("contextMenu")||{};if(W.$selected){var T=W.$selected;W=W.$selected.parent().data("contextMenu")||{};W.$selected=T}var V=W.$menu.children(),U=!W.$selected||!W.$selected.prev().length?V.last():W.$selected.prev(),Z=U;while(U.hasClass("disabled")||U.hasClass("not-selectable")){if(U.prev().length){U=U.prev()}else{U=V.last()}if(U.is(Z)){return }}if(W.$selected){S.itemMouseleave.call(W.$selected.get(0),X)}S.itemMouseenter.call(U.get(0),X);var Y=U.find("input, textarea, select");if(Y.length){Y.focus()}},nextItem:function(X){X.stopPropagation();var W=C(this).data("contextMenu")||{};if(W.$selected){var T=W.$selected;W=W.$selected.parent().data("contextMenu")||{};W.$selected=T}var V=W.$menu.children(),U=!W.$selected||!W.$selected.next().length?V.first():W.$selected.next(),Z=U;while(U.hasClass("disabled")||U.hasClass("not-selectable")){if(U.next().length){U=U.next()}else{U=V.first()}if(U.is(Z)){return }}if(W.$selected){S.itemMouseleave.call(W.$selected.get(0),X)}S.itemMouseenter.call(U.get(0),X);var Y=U.find("input, textarea, select");if(Y.length){Y.focus()}},focusInput:function(X){var W=C(this).closest(".context-menu-item"),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;T.$selected=U.$selected=W;T.isInput=U.isInput=true},blurInput:function(X){var W=C(this).closest(".context-menu-item"),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;T.isInput=U.isInput=false},menuMouseenter:function(U){var T=C(this).data().contextMenuRoot;T.hovering=true},menuMouseleave:function(U){var T=C(this).data().contextMenuRoot;if(T.$layer&&T.$layer.is(U.relatedTarget)){T.hovering=false}},itemMouseenter:function(X){var W=C(this),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;T.hovering=true;if(X&&T.$layer&&T.$layer.is(X.relatedTarget)){X.preventDefault();X.stopImmediatePropagation()}(U.$menu?U:T).$menu.children(".hover").trigger("contextmenu:blur");if(W.hasClass("disabled")||W.hasClass("not-selectable")){U.$selected=null;return }W.trigger("contextmenu:focus")},itemMouseleave:function(X){var W=C(this),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;if(T!==U&&T.$layer&&T.$layer.is(X.relatedTarget)){T.$selected&&T.$selected.trigger("contextmenu:blur");X.preventDefault();X.stopImmediatePropagation();T.$selected=U.$selected=U.$node;return }W.trigger("contextmenu:blur")},itemClick:function(Y){var X=C(this),W=X.data(),V=W.contextMenu,T=W.contextMenuRoot,U=W.contextMenuKey,Z;if(!V.items[U]||X.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){return }Y.preventDefault();Y.stopImmediatePropagation();if(C.isFunction(T.callbacks[U])&&Object.prototype.hasOwnProperty.call(T.callbacks,U)){Z=T.callbacks[U]}else{if(C.isFunction(T.callback)){Z=T.callback}else{return }}if(Z.call(T.$trigger,U,T)!==false){T.$menu.trigger("contextmenu:hide")}else{if(T.$menu.parent().length){F.update.call(T.$trigger,T)}}},inputClick:function(T){T.stopImmediatePropagation()},hideMenu:function(V,U){var T=C(this).data("contextMenuRoot");F.hide.call(T.$trigger,T,U&&U.force)},focusItem:function(X){X.stopPropagation();var W=C(this),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;W.addClass("hover").siblings(".hover").trigger("contextmenu:blur");U.$selected=T.$selected=W;if(U.$node){T.positionSubmenu.call(U.$node,U.$menu)}},blurItem:function(X){X.stopPropagation();var W=C(this),V=W.data(),U=V.contextMenu,T=V.contextMenuRoot;W.removeClass("hover");U.$selected=null}},F={show:function(W,U,Y){var T=C(this),X,V={};C("#context-menu-layer").trigger("mousedown");W.$trigger=T;if(W.events.show.call(T,W)===false){Q=null;return }F.update.call(T,W);W.position.call(T,W,U,Y);if(W.zIndex){V.zIndex=E(T)+W.zIndex}F.layer.call(W.$menu,W,V.zIndex);W.$menu.find("ul").css("zIndex",V.zIndex+1);W.$menu.css(V)[W.animation.show](W.animation.duration,function(){T.trigger("contextmenu:visible")});T.data("contextMenu",W).addClass("context-menu-active");C(document).off("keydown.contextMenu").on("keydown.contextMenu",S.key);if(W.autoHide){C(document).on("mousemove.contextMenuAutoHide",function(Z){var b=T.offset();b.right=b.left+T.outerWidth();b.bottom=b.top+T.outerHeight();if(W.$layer&&!W.hovering&&(!(Z.pageX>=b.left&&Z.pageX<=b.right)||!(Z.pageY>=b.top&&Z.pageY<=b.bottom))){W.$menu.trigger("contextmenu:hide")}})}},hide:function(U,V){var T=C(this);if(!U){U=T.data("contextMenu")||{}}if(!V&&U.events&&U.events.hide.call(T,U)===false){return }T.removeData("contextMenu").removeClass("context-menu-active");if(U.$layer){setTimeout((function(X){return function(){X.remove()}})(U.$layer),10);try{delete U.$layer}catch(W){U.$layer=null}}Q=null;U.$menu.find(".hover").trigger("contextmenu:blur");U.$selected=null;C(document).off(".contextMenuAutoHide").off("keydown.contextMenu");U.$menu&&U.$menu[U.animation.hide](U.animation.duration,function(){if(U.build){U.$menu.remove();C.each(U,function(X,Y){switch(X){case"ns":case"selector":case"build":case"trigger":return true;default:U[X]=D;try{delete U[X]}catch(Z){}return true}})}setTimeout(function(){T.trigger("contextmenu:hidden")},10)})},create:function(U,T){if(T===D){T=U}U.$menu=C('<ul class="context-menu-list"></ul>').addClass(U.className||"").data({contextMenu:U,contextMenuRoot:T});C.each(["callbacks","commands","inputs"],function(W,V){U[V]={};if(!T[V]){T[V]={}}});T.accesskeys||(T.accesskeys={});C.each(U.items,function(X,Y){var d=C('<li class="context-menu-item"></li>').addClass(Y.className||""),V=null,c=null;d.on("click",C.noop);Y.$node=d.data({contextMenu:U,contextMenuRoot:T,contextMenuKey:X});if(Y.accesskey){var Z=N(Y.accesskey);for(var W=0,b;b=Z[W];W++){if(!T.accesskeys[b]){T.accesskeys[b]=Y;Y._name=Y.name.replace(new RegExp("("+b+")","i"),'<span class="context-menu-accesskey">$1</span>');break}}}if(typeof Y=="string"){d.addClass("context-menu-separator not-selectable")}else{if(Y.type&&K[Y.type]){K[Y.type].call(d,Y,U,T);C.each([U,T],function(f,e){e.commands[X]=Y;if(C.isFunction(Y.callback)){e.callbacks[X]=Y.callback}})}else{if(Y.type=="html"){d.addClass("context-menu-html not-selectable")}else{if(Y.type){V=C("<label></label>").appendTo(d);C("<span></span>").html(Y._name||Y.name).appendTo(V);d.addClass("context-menu-input");U.hasTypes=true;C.each([U,T],function(f,e){e.commands[X]=Y;e.inputs[X]=Y})}else{if(Y.items){Y.type="sub"}}}switch(Y.type){case"text":c=C('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+X).val(Y.value||"").appendTo(V);break;case"textarea":c=C('<textarea name=""></textarea>').attr("name","context-menu-input-"+X).val(Y.value||"").appendTo(V);if(Y.height){c.height(Y.height)}break;case"checkbox":c=C('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+X).val(Y.value||"").prop("checked",!!Y.selected).prependTo(V);break;case"radio":c=C('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+Y.radio).val(Y.value||"").prop("checked",!!Y.selected).prependTo(V);break;case"select":c=C('<select name="">').attr("name","context-menu-input-"+X).appendTo(V);if(Y.options){C.each(Y.options,function(e,f){C("<option></option>").val(e).text(f).appendTo(c)});c.val(Y.selected)}break;case"sub":C("<span></span>").html(Y._name||Y.name).appendTo(d);Y.appendTo=Y.$node;F.create(Y,T);d.data("contextMenu",Y).addClass("context-menu-submenu");Y.callback=null;break;case"html":C(Y.html).appendTo(d);break;default:C.each([U,T],function(f,e){e.commands[X]=Y;if(C.isFunction(Y.callback)){e.callbacks[X]=Y.callback}});C("<span></span>").html(Y._name||Y.name||"").appendTo(d);break}if(Y.type&&Y.type!="sub"&&Y.type!="html"){c.on("focus",S.focusInput).on("blur",S.blurInput);if(Y.events){c.on(Y.events,U)}}if(Y.icon){d.addClass("icon icon-"+Y.icon)}}}Y.$input=c;Y.$label=V;d.appendTo(U.$menu);if(!U.hasTypes&&C.support.eventSelectstart){d.on("selectstart.disableTextSelect",S.abortevent)}});if(!U.$node){U.$menu.css("display","none").addClass("context-menu-root")}U.$menu.appendTo(U.appendTo||document.body)},resize:function(T,U){T.css({position:"absolute",display:"block"});T.data("width",Math.ceil(T.width())+1);T.css({position:"static",minWidth:"0px",maxWidth:"100000px"});T.find("> li > ul").each(function(){F.resize(C(this),true)});if(!U){T.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return C(this).data("width")})}},update:function(V,U){var T=this;if(U===D){U=V;F.resize(V.$menu)}V.$menu.children().each(function(){var W=C(this),X=W.data("contextMenuKey"),Z=V.items[X],Y=(C.isFunction(Z.disabled)&&Z.disabled.call(T,X,U))||Z.disabled===true;W[Y?"addClass":"removeClass"]("disabled");if(Z.type){W.find("input, select, textarea").prop("disabled",Y);switch(Z.type){case"text":case"textarea":Z.$input.val(Z.value||"");break;case"checkbox":case"radio":Z.$input.val(Z.value||"").prop("checked",!!Z.selected);break;case"select":Z.$input.val(Z.selected||"");break}}if(Z.$menu){F.update.call(T,Z,U)}})},layer:function(U,V){var T=U.$layer=C('<div id="context-menu-layer" style="position:fixed; z-index:'+V+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:O.height(),width:O.width(),display:"block"}).data("contextMenuRoot",U).insertBefore(this).on("contextmenu",S.abortevent).on("mousedown",S.layerClick);if(!C.support.fixedPosition){T.css({position:"absolute",height:C(document).height()})}return T}};function N(X){var V=X.split(/\s+/),W=[];for(var U=0,T;T=V[U];U++){T=T[0].toUpperCase();W.push(T)}return W}C.fn.contextMenu=function(T){if(T===D){this.first().trigger("contextmenu")}else{if(T.x&&T.y){this.first().trigger(C.Event("contextmenu",{pageX:T.x,pageY:T.y}))}else{if(T==="hide"){var U=this.data("contextMenu").$menu;U&&U.trigger("contextmenu:hide")}else{if(T==="destroy"){C.contextMenu("destroy",{context:this})}else{if(C.isPlainObject(T)){T.context=this;C.contextMenu("create",T)}else{if(T){this.removeClass("context-menu-disabled")}else{if(!T){this.addClass("context-menu-disabled")}}}}}}}return this};C.contextMenu=function(X,c){if(typeof X!="string"){c=X;X="create"}if(typeof c=="string"){c={selector:c}}else{if(c===D){c={}}}var V=C.extend(true,{},I,c||{});var W=C(document);var Z=W;var b=false;if(!V.context||!V.context.length){V.context=document}else{Z=C(V.context).first();V.context=Z.get(0);b=V.context!==document}switch(X){case"create":if(!V.selector){throw new Error("No selector specified")}if(V.selector.match(/.context-menu-(list|item|input)($|\s)/)){throw new Error('Cannot bind to selector "'+V.selector+'" as it contains a reserved className')}if(!V.build&&(!V.items||C.isEmptyObject(V.items))){throw new Error("No Items specified")}H++;V.ns=".contextMenu"+H;if(!b){G[V.selector]=V.ns}M[V.ns]=V;if(!V.trigger){V.trigger="right"}if(!B){W.on({"contextmenu:hide.contextMenu":S.hideMenu,"prevcommand.contextMenu":S.prevItem,"nextcommand.contextMenu":S.nextItem,"contextmenu.contextMenu":S.abortevent,"mouseenter.contextMenu":S.menuMouseenter,"mouseleave.contextMenu":S.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",S.inputClick).on({"mouseup.contextMenu":S.itemClick,"contextmenu:focus.contextMenu":S.focusItem,"contextmenu:blur.contextMenu":S.blurItem,"contextmenu.contextMenu":S.abortevent,"mouseenter.contextMenu":S.itemMouseenter,"mouseleave.contextMenu":S.itemMouseleave},".context-menu-item");B=true}Z.on("contextmenu"+V.ns,V.selector,V,S.contextmenu);if(b){Z.on("remove"+V.ns,function(){C(this).contextMenu("destroy")})}switch(V.trigger){case"hover":Z.on("mouseenter"+V.ns,V.selector,V,S.mouseenter).on("mouseleave"+V.ns,V.selector,V,S.mouseleave);break;case"left":Z.on("click"+V.ns,V.selector,V,S.click);break}if(!V.build){F.create(V)}break;case"destroy":var T;if(b){var U=V.context;C.each(M,function(d,g){if(g.context!==U){return true}T=C(".context-menu-list").filter(":visible");if(T.length&&T.data().contextMenuRoot.$trigger.is(C(g.context).find(g.selector))){T.trigger("contextmenu:hide",{force:true})}try{if(M[g.ns].$menu){M[g.ns].$menu.remove()}delete M[g.ns]}catch(f){M[g.ns]=null}C(g.context).off(g.ns);return true})}else{if(!V.selector){W.off(".contextMenu .contextMenuAutoHide");C.each(M,function(d,e){C(e.context).off(e.ns)});G={};M={};H=0;B=false;C("#context-menu-layer, .context-menu-list").remove()}else{if(G[V.selector]){T=C(".context-menu-list").filter(":visible");if(T.length&&T.data().contextMenuRoot.$trigger.is(V.selector)){T.trigger("contextmenu:hide",{force:true})}try{if(M[G[V.selector]].$menu){M[G[V.selector]].$menu.remove()}delete M[G[V.selector]]}catch(Y){M[G[V.selector]]=null}W.off(G[V.selector])}}}break;case"html5":if((!C.support.htmlCommand&&!C.support.htmlMenuitem)||(typeof c=="boolean"&&c)){C('menu[type="context"]').each(function(){if(this.id){C.contextMenu({selector:"[contextmenu="+this.id+"]",items:C.contextMenu.fromMenu(this)})}}).css("display","none")}break;default:throw new Error('Unknown operation "'+X+'"')}return this};C.contextMenu.setInputValues=function(T,U){if(U===D){U={}}C.each(T.inputs,function(V,W){switch(W.type){case"text":case"textarea":W.value=U[V]||"";break;case"checkbox":W.selected=U[V]?true:false;break;case"radio":W.selected=(U[W.radio]||"")==W.value?true:false;break;case"select":W.selected=U[V]||"";break}})};C.contextMenu.getInputValues=function(T,U){if(U===D){U={}}C.each(T.inputs,function(V,W){switch(W.type){case"text":case"textarea":case"select":U[V]=W.$input.val();break;case"checkbox":U[V]=W.$input.prop("checked");break;case"radio":if(W.$input.prop("checked")){U[W.radio]=W.value}break}});return U};function P(T){return(T.id&&C('label[for="'+T.id+'"]').val())||T.name}function A(V,U,T){if(!T){T=0}U.each(function(){var W=C(this),Z=this,b=this.nodeName.toLowerCase(),X,Y;if(b=="label"&&W.find("input, textarea, select").length){X=W.text();W=W.children().first();Z=W.get(0);b=Z.nodeName.toLowerCase()}switch(b){case"menu":Y={name:W.attr("label"),items:{}};T=A(Y.items,W.children(),T);break;case"a":case"button":Y={name:W.text(),disabled:!!W.attr("disabled"),callback:(function(){return function(){W.click()}})()};break;case"menuitem":case"command":switch(W.attr("type")){case D:case"command":case"menuitem":Y={name:W.attr("label"),disabled:!!W.attr("disabled"),callback:(function(){return function(){W.click()}})()};break;case"checkbox":Y={type:"checkbox",disabled:!!W.attr("disabled"),name:W.attr("label"),selected:!!W.attr("checked")};break;case"radio":Y={type:"radio",disabled:!!W.attr("disabled"),name:W.attr("label"),radio:W.attr("radiogroup"),value:W.attr("id"),selected:!!W.attr("checked")};break;default:Y=D}break;case"hr":Y="-------";break;case"input":switch(W.attr("type")){case"text":Y={type:"text",name:X||P(Z),disabled:!!W.attr("disabled"),value:W.val()};break;case"checkbox":Y={type:"checkbox",name:X||P(Z),disabled:!!W.attr("disabled"),selected:!!W.attr("checked")};break;case"radio":Y={type:"radio",name:X||P(Z),disabled:!!W.attr("disabled"),radio:!!W.attr("name"),value:W.val(),selected:!!W.attr("checked")};break;default:Y=D;break}break;case"select":Y={type:"select",name:X||P(Z),disabled:!!W.attr("disabled"),selected:W.val(),options:{}};W.children().each(function(){Y.options[this.value]=C(this).text()});break;case"textarea":Y={type:"textarea",name:X||P(Z),disabled:!!W.attr("disabled"),value:W.val()};break;case"label":break;default:Y={type:"html",html:W.clone(true)};break}if(Y){T++;V["key"+T]=Y}});return T}C.contextMenu.fromMenu=function(U){var V=C(U),T={};A(T,V.children());return T};C.contextMenu.defaults=I;C.contextMenu.types=K;C.contextMenu.handle=S;C.contextMenu.op=F;C.contextMenu.menus=M})(jQuery);(function(A){if(typeof define==="function"&&define.amd){define(["jquery"],A)}else{if(typeof exports==="object"){module.exports=A}else{A(jQuery)}}}(function(E){var D=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"];var G="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];var F,A;if(E.event.fixHooks){for(var B=D.length;B;){E.event.fixHooks[D[--B]]=E.event.mouseHooks}}E.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var H=G.length;H;){this.addEventListener(G[--H],C,false)}}else{this.onmousewheel=C}},teardown:function(){if(this.removeEventListener){for(var H=G.length;H;){this.removeEventListener(G[--H],C,false)}}else{this.onmousewheel=null}}};E.fn.extend({mousewheel:function(H){return H?this.bind("mousewheel",H):this.trigger("mousewheel")},unmousewheel:function(H){return this.unbind("mousewheel",H)}});function C(H){var I=H||window.event,O=[].slice.call(arguments,1),Q=0,K=0,J=0,N=0,M=0,P;H=E.event.fix(I);H.type="mousewheel";if(I.wheelDelta){Q=I.wheelDelta}if(I.detail){Q=I.detail*-1}if(I.deltaY){J=I.deltaY*-1;Q=J}if(I.deltaX){K=I.deltaX;Q=K*-1}if(I.wheelDeltaY!==undefined){J=I.wheelDeltaY}if(I.wheelDeltaX!==undefined){K=I.wheelDeltaX*-1}N=Math.abs(Q);if(!F||N<F){F=N}M=Math.max(Math.abs(J),Math.abs(K));if(!A||M<A){A=M}P=Q>0?"floor":"ceil";Q=Math[P](Q/F);K=Math[P](K/A);J=Math[P](J/A);O.unshift(H,Q,K,J);return(E.event.dispatch||E.event.handle).apply(this,O)}}));(function(A){if(typeof define==="function"&&define.amd){define(["jquery"],A)}else{A(jQuery)}}(function(I){var Q={},N,g,S,d,T,K,h,i,V,C,D,j,Y,M,R,f,b,G,P,c,E,A,e,U,O,k,B,X,J,Z,W,H,F=0;N=function(){return{common:{type:"line",lineColor:"#000",fillColor:false,defaultPixelsPerValue:3,width:"auto",height:"auto",composite:false,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:false,enableHighlight:true,highlightLighten:1.4,tooltipSkipNull:true,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:false,numberFormatter:false,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:false,disableInteraction:false},line:{spotColor:"#000",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:2,minSpotColor:"#000",maxSpotColor:"#000",lineWidth:1,normalRangeMin:undefined,normalRangeMax:undefined,normalRangeColor:"#ccc",drawNormalOnTop:false,chartRangeMin:undefined,chartRangeMax:undefined,chartRangeMinX:undefined,chartRangeMaxX:undefined,tooltipFormat:new S('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:undefined,nullColor:undefined,zeroAxis:true,barWidth:4,barSpacing:1,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:false,colorMap:undefined,tooltipFormat:new S('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new S('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss","0":"Draw","1":"Win"}}},discrete:{lineHeight:"auto",thresholdColor:undefined,thresholdValue:0,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:false,tooltipFormat:new S("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:undefined,tooltipFormat:new S("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new S('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:false,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:true,outlierIQR:1.5,spotRadius:1.5,target:undefined,targetColor:"#4a2",chartRangeMax:undefined,chartRangeMin:undefined,tooltipFormat:new S("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}};k='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}';g=function(){var l,m;l=function(){this.init.apply(this,arguments)};if(arguments.length>1){if(arguments[0]){l.prototype=I.extend(new arguments[0](),arguments[arguments.length-1]);l._super=arguments[0].prototype}else{l.prototype=arguments[arguments.length-1]}if(arguments.length>2){m=Array.prototype.slice.call(arguments,1,-1);m.unshift(l.prototype);I.extend.apply(I,m)}}else{l.prototype=arguments[0]}l.prototype.cls=l;return l};I.SPFormatClass=S=g({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(m,l){this.format=m;this.fclass=l},render:function(t,r,u){var s=this,q=t,p,m,n,o,l;return this.format.replace(this.fre,function(){var v;m=arguments[1];n=arguments[3];p=s.precre.exec(m);if(p){l=p[2];m=p[1]}else{l=false}o=q[m];if(o===undefined){return""}if(n&&r&&r[n]){v=r[n];if(v.get){return r[n].get(o)||o}else{return r[n][o]||o}}if(V(o)){if(u.get("numberFormatter")){o=u.get("numberFormatter")(o)}else{o=M(o,l,u.get("numberDigitGroupCount"),u.get("numberDigitGroupSep"),u.get("numberDecimalMark"))}}return o})}});I.spformat=function(m,l){return new S(m,l)};d=function(n,m,l){if(n<m){return m}if(n>l){return l}return n};T=function(l,n){var m;if(n===2){m=Math.floor(l.length/2);return l.length%2?l[m]:(l[m-1]+l[m])/2}else{if(l.length%2){m=(l.length*n+n)/4;return m%1?(l[Math.floor(m)]+l[Math.floor(m)-1])/2:l[m-1]}else{m=(l.length*n+2)/4;return m%1?(l[Math.floor(m)]+l[Math.floor(m)-1])/2:l[m-1]}}};K=function(m){var l;switch(m){case"undefined":m=undefined;break;case"null":m=null;break;case"true":m=true;break;case"false":m=false;break;default:l=parseFloat(m);if(m==l){m=l}}return m};h=function(n){var m,l=[];for(m=n.length;m--;){l[m]=K(n[m])}return l};i=function(p,n){var m,o,l=[];for(m=0,o=p.length;m<o;m++){if(p[m]!==n){l.push(p[m])}}return l};V=function(l){return !isNaN(parseFloat(l))&&isFinite(l)};M=function(n,m,l,r,q){var s,o;n=(m===false?parseFloat(n).toString():n.toFixed(m)).split("");s=(s=I.inArray(".",n))<0?n.length:s;if(s<n.length){n[s]=q}for(o=s-l;o>0;o-=l){n.splice(o,0,r)}return n.join("")};C=function(o,m,l){var n;for(n=m.length;n--;){if(l&&m[n]===null){continue}if(m[n]!==o){return false}}return true};D=function(n){var m=0,l;for(l=n.length;l--;){m+=typeof n[l]==="number"?n[l]:0}return m};Y=function(l){return I.isArray(l)?l:[l]};j=function(m){var l;if(document.createStyleSheet){document.createStyleSheet().cssText=m}else{l=document.createElement("style");l.type="text/css";document.getElementsByTagName("head")[0].appendChild(l);l[(typeof document.body.style.WebkitAppearance=="string")?"innerText":"innerHTML"]=m}};I.fn.simpledraw=function(o,l,m,n){var q,p;if(m&&(q=this.data("_jqs_vcanvas"))){return q}if(o===undefined){o=I(this).innerWidth()}if(l===undefined){l=I(this).innerHeight()}if(I.browser.hasCanvas){q=new Z(o,l,this,n)}else{if(I.browser.msie){q=new W(o,l,this)}else{return false}}p=I(this).data("_jqs_mhandler");if(p){p.registerCanvas(q)}return q};I.fn.cleardraw=function(){var l=this.data("_jqs_vcanvas");if(l){l.reset()}};I.RangeMapClass=R=g({init:function(o){var n,l,m=[];for(n in o){if(o.hasOwnProperty(n)&&typeof n==="string"&&n.indexOf(":")>-1){l=n.split(":");l[0]=l[0].length===0?-Infinity:parseFloat(l[0]);l[1]=l[1].length===0?Infinity:parseFloat(l[1]);l[2]=o[n];m.push(l)}}this.map=o;this.rangelist=m||false},get:function(p){var o=this.rangelist,n,m,l;if((l=this.map[p])!==undefined){return l}if(o){for(n=o.length;n--;){m=o[n];if(m[0]<=p&&m[1]>=p){return m[2]}}}return undefined}});I.range_map=function(l){return new R(l)};f=g({init:function(n,l){var m=I(n);this.$el=m;this.options=l;this.currentPageX=0;this.currentPageY=0;this.el=n;this.splist=[];this.tooltip=null;this.over=false;this.displayTooltips=!l.get("disableTooltips");this.highlightEnabled=!l.get("disableHighlight")},registerSparkline:function(l){this.splist.push(l);if(this.over){this.updateDisplay()}},registerCanvas:function(l){var m=I(l.canvas);this.canvas=l;this.$canvas=m;m.mouseenter(I.proxy(this.mouseenter,this));m.mouseleave(I.proxy(this.mouseleave,this));m.click(I.proxy(this.mouseclick,this))},reset:function(l){this.splist=[];if(this.tooltip&&l){this.tooltip.remove();this.tooltip=undefined}},mouseclick:function(m){var l=I.Event("sparklineClick");l.originalEvent=m;l.sparklines=this.splist;this.$el.trigger(l)},mouseenter:function(l){I(document.body).unbind("mousemove.jqs");I(document.body).bind("mousemove.jqs",I.proxy(this.mousemove,this));this.over=true;this.currentPageX=l.pageX;this.currentPageY=l.pageY;this.currentEl=l.target;if(!this.tooltip&&this.displayTooltips){this.tooltip=new b(this.options);this.tooltip.updatePosition(l.pageX,l.pageY)}this.updateDisplay()},mouseleave:function(){I(document.body).unbind("mousemove.jqs");var o=this.splist,l=o.length,n=false,p,m;this.over=false;this.currentEl=null;if(this.tooltip){this.tooltip.remove();this.tooltip=null}for(m=0;m<l;m++){p=o[m];if(p.clearRegionHighlight()){n=true}}if(n){this.canvas.render()}},mousemove:function(l){this.currentPageX=l.pageX;this.currentPageY=l.pageY;this.currentEl=l.target;if(this.tooltip){this.tooltip.updatePosition(l.pageX,l.pageY)}this.updateDisplay()},updateDisplay:function(){var m=this.splist,s=m.length,q=false,p=this.$canvas.offset(),o=this.currentPageX-p.left,n=this.currentPageY-p.top,t,l,r,v,u;if(!this.over){return }for(r=0;r<s;r++){l=m[r];v=l.setRegionHighlight(this.currentEl,o,n);if(v){q=true}}if(q){u=I.Event("sparklineRegionChange");u.sparklines=this.splist;this.$el.trigger(u);if(this.tooltip){t="";for(r=0;r<s;r++){l=m[r];t+=l.getCurrentRegionTooltip()}this.tooltip.setContent(t)}if(!this.disableHighlight){this.canvas.render()}}if(v===null){this.mouseleave()}}});b=g({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(l){var o=l.get("tooltipClassname","jqstooltip"),m=this.sizeStyle,n;this.container=l.get("tooltipContainer")||document.body;this.tooltipOffsetX=l.get("tooltipOffsetX",10);this.tooltipOffsetY=l.get("tooltipOffsetY",12);I("#jqssizetip").remove();I("#jqstooltip").remove();this.sizetip=I("<div/>",{id:"jqssizetip",style:m,"class":o});this.tooltip=I("<div/>",{id:"jqstooltip","class":o}).appendTo(this.container);n=this.tooltip.offset();this.offsetLeft=n.left;this.offsetTop=n.top;this.hidden=true;I(window).unbind("resize.jqs scroll.jqs");I(window).bind("resize.jqs scroll.jqs",I.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=I(window).scrollTop();this.scrollLeft=I(window).scrollLeft();this.scrollRight=this.scrollLeft+I(window).width();this.updatePosition()},getSize:function(l){this.sizetip.html(l).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(l){if(!l){this.tooltip.css("visibility","hidden");this.hidden=true;return }this.getSize(l);this.tooltip.html(l).css({width:this.width,height:this.height,visibility:"visible"});if(this.hidden){this.hidden=false;this.updatePosition()}},updatePosition:function(l,m){if(l===undefined){if(this.mousex===undefined){return }l=this.mousex-this.offsetLeft;m=this.mousey-this.offsetTop}else{this.mousex=l=l-this.offsetLeft;this.mousey=m=m-this.offsetTop}if(!this.height||!this.width||this.hidden){return }m-=this.height+this.tooltipOffsetY;l+=this.tooltipOffsetX;if(m<this.scrollTop){m=this.scrollTop}if(l<this.scrollLeft){l=this.scrollLeft}else{if(l+this.width>this.scrollRight){l=this.scrollRight-this.width}}this.tooltip.css({left:l,top:m})},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=undefined;I(window).unbind("resize.jqs scroll.jqs")}});B=function(){j(k)};I(B);H=[];I.fn.sparkline=function(l,m){return this.each(function(){var n=new I.fn.sparkline.options(this,m),q=I(this),p,o;p=function(){var s,u,r,t,x,w,v;if(l==="html"||l===undefined){v=this.getAttribute(n.get("tagValuesAttribute"));if(v===undefined||v===null){v=q.html()}s=v.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{s=l}u=n.get("width")==="auto"?s.length*n.get("defaultPixelsPerValue"):n.get("width");if(n.get("height")==="auto"){if(!n.get("composite")||!I.data(this,"_jqs_vcanvas")){t=document.createElement("span");t.innerHTML="a";q.html(t);r=I(t).innerHeight()||I(t).height();I(t).remove();t=null}}else{r=n.get("height")}if(!n.get("disableInteraction")){x=I.data(this,"_jqs_mhandler");if(!x){x=new f(this,n);I.data(this,"_jqs_mhandler",x)}else{if(!n.get("composite")){x.reset()}}}else{x=false}if(n.get("composite")&&!I.data(this,"_jqs_vcanvas")){if(!I.data(this,"_jqs_errnotify")){alert("Attempted to attach a composite sparkline to an element with no existing sparkline");I.data(this,"_jqs_errnotify",true)}return }w=new I.fn.sparkline[n.get("type")](this,s,n,u,r);w.render();if(x){x.registerSparkline(w)}};if((I(this).html()&&!n.get("disableHiddenCheck")&&I(this).is(":hidden"))||(I.fn.jquery<"1.3.0"&&I(this).parents().is(":hidden"))||!I(this).parents("body").length){if(!n.get("composite")&&I.data(this,"_jqs_pending")){for(o=H.length;o;o--){if(H[o-1][0]==this){H.splice(o-1,1)}}}H.push([this,p]);I.data(this,"_jqs_pending",true)}else{p.call(this)}})};I.fn.sparkline.defaults=N();I.sparkline_display_visible=function(){var o,m,n;var l=[];for(m=0,n=H.length;m<n;m++){o=H[m][0];if(I(o).is(":visible")&&!I(o).parents().is(":hidden")){H[m][1].call(o);I.data(H[m][0],"_jqs_pending",false);l.push(m)}else{if(!I(o).closest("html").length&&!I.data(o,"_jqs_pending")){I.data(H[m][0],"_jqs_pending",false);l.push(m)}}}for(m=l.length;m;m--){H.splice(l[m-1],1)}};I.fn.sparkline.options=g({init:function(l,q){var p,o,n,m;this.userOptions=q=q||{};this.tag=l;this.tagValCache={};o=I.fn.sparkline.defaults;n=o.common;this.tagOptionsPrefix=q.enableTagOptions&&(q.tagOptionsPrefix||n.tagOptionsPrefix);m=this.getTagSetting("type");if(m===Q){p=o[q.type||n.type]}else{p=o[m]}this.mergedOptions=I.extend({},n,p,q)},getTagSetting:function(n){var p=this.tagOptionsPrefix,q,m,o,l;if(p===false||p===undefined){return Q}if(this.tagValCache.hasOwnProperty(n)){q=this.tagValCache.key}else{q=this.tag.getAttribute(p+n);if(q===undefined||q===null){q=Q}else{if(q.substr(0,1)==="["){q=q.substr(1,q.length-2).split(",");for(m=q.length;m--;){q[m]=K(q[m].replace(/(^\s*)|(\s*$)/g,""))}}else{if(q.substr(0,1)==="{"){o=q.substr(1,q.length-2).split(",");q={};for(m=o.length;m--;){l=o[m].split(":",2);q[l[0].replace(/(^\s*)|(\s*$)/g,"")]=K(l[1].replace(/(^\s*)|(\s*$)/g,""))}}else{q=K(q)}}}this.tagValCache.key=q}return q},get:function(o,n){var m=this.getTagSetting(o),l;if(m!==Q){return m}return(l=this.mergedOptions[o])===undefined?n:l}});I.fn.sparkline._base=g({disabled:false,init:function(p,m,n,o,l){this.el=p;this.$el=I(p);this.values=m;this.options=n;this.width=o;this.height=l;this.currentRegion=undefined},initTarget:function(){var l=!this.options.get("disableInteraction");if(!(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),l))){this.disabled=true}else{this.canvasWidth=this.target.pixelWidth;this.canvasHeight=this.target.pixelHeight}},render:function(){if(this.disabled){this.el.innerHTML="";return false}return true},getRegion:function(l,m){},setRegionHighlight:function(n,l,q){var o=this.currentRegion,m=!this.options.get("disableHighlight"),p;if(l>this.canvasWidth||q>this.canvasHeight||l<0||q<0){return null}p=this.getRegion(n,l,q);if(o!==p){if(o!==undefined&&m){this.removeHighlight()}this.currentRegion=p;if(p!==undefined&&m){this.renderHighlight()}return true}return false},clearRegionHighlight:function(){if(this.currentRegion!==undefined){this.removeHighlight();this.currentRegion=undefined;return true}return false},renderHighlight:function(){this.changeHighlight(true)},removeHighlight:function(){this.changeHighlight(false)},changeHighlight:function(l){},getCurrentRegionTooltip:function(){var AB=this.options,q="",r=[],s,x,l,u,AA,p,t,o,v,n,z,y,w,m;if(this.currentRegion===undefined){return""}s=this.getCurrentRegionFields();z=AB.get("tooltipFormatter");if(z){return z(this,AB,s)}if(AB.get("tooltipChartTitle")){q+='<div class="jqs jqstitle">'+AB.get("tooltipChartTitle")+"</div>\n"}x=this.options.get("tooltipFormat");if(!x){return""}if(!I.isArray(x)){x=[x]}if(!I.isArray(s)){s=[s]}t=this.options.get("tooltipFormatFieldlist");o=this.options.get("tooltipFormatFieldlistKey");if(t&&o){v=[];for(p=s.length;p--;){n=s[p][o];if((m=I.inArray(n,t))!=-1){v[m]=s[p]}}s=v}l=x.length;w=s.length;for(p=0;p<l;p++){y=x[p];if(typeof y==="string"){y=new S(y)}u=y.fclass||"jqsfield";for(m=0;m<w;m++){if(!s[m].isNull||!AB.get("tooltipSkipNull")){I.extend(s[m],{prefix:AB.get("tooltipPrefix"),suffix:AB.get("tooltipSuffix")});AA=y.render(s[m],AB.get("tooltipValueLookups"),AB);r.push('<div class="'+u+'">'+AA+"</div>")}}}if(r.length){return q+r.join("\n")}return""},getCurrentRegionFields:function(){},calcHighlightColor:function(l,m){var s=m.get("highlightColor"),o=m.get("highlightLighten"),r,q,p,n;if(s){return s}if(o){r=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(l)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(l);if(r){p=[];q=l.length===4?16:1;for(n=0;n<3;n++){p[n]=d(Math.round(parseInt(r[n+1],16)*q*o),0,255)}return"rgb("+p.join(",")+")"}}return l}});G={changeHighlight:function(n){var p=this.currentRegion,o=this.target,l=this.regionShapes[p],m;if(l){m=this.renderRegion(p,n);if(I.isArray(m)||I.isArray(l)){o.replaceWithShapes(l,m);this.regionShapes[p]=I.map(m,function(q){return q.id})}else{o.replaceWithShape(l,m);this.regionShapes[p]=m.id}}},render:function(){var m=this.values,q=this.target,r=this.regionShapes,l,p,o,n;if(!this.cls._super.render.call(this)){return }for(o=m.length;o--;){l=this.renderRegion(o);if(l){if(I.isArray(l)){p=[];for(n=l.length;n--;){l[n].append();p.push(l[n].id)}r[o]=p}else{l.append();r[o]=l.id}}else{r[o]=null}}q.render()}};I.fn.sparkline.line=P=g(I.fn.sparkline._base,{type:"line",init:function(p,m,n,o,l){P._super.init.call(this,p,m,n,o,l);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.hightlightSpotId=null;this.lastShapeId=null;this.initTarget()},getRegion:function(n,l,p){var m,o=this.regionMap;for(m=o.length;m--;){if(o[m]!==null&&l>=o[m][0]&&l<=o[m][1]){return o[m][2]}}return undefined},getCurrentRegionFields:function(){var l=this.currentRegion;return{isNull:this.yvalues[l]===null,x:this.xvalues[l],y:this.yvalues[l],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:l}},renderHighlight:function(){var l=this.currentRegion,s=this.target,p=this.vertices[l],t=this.options,o=t.get("spotRadius"),n=t.get("highlightSpotColor"),q=t.get("highlightLineColor"),m,r;if(!p){return }if(o&&n){m=s.drawCircle(p[0],p[1],o,undefined,n);this.highlightSpotId=m.id;s.insertAfterShape(this.lastShapeId,m)}if(q){r=s.drawLine(p[0],this.canvasTop,p[0],this.canvasTop+this.canvasHeight,q);this.highlightLineId=r.id;s.insertAfterShape(this.lastShapeId,r)}},removeHighlight:function(){var l=this.target;if(this.highlightSpotId){l.removeShapeId(this.highlightSpotId);this.highlightSpotId=null}if(this.highlightLineId){l.removeShapeId(this.highlightLineId);this.highlightLineId=null}},scanValues:function(){var t=this.values,n=t.length,l=this.xvalues,r=this.yvalues,u=this.yminmax,p,o,s,q,m;for(p=0;p<n;p++){o=t[p];s=typeof (t[p])==="string";q=typeof (t[p])==="object"&&t[p] instanceof Array;m=s&&t[p].split(":");if(s&&m.length===2){l.push(Number(m[0]));r.push(Number(m[1]));u.push(Number(m[1]))}else{if(q){l.push(o[0]);r.push(o[1]);u.push(o[1])}else{l.push(p);if(t[p]===null||t[p]==="null"){r.push(null)}else{r.push(Number(o));u.push(Number(o))}}}}if(this.options.get("xvalues")){l=this.options.get("xvalues")}this.maxy=this.maxyorg=Math.max.apply(Math,u);this.miny=this.minyorg=Math.min.apply(Math,u);this.maxx=Math.max.apply(Math,l);this.minx=Math.min.apply(Math,l);this.xvalues=l;this.yvalues=r;this.yminmax=u},processRangeOptions:function(){var m=this.options,l=m.get("normalRangeMin"),n=m.get("normalRangeMax");if(l!==undefined){if(l<this.miny){this.miny=l}if(n>this.maxy){this.maxy=n}}if(m.get("chartRangeMin")!==undefined&&(m.get("chartRangeClip")||m.get("chartRangeMin")<this.miny)){this.miny=m.get("chartRangeMin")}if(m.get("chartRangeMax")!==undefined&&(m.get("chartRangeClip")||m.get("chartRangeMax")>this.maxy)){this.maxy=m.get("chartRangeMax")}if(m.get("chartRangeMinX")!==undefined&&(m.get("chartRangeClipX")||m.get("chartRangeMinX")<this.minx)){this.minx=m.get("chartRangeMinX")}if(m.get("chartRangeMaxX")!==undefined&&(m.get("chartRangeClipX")||m.get("chartRangeMaxX")>this.maxx)){this.maxx=m.get("chartRangeMaxX")}},drawNormalRange:function(n,r,q,o,s){var l=this.options.get("normalRangeMin"),p=this.options.get("normalRangeMax"),m=r+Math.round(q-(q*((p-this.miny)/s))),t=Math.round((q*(p-l))/s);t=Math.max(t,1);if(t==1){this.target.drawLine(n,m,o,m,this.options.get("normalRangeColor"),1).append()}else{this.target.drawRect(n,m,o,t,undefined,this.options.get("normalRangeColor")).append()}},render:function(){var r=this.options,AR=this.target,AO=this.canvasWidth,o=this.canvasHeight,u=this.vertices,AS=r.get("spotRadius"),AD=this.regionMap,n,m,AI,AM,AK,AN,AE,AH,AB,AA,AG,p,AP,z,AF,AQ,q,s,AC,l,v,AJ,w,t,AL;if(!P._super.render.call(this)){return }this.scanValues();this.processRangeOptions();w=this.xvalues;t=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return }AM=AK=0;n=this.maxx-this.minx===0?1:this.maxx-this.minx;m=this.maxy-this.miny===0?1:this.maxy-this.miny;AI=this.yvalues.length-1;if(AS&&(AO<(AS*4)||o<(AS*4))){AS=0}if(AS){v=r.get("highlightSpotColor")&&!r.get("disableInteraction");if(v||r.get("minSpotColor")||(r.get("spotColor")&&t[AI]===this.miny)){o-=Math.ceil(AS)}if(v||r.get("maxSpotColor")||(r.get("spotColor")&&t[AI]===this.maxy)){o-=Math.ceil(AS);AM+=Math.ceil(AS)}if(v||((r.get("minSpotColor")||r.get("maxSpotColor"))&&(t[0]===this.miny||t[0]===this.maxy))){AK+=Math.ceil(AS);AO-=Math.ceil(AS)}if(v||r.get("spotColor")||(r.get("minSpotColor")||r.get("maxSpotColor")&&(t[AI]===this.miny||t[AI]===this.maxy))){AO-=Math.ceil(AS)}}o--;if(r.get("normalRangeMin")!==undefined&&!r.get("drawNormalOnTop")){this.drawNormalRange(AK,AM,o,AO,m)}AE=[];AH=[AE];z=AF=null;AQ=t.length;for(AL=0;AL<AQ;AL++){AB=w[AL];AG=w[AL+1];AA=t[AL];p=AK+Math.round((AB-this.minx)*(AO/n));AP=AL<AQ-1?AK+Math.round((AG-this.minx)*(AO/n)):AO;AF=p+((AP-p)/2);AD[AL]=[z||0,AF,AL];z=AF;if(AA===null){if(AL){if(t[AL-1]!==null){AE=[];AH.push(AE)}u.push(null)}}else{if(AA<this.miny){AA=this.miny}if(AA>this.maxy){AA=this.maxy}if(!AE.length){AE.push([p,AM+o])}AN=[p,AM+Math.round(o-(o*((AA-this.miny)/m)))];AE.push(AN);u.push(AN)}}q=[];s=[];AC=AH.length;for(AL=0;AL<AC;AL++){AE=AH[AL];if(AE.length){if(r.get("fillColor")){AE.push([AE[AE.length-1][0],(AM+o)]);s.push(AE.slice(0));AE.pop()}if(AE.length>2){AE[0]=[AE[0][0],AE[1][1]]}q.push(AE)}}AC=s.length;for(AL=0;AL<AC;AL++){AR.drawShape(s[AL],r.get("fillColor"),r.get("fillColor")).append()}if(r.get("normalRangeMin")!==undefined&&r.get("drawNormalOnTop")){this.drawNormalRange(AK,AM,o,AO,m)}AC=q.length;for(AL=0;AL<AC;AL++){AR.drawShape(q[AL],r.get("lineColor"),undefined,r.get("lineWidth")).append()}if(AS&&r.get("valueSpots")){l=r.get("valueSpots");if(l.get===undefined){l=new R(l)}for(AL=0;AL<AQ;AL++){AJ=l.get(t[AL]);if(AJ){AR.drawCircle(AK+Math.round((w[AL]-this.minx)*(AO/n)),AM+Math.round(o-(o*((t[AL]-this.miny)/m))),AS,undefined,AJ).append()}}}if(AS&&r.get("spotColor")){AR.drawCircle(AK+Math.round((w[w.length-1]-this.minx)*(AO/n)),AM+Math.round(o-(o*((t[AI]-this.miny)/m))),AS,undefined,r.get("spotColor")).append()}if(this.maxy!==this.minyorg){if(AS&&r.get("minSpotColor")){AB=w[I.inArray(this.minyorg,t)];AR.drawCircle(AK+Math.round((AB-this.minx)*(AO/n)),AM+Math.round(o-(o*((this.minyorg-this.miny)/m))),AS,undefined,r.get("minSpotColor")).append()}if(AS&&r.get("maxSpotColor")){AB=w[I.inArray(this.maxyorg,t)];AR.drawCircle(AK+Math.round((AB-this.minx)*(AO/n)),AM+Math.round(o-(o*((this.maxyorg-this.miny)/m))),AS,undefined,r.get("maxSpotColor")).append()}}this.lastShapeId=AR.getLastShapeId();this.canvasTop=AM;AR.render()}});I.fn.sparkline.bar=c=g(I.fn.sparkline._base,G,{type:"bar",init:function(AS,AU,z,l,m){var AB=parseInt(z.get("barWidth"),10),AD=parseInt(z.get("barSpacing"),10),r=z.get("chartRangeMin"),AI=z.get("chartRangeMax"),o=z.get("chartRangeClip"),AM=Infinity,v=-Infinity,AV,s,AK,AA,AJ,AR,AL,q,AF,x,AT,y,AQ,w,AN,p,AP,AG,t,AC,n,AO,AH;c._super.init.call(this,AS,AU,z,l,m);for(AR=0,AL=AU.length;AR<AL;AR++){AC=AU[AR];AV=typeof (AC)==="string"&&AC.indexOf(":")>-1;if(AV||I.isArray(AC)){AN=true;if(AV){AC=AU[AR]=h(AC.split(":"))}AC=i(AC,null);s=Math.min.apply(Math,AC);AK=Math.max.apply(Math,AC);if(s<AM){AM=s}if(AK>v){v=AK}}}this.stacked=AN;this.regionShapes={};this.barWidth=AB;this.barSpacing=AD;this.totalBarWidth=AB+AD;this.width=l=(AU.length*AB)+((AU.length-1)*AD);this.initTarget();if(o){AQ=r===undefined?-Infinity:r;w=AI===undefined?Infinity:AI}AJ=[];AA=AN?[]:AJ;var AE=[];var u=[];for(AR=0,AL=AU.length;AR<AL;AR++){if(AN){p=AU[AR];AU[AR]=t=[];AE[AR]=0;AA[AR]=u[AR]=0;for(AP=0,AG=p.length;AP<AG;AP++){AC=t[AP]=o?d(p[AP],AQ,w):p[AP];if(AC!==null){if(AC>0){AE[AR]+=AC}if(AM<0&&v>0){if(AC<0){u[AR]+=Math.abs(AC)}else{AA[AR]+=AC}}else{AA[AR]+=Math.abs(AC-(AC<0?v:AM))}AJ.push(AC)}}}else{AC=o?d(AU[AR],AQ,w):AU[AR];AC=AU[AR]=K(AC);if(AC!==null){AJ.push(AC)}}}this.max=y=Math.max.apply(Math,AJ);this.min=AT=Math.min.apply(Math,AJ);this.stackMax=v=AN?Math.max.apply(Math,AE):y;this.stackMin=AM=AN?Math.min.apply(Math,AJ):AT;if(z.get("chartRangeMin")!==undefined&&(z.get("chartRangeClip")||z.get("chartRangeMin")<AT)){AT=z.get("chartRangeMin")}if(z.get("chartRangeMax")!==undefined&&(z.get("chartRangeClip")||z.get("chartRangeMax")>y)){y=z.get("chartRangeMax")}this.zeroAxis=AF=z.get("zeroAxis",true);if(AT<=0&&y>=0&&AF){x=0}else{if(AF==false){x=AT}else{if(AT>0){x=AT}else{x=y}}}this.xaxisOffset=x;q=AN?(Math.max.apply(Math,AA)+Math.max.apply(Math,u)):y-AT;this.canvasHeightEf=(AF&&AT<0)?this.canvasHeight-2:this.canvasHeight-1;if(AT<x){AO=(AN&&y>=0)?v:y;n=(AO-x)/q*this.canvasHeight;if(n!==Math.ceil(n)){this.canvasHeightEf-=2;n=Math.ceil(n)}}else{n=this.canvasHeight}this.yoffset=n;if(I.isArray(z.get("colorMap"))){this.colorMapByIndex=z.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=z.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===undefined){this.colorMapByValue=new R(this.colorMapByValue)}}this.range=q},getRegion:function(n,m,o){var l=Math.floor(m/this.totalBarWidth);return(l<0||l>=this.values.length)?undefined:l},getCurrentRegionFields:function(){var p=this.currentRegion,m=Y(this.values[p]),l=[],o,n;for(n=m.length;n--;){o=m[n];l.push({isNull:o===null,value:o,color:this.calcColor(n,o,p),offset:p})}return l},calcColor:function(p,q,r){var s=this.colorMapByIndex,o=this.colorMapByValue,n=this.options,l,m;if(this.stacked){l=n.get("stackedBarColor")}else{l=(q<0)?n.get("negBarColor"):n.get("barColor")}if(q===0&&n.get("zeroColor")!==undefined){l=n.get("zeroColor")}if(o&&(m=o.get(q))){l=m}else{if(s&&s.length>r){l=s[r]}}return I.isArray(l)?l[p%l.length]:l},renderRegion:function(v,p){var z=this.values[v],n=this.options,l=this.xaxisOffset,t=[],AA=this.range,AG=this.stacked,AH=this.target,s=v*this.totalBarWidth,m=this.canvasHeightEf,u=this.yoffset,r,AB,AD,AC,q,AE,o,AI,AF,w;z=I.isArray(z)?z:[z];o=z.length;AI=z[0];AC=C(null,z);w=C(l,z,true);if(AC){if(n.get("nullColor")){AD=p?n.get("nullColor"):this.calcHighlightColor(n.get("nullColor"),n);r=(u>0)?u-1:u;return AH.drawRect(s,r,this.barWidth-1,0,AD,AD)}else{return undefined}}q=u;for(AE=0;AE<o;AE++){AI=z[AE];if(AG&&AI===l){if(!w||AF){continue}AF=true}if(AA>0){AB=Math.floor(m*((Math.abs(AI-l)/AA)))+1}else{AB=1}if(AI<l||(AI===l&&u===0)){r=q;q+=AB}else{r=u-AB;u-=AB}AD=this.calcColor(AE,AI,v);if(p){AD=this.calcHighlightColor(AD,n)}t.push(AH.drawRect(s,r,this.barWidth-1,AB-1,AD,AD))}if(t.length===1){return t[0]}return t}});I.fn.sparkline.tristate=E=g(I.fn.sparkline._base,G,{type:"tristate",init:function(q,m,n,p,l){var o=parseInt(n.get("barWidth"),10),r=parseInt(n.get("barSpacing"),10);E._super.init.call(this,q,m,n,p,l);this.regionShapes={};this.barWidth=o;this.barSpacing=r;this.totalBarWidth=o+r;this.values=I.map(m,Number);this.width=p=(m.length*o)+((m.length-1)*r);if(I.isArray(n.get("colorMap"))){this.colorMapByIndex=n.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=n.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===undefined){this.colorMapByValue=new R(this.colorMapByValue)}}this.initTarget()},getRegion:function(m,l,n){return Math.floor(l/this.totalBarWidth)},getCurrentRegionFields:function(){var l=this.currentRegion;return{isNull:this.values[l]===undefined,value:this.values[l],color:this.calcColor(this.values[l],l),offset:l}},calcColor:function(q,r){var m=this.values,p=this.options,s=this.colorMapByIndex,o=this.colorMapByValue,l,n;if(o&&(n=o.get(q))){l=n}else{if(s&&s.length>r){l=s[r]}else{if(m[r]<0){l=p.get("negBarColor")}else{if(m[r]>0){l=p.get("posBarColor")}else{l=p.get("zeroBarColor")}}}}return l},renderRegion:function(o,l){var t=this.values,v=this.options,p=this.target,n,u,q,s,r,m;n=p.pixelHeight;q=Math.round(n/2);s=o*this.totalBarWidth;if(t[o]<0){r=q;u=q-1}else{if(t[o]>0){r=0;u=q-1}else{r=q-1;u=2}}m=this.calcColor(t[o],o);if(m===null){return }if(l){m=this.calcHighlightColor(m,v)}return p.drawRect(s,r,this.barWidth-1,u-1,m,m)}});I.fn.sparkline.discrete=A=g(I.fn.sparkline._base,G,{type:"discrete",init:function(p,m,n,o,l){A._super.init.call(this,p,m,n,o,l);this.regionShapes={};this.values=m=I.map(m,Number);this.min=Math.min.apply(Math,m);this.max=Math.max.apply(Math,m);this.range=this.max-this.min;this.width=o=n.get("width")==="auto"?m.length*2:this.width;this.interval=Math.floor(o/m.length);this.itemWidth=o/m.length;if(n.get("chartRangeMin")!==undefined&&(n.get("chartRangeClip")||n.get("chartRangeMin")<this.min)){this.min=n.get("chartRangeMin")}if(n.get("chartRangeMax")!==undefined&&(n.get("chartRangeClip")||n.get("chartRangeMax")>this.max)){this.max=n.get("chartRangeMax")}this.initTarget();if(this.target){this.lineHeight=n.get("lineHeight")==="auto"?Math.round(this.canvasHeight*0.3):n.get("lineHeight")}},getRegion:function(m,l,n){return Math.floor(l/this.itemWidth)},getCurrentRegionFields:function(){var l=this.currentRegion;return{isNull:this.values[l]===undefined,value:this.values[l],offset:l}},renderRegion:function(t,o){var AA=this.values,AB=this.options,q=this.min,w=this.max,s=this.range,m=this.interval,v=this.target,r=this.canvasHeight,z=this.lineHeight,u=r-z,l,n,p,y;n=d(AA[t],q,w);y=t*m;l=Math.round(u-u*((n-q)/s));p=(AB.get("thresholdColor")&&n<AB.get("thresholdValue"))?AB.get("thresholdColor"):AB.get("lineColor");if(o){p=this.calcHighlightColor(p,AB)}return v.drawLine(y,l,y,l+z,p)}});I.fn.sparkline.bullet=e=g(I.fn.sparkline._base,{type:"bullet",init:function(r,n,o,q,m){var p,l,s;e._super.init.call(this,r,n,o,q,m);this.values=n=h(n);s=n.slice();s[0]=s[0]===null?s[2]:s[0];s[1]=n[1]===null?s[2]:s[1];p=Math.min.apply(Math,n);l=Math.max.apply(Math,n);if(o.get("base")===undefined){p=p<0?p:0}else{p=o.get("base")}this.min=p;this.max=l;this.range=l-p;this.shapes={};this.valueShapes={};this.regiondata={};this.width=q=o.get("width")==="auto"?"4.0em":q;this.target=this.$el.simpledraw(q,m,o.get("composite"));if(!n.length){this.disabled=true}this.initTarget()},getRegion:function(m,l,o){var n=this.target.getShapeAt(m,l,o);return(n!==undefined&&this.shapes[n]!==undefined)?this.shapes[n]:undefined},getCurrentRegionFields:function(){var l=this.currentRegion;return{fieldkey:l.substr(0,1),value:this.values[l.substr(1)],region:l}},changeHighlight:function(m){var o=this.currentRegion,n=this.valueShapes[o],l;delete this.shapes[n];switch(o.substr(0,1)){case"r":l=this.renderRange(o.substr(1),m);break;case"p":l=this.renderPerformance(m);break;case"t":l=this.renderTarget(m);break}this.valueShapes[o]=l.id;this.shapes[l.id]=o;this.target.replaceWithShape(n,l)},renderRange:function(o,m){var p=this.values[o],n=Math.round(this.canvasWidth*((p-this.min)/this.range)),l=this.options.get("rangeColors")[o-2];if(m){l=this.calcHighlightColor(l,this.options)}return this.target.drawRect(0,0,n-1,this.canvasHeight-1,l,l)},renderPerformance:function(m){var o=this.values[1],n=Math.round(this.canvasWidth*((o-this.min)/this.range)),l=this.options.get("performanceColor");if(m){l=this.calcHighlightColor(l,this.options)}return this.target.drawRect(0,Math.round(this.canvasHeight*0.3),n-1,Math.round(this.canvasHeight*0.4)-1,l,l)},renderTarget:function(n){var q=this.values[0],l=Math.round(this.canvasWidth*((q-this.min)/this.range)-(this.options.get("targetWidth")/2)),p=Math.round(this.canvasHeight*0.1),o=this.canvasHeight-(p*2),m=this.options.get("targetColor");if(n){m=this.calcHighlightColor(m,this.options)}return this.target.drawRect(l,p,this.options.get("targetWidth")-1,o-1,m,m)},render:function(){var o=this.values.length,n=this.target,m,l;if(!e._super.render.call(this)){return }for(m=2;m<o;m++){l=this.renderRange(m).append();this.shapes[l.id]="r"+m;this.valueShapes["r"+m]=l.id}if(this.values[1]!==null){l=this.renderPerformance().append();this.shapes[l.id]="p1";this.valueShapes.p1=l.id}if(this.values[0]!==null){l=this.renderTarget().append();this.shapes[l.id]="t0";this.valueShapes.t0=l.id}n.render()}});I.fn.sparkline.pie=U=g(I.fn.sparkline._base,{type:"pie",init:function(q,m,n,p,l){var r=0,o;U._super.init.call(this,q,m,n,p,l);this.shapes={};this.valueShapes={};this.values=m=I.map(m,Number);if(n.get("width")==="auto"){this.width=this.height}if(m.length>0){for(o=m.length;o--;){r+=m[o]}}this.total=r;this.initTarget();this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(m,l,o){var n=this.target.getShapeAt(m,l,o);return(n!==undefined&&this.shapes[n]!==undefined)?this.shapes[n]:undefined},getCurrentRegionFields:function(){var l=this.currentRegion;return{isNull:this.values[l]===undefined,value:this.values[l],percent:this.values[l]/this.total*100,color:this.options.get("sliceColors")[l%this.options.get("sliceColors").length],offset:l}},changeHighlight:function(l){var o=this.currentRegion,m=this.renderSlice(o,l),n=this.valueShapes[o];delete this.shapes[n];this.target.replaceWithShape(n,m);this.valueShapes[o]=m.id;this.shapes[m.id]=o},renderSlice:function(u,o){var w=this.target,AA=this.options,v=this.radius,l=AA.get("borderWidth"),r=AA.get("offset"),m=2*Math.PI,z=this.values,x=this.total,t=r?(2*Math.PI)*(r/360):0,n,q,s,y,p;y=z.length;for(s=0;s<y;s++){n=t;q=t;if(x>0){q=t+(m*(z[s]/x))}if(u===s){p=AA.get("sliceColors")[s%AA.get("sliceColors").length];if(o){p=this.calcHighlightColor(p,AA)}return w.drawPieSlice(v,v,v-l,n,q,undefined,p)}t=q}},render:function(){var r=this.target,o=this.values,p=this.options,l=this.radius,n=p.get("borderWidth"),m,q;if(!U._super.render.call(this)){return }if(n){r.drawCircle(l,l,Math.floor(l-(n/2)),p.get("borderColor"),undefined,n).append()}for(q=o.length;q--;){if(o[q]){m=this.renderSlice(q).append();this.valueShapes[q]=m.id;this.shapes[m.id]=q}}r.render()}});I.fn.sparkline.box=O=g(I.fn.sparkline._base,{type:"box",init:function(p,m,n,o,l){O._super.init.call(this,p,m,n,o,l);this.values=I.map(m,Number);this.width=n.get("width")==="auto"?"4.0em":o;this.initTarget();if(!this.values.length){this.disabled=1}},getRegion:function(){return 1},getCurrentRegionFields:function(){var l=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];if(this.loutlier!==undefined){l.push({field:"lo",value:this.loutlier})}if(this.routlier!==undefined){l.push({field:"ro",value:this.routlier})}if(this.lwhisker!==undefined){l.push({field:"lw",value:this.lwhisker})}if(this.rwhisker!==undefined){l.push({field:"rw",value:this.rwhisker})}return l},render:function(){var AE=this.target,o=this.values,s=o.length,q=this.options,AD=this.canvasWidth,m=this.canvasHeight,x=q.get("chartRangeMin")===undefined?Math.min.apply(Math,o):q.get("chartRangeMin"),AC=q.get("chartRangeMax")===undefined?Math.max.apply(Math,o):q.get("chartRangeMax"),z=0,w,AB,p,v,u,t,l,r,AA,y,n;if(!O._super.render.call(this)){return }if(q.get("raw")){if(q.get("showOutliers")&&o.length>5){AB=o[0];w=o[1];v=o[2];u=o[3];t=o[4];l=o[5];r=o[6]}else{w=o[0];v=o[1];u=o[2];t=o[3];l=o[4]}}else{o.sort(function(AG,AF){return AG-AF});v=T(o,1);u=T(o,2);t=T(o,3);p=t-v;if(q.get("showOutliers")){w=l=undefined;for(AA=0;AA<s;AA++){if(w===undefined&&o[AA]>v-(p*q.get("outlierIQR"))){w=o[AA]}if(o[AA]<t+(p*q.get("outlierIQR"))){l=o[AA]}}AB=o[0];r=o[s-1]}else{w=o[0];l=o[s-1]}}this.quartiles=[v,u,t];this.lwhisker=w;this.rwhisker=l;this.loutlier=AB;this.routlier=r;n=AD/(AC-x+1);if(q.get("showOutliers")){z=Math.ceil(q.get("spotRadius"));AD-=2*Math.ceil(q.get("spotRadius"));n=AD/(AC-x+1);if(AB<w){AE.drawCircle((AB-x)*n+z,m/2,q.get("spotRadius"),q.get("outlierLineColor"),q.get("outlierFillColor")).append()}if(r>l){AE.drawCircle((r-x)*n+z,m/2,q.get("spotRadius"),q.get("outlierLineColor"),q.get("outlierFillColor")).append()}}AE.drawRect(Math.round((v-x)*n+z),Math.round(m*0.1),Math.round((t-v)*n),Math.round(m*0.8),q.get("boxLineColor"),q.get("boxFillColor")).append();AE.drawLine(Math.round((w-x)*n+z),Math.round(m/2),Math.round((v-x)*n+z),Math.round(m/2),q.get("lineColor")).append();AE.drawLine(Math.round((w-x)*n+z),Math.round(m/4),Math.round((w-x)*n+z),Math.round(m-m/4),q.get("whiskerColor")).append();AE.drawLine(Math.round((l-x)*n+z),Math.round(m/2),Math.round((t-x)*n+z),Math.round(m/2),q.get("lineColor")).append();AE.drawLine(Math.round((l-x)*n+z),Math.round(m/4),Math.round((l-x)*n+z),Math.round(m-m/4),q.get("whiskerColor")).append();AE.drawLine(Math.round((u-x)*n+z),Math.round(m*0.1),Math.round((u-x)*n+z),Math.round(m*0.9),q.get("medianColor")).append();if(q.get("target")){y=Math.ceil(q.get("spotRadius"));AE.drawLine(Math.round((q.get("target")-x)*n+z),Math.round((m/2)-y),Math.round((q.get("target")-x)*n+z),Math.round((m/2)+y),q.get("targetColor")).append();AE.drawLine(Math.round((q.get("target")-x)*n+z-y),Math.round(m/2),Math.round((q.get("target")-x)*n+z+y),Math.round(m/2),q.get("targetColor")).append()}AE.render()}});if(I.browser.msie&&document.namespaces&&!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")}if(I.browser.hasCanvas===undefined){I.browser.hasCanvas=document.createElement("canvas").getContext!==undefined}X=g({init:function(n,o,m,l){this.target=n;this.id=o;this.type=m;this.args=l},append:function(){this.target.appendShape(this);return this}});J=g({_pxregex:/(\d+)(px)?\s*$/i,init:function(m,l,n){if(!m){return }this.width=m;this.height=l;this.target=n;this.lastShapeId=null;if(n[0]){n=n[0]}I.data(n,"_jqs_vcanvas",this)},drawLine:function(n,p,m,o,q,l){return this.drawShape([[n,p],[m,o]],q,l)},drawShape:function(n,m,o,l){return this._genShape("Shape",[n,m,o,l])},drawCircle:function(n,q,m,o,p,l){return this._genShape("Circle",[n,q,m,o,p,l])},drawPieSlice:function(m,r,l,o,n,p,q){return this._genShape("PieSlice",[m,r,l,o,n,p,q])},drawRect:function(m,q,n,l,o,p){return this._genShape("Rect",[m,q,n,l,o,p])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(l,m){I(m).html(l)},_calculatePixelDims:function(o,l,n){var m;m=this._pxregex.exec(l);if(m){this.pixelHeight=m[1]}else{this.pixelHeight=I(n).height()}m=this._pxregex.exec(o);if(m){this.pixelWidth=m[1]}else{this.pixelWidth=I(n).width()}},_genShape:function(m,l){var n=F++;l.unshift(n);return new X(this,n,m,l)},appendShape:function(l){alert("appendShape not implemented")},replaceWithShape:function(m,l){alert("replaceWithShape not implemented")},insertAfterShape:function(m,l){alert("insertAfterShape not implemented")},removeShapeId:function(l){alert("removeShapeId not implemented")},getShapeAt:function(m,l,n){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});Z=g(J,{init:function(n,l,o,m){Z._super.init.call(this,n,l,o);this.canvas=document.createElement("canvas");if(o[0]){o=o[0]}I.data(o,"_jqs_vcanvas",this);I(this.canvas).css({display:"inline-block",width:n,height:l,verticalAlign:"top"});this._insert(this.canvas,o);this._calculatePixelDims(n,l,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=m;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=undefined;I(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(n,o,l){var m=this.canvas.getContext("2d");if(n!==undefined){m.strokeStyle=n}m.lineWidth=l===undefined?1:l;if(o!==undefined){m.fillStyle=o}return m},reset:function(){var l=this._getContext();l.clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=undefined},_drawShape:function(r,q,p,s,l){var n=this._getContext(p,s,l),m,o;n.beginPath();n.moveTo(q[0][0]+0.5,q[0][1]+0.5);for(m=1,o=q.length;m<o;m++){n.lineTo(q[m][0]+0.5,q[m][1]+0.5)}if(p!==undefined){n.stroke()}if(s!==undefined){n.fill()}if(this.targetX!==undefined&&this.targetY!==undefined&&n.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=r}},_drawCircle:function(q,n,s,m,p,r,l){var o=this._getContext(p,r,l);o.beginPath();o.arc(n,s,m,0,2*Math.PI,false);if(this.targetX!==undefined&&this.targetY!==undefined&&o.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=q}if(p!==undefined){o.stroke()}if(r!==undefined){o.fill()}},_drawPieSlice:function(p,t,r,o,q,n,s,m){var l=this._getContext(s,m);l.beginPath();l.moveTo(t,r);l.arc(t,r,o,q,n,false);l.lineTo(t,r);l.closePath();if(s!==undefined){l.stroke()}if(m){l.fill()}if(this.targetX!==undefined&&this.targetY!==undefined&&l.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=p}},_drawRect:function(p,m,r,n,l,o,q){return this._drawShape(p,[[m,r],[m+n,r],[m+n,r+l],[m,r+l],[m,r]],o,q)},appendShape:function(l){this.shapes[l.id]=l;this.shapeseq.push(l.id);this.lastShapeId=l.id;return l.id},replaceWithShape:function(n,l){var o=this.shapeseq,m;this.shapes[l.id]=l;for(m=o.length;m--;){if(o[m]==n){o[m]=l.id}}delete this.shapes[n]},replaceWithShapes:function(n,m){var r=this.shapeseq,p={},l,o,q;for(o=n.length;o--;){p[n[o]]=true}for(o=r.length;o--;){l=r[o];if(p[l]){r.splice(o,1);delete this.shapes[l];q=o}}for(o=m.length;o--;){r.splice(q,0,m[o].id);this.shapes[m[o].id]=m[o]}},insertAfterShape:function(n,l){var o=this.shapeseq,m;for(m=o.length;m--;){if(o[m]===n){o.splice(m+1,0,l.id);this.shapes[l.id]=l;return }}},removeShapeId:function(m){var n=this.shapeseq,l;for(l=n.length;l--;){if(n[l]===m){n.splice(l,1);break}}delete this.shapes[m]},getShapeAt:function(m,l,n){this.targetX=l;this.targetY=n;this.render();return this.currentTargetShapeId},render:function(){var r=this.shapeseq,l=this.shapes,p=r.length,o=this._getContext(),q,m,n;o.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(n=0;n<p;n++){q=r[n];m=l[q];this["_draw"+m.type].apply(this,m.args)}if(!this.interact){this.shapes={};this.shapeseq=[]}}});W=g(J,{init:function(m,l,o){var n;W._super.init.call(this,m,l,o);if(o[0]){o=o[0]}I.data(o,"_jqs_vcanvas",this);this.canvas=document.createElement("span");I(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:m,height:l,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,o);this._calculatePixelDims(m,l,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;n='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>';this.canvas.insertAdjacentHTML("beforeEnd",n);this.group=I(this.canvas).children()[0];this.rendered=false;this.prerender=""},_drawShape:function(q,x,s,l,o){var t=[],r,w,v,p,u,m,n;for(n=0,m=x.length;n<m;n++){t[n]=""+(x[n][0])+","+(x[n][1])}r=t.splice(0,1);o=o===undefined?1:o;w=s===undefined?' stroked="false" ':' strokeWeight="'+o+'px" strokeColor="'+s+'" ';v=l===undefined?' filled="false"':' fillColor="'+l+'" filled="true" ';p=t[0]===t[t.length-1]?"x ":"";u='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+q+'" '+w+v+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+r+" l "+t.join(", ")+" "+p+'e"> </v:shape>';return u},_drawCircle:function(o,r,p,n,q,l,m){var u,t,s;r-=n;p-=n;u=q===undefined?' stroked="false" ':' strokeWeight="'+m+'px" strokeColor="'+q+'" ';t=l===undefined?' filled="false"':' fillColor="'+l+'" filled="true" ';s='<v:oval  id="jqsshape'+o+'" '+u+t+' style="position:absolute;top:'+p+"px; left:"+r+"px; width:"+(n*2)+"px; height:"+(n*2)+'px"></v:oval>';return s},_drawPieSlice:function(s,z,v,r,t,o,w,n){var u,m,l,q,p,AC,AB,AA;if(t===o){return }if((o-t)===(2*Math.PI)){t=0;o=(2*Math.PI)}m=z+Math.round(Math.cos(t)*r);l=v+Math.round(Math.sin(t)*r);q=z+Math.round(Math.cos(o)*r);p=v+Math.round(Math.sin(o)*r);if(m===q&&l===p&&(o-t)<Math.PI){return }u=[z-r,v-r,z+r,v+r,m,l,q,p];AC=w===undefined?' stroked="false" ':' strokeWeight="1px" strokeColor="'+w+'" ';AB=n===undefined?' filled="false"':' fillColor="'+n+'" filled="true" ';AA='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+s+'" '+AC+AB+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+z+","+v+" wa "+u.join(", ")+' x e"> </v:shape>';return AA},_drawRect:function(p,m,r,n,l,o,q){return this._drawShape(p,[[m,r],[m,r+l],[m+n,r+l],[m+n,r],[m,r]],o,q)},reset:function(){this.group.innerHTML=""},appendShape:function(l){var m=this["_draw"+l.type].apply(this,l.args);if(this.rendered){this.group.insertAdjacentHTML("beforeEnd",m)}else{this.prerender+=m}this.lastShapeId=l.id;return l.id},replaceWithShape:function(o,l){var n=I("#jqsshape"+o),m=this["_draw"+l.type].apply(this,l.args);n[0].outerHTML=m},replaceWithShapes:function(m,l){var p=I("#jqsshape"+m[0]),o="",q=l.length,n;for(n=0;n<q;n++){o+=this["_draw"+l[n].type].apply(this,l[n].args)}p[0].outerHTML=o;for(n=1;n<m.length;n++){I("#jqsshape"+m[n]).remove()}},insertAfterShape:function(o,l){var n=I("#jqsshape"+o),m=this["_draw"+l.type].apply(this,l.args);n[0].insertAdjacentHTML("afterEnd",m)},removeShapeId:function(m){var l=I("#jqsshape"+m);this.group.removeChild(l[0])},getShapeAt:function(m,l,o){var n=m.id.substr(8);return n},render:function(){if(!this.rendered){this.group.innerHTML=this.prerender;this.rendered=true}}})}));(function(E,C){E.ui=E.ui||{};var J,K=Math.max,P=Math.abs,N=Math.round,D=/left|center|right/,H=/top|center|bottom/,A=/[\+\-]\d+%?/,M=/^\w+/,B=/%$/,G=E.fn.position;function O(S,R,Q){return[parseInt(S[0],10)*(B.test(S[0])?R/100:1),parseInt(S[1],10)*(B.test(S[1])?Q/100:1)]}function I(Q,R){return parseInt(E.css(Q,R),10)||0}function F(R){var Q=R[0];if(Q.nodeType===9){return{width:R.width(),height:R.height(),offset:{top:0,left:0}}}if(E.isWindow(Q)){return{width:R.width(),height:R.height(),offset:{top:R.scrollTop(),left:R.scrollLeft()}}}if(Q.preventDefault){return{width:0,height:0,offset:{top:Q.pageY,left:Q.pageX}}}return{width:R.outerWidth(),height:R.outerHeight(),offset:R.offset()}}E.position={scrollbarWidth:function(){if(J!==C){return J}var R,Q,T=E("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),S=T.children()[0];E("body").append(T);R=S.offsetWidth;T.css("overflow","scroll");Q=S.offsetWidth;if(R===Q){Q=T[0].clientWidth}T.remove();return(J=R-Q)},getScrollInfo:function(U){var T=U.isWindow?"":U.element.css("overflow-x"),S=U.isWindow?"":U.element.css("overflow-y"),R=T==="scroll"||(T==="auto"&&U.width<U.element[0].scrollWidth),Q=S==="scroll"||(S==="auto"&&U.height<U.element[0].scrollHeight);return{width:R?E.position.scrollbarWidth():0,height:Q?E.position.scrollbarWidth():0}},getWithinInfo:function(R){var S=E(R||window),Q=E.isWindow(S[0]);return{element:S,isWindow:Q,offset:S.offset()||{left:0,top:0},scrollLeft:S.scrollLeft(),scrollTop:S.scrollTop(),width:Q?S.width():S.outerWidth(),height:Q?S.height():S.outerHeight()}}};E.fn.position=function(b){if(!b||!b.of){return G.apply(this,arguments)}b=E.extend({},b);var c,X,V,Z,U,Q,W=E(b.of),T=E.position.getWithinInfo(b.within),R=E.position.getScrollInfo(T),Y=(b.collision||"flip").split(" "),S={};Q=F(W);if(W[0].preventDefault){b.at="left top"}X=Q.width;V=Q.height;Z=Q.offset;U=E.extend({},Z);E.each(["my","at"],function(){var f=(b[this]||"").split(" "),e,d;if(f.length===1){f=D.test(f[0])?f.concat(["center"]):H.test(f[0])?["center"].concat(f):["center","center"]}f[0]=D.test(f[0])?f[0]:"center";f[1]=H.test(f[1])?f[1]:"center";e=A.exec(f[0]);d=A.exec(f[1]);S[this]=[e?e[0]:0,d?d[0]:0];b[this]=[M.exec(f[0])[0],M.exec(f[1])[0]]});if(Y.length===1){Y[1]=Y[0]}if(b.at[0]==="right"){U.left+=X}else{if(b.at[0]==="center"){U.left+=X/2}}if(b.at[1]==="bottom"){U.top+=V}else{if(b.at[1]==="center"){U.top+=V/2}}c=O(S.at,X,V);U.left+=c[0];U.top+=c[1];return this.each(function(){var e,n,g=E(this),i=g.outerWidth(),f=g.outerHeight(),h=I(this,"marginLeft"),d=I(this,"marginTop"),m=i+h+I(this,"marginRight")+R.width,l=f+d+I(this,"marginBottom")+R.height,j=E.extend({},U),k=O(S.my,g.outerWidth(),g.outerHeight());if(b.my[0]==="right"){j.left-=i}else{if(b.my[0]==="center"){j.left-=i/2}}if(b.my[1]==="bottom"){j.top-=f}else{if(b.my[1]==="center"){j.top-=f/2}}j.left+=k[0];j.top+=k[1];if(!E.support.offsetFractions){j.left=N(j.left);j.top=N(j.top)}e={marginLeft:h,marginTop:d};E.each(["left","top"],function(p,o){if(E.ui.position[Y[p]]){E.ui.position[Y[p]][o](j,{targetWidth:X,targetHeight:V,elemWidth:i,elemHeight:f,collisionPosition:e,collisionWidth:m,collisionHeight:l,offset:[c[0]+k[0],c[1]+k[1]],my:b.my,at:b.at,within:T,elem:g})}});if(b.using){n=function(r){var t=Z.left-j.left,q=t+X-i,s=Z.top-j.top,p=s+V-f,o={target:{element:W,left:Z.left,top:Z.top,width:X,height:V},element:{element:g,left:j.left,top:j.top,width:i,height:f},horizontal:q<0?"left":t>0?"right":"center",vertical:p<0?"top":s>0?"bottom":"middle"};if(X<i&&P(t+q)<X){o.horizontal="center"}if(V<f&&P(s+p)<V){o.vertical="middle"}if(K(P(t),P(q))>K(P(s),P(p))){o.important="horizontal"}else{o.important="vertical"}b.using.call(this,r,o)}}g.offset(E.extend(j,{using:n}))})};E.ui.position={fit:{left:function(U,T){var S=T.within,W=S.isWindow?S.scrollLeft:S.offset.left,Y=S.width,V=U.left-T.collisionPosition.marginLeft,X=W-V,R=V+T.collisionWidth-Y-W,Q;if(T.collisionWidth>Y){if(X>0&&R<=0){Q=U.left+X+T.collisionWidth-Y-W;U.left+=X-Q}else{if(R>0&&X<=0){U.left=W}else{if(X>R){U.left=W+Y-T.collisionWidth}else{U.left=W}}}}else{if(X>0){U.left+=X}else{if(R>0){U.left-=R}else{U.left=K(U.left-V,U.left)}}}},top:function(T,S){var R=S.within,X=R.isWindow?R.scrollTop:R.offset.top,Y=S.within.height,V=T.top-S.collisionPosition.marginTop,W=X-V,U=V+S.collisionHeight-Y-X,Q;if(S.collisionHeight>Y){if(W>0&&U<=0){Q=T.top+W+S.collisionHeight-Y-X;T.top+=W-Q}else{if(U>0&&W<=0){T.top=X}else{if(W>U){T.top=X+Y-S.collisionHeight}else{T.top=X}}}}else{if(W>0){T.top+=W}else{if(U>0){T.top-=U}else{T.top=K(T.top-V,T.top)}}}}},flip:{left:function(W,V){var U=V.within,b=U.offset.left+U.scrollLeft,e=U.width,S=U.isWindow?U.scrollLeft:U.offset.left,X=W.left-V.collisionPosition.marginLeft,c=X-S,R=X+V.collisionWidth-e-S,Z=V.my[0]==="left"?-V.elemWidth:V.my[0]==="right"?V.elemWidth:0,d=V.at[0]==="left"?V.targetWidth:V.at[0]==="right"?-V.targetWidth:0,T=-2*V.offset[0],Q,Y;if(c<0){Q=W.left+Z+d+T+V.collisionWidth-e-b;if(Q<0||Q<P(c)){W.left+=Z+d+T}}else{if(R>0){Y=W.left-V.collisionPosition.marginLeft+Z+d+T-S;if(Y>0||P(Y)<R){W.left+=Z+d+T}}}},top:function(V,U){var T=U.within,d=T.offset.top+T.scrollTop,e=T.height,Q=T.isWindow?T.scrollTop:T.offset.top,X=V.top-U.collisionPosition.marginTop,Z=X-Q,W=X+U.collisionHeight-e-Q,b=U.my[1]==="top",Y=b?-U.elemHeight:U.my[1]==="bottom"?U.elemHeight:0,f=U.at[1]==="top"?U.targetHeight:U.at[1]==="bottom"?-U.targetHeight:0,S=-2*U.offset[1],c,R;if(Z<0){R=V.top+Y+f+S+U.collisionHeight-e-d;if((V.top+Y+f+S)>Z&&(R<0||R<P(Z))){V.top+=Y+f+S}}else{if(W>0){c=V.top-U.collisionPosition.marginTop+Y+f+S-Q;if((V.top+Y+f+S)>W&&(c>0||P(c)<W)){V.top+=Y+f+S}}}}},flipfit:{left:function(){E.ui.position.flip.left.apply(this,arguments);E.ui.position.fit.left.apply(this,arguments)},top:function(){E.ui.position.flip.top.apply(this,arguments);E.ui.position.fit.top.apply(this,arguments)}}};(function(){var U,W,R,T,S,Q=document.getElementsByTagName("body")[0],V=document.createElement("div");U=document.createElement(Q?"div":"body");R={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(Q){E.extend(R,{position:"absolute",left:"-1000px",top:"-1000px"})}for(S in R){U.style[S]=R[S]}U.appendChild(V);W=Q||document.documentElement;W.insertBefore(U,W.firstChild);V.style.cssText="position: absolute; left: 10.7432222px;";T=E(V).offset().left;E.support.offsetFractions=T>10&&T<11;U.innerHTML="";W.removeChild(U)})()}(jQuery));function loadAlertsBuckets(){$(".alertsList").each(function(G){var A=$(this).parents(".bucket-process").attr("id");var D=A+"_alertsList_"+G;$(this).attr("id",D);var F=$(this).attr("scorecard");var E=$(this).attr("granularity");var B={controlType:"alertsList",scorecard:F,granularity:E};var C=getMetricsRecordsForScorecardAndGranularity(B);C=sortAlertsRecords(C);drawAlertsList(D,C,G)})}function getMetricsRecordsForScorecardAndGranularity(B){try{var A=Ab.workflow.Workflow.callMethod("AbCommonResources-MetricsService-getTrendValuesForScorecard",B.scorecard,B.granularity);if(Ab.workflow.Workflow.sessionTimeoutDetected){A=false}else{if(A.data){A=A.data}else{A=false}}}catch(C){Workflow.handleError(C);A=false}return A}function sortAlertsRecords(G){var F=[];var E=[];var J=[];for(var H=0,D;D=G[H];H++){if(!D.stoplightColor){continue}var I=D.stoplightColor;if(I.toLowerCase()==="red"){F.push(G[H])}else{if(I==="yellow"){E.push(G[H])}else{J.push(G[H])}}}for(var C=0,A;A=E[C];C++){F.push(A)}for(var B=0,K;K=J[B];B++){F.push(K)}return F}function drawAlertsList(O,I,D){var P=$("#"+O);P.empty();var F=1;var J=O+"_page";var N=O.substring(O.indexOf("_")+1);N=N.substring(N.indexOf("_")+1);var K=formAlertsItemsString(J,N,F,I);P.append(K);var C=getBucketContentHeight(O);var E=P.height();var A=0;if(E>C){for(var H=I.length-1;E>C;H--){var G="#"+N+F+"_row_"+H;$(G).remove();A++;E=P.height()}var M="#"+J+F;var B=getPageRowHeight(M);$(M).wrap('<div class="scrollable-wrapper scrollable-wrapper-'+B+'"></div>');$(M).wrap('<div class="scrollable-root scrollable-'+B+'" id="'+N+'_scroller"></div>');$(M).wrap('<div class="items"></div>');appendAdditionalAlertsPages(C,J,N,F,I,A);P.append('<div class="navi" id="alertsNavi_'+D+'"></div>');$("#"+N+"_scroller").scrollable({vertical:false,mousewheel:true}).navigator("#alertsNavi_"+D)}}function formAlertsItemsString(G,O,B,D){var I='<ol id="'+G+B+'" class="alert-items">';var E=I.length;var C=D.length;var F;for(var M=0;M<C;M++){F=D[M];if(!F.metricTitle){continue}var H=F.metricTitle;var J=F.metricValue;var N=F.stoplightColor.toLowerCase();var K="alert-low";if(N==="red"){K="alert-high"}else{if(N==="yellow"){K="alert-medium"}}var A=F.drillDownView;A=valueExists(A)?' rel="'+A+'" onMouseUp="openAlertDrilldown(this, event);"':"";I+='<li id="'+O+B+"_row_"+M+'" class="'+K+'"'+A+">";if(A.length>0){I+="<a>"}I+='<span class="alert-description">['+J+"] "+H+"</span>";if(A.length>0){I+="</a>"}I+="</li>"}if(E===I.length){I+="<li >"+getLocalizedString(pageNavStrings.z_PAGENAV_BUCKET_NODATA)+" </li>"}I+="</ol>";return I}function openAlertDrilldown(F,E){var H="-popup.axvw";if(signOutOnTimeOut()){return false}E=E||window.event;if(E){F=E.target||E.srcElement}if(E.button===2||E.which===3){return false}var B=$(F).attr("rel");if(!B){B=$(F).parents("li").attr("rel")}if(B){var G=PageNavUserInfo.webAppContextPath+B;if(B.indexOf(H)===B.length-H.length){var D='<div id="alert-drilldown" style="padding:0;"><iframe id="alert-drilldown-frame" src="'+G+'" width="99%" height="99%"></iframe></div>';var A=$(window);var C=$(D).dialog({autoOpen:false,height:A.height()-12,width:A.width()-14,modal:true,open:function(){$(".ui-dialog-titlebar-close").show();var J=$("#alert-drilldown-frame")[0];var I=$(J).contents().find("#viewToolbar_title").text();$(this).dialog("option","title",I)},close:function(){$("#alert-drilldown").remove()}});C.dialog("open")}else{window.open(G)}}}function pageTallProcessBuckets(){$(".bucket-process > .bucket-wrapper").each(function(G){var K=getUnpagedBucketHeight(this,"process");var J=K-25;var A=$(this).height();var H=$(this).children("ol.ptask-labels");if(A>K&&H.length>0){var E=$(H).children("li");var I=$(H).children("ol.process-tasks");var M=I.length>1;var N=mustTaskGroupsBeDivided(this,J,E,I);var B=removePTaskElementsToCorrectHeight(J,E,I,M,N,this);var F=H.get(0);var D=getPageRowHeight(F);var C=$(this).attr("id");$(F).wrap('<div class="scrollable-wrapper scrollable-wrapper-'+D+'"></div>');$(F).wrap('<div class="scrollable-root scrollable-'+D+'" id="'+C+G+'_scroller"></div>');$(F).wrap('<div class="items"></div>');appendAdditionalTaskPages(J,F,C,G,1,M,N,B);$("#"+C).append('<div class="navi" id="pTaskNavi_'+G+'"></div>');$("#"+C+G+"_scroller").scrollable({vertical:false,mousewheel:true}).navigator("#pTaskNavi_"+G)}})}function getUnpagedBucketHeight(G,A){var B=$(G).parent(".bucket-"+A);var I=$(B).height();var E=$(G).css("padding-top");E=parseInt(E);var J=$(G).css("padding-bottom");J=parseInt(J);var D=$(G).siblings("."+A+"-title").get(0);if(!D){D=$(G).siblings("."+A+"s-process-title").get(0)}var F=$(D).height();var C=$(D).css("padding-top");C=parseInt(C);var H=$(D).css("padding-bottom");H=parseInt(H);return I-F-E-J-C-H}function mustTaskGroupsBeDivided(H,G,A,C){var I=false;if(C.length>1){var F=$(H).css("padding-top");var E=getTaskGroupHeights(parseInt(F),A,C);var B=E.length;for(var D=0;D<B;D++){if(E[D]>G){I=true;break}}}return I}function getTaskGroupHeights(B,E,A){var F=[];var C=E.length;for(var D=0;D<C;D++){$("body").append('<div id="test_paging_scroller" class="page bucket-process" style="position:absolute;visibility:hidden"><div class="scrollable-full-height"><ol id="test_paging_insert_root" class="ptask-labels"></ol></div></div>');var G=$("#test_paging_insert_root");G.append($($(E).get(D)).clone(false));G.append($($(A).get(D)).clone(false));F.push(B+G.height());$("#test_paging_scroller").remove()}return F}function removePTaskElementsToCorrectHeight(J,D,G,K,N,B){var A=$(B).height();var C=[];var M;if(K&&N){for(var I=G.length-1;I>=0&&A>J;I--){var O=G.get(I);M=$(O).children("li");for(var H=M.length-1;H>=0&&A>J;H--){A=detachElementAndRemeasure(M,H,C,B)}M=$(O).children("li");if(M.length===0){detachElementAndRemeasure(G,I,C,B);detachElementAndRemeasure(D,I,C,B)}A=$(B).height()}}else{if(K){for(var F=G.length-1;F>=0&&A>J;F--){detachElementAndRemeasure(G,F,C,B);A=detachElementAndRemeasure(D,F,C,B)}if(C.length>0&&C[0].nodeName==="LI"&&C[0].innerHTML==="&nbsp;"){C=C.slice(1)}}else{M=$(G).children("li");for(var E=M.length-1;E>=0&&A>J;E--){A=detachElementAndRemeasure(M,E,C,B)}}}return C}function detachElementAndRemeasure(E,B,D,C){var A=E.get(B);if(A){D.unshift($(A).detach().get(0))}return $(C).height()}function appendAdditionalTaskPages(K,F,C,E,G,M,R,B){var N=C+E+"_"+G+"_insert_root";$(F).after('<ol class="ptask-labels" id="'+N+'"></ol>');var O=$("#"+N);if(M&&R){appendAdditionalTaskPagesBrokenTaskGroups(N,B)}else{if(!M){O.append('<li></li><ol class="process-tasks"></ol>')}var P=M?O:O.find("ol");var Q=B.length;for(var J=0;J<Q;J++){P.append(B[J])}}var A=O.height();if(A>K){var I=O.children("ol.process-tasks");var D=O.children("li");var H=removePTaskElementsToCorrectHeight(K,D,I,M,R,O);appendAdditionalTaskPages(K,O,C,E,G+1,M,R,H)}}function appendAdditionalTaskPagesBrokenTaskGroups(A,D){if($(D[0]).children("a").length>0){$("#"+A).append('<li></li><ol class="process-tasks"></ol>')}var C=D.length;for(var B=0;B<C;B++){if($(D[B]).children("a").length>0){$("#"+A+" > ol:last").append(D[B])}else{$("#"+A).append(D[B])}}}function appendAdditionalAlertsPages(C,I,O,D,H,A){var K=D+1;var N="#"+I+D;var P=[];for(var F=A;F>0;F--){P.push(H[H.length-F])}var J=formAlertsItemsString(I,O,K,P);$(J).insertAfter(N);var M="#"+I+(K);var B=$(M).height();if(B>C){A=0;for(var G=P.length-1;B>C;G--){var E="#"+O+K+"_row_"+G;$(E).remove();A++;B=$(M).height()}appendAdditionalAlertsPages(C,I,O,K,P,A)}}function getBucketContentHeight(B){var C=$("#"+B);var D=C.parents(".bucket-process").height();var A=C.parents(".bucket-process").children(".process-title").height();return D-A-55}function getPageRowHeight(D){var A="half-height";var G=$(D).parents(".page-row").first().attr("class");var F=G.split(" ");var C=F.length;for(var E=0;E<C;E++){var B=$.trim(F[E]);if(B.indexOf("height")===(B.length-6)){A=B;break}}return A}function pageTallPTaskBuckets(){$("#applicationsProcessView").find(".bucket-application").each(function(G){var M=$(this).find(".bucket-wrapper");var K=getUnpagedBucketHeight(M,"application");var J=K-25;var A=$(M).height();var H=$(M).children("ol.ptask-labels");if(A>K&&H.length>0){var I=$(H).children("ol.process-tasks");var E=$(H).children("li");var N=I.length>1;var O=mustTaskGroupsBeDivided(M,J,E,I);var B=removePTaskElementsToCorrectHeight(J,E,I,N,O,M);var F=H.get(0);var D=getPageRowHeight(F);var C=$(M).attr("id");$(F).wrap('<div class="scrollable-wrapper scrollable-wrapper-'+D+'"></div>');$(F).wrap('<div class="scrollable-root scrollable-'+D+'" id="'+C+G+'_scroller"></div>');$(F).wrap('<div class="items"></div>');appendAdditionalTaskPages(J,F,C,G,1,N,O,B);$("#"+C).append('<div class="navi" id="appTaskNavi_'+C+G+'"></div>');$("#"+C+G+"_scroller").scrollable({circular:false,vertical:false,mousewheel:true}).navigator("#appTaskNavi_"+C+G)}})}function pageTallApplicationBuckets(){$("#applicationsTabView").find(".bucket-application").each(function(F){var N=$(this).height();var I=$(this).find(".product-title").get(0);var M=$(this).find(".bucket-wrapper");var J=$(I).height();var K=N-J-20;var H=N-J-40;var A=$(M).height();var G=$(M).children("ol.app-processes");if(A>K&&G.length>0){var E=G.get(0);var O=$(G).children("li");var D=removeActivityElementsToCorrectHeight(H,O,M);var C=getPageRowHeight(E);var B=$(M).attr("id");$(E).wrap('<div class="scrollable-wrapper scrollable-wrapper-'+C+'"></div>');$(E).wrap('<div class="scrollable-root scrollable-'+C+'" id="'+B+F+'_scroller"></div>');$(E).wrap('<div class="items"></div>');appendAdditionalActivityPages(H,E,B,F,0,D);$("#"+B).append('<div class="navi" id="activityNavi_'+F+'"></div>');$("#"+B+F+"_scroller").scrollable({circular:false,vertical:false,mousewheel:true}).navigator("#activityNavi_"+F)}})}function removeActivityElementsToCorrectHeight(F,G,B){var E=$(B).height();var D=[];for(var C=G.length;C>0&&E>F;C--){var A=G.get(C-1);D.unshift($(A).detach().get(0));E=$(B).height()}return D}function appendAdditionalActivityPages(I,E,B,D,F,C){var K=B+D+"_"+F+"_insert_root";$(E).after('<ol class="app-processes" id="'+K+'"></ol>');var M=$("#"+K);var J=C.length;for(var H=0;H<J;H++){M.append(C[H])}var A=M.height();if(A>I){var N=M.children("li");var G=removeActivityElementsToCorrectHeight(I,N,M);appendAdditionalActivityPages(I,M,B,D,F+1,G)}}function modifyProductTitleDisplay(){var J=$(".bucket-application h2");var A=parseInt(J.css("height"));var I=parseInt(J.css("padding-left"));var K=parseInt($(".application-title-icon").css("left"));var C=5;var B=[[],[],[]];var G=[false,false,false];$("h2.product-title").each(function(Q){var M=$(this).children("span.product-title-text");var O=$(M).text();var P=$(M).width();var N=$(M).height();if((P+I)>=K){$(this).children(".application-title-icon").css("opacity",0.45)}if(N>A){G[Math.floor(Q/C)]=true}B[Math.floor(Q/C)].push(this)});var E=G.length;for(var H=0;H<E;H++){if(G[H]){for(var F=0;F<B[H].length;F++){var D=B[H][F];$(D).css("height","65px")}}}}function modifyProcessTitleDisplay(){var I=parseInt($(".bucket-application h2").css("height"));var B=5;var A=[[],[],[],[],[]];var E=[false,false,false,false,false];$("h2.applications-process-title").each(function(K){var J=$(this).children("span.process-title-text");if($(J).height()>I){E[Math.floor(K/B)]=true}A[Math.floor(K/B)].push(this)});var D=E.length;for(var G=0;G<D;G++){if(E[G]){for(var F=0;F<A[G].length;F++){var C=A[G][F];$(C).css("height","65px");var H=$(C).siblings("div.bucket-wrapper");if(H&&H.length>0){$(H).css("padding-top","2px")}}}}}function bindTaskContextMenu(){$.contextMenu({selector:'a.ui-tabs-anchor,a[rel$="Task"],h2.product-title,h2.application-title,h3.application-title,a.application-title,h2.process-title,h2.applications-process-title',build:function(C,F){var E;var B=$(F.currentTarget).attr("rel");var D=F.currentTarget.className;if(B==="eTask"||B==="pTask"){var A=F.currentTarget.innerHTML;if(A.indexOf("<img")>0){A=$.trim(A.substring(0,A.indexOf("<img")))}E=returnTaskMenu(F,A,F.currentTarget.href)}else{if(isFavoritesProcessHeader(F.currentTarget)){showFavoritesDialog(F.currentTarget);E=false}else{if($(F.currentTarget).siblings(".app-specific-bucket").length>0){E=returnAppSpecificMenu()}else{if(D==="process-title"||D==="applications-process-title"){E=returnProcessMenu(F)}else{if(D==="application-title"){E=returnActivityOrProductMenu(F)}else{if(D==="product-title"){E=returnActivityOrProductMenu(F)}}}}}}return E}})}function isFavoritesProcessHeader(C){var A=false;var D=$(C).siblings(".bucket-wrapper");if(D&&D.length>0){var B=$(D).find(".favorites");if(B&&B.length>0){A=true}}return A}function returnTaskMenu(F,B,H){var C=$(F.currentTarget).attr("href");var E=H.substring(0,H.indexOf("schema/"));var G=$(F.currentTarget).parents("div.bucket-application, div.bucket-process");if(G.length>0){var A=getProcessPath(G,F.currentTarget);A=A?A+B:"";var D=$(G).attr("data-subfolder");if(!D){D=""}return{callback:function(J,I){var K=I.commands[J].name;K=K.substr(K.lastIndexOf(">")+1);copyToClipboard(K)},items:{fold1:{name:getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_DETAILS),items:{fold1key1:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_TASK)+":</strong> "+B},fold2key2:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_TASK_FILE)+":</strong> "+C},fold1key3:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_ACTIVITY_FOLDER)+":</strong> "+D}}},fold2:{name:getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_SHOW_URL),items:{fold2key1:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_PATH)+":</strong> "+A},fold2key2:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_URL)+":</strong> "+E+C}}}}}}}function returnProcessMenu(D){var B;var F=D.currentTarget;var E=$(F).parents("div.bucket-application, div.bucket-process");if(E.length>0){B=getBasisMenuProductActivityProcess(D);if(context.keyValue&&context.keyValue.length>0){var C=$(E).attr("data-dashboardLayout");var A=$(E).attr("data-dashboardView");B.items.fold2.items.fold2key3={name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_DASHBOARDLAYOUT)+":</strong> "+C?C:""};B.items.fold2.items.fold2key4={name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_DASHBOARDVIEW)+":</strong> "+A?A:""}}if(B.showHelp){addHelpToContextMenu(B,D)}}return B}function returnActivityOrProductMenu(B){var A=getBasisMenuProductActivityProcess(B);if(A&&A.showHelp){addHelpToContextMenu(A,B)}return A}function getBasisMenuProductActivityProcess(A){var D;var G=A.currentTarget;var H=$(G).parents("div.bucket-application, div.bucket-process");if(H.length>0){var C=getKeyValue(H,G);var I=getSummaryText(H,G);var F=getHelpLink(H,G);var B=getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_SUMMARY);var E=true;if(!F){F="";E=false}D={items:{fold1:{name:B,items:{fold1key1:{name:"<strong>"+B+":</strong> "+I}}},fold2:{name:getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_DETAILS),items:{fold2key1:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_KEY)+":</strong> "+C},fold2key2:{name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENU_HELPLINK)+":</strong> "+F}}}}};D.keyValue=C;D.showHelp=E;D.helpLink=F}return D}function getProcessPath(B,D){var E=$(B).attr("data-productTitle");if(!E){E=$(D).attr("data-productTitle")}var C=$(B).attr("data-activityTitle");if(!C){C=$(D).attr("data-activityTitle")}var A=$(B).attr("data-processTitle");if(!A){A=$(D).attr("data-processTitle")}return E?E+"/"+C+"/"+A+"/":false}function getKeyValue(C,E){var B=$(C).attr("data-productId");var A=$(C).attr("data-activityId");if(!A){A=$(E).attr("data-activityId")}var F=$(C).attr("data-processId");var D="";if(F){D=F}else{if(A){D=A}else{if(B){D=B}}}return D}function getSummaryText(B,C){var A=$(C).attr("title");if(!A){A=$(B).children("h2").attr("title")}if(!A){A=""}return A}function getHelpLink(B,C){var A=$(C).attr("data-helpLink");if(!A){A=$(B).attr("data-helpLink")}return A}function addHelpToContextMenu(A,B){var D=$(B.currentTarget).attr("data-helpSystem");if(!D){var C=$(B.currentTarget).parents("div.bucket-application, div.bucket-process");D=$(C).attr("data-helpSystem")}A.items.help={name:"<strong>"+getLocalizedString(pageNavStrings.z_NAVIGATOR_MENUITEM_HELP)+"</strong>",callback:function(J,H){if(A.helpLink&&$.trim(A.helpLink).length>0){var I="toolbar=yes,menubar=no,resizable=yes,scrollbars=yes,status=yes,width=800,height=600,left=10,top=10";var G=context.archibusHelpLink.replace("(user.helpExtension)",context.userHelpExtension);if(D&&D==="SYSTEM"){G=context.systemMgmtHelpLink}var F=G+"#.."+A.helpLink.replace(/\\/g,"/");return window.open(F,getLocalizedString(pageNavStrings.z_PAGENAV_ARCHIBUS_HELP),I)}else{A.helpLink="an undefined help link.";var E="help was clicked for "+A.helpLink;window.console&&console.log(E)||alert(E)}}};return A}function copyToClipboard(A){window.prompt(getLocalizedString(pageNavStrings.z_PAGENAV_COPY_TO_CLIPBOARD),A)}function returnAppSpecificMenu(){return{callback:function(B,A){if(B==="report"){var C=$(this).parent(".bucket-process");var D=$(C).attr("id");html2canvas($("#"+D),{proxy:"/html2canvasproxy",allowTaint:true,useCORS:true,onrendered:function(E){var F=E.toDataURL("image/png");saveToDisk(F,"testMeNow.png",C[0])}})}},items:{notice:{name:getLocalizedString(pageNavStrings.z_PAGENAV_RUNTIME_CONTEXT_MENU)}}}}function saveToDisk(A,H,D){if(!window.ActiveXObject){var F=document.createElement("a");F.href=A;F.target="_blank";F.download=H||A;var E=new MouseEvent("click",{view:window,bubbles:true,cancelable:true});F.dispatchEvent(E);(window.URL||window.webkitURL).revokeObjectURL(F.href)}else{if(!!window.ActiveXObject&&document.execCommand){var G=jQuery.Event("SaveAs");jQuery(D).trigger(G);var B="<p>Right-click on image below and Save-Picture-As</p>";B+="<img src='"+A+"' alt='from canvas'/>";var C=window.open();C.document.write(B);C.execCommand("SaveAs",true,H);C.close()}}}var PageNavUserInfo={locale:"en_US",localeDirectory:"",roleDirectory:"",redirectIntervalId:0,redirectWaitCounter:0,loggedInUser:"",webAppContextPath:"/archibus/",cssDirectory:"/archibus/schema/ab-core/css/",cssFilePrefix:"ab-page-navigation-",generationDirectory:"schema/ab-products/common/views/page-navigation/generated/",userInterfaceTheme:"",languageExtension:"",homeTabFragment:null,applicationsTabHtmlFragment:null,roleSplitRegex:/[\\ /]/};function fileExists(A){if(A){var C=A.substr(A.lastIndexOf(PageNavUserInfo.webAppContextPath));var B=new XMLHttpRequest();B.open("GET",C,false);B.send();return B.status===200}else{return false}}function setPageNavUserInfo(A){setUserLocaleDirectory(A.locale,A.languageExtension);setUserRoleDirectory(A.role);setUserColorScheme(A.colorScheme)}function setUserLocaleDirectory(C,B){setUserLanguage(B);if(C){var A=C;if(!B||B.length===0){if(A==="zh_CN"){B="ch"}else{B=A.substr(0,2)}}else{if(B.length===3){B=B.substring(1)}}PageNavUserInfo.locale=A;PageNavUserInfo.localeDirectory=B+"/"}}function setUserLanguage(A){if(A){PageNavUserInfo.languageExtension=A}}function setUserRoleDirectory(A){PageNavUserInfo.roleDirectory=getCamelCasedString(A)+"/";return PageNavUserInfo.roleDirectory}function getUserRoleDirectory(A){return getCamelCasedString(A)+"/"}function setUserColorScheme(A){if(A&&A.length>0){PageNavUserInfo.userInterfaceTheme=$.trim(A).toLowerCase().replace(" ","-")}}function getCamelCasedString(F){var B="";if(F&&F.length>0){var E=F.split(PageNavUserInfo.roleSplitRegex);var A=E.length;for(var C=0;C<A;C++){if(E[C].length===1&&(E[C].charAt(0)==="&"||E[C].charAt(0)==="_")){continue}if(E[C].charAt(0)==="("){E[C]=E[C].substr(1)}var D=E[C].length;if(E[C].charAt(D-1)===")"){E[C]=E[C].substr(0,D-1)}if(C===0){B=E[C].toLocaleLowerCase()}else{B+=E[C].charAt(0).toLocaleUpperCase();B+=E[C].substr(1).toLocaleLowerCase()}}}return B}function getRoleDashed(C){var B="";var F=C.toLocaleLowerCase().split(PageNavUserInfo.roleSplitRegex);var D=F.length;for(var E=0;E<D;E++){if(F[E].length===1&&(F[E].charAt(0)==="&"||F[E].charAt(0)==="-")){continue}if(F[E].charAt(0)==="("){F[E]=F[E].substr(1)}var A=F[E].length;if(F[E].charAt(A-1)===")"){F[E]=F[E].substr(0,A-1)}B+=(E===0)?F[E]:"-"+F[E]}return B}function getUserInfo(){var B;try{var A=Ab.workflow.Workflow.call("AbCommonResources-getUser",{});if(Ab.workflow.Workflow.sessionTimeoutDetected){B={name:"timeout",role:"timeout"}}else{if(A.data){var D=AdminService._path;var E="";if(D){E=D.substr(0,D.indexOf("/",2)+1)}B={name:A.data.user_name,role:A.data.role_name,groups:A.data.groups,projectName:A.data.projectName,serverVersion:A.data.serverVersion,locale:A.data.locale,languageExtension:A.data.languageExtension,colorScheme:A.data.colorScheme,webAppContextPath:E}}}}catch(C){Workflow.handleError(C)}return B}function setUpHistory(A,B){A.find(B).click(function(){var D=$(this).closest(".ui-tabs").attr("id");var C=$(this).parent().prevAll().length;pushState(D,C)});$("#navigationTabs").find("a").click(function(){return false});$(window).bind("hashchange",function(E){if(signOutOnTimeOut()){return }A.each(function(){var F=$.bbq.getState(this.id,true)||0;$("#navigationTabs").tabs("option","active",F)});var D=$.deparam.fragment();if((!D.eTask&&!D.process&&!D.pTask)){var C=D.navigationTabs||0;restoreTab(C)}if(D.eTask){if(!isTaskAlreadyShown("#taskFrame",D.eTask)){setDisplayContainers("#taskFrame",D.eTask)}}else{if(D.pTask){if(!isTaskAlreadyShown("#pTaskFrame",D.pTask)){setDisplayContainers("#pTaskFrame",D.pTask)}}else{if(D.process){if(!isProcessAlreadyShown("#applicationsProcessView",D.process)){setDisplayContainers("#applicationsProcessView",D.process)}$("#breadCrumbContainer").hide()}}}});$(window).trigger("hashchange")}function getStateCopy(){var B={};var A=$.bbq.getState();if(A.navigationTabs){B.navigationTabs=A.navigationTabs}if(A.role){B.role=A.role}if(A.process){B.process=A.process}if(A.taskFile){B.taskFile=A.taskFile}if(A.pTask){B.pTask=A.pTask}return B}function pushState(A,C){var B=getStateCopy();B[A]=C;$.bbq.pushState(B)}function isTaskAlreadyShown(D,B){var C=false;var A=$(D).attr("src");if(A&&A.lastIndexOf("/")>0){A=A.substr(A.lastIndexOf("/")+1);if(A===B){C=true}}return C}function isProcessAlreadyShown(D,B){var C=false;var A=$(D).attr("rel");if(A&&A.lastIndexOf("/")>0){A=A.substr(A.lastIndexOf("/")+1);if(A===B){C=true}}return C}function loadLocalization(B){if(B&&B.length>1){var A=PageNavUserInfo.webAppContextPath+"schema/ab-core/controls/lang/ui-controls-lang-"+B+".js";if(langFileExists(A)){$.getScript(A,function(C,E,D){console.log(E);console.log("Load of locale strings was performed.");localizeDisplayText();localizeFavoritesDisplayText()})}else{localizeDisplayText();localizeFavoritesDisplayText()}}}function langFileExists(A){if(A){var D=window.location.href;var C=D.substr(0,D.indexOf("/",10));D=C+A;var B=new XMLHttpRequest();B.open("GET",D,false);B.send();return B.status===200}else{return false}}function getLocalizedString(D){var A=D;if(Ab.localization){var C=Ab.localization.Localization.localizedStrings;for(var B=0,E;E=C[B];B++){if(E.key3===D){(E.value==="")?A="*"+E.key3:A=E.value;return A}}}if(valueExistsNotEmpty(A)){A=convertFromXMLValue(A)}return A}function convertFromXMLValue(B){var A="";if(B&&jQuery.isNumeric(B)){A=B}else{if(B&&typeof B=="string"){A=B.replace(/&amp;/g,"&");A=A.replace(/&gt;/g,">");A=A.replace(/&lt;/g,"<");A=A.replace(/&apos;/g,"'");A=A.replace(/&quot;/g,'"')}}return A}function convertToXMLValue(B){var A="";if(B&&jQuery.isNumeric(B)){A=B}else{if(B&&typeof B==="string"){A=B.replace(/&/g,"&amp;");A=A.replace(/>/g,"&gt;");A=A.replace(/</g,"&lt;");A=A.replace(/\'/g,"&apos;");A=A.replace(/\"/g,"&quot;")}else{if(typeof B==="boolean"){A=B?"true":"false"}}}return A}var pageNavStrings={z_NAVIGATOR_MENU_KEY:"Key",z_NAVIGATOR_MENU_HELPLINK:"Help Link",z_NAVIGATOR_MENU_TASK:"Task",z_NAVIGATOR_MENU_TASK_FILE:"Task File",z_NAVIGATOR_MENU_ACTIVITY_FOLDER:"Activity Folder",z_NAVIGATOR_MENU_PATH:"Path",z_NAVIGATOR_MENU_URL:"URL",z_NAVIGATOR_MENUITEM_SUMMARY:"Summary",z_NAVIGATOR_MENUITEM_DETAILS:"Details",z_NAVIGATOR_MENUITEM_HELP:"Help",z_NAVIGATOR_MENUITEM_SHOW_URL:"Show Task Information",z_NAVIGATOR_USERMENU_PROJECT:"Project:",z_NAVIGATOR_USERMENU_ROLE:"Role:",z_NAVIGATOR_USERMENU_VERSION:"Version:",z_NAVIGATOR_USERMENU_PROFILE:"My Profile",z_NAVIGATOR_USERMENU_JOBS:"My Jobs",z_NAVIGATOR_USERMENU_PRESENTATIONS:"Create Presentation",z_NAVIGATOR_USERMENU_EDITOR:"Edit Home Page",z_NAVIGATOR_MENUITEM_DASHBOARDLAYOUT:"Dashboard Layout",z_NAVIGATOR_MENUITEM_DASHBOARDVIEW:"Dashboard View",z_NAVIGATOR_MENUITEM_DESCRIPTORFILE:"Descriptor File",z_NAVIGATOR_MENUITEM_DESCRIPTORPROCESS:"Descriptor Process",z_PAGENAV_SESSION_TIME_OUT:"Session has timed out. Please sign in again.",z_PAGENAV_BUCKET_NODATA:"No data found",z_PAGENAV_SEARCH_NODATA:"No search results found",z_PAGENAV_GETRECORDS_MORE:"More values exist",z_PAGENAV_FAVORITES_DUPLICATE_WARNING:"The task <b>{1}</b> is already one of your Favorites!",z_PAGENAV_FAVORITES_DUPLICATE_TITLE:"No Duplicating Favorites",z_PAGENAV_FAVORITES_SAVE_ERROR_TITLE:"Error saving Favorites",z_PAGENAV_FAVORITES_DELETE_ERROR_TITLE:"Error removing Favorites",z_PAGENAV_PUBLISH:"Publish",z_PAGENAV_PUBLISH_LOCALE_BEFORE_LOGIN:"HTML files for the locale {1} do not exist. Please publish before logging in.",z_PAGENAV_COPY_TO_CLIPBOARD:"Copy to clipboard: Ctrl+C, Enter",z_PAGENAV_RUNTIME_CONTEXT_MENU:"No additional information is available for this panel.",z_PAGENAV_RUNTIME_BUCKET_REPORT:"Save as a Powerpoint .ppt file.",z_PAGENAV_RUNTIME_PAGE_REPORT:"Print Home Page to a .ppt file.",z_PAGENAV_WINDOW_TITLE:"ARCHIBUS Web Central",z_PAGENAV_BREADCRUMB_LABEL:"Tasks",z_PAGENAV_SEARCHBOX_INITIAL_TEXT:"Find a form or report",z_PAGENAV_SEARCHRESULT_TITLE:"Search",z_PAGENAV_SEARCHRESULT_DOMAIN:"Domain",z_PAGENAV_SEARCHRESULT_APPLICATION:"Application",z_PAGENAV_SEARCHRESULT_PROCESS:"Process",z_PAGENAV_SIGNOUT_BUTTON_LABEL:"Sign Out",z_PAGENAV_HELP_BUTTON_LABEL:"Help",z_PAGENAV_FAVORITES_ADD_TARGET_TEXT:"Drag a task here to add.",z_PAGENAV_FAVORITES_ADD_TARGET_TOOLTIP:"Drag any task or report into the box to add it.",z_PAGENAV_FAVORITES_DELETE_TARGET_TOOLTIP:"Drag a favorite into the trashcan to remove it.",z_PAGENAV_BACK_TO_TOP:"Back to Top",z_PAGENAV_ARCHIBUS_HELP:"Archibus Help",z_PAGENAV_METRICS_METRIC:"Metric",z_PAGENAV_METRICS_CURRENT:"Current",z_PAGENAV_METRICS_CHANGE:"Change",z_PAGENAV_METRICS_PER_YEAR:"Per Year",z_PAGENAV_METRICS_TARGET_PERCENT:"% of Target",z_PAGENAV_METRICS_TREND:"Trend",Z_PAGENAV_METRICS_ASSUMPTIONS_DESCRIPTION:"Description",Z_PAGENAV_METRICS_ASSUMPTIONS:"Assumptions",Z_PAGENAV_METRICS_ASSUMPTIONS_BSN_IMPL:"Business Implications",Z_PAGENAV_METRICS_ASSUMPTIONS_RECURRENCE:"Recurrence",z_PAGENAV_METRICS_ALL:"All",z_PAGENAV_FAVORITES_OK:"OK",z_PAGENAV_FAVORITES_SAVE:"Save",z_PAGENAV_FAVORITES_CANCEL:"Cancel",z_PAGENAV_FAVORITES_RENAME:"Rename",z_PAGENAV_FAVORITES_EDIT_TITLE:"Edit Favorites Titles and Ordering",z_PAGENAV_FAVORITES_SAVE_ORDER:"Save Order",z_PAGENAV_FAVORITES_CANCEL_REORDER:"Discard Changed Order",z_PAGENAV_FAVORITES_LOSE_ORDER_MESSAGE:"Closing the dialog now will lose the changed ordering of the favorites.",z_PAGENAV_FAVORITES_LOSE_ORDER_QUESTION:"Do you want to close now?",z_PAGENAV_FAVORITES_SAVE_FAILED:"Saving new name failed",z_PAGENAV_FAVORITES_RENAME_FAIL_MESSAGE:"The renaming was not saved to the server.",z_PAGENAV_FAVORITES_RENAME_FAIL_QUESTION:"Ensure that name is unique.",z_PAGENAV_FAVORITES_ORDER_SAVED:"Order saved.",z_PAGENAV_FAVORITES_SAVE_NOOP:"No need to save.",z_PAGENAV_FAVORITES_ORDER_SAVE_FAILED:"Order save failed!",z_PAGENAV_BUCKET_DEF_ERROR:"Bucket Definition Error",z_PAGENAV_NO_DATA_AVAILABLE:"No Data Available",z_PAGENAV_MAP_WORLD_IMAGERY:"World Imagery",z_PAGENAV_MAP_WORLD_IMAGERY_WITH_LABELS:"World Imagery with Labels",z_PAGENAV_MAP_WORLD_LIGHT_GRAY_BASE:"World Light Gray Canvas",z_PAGENAV_MAP_WORLD_DARK_GRAY_BASE:"World Dark Gray Canvas",z_PAGENAV_MAP_WORLD_STREET_MAP:"World Street Map",z_PAGENAV_MAP_WORLD_SHADED_RELIEF:"World Shaded Relief",z_PAGENAV_MAP_WORLD_TOPOGRAPHIC_MAP:"World Topographic",z_PAGENAV_MAP_NATGEO_WORLD_MAP:"National Geographic World Map",z_PAGENAV_MAP_OCEAN_BASEMAP:"Oceans Basemap",z_PAGENAV_MAP_ROADMAP:"Road Map",z_PAGENAV_MAP_SATELLITE:"Satellite",z_PAGENAV_MAP_HYBRID:"Satellite with Labels",z_PAGENAV_MAP_TERRAIN:"Terrain"};function initDandDFavorites(){var A=getActiveTabId();var B=$(A).find('.nav-pages[display!= "none"]');var D=$(A).find(".process-tasks > li > a");$(D).draggable({cursor:"move",helper:"clone",containment:B,appendTo:B,revert:"invalid",revertDuration:100});var E=$(A).find(".favorites-add-target");$(E).droppable({tolerance:"pointer",greedy:true,accept:'a[data-isFavorites!="true"]'});$(E).on("drop",handleFavoritesAddDropEvent);var C=$(A).find(".favorites-delete-target");$(C).droppable({tolerance:"pointer",greedy:true,accept:'a[data-isFavorites="true"]'});$(C).on("drop",handleFavoritesDeleteDropEvent)}function localizeFavoritesDisplayText(){$("span.favorites-add-target").html(getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_ADD_TARGET_TEXT));$(".favorites-add-target").attr("title",getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_ADD_TARGET_TOOLTIP));$("span.favorites-delete-target").attr("title",getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_DELETE_TARGET_TOOLTIP));$("a.page-top-link").html(getLocalizedString(pageNavStrings.z_PAGENAV_BACK_TO_TOP))}function loadFavoritesBuckets(){var A=getActiveTabId();var B=$(A).find(".bucket-wrapper > .favorites").find(".favorites-items").first();if(B){var D={viewName:"ab-page-navigation-datasource.axvw",dataSourceId:"pageNavigationFavorites_ds",groupIndex:0,version:"2",useHierarchicalSecurityRestriction:false};var C=getDataRecords(D);drawFavoritesRecords(B,C.records);pageTallFavoritesBuckets()}}function drawFavoritesRecords(K,B){$(K).empty();if(B&&B.length>0){var F=$("li.ui-tabs-active > a");var J=$(F).attr("id");var I=J.toLowerCase().indexOf("home")>=0?"eTask":"pTask";for(var D=0,E;E=B[D];D++){var H=E["afm_ptasks.task_id"];var A=removeUserNameFromTaskString(H);$(K).append('<li><a href="'+E["afm_ptasks.task_file"]+'" rel="'+I+'" data-activityId="'+E["afm_ptasks.activity_id"]+'" data-processId="'+E["afm_ptasks.process_id"]+'" data-taskId="'+H+'" data-isFavorites="true">'+A+"</a></li>")}var G=getActiveTabId();var C=$(".favorites-items > li > a");C.draggable({helper:"clone",containment:$(G).find(".favorites").parent(".bucket-wrapper")});C.click(function(){return false})}}function removeUserNameFromTaskString(A){var B=PageNavUserInfo.loggedInUser.toUpperCase();if(A.indexOf("("+B+")")===(A.length-B.length-2)){A=$.trim(A.substr(0,A.indexOf(B)-1))}return A}function handleFavoritesAddDropEvent(O,P){var D=P.draggable;var K=D.attr("href");var A=convertFromXMLValue(D.get(0).innerHTML);var F="-"+PageNavUserInfo.loggedInUser.toLowerCase()+".axvw";var Q=".axvw";var J=$(getActiveTabId()).find(".bucket-wrapper > .favorites > ol.favorites-items > li > a");for(var S=0,I;I=J[S];S++){var G=$(I).attr("href");G=G.substr(G.lastIndexOf("\\")+1);var B=G.replace(F,Q);if(K===G||K===B){showModalMessageDialog(getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_DUPLICATE_TITLE),getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_DUPLICATE_WARNING).replace("{1}",A));return }}var M=$(D).parents(".bucket-process, .bucket-application");var R;var N;var C=convertFromXMLValue($(D).attr("data-taskId"));var T=convertFromXMLValue($(D).attr("data-taskIcon"));if(M.length>0){R=$(M).attr("data-activityId");N=$(M).attr("data-processId");var H={viewName:K,activityId:R,processId:N,taskId:C,taskIcon:T,taskIdLocalized:A,isWritePtask:true};var E=runWorkflowRuleAndConfirm("AbSystemAdministration-addViewToMyFavorites",H);if(E.success){refreshFavorites()}else{showModalMessageDialog(getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE_ERROR_TITLE),E.message)}}}function handleFavoritesDeleteDropEvent(C,E){var B=E.draggable;var D=B.get(0);var A=$("body");A.css("cursor","progress");var F=removeMyFavoritesTask(D);if(F){$(D).parent().remove()}else{returnElementToUndraggedPosition(D)}A.css("cursor","default")}function removeMyFavoritesTask(C){var A=C.innerHTML;var D=PageNavUserInfo.loggedInUser.toUpperCase();var B={viewName:$(C).attr("href"),isWritePtask:true,taskId:convertFromXMLValue($(C).attr("data-taskId")),taskIdLocalized:convertFromXMLValue(A+" ("+D+")"),processId:$(C).attr("data-processId"),activityId:$(C).attr("data-activityId")};var E=runWorkflowRuleAndConfirm("AbSystemAdministration-removeViewFromMyFavorites",B);if(!E.success){B.taskId=$.trim(A.substring(0,A.indexOf("("+D)));E=runWorkflowRuleAndConfirm("AbSystemAdministration-removeViewFromMyFavorites",B)}if(!E.success){showModalMessageDialog(getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_DELETE_ERROR_TITLE),wfrResult.message)}else{refreshFavorites()}return E}function removeImgElemIfExists(C){var A=C.indexOf("<img ");if(A>=0){var B=C.indexOf(">",A);C=C.substr(0,A)+C.substr(B+1)}return $.trim(C)}function pageTallFavoritesBuckets(){var A=getActiveTabId();var B=A==="#tabPageNavigationHome"?"process":"application";$(A).find(".bucket-wrapper > .favorites").each(function(H){var K=getUnpagedBucketHeight($(this).parent(),B);var J=K-60;var C=$(this).parent().height();if(C>K){var D=$(this).find(".favorites-items").find("li");var I=$(this).find(".favorites-items");var E=removeActivityElementsToCorrectHeight(J,D,this);var G=getPageRowHeight(I);var F=$(this).parent().attr("id");$(I).wrap('<div class="scrollable-wrapper scrollable-favorites-wrapper-'+G+'"></div>');$(I).wrap('<div class="scrollable-root scrollable-favorites-'+G+'" id="'+F+H+'_scroller"></div>');$(I).wrap('<div class="items"></div>');appendAdditionalFavoritesPages(J,I,F,H,1,E);$(this).append('<div class="navi" id="favNavi_'+F+H+'"></div>');$("#"+F+H+"_scroller").scrollable({vertical:false,mousewheel:true}).navigator("#favNavi_"+F+H)}})}function appendAdditionalFavoritesPages(I,E,B,D,F,C){var K=B+D+"_"+F+"_insert_root";$(E).after('<ol class="favorites-items" id="'+K+'"></ol>');var J=$("#"+K);var M=C.length;for(var H=0;H<M;H++){J.append(C[H])}var A=J.height();if(A>I){var N=J.children("li");var G=removeActivityElementsToCorrectHeight(I,N,J);appendAdditionalFavoritesPages(I,J,B,D,F+1,G)}}function wasFavoritesDrag(B){var A=false;if($(B).attr("data-isFavorites")&&wasElementDragged(B)){A=true}return A}function returnElementToUndraggedPosition(A){var C=parseFloat($(A).css("left"));var B=parseFloat($(A).css("top"));if(isNumber(C)&&Math.abs(C)>0){$(A).css("left","0px")}if(isNumber(B)&&Math.abs(B)>0){$(A).css("top","0px")}}function runWorkflowRuleAndConfirm(D,B){var A={success:true,message:""};try{Ab.workflow.Workflow.call(D,B)}catch(C){A={success:false,message:C.message}}return A}function showModalMessageDialog(C,B){var A=$("#messageDialog");A.attr("title",C);A.html("<p>"+B+"</p>");A.dialog({modal:true})}function refreshFavorites(){var A=getActiveTabId();var B=$(A).find(".favorites");if(B&&$(B).length){$(B).empty();$(B).append('<ol class="favorites-items"></ol>');loadFavoritesBuckets()}}var PageNavFavoritesDialogConfig={confirmDiscardReorderDialogOptions:null,renameFailedDialogOptions:null,confirmDialog:null,reorderFavoritesWfrDefined:false};function getReorderFavoritesWfrDefined(){if(typeof PageNavFavoritesDialogConfig.reorderFavoritesWfrDefined==="undefined"){var B={viewName:"ab-page-navigation-datasource.axvw",dataSourceId:"pageNavigationFavorites_ds",isWritePtask:true,favorites:toJSON([])};try{var A=runWorkflowRuleAndConfirm("AbSystemAdministration-updateOrderOfMyFavorites",B);PageNavFavoritesDialogConfig.reorderFavoritesWfrDefined=A.success}catch(C){PageNavFavoritesDialogConfig.reorderFavoritesWfrDefined=false}}return PageNavFavoritesDialogConfig.reorderFavoritesWfrDefined}function showFavoritesDialog(T){if(!getReorderFavoritesWfrDefined()){return false}var M=$(T).parent().attr("id");var P=M+"_dialog";var E=getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_CANCEL);var D=getConfirmDialogHtml(getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_CANCEL_REORDER),getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_LOSE_ORDER_MESSAGE)+"<br>"+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_LOSE_ORDER_QUESTION));var S=$("#"+P);var Q=(S&&S.length>0);if(!Q){$(T).append('<div id="'+P+'" class="favorites-dialog" title="'+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_EDIT_TITLE)+'"><div class="favorites-dialog-status" data-status="initial"><span class="favorites-status-display"></span></div>'+D+"<ol></ol></div>");S=$(T).find("#"+P)}var A=$(S).find("ol");var K=$(T).siblings(".bucket-wrapper").find("a.ui-draggable");var I=K.length;for(var N=0;N<I;N++){var O=K[N];var H=O.innerHTML;var J=$(O).attr("data-activityid");var G=$(O).attr("data-processid");var B=$(O).attr("data-taskid");var R=$(O).attr("href");A.append('<li><div class="portlet" data-task-file ="'+R+'"data-activity-id="'+J+'" data-process-id="'+G+'" data-task-id="'+B+'"><div class="portlet-header"><span class="favorites-display-title">'+H+'</span></div><div class="portlet-content" style="display:none;">'+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_RENAME)+'<br><input type="text" style="padding-right:0;margin:0;width:99%;" value="'+H+'"><br><div class="portlet-button-panel"><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only rename-save" type="button" role="button"><span class="ui-button-text">'+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE)+'</span></button><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only rename-cancel" type="button" role="button"><span class="ui-button-text">'+E+"</span></button></div></div></div></li>")}A.sortable({handle:".portlet-header",cancel:".portlet-toggle",placeholder:"portlet-placeholder ui-corner-all",change:onFavoritesSortChange});$(".favorites-dialog-status").css("display","none");$(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend('<span class="ui-icon ui-icon-plusthick portlet-toggle"></span>');$(".portlet-toggle").click(function(){var U=$(this);U.toggleClass("ui-icon-minusthick ui-icon-plusthick");U.closest(".portlet").find(".portlet-content").toggle()});$(".rename-cancel").click(cancelFavoriteRenaming);$(".rename-save").click(saveFavoriteRenaming);var F=parseInt($(T).closest(".ui-tabs-panel").css("height"));var C=Math.min(F,(K.length*45)+150);if(!Q){S.dialog({autoOpen:false,modal:true,height:C,minHeight:C,maxHeight:F,minWidth:350,beforeClose:checkFavoritesReOrderSave,close:onCloseFavoritesDialog,buttons:[{text:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE_ORDER),click:saveFavoritesReOrdering},{text:E,click:closeFavoritesDialog}]})}PageNavFavoritesDialogConfig.confirmDialog=$("#dialog-confirm").dialog({autoOpen:false,modal:true,resizable:false,height:165,width:340,minWidth:340,buttons:[{text:"OK",click:acceptFavoritesReOrderingWarning},{text:E,click:closeFavoritesConfirmDialog}]});if(!PageNavFavoritesDialogConfig.renameFailedDialogOptions){initializeDialogOptions()}S.parent().fadeTo("fast",1);S.dialog("open")}function initializeDialogOptions(){PageNavFavoritesDialogConfig.confirmDiscardReorderDialogOptions={title:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_CANCEL_REORDER),message:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_LOSE_ORDER_MESSAGE)+"<br>"+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_LOSE_ORDER_QUESTION),okButtonTitle:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE_ORDER),okButtonClickMethod:saveFavoritesReOrdering,cancelButtonTitle:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_CANCEL),cancelButtonClickMethod:closeFavoritesConfirmDialog};PageNavFavoritesDialogConfig.renameFailedDialogOptions={title:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE_FAILED),message:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_RENAME_FAIL_MESSAGE)+"<br>"+getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_RENAME_FAIL_QUESTION),okButtonTitle:getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_OK),okButtonClickMethod:closeFavoritesConfirmDialog}}function onCloseFavoritesDialog(B,C){var A=$(B.target).parent().find("ol");A.empty()}function onFavoritesSortChange(A,B){setFavoritesReOrderStatusElement($(A.target).parent(),"changed")}function setFavoritesReOrderStatusElement(A,B){var C=A.find(".favorites-dialog-status");C.attr("data-status",B)}function getFavoritesReOrderStatusElement(A){var B=A.find(".favorites-dialog-status");if(B&&B.length>0){B=B[0]}else{B=null}return B}function getFavoritesReOrderStatus(B){var A="unknown";if(B&&B.length>0){A=B.attr("data-status")}return A}function checkFavoritesReOrderSave(E,F){var D=$(E.target).parent().find(".favorites-dialog-status");var A=getFavoritesReOrderStatus(D);var G=(A!=="initial"&&A!=="saved");if(G){var C=PageNavFavoritesDialogConfig.confirmDialog;var B=PageNavFavoritesDialogConfig.confirmDiscardReorderDialogOptions;if(B.title!==C.dialog("option","title")){C.dialog("option","title",B.title);C.find("p").html('<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 40px 0;"></span>'+B.message);C.dialog("option","buttons",[{text:B.okButtonTitle,click:B.okButtonClickMethod},{text:B.cancelButtonTitle,click:B.cancelButtonClickMethod}])}C.dialog("open")}return !G}function saveFavoriteRenaming(){var C=$(this);var I=C.closest(".portlet");var G=I.find(".portlet-header");var H=C.closest(".portlet-content");var E=H.find("input[type='text']").attr("value");var B=I.attr("data-activity-id");var A=I.attr("data-process-id");var D=I.attr("data-task-id");D=convertFromXMLValue(D);var F=convertFromXMLValue(E);if(D.indexOf("("+PageNavUserInfo.loggedInUser+")")>0){F=E+" ("+PageNavUserInfo.loggedInUser+")"}if(D===F){H.toggle();G.find(".portlet-toggle").toggleClass("ui-icon-minusthick ui-icon-plusthick")}else{if(saveFavoriteRenamingToServer(B,A,D,F)){G.find("span.favorites-display-title").text(E);I.attr("data-task-id",F);H.toggle();G.find(".portlet-toggle").toggleClass("ui-icon-minusthick ui-icon-plusthick");refreshFavorites()}else{var J=$(".dialog-confirm");J.dialog("option","title",PageNavFavoritesDialogConfig.renameFailedDialogOptions.title);J.find("p").html('<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 40px 0;"></span>'+PageNavFavoritesDialogConfig.renameFailedDialogOptions.message);J.dialog("option","buttons",[{text:PageNavFavoritesDialogConfig.renameFailedDialogOptions.okButtonTitle,click:PageNavFavoritesDialogConfig.renameFailedDialogOptions.okButtonClickMethod}]);J.dialog("open")}}}function saveFavoritesReOrdering(){var A=getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_ORDER_SAVED);var F=getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_SAVE_NOOP);var G=getLocalizedString(pageNavStrings.z_PAGENAV_FAVORITES_ORDER_SAVE_FAILED);var K=$(this);var H=[];var E=K.find("div.portlet");var C=getFavoritesReOrderStatus(K.find(".favorites-dialog-status"));if(!E||E.length===0||C==="initial"||C==="saved"){showStatusMessage(K,F);fadeDialogAndClose(K);return }var I=E.length;for(var D=0;D<I;D++){var M=E[D];H.push({activityId:$(M).attr("data-activity-id"),processId:$(M).attr("data-process-id"),taskId:convertFromXMLValue($(M).attr("data-task-id")),taskFile:$(M).attr("data-task-file"),displayOrder:(D+1)*100,hotUserName:PageNavUserInfo.loggedInUser})}var J={viewName:"ab-page-navigation-datasource.axvw",dataSourceId:"pageNavigationFavorites_ds",isWritePtask:true,favorites:toJSON(H)};var B=runWorkflowRuleAndConfirm("AbSystemAdministration-updateOrderOfMyFavorites",J);if(B.success){showStatusMessage(K,A);setFavoritesReOrderStatusElement(K,"saved");refreshFavorites();fadeDialogAndClose(K)}else{showStatusMessage(K,G)}}function saveFavoriteRenamingToServer(B,A,G,D){var E=false;var H={"afm_ptasks.activity_id":B,"afm_ptasks.process_id":A,"afm_ptasks.task_id":G,"afm_ptasks.hot_user_name":PageNavUserInfo.loggedInUser};var C={"afm_ptasks.activity_id":B,"afm_ptasks.process_id":A,"afm_ptasks.task_id":D,"afm_ptasks.hot_user_name":PageNavUserInfo.loggedInUser};var I={viewName:"ab-page-navigation-datasource.axvw",dataSourceId:"pageNavigationFavorites_ds",isNewRecord:false,version:"2.0",oldFieldValues:toJSON(H),fieldValues:toJSON(C)};var F=Ab.workflow.Workflow.call("AbCommonResources-saveDataRecord",I);if(F.code==="executed"){E=true}return E}function cancelFavoriteRenaming(){var A=$(this);var B=A.closest(".portlet").find(".portlet-header");var D=A.closest(".portlet-content");var C=B.find("span.favorites-display-title").text();D.find("input[type='text']").attr("value",C);D.toggle();B.find(".portlet-toggle").toggleClass("ui-icon-minusthick ui-icon-plusthick")}function closeFavoritesDialog(){$(this).dialog("close")}function closeFavoritesConfirmDialog(){confirmDialog.dialog("close")}function showStatusMessage(A,C){var B=getFavoritesReOrderStatusElement(A);$(B).html('<span class="status-display">'+C+"</span>");$(B).css("display","block")}function fadeDialogAndClose(A){A.parent().fadeTo("slow",0.7,function(){A.dialog("close")})}function getConfirmDialogHtml(A,B){return'<div id="dialog-confirm" class="dialog-confirm" title="'+A+'" style="display:none;"><p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 40px 0;"></span>'+B+"</p></div>"}function acceptFavoritesReOrderingWarning(){var A=$(".favorites-dialog");setFavoritesReOrderStatusElement(A,"initial");$(this).dialog("close");A.dialog("close")}function cancelFavoritesReOrderingWarning(){confirmDialog.dialog("close")}function convertFromXMLValue(A){if(typeof A!="undefined"&&A!=null){A=A.replace(/&amp;/g,"&");A=A.replace(/&gt;/g,">");A=A.replace(/&lt;/g,"<");A=A.replace(/&apos;/g,"'");A=A.replace(/&quot;/g,'"');return A}return""}var homeTabScroller=null;var applicationsTabScroller=null;var applicationsTabHtmlFragment="3053784";var tabsWidget;function startInitialization(){$(".task-view").hide();tabsWidget=setUpTabs();PageNavUserInfo.redirectIntervalId=setInterval(initialWfrCall,100)}function initialWfrCall(){if(valueExists(dwr.engine._scriptSessionId)){var A=getUserInfo();if(A&&"timeout"!==A.name){setPageNavUserInfo(A);if(typeof loadLocalization==="function"){loadLocalization(PageNavUserInfo.localeDirectory.replace("/",""))}if(typeof finishSetup==="function"){finishSetup(A)}}clearInterval(PageNavUserInfo.redirectIntervalId)}else{PageNavUserInfo.redirectWaitCounter++}}function setUpTabs(){return $("#navigationTabs").tabs({event:"change"})}function loadColorScheme(){if(PageNavUserInfo.userInterfaceTheme&&PageNavUserInfo.userInterfaceTheme.length>0){loadCSS(PageNavUserInfo.cssDirectory+PageNavUserInfo.cssFilePrefix+PageNavUserInfo.userInterfaceTheme+".css")}}function finishSetup(A){setUpSearchDialog();setUserHeader(A);setFragmentFileNamesFromRole(A.role);loadColorScheme();setUpHistory(tabsWidget,"ul.ui-tabs-nav a");positionBreadCrumbs();if(!useScroller()){$("#searchText").hide()}$(window).resize(function(){setPageDimensions()});window.setTimeout(hovertipInit,100);if(context.includeHomeTab){goHome()}else{if(context.includeAppTab){goApps()}}}function dynamicallyLoadCodeFile(C){if(C.substr(C.length-3)===".js"||C.indexOf("/js?")>0){var B=C;$.ajax({type:"GET",url:B,dataType:"script",crossDomain:true,statusCode:{404:function(){alert("page not found")}}}).done(function(){console.log("Load of "+C+" was successful.")}).fail(function(){console.log("Error loading "+C)})}else{if(C.substr(C.length-4)===".css"){var A=$("<link rel='stylesheet' type='text/css' href='"+C+"'>");$("head").append(A);console.log("Load of "+C+" was successful.")}else{console.log("Error loading "+C+". It must be a js or css file.")}}}function localizeDisplayText(){window.document.title=getLocalizedString(pageNavStrings.z_PAGENAV_WINDOW_TITLE);$("#breadCrumbs").html(getLocalizedString(pageNavStrings.z_PAGENAV_BREADCRUMB_LABEL)+'<b class="caret"></b>');var A=getLocalizedString(pageNavStrings.z_PAGENAV_SEARCHBOX_INITIAL_TEXT);$("#searchText").attr("value",A).attr("title",A);$("#signOutLink").html(getLocalizedString(pageNavStrings.z_PAGENAV_SIGNOUT_BUTTON_LABEL));$("#helpLink").html(getLocalizedString(pageNavStrings.z_PAGENAV_HELP_BUTTON_LABEL));$("a.page-top-link").html(getLocalizedString(pageNavStrings.z_PAGENAV_BACK_TO_TOP));$("#userMenuProject").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PROJECT));$("#userMenuRole").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_ROLE));$("#userMenuVersion").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_VERSION));$("#myProfileMenuLink").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PROFILE));$("#myJobsMenuLink").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_JOBS));$("#myPresentationsMenuLink").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PRESENTATIONS));$("#myEditorMenuLink").html(getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_EDITOR))}function setPageDimensions(){var I=$("#headBannerHome");var J=$(window);var Q=I.height()+parseInt(I.css("padding-top"));var A=J.height();var B=J.width();var M=16;var D=$("#navigationTabs");D.css("width",B-2+"px");var P=0;var E=$("#homeTabView");var K=$("#applicationsTabView");var O=$("#applicationsProcessView");if(E.find(".page-row").is(":visible")){E.find(".page-row").each(function(){P+=$(this).outerHeight()});P+=E.find(".page-break-banner").outerHeight()}else{if(K.find(".page-row").is(":visible")){K.find(".page-row").each(function(){P+=$(this).outerHeight();P+=parseInt($(this).css("margin-top"));P+=parseInt($(this).css("margin-bottom"))})}else{if(O.find(".page-row").is(":visible")){O.find(".page-row").each(function(){P+=$(this).outerHeight()})}}}var C=Math.max(P+Q,A-Q-M);$(".page").css("height",C+"px");if(E.is(":visible")){$(".task-view").css("height",(A-Q)+"px")}else{$(".task-view").not(O).css("height",(A-Q-M)+"px");O.css("height",(C-Q+25)+"px")}if(useScroller()){E.css("height",(A-Q-2)+"px");E.parent().css("height",(A-Q)+"px");E.css("overflow","hidden");D.css("min-width","0px");I.css({position:"inherit","min-width":"0px"});$("#bannerMenu").css("right","10px");if(homeTabScroller){homeTabScroller.update()}else{homeTabScroller=new Ab.view.Scroller(E)}var F=$("#applicationsViewParent");F.parent().css("height",(A-Q)+"px");F.css("overflow","hidden");if(applicationsTabScroller){applicationsTabScroller.update()}else{applicationsTabScroller=new Ab.view.Scroller(F)}var H=$("#pTaskFrame");var G=$("#taskFrame");if(G.is(":visible")){G.css("height",(A-Q-5)+"px");G.css("width",(B-2)+"px")}else{if(H.is(":visible")){H.css("height",(A-Q-5)+"px");H.css("width",(B-18)+"px")}else{$(".task-view").css("width",(B-20)+"px")}}}else{$(".task-view").css("width",B+"px")}var N=$("#searchDialog");if(N.dialog("instance")&&N.dialog("isOpen")){N.dialog("option","position",{my:"right top",at:"right-15 top"})}}function useScroller(){return navigator.userAgent.match(/Android/i)===null&&navigator.userAgent.match(/iPhone|iPad/i)===null}function goHome(){if(signOutOnTimeOut()){return }var A=window.location.href;restoreTab(0);if(PageNavUserInfo.homeTabHtmlFragment){loadQuasiFrameAndDisplay("#homeTabView",PageNavUserInfo.homeTabHtmlFragment,A.substring(0,A.lastIndexOf(PageNavUserInfo.webAppContextPath)+PageNavUserInfo.webAppContextPath.length))}refreshFavorites()}function goApps(){if(signOutOnTimeOut()){return }var B=$("#pTaskFrame");if(B.length>0&&$(B).css("display")!=="none"){var D=$.bbq.getState();var F={};if(D.navigationTabs){F.navigationTabs=D.navigationTabs}if(D.process){F.process=D.process}$("#tabApplications").parent("li").removeClass("ui-task-tab-active").addClass("ui-state-active");$("#breadCrumbContent").find(".hovertip_wrap3").empty();$("#breadCrumbContainer").hide();$.bbq.pushState(F);hidePTaskFrame();var E=$("#applicationsProcessView");E.show();E.find(".nav-pages").show();setPageDimensions()}else{if(PageNavUserInfo.applicationsTabHtmlFragment){var C=window.location.href;var A=C.substring(0,C.lastIndexOf(PageNavUserInfo.webAppContextPath)+PageNavUserInfo.webAppContextPath.length);loadQuasiFrameAndDisplay("#applicationsTabView",PageNavUserInfo.applicationsTabHtmlFragment,A);restoreTab(1)}}}function restoreTab(A){$(".nav-pages").show();$("#applicationsProcessView").hide();hideTaskFrame();hidePTaskFrame();$("#breadCrumbContainer").hide();$("#breadCrumbContent").find(".hovertip_wrap3").empty();var B=$.bbq.removeState("eTask","pTask","process");if(!B){B={}}B.navigationTabs=A;$.bbq.pushState(B);showTab(A)}function showTab(A){$("#navigationTabs").tabs("option","active",A);$("ul.ui-tabs-nav > li").removeClass("ui-task-tab-active").addClass("ui-state-default");if(A===0){$("#homeTabView").show();$("#tabHome").parent("li").removeClass("ui-task-tab-active").addClass("ui-state-active")}else{if(A===1){$("#applicationsTabView").show();$("#tabApplications").parent("li").removeClass("ui-task-tab-active").addClass("ui-state-active")}}setPageDimensions()}function hideTaskFrame(){hideFrameElement("taskFrame")}function hidePTaskFrame(){hideFrameElement("pTaskFrame")}function hideFrameElement(B){var E=$("#"+B);if(E.length>0){try{var D=$(E).contents().find("body");var A=$(D).find("div.drawing");if(A.length>0){$(A).remove()}}catch(C){console.log("Frame contents not in server domain.")}$(E).hide();$(E).attr("src",null)}}function resetViewsToHome(){$(".bread-crumb-list").remove();$(".nav-pages").show();$(".task-view").hide();hideTaskFrame();hidePTaskFrame();$("#navigationTabs").tabs("option","active",0)}function loadCSS(B){var A=$("<link>");A.attr({rel:"stylesheet",type:"text/css",href:B});$("head").append(A)}function setFragmentFileNamesFromRole(A){var B=getRoleDashed(A);PageNavUserInfo.applicationsTabHtmlFragment=PageNavUserInfo.generationDirectory+PageNavUserInfo.localeDirectory+PageNavUserInfo.roleDirectory+"applications-home-"+B+".html"}function goToTop(){if(useScroller()){if(homeTabScroller){homeTabScroller.scrollbars.tweenTo(0,0)}if(applicationsTabScroller){applicationsTabScroller.scrollbars.tweenTo(0,0)}}else{$("html, body").animate({scrollTop:0},600)}return false}function scrollToCorner(B,A){if(useScroller()){if(homeTabScroller){homeTabScroller.scrollbars.scrollTo(B,A)}if(applicationsTabScroller){applicationsTabScroller.scrollbars.scrollTo(B,A)}}else{$("html, body").animate({scrollTop:A},600)}return false}function getRecord(C){var A=false;var B=getDataRecords(C);if(B&&B.records.length===1){A=B.records[0]}return A}function getDataRecords(C){var B=false;try{var A=Ab.workflow.Workflow.call("AbCommonResources-getDataRecords",C);if(!Ab.workflow.Workflow.sessionTimeoutDetected&&A.data&&A.data.records){B=A.data}}catch(D){Workflow.handleError(D)}return B}function setUpSearchDialog(){$("#searchDialog").dialog({modal:true,autoOpen:false,draggable:false,width:500});$(".ui-dialog-title").after('<input type="text" id="searchDialogTitleInput" class="search-text" onkeypress="onSearchBoxKeyPress(event);" style="float:right;margin-right:30px;width:240px;">');$("#searchDialogTitleInput").prev(".ui-dialog-title").css("width","20%")}function onSearchBoxSelect(A){var B=A.value;if(B===getLocalizedString(pageNavStrings.z_PAGENAV_SEARCHBOX_INITIAL_TEXT)){A.value=""}$("#searchText").css("color","black")}function onSearchBoxKeyPress(B){B=B||window.event;var A=B.keyCode||B.which;if(A===13){var C=$("#searchDialog").dialog("isOpen")?$.trim($("#searchDialogTitleInput").val()):$.trim($("#searchText").val());if(C.length>0){closeSearchDialog();displaySearchDialog(C)}}}function displaySearchDialog(E){var A=500;var G=800;var D=$("#searchDialog");if(Ab.workflow.Workflow.sessionTimeoutDetected){D.on("dialogbeforeclose",function(I,J){window.location=context.logoutView});D.html(getLocalizedString(pageNavStrings.z_PAGENAV_SESSION_TIME_OUT))}else{var H=PageNavUserInfo.webAppContextPath+"ab-page-navigation-view-search.axvw?searchText="+E;D.html('<iframe id="alert-drilldown-frame" src="'+H+'" width="99%" height="99%"></iframe>')}D.dialog("option","position",{my:"right top",at:"right-10 top"});D.dialog("option","height",A);D.dialog("option","width",G);var C=$("#searchDialogTitleInput");$(C).attr("value",E);var B=$(C).siblings(".ui-dialog-title");var F=getLocalizedString(pageNavStrings.z_PAGENAV_SEARCHRESULT_TITLE);B.attr("title",F);B.html(F);setTimeout(function(){D.dialog("open")},100);setTimeout(hovertipInit,100)}function closeSearchDialog(){var A=$("#searchDialog");if(A.dialog("isOpen")){A.dialog("close")}}function getViewsByName(C){var B={viewName:"ab-page-navigation-view-search.axvw",dataSourceId:"taskTitleSearch_pg_ds",groupIndex:0,version:"2",searchString:C,useHierarchicalSecurityRestriction:true};if(PageNavUserInfo.locale.substr(0,2)!=="en"){var A=PageNavUserInfo.localeDirectory.replace("/","");B.taskTitleColumn="afm_ptasks.task_"+A;B.processesTitleColumn="afm_processes.title_"+A;B.activitiesTitleColumn="afm_activities.title_"+A;B.productsTitleColumn="afm_products.title_"+A}return getDataRecords(B)}function changeHomeTab(D,C){var B=D.innerHTML;$("#tabLabelHome").html(B);positionBreadCrumbs();var A=D.href;A=A.substring(A.lastIndexOf("/")+1);PageNavUserInfo.homeTabHtmlFragment=PageNavUserInfo.generationDirectory+PageNavUserInfo.localeDirectory+PageNavUserInfo.roleDirectory+A;goHome()}function getArrayFromContextString(E){var A=[];if(E){var F=E.split(",");var D=F.length;for(var C=0;C<D;C++){var B=$.trim(F[C]);if(B.indexOf("[")===0){B=B.substr(1)}if(B.indexOf("]")===B.length-1){B=B.substr(0,B.length-1)}A.push(B)}}return A}function showHelp(){var B="toolbar=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width=800,height=600,left=10,top=10";var A=context.archibusHelpLink.replace("(user.helpExtension)",context.userHelpExtension);return window.open(A,"Archibus_Help",B)}function doSignOut(){var A=Workflow.getJobStatusesForUser();if(Workflow.sessionTimeoutDetected){var E=location.href;var D=E.substring(0,E.indexOf("schema"));window.location=D+context.logoutView;return }var B=false;for(var C in A){if(A[C].jobFinished===false&&A[C].jobStatusCode!==8){B=true}}if(B){}else{this.doLogout()}}function signOutOnTimeOut(){var A=false;if(Ab.workflow.Workflow.sessionTimeoutDetected){doLogout();A=true}return A}function doLogout(){SecurityService.logout({callback:function(A,E,D){PageNavUserInfo.loggedInUser="";var C=location.href;var B=C.substring(0,C.indexOf("schema"));window.location=B+context.logoutView},errorHandler:function(A,B){if(A==="Attempt to fix script session"||A.indexOf("expired")!==-1){window.location=context.logoutView}}})}function configureForSmartClient(){$("#signOutLink").css("display","none")}var PageNavReportingConfig={capturedCount:0,includeMapBuckets:false,bucketMapHash:null};function writeAppSpecificBucketReport(F,E){var H=$("#presentation_job_spinner");$(H).show();var G=true;var A={};var D=$("div.app-specific-bucket");var C=D.length;var B=false;PageNavReportingConfig.capturedCount=0;$(D).each(function(N){var K=$(this).parent(".bucket-process");var M=$(K).attr("id");var J=$(K).children("h2")[0].innerHTML;var I=false;if($(K).find(".pgnav-map").length>0){B=true;I=true}A[M]={index:N,title:J,isMapBucket:I,images:{}}});if(B&&G&&PageNavReportingConfig.includeMapBuckets){$(H).hide();openAppSpecificReportDialog()}else{captureReportImages(A,C)}}function captureReportImages(A,E){var B=E;for(var F in A){if(A[F].isMapBucket){B-=1;continue}var D=$("#"+F);var G=$(D).find(".navi");if(G.length>0){var C=$(G).children("a").length;B=B+C-1}captureBucketImage(F,0,A,B)}}function captureBucketImage(D,A,B,C){try{html2canvas($("#"+D),{allowTaint:true,useCORS:true,onrendered:function(F){addAdditionalPagesIfNeeded(D,A,B,C);processCanvasToImageContainer(F,D,A,B,C)}})}catch(E){console.log("Error in call to html2canvas for bucket "+D)}}function addAdditionalPagesIfNeeded(G,A,B,C){var F=$("#"+G);var H=$(F).find(".navi");if(H.length>0){var D=$(H).children("a").length;if(A+1<D){var E=$(F).find(".scrollable-root").data("scrollable");E.move(1);setTimeout(function(){captureBucketImage(G,A+1,B,C)},2000)}}}function captureMapBucketImage(D,C,A,B){leafletImage(D,function(F,E){processCanvasToImageContainer(E,C,0,A,B)})}function processCanvasToImageContainer(B,A,C,E,G){var F="base64,";try{var D=B.toDataURL();var I=D.indexOf(F)+F.length;E[A].images[C]=D.substring(I);PageNavReportingConfig.capturedCount+=1;$("#presentation_job_spinner").hide();if(G===PageNavReportingConfig.capturedCount){generatePPTX(formSlidesCollectionFromImagesContainer(E))}}catch(H){console.log("Exception taking canvas to image string for bucket "+A+" : "+C);console.log(H)}}function formSlidesCollectionFromImagesContainer(A){var D=[];for(var E in A){A[E].imageArray=[];var C=Object.keys(A[E].images).length;for(var B=0;B<C;B++){A[E].imageArray.push(A[E].images[B])}if(B>0){D.push({title:A[E].title,images:A[E].imageArray})}}return D}function generatePPTX(B){var A=Ab.workflow.Workflow.startJob("AbSystemAdministration-generatePaginatedReport-generatePpt",B,{fileName:"my-presentation.pptx"});var C=Ab.workflow.Workflow.getJobStatus(A);while(C.jobFinished!=true&&C.jobStatusCode!=8){C=Ab.workflow.Workflow.getJobStatus(A)}if(C.jobFinished){window.location=C.jobFile.url}$("#presentation_job_spinner").hide()}function openAppSpecificReportDialog(){var B=870;var D=1150;var E=PageNavUserInfo.webAppContextPath+PageNavUserInfo.homeTabHtmlFragment.replace(".html","-rpt.html");var C=$("#reportingDialog");C.attr("title","Graphics Sectors Report");C.attr("style","padding: 0");C.html('<iframe id="asb-report-frame" src="'+E+'" width="99%" height="99%"></iframe>');C.dialog({modal:true,autoOpen:false,draggable:false,width:500});var A=$(".ui-dialog-title");$(A).css("width","75%");$(A).after('<button class="ui-widget" id="reportButton" type="button" onClick="onReportButtonClick(event);" style="float:right;margin-right:30px;">Run Report</button>');C.dialog("option","position",{my:"right top",at:"right-10 top"});C.dialog("option","height",B);C.dialog("option","width",D);C.dialog("open")}function closeAppSpecificReportDialog(){$("#reportingDialog").dialog("close")}function onReportButtonClick(B){var A={};PageNavReportingConfig.capturedCount=0;var C=$("div.app-specific-bucket");$(C).each(function(G){var E=$(this).parent(".bucket-process");var F=$(E).attr("id");var D=$(E).children("h2")[0].innerHTML;A[F]={index:G,title:D,images:{}}});captureReportImages(A,C.length)}function constructRuntimeBuckets(){loadHorizontalBarCharts();loadProcessMetricsControls();loadAlertsBuckets();loadFavoritesBuckets();PageNavReportingConfig.bucketMapHash=loadMapControls();loadCustomCodeFiles()}function loadHorizontalBarCharts(){$(".horizontalBarChart").each(function(E){var D=$(this);var A=D.parents(".bucket-process").attr("id");var C=A+"_plot"+E;var B=getHorizontalBarChartConfig(D,A,E);if(!B.elementId){return }getDataAndConstructBarChart(B,C,D)})}function getDataAndConstructBarChart(A,B,E){var D=getPlotData(A,B);if(!D||D.length===0){return }D=preprocessBarChartData(A,D);var C=horizontalBarChartBucket_Plot(A,B,D);E.append(C);bindDrilldownBarHover()}function getHorizontalBarChartConfig(B,A,D){var C={elementId:A,bucketWidth:$("#"+A).width(),sortOrder:"desc",valueOnTop:"largest",abbreviateValues:"true",recordLimit:"5",useStoplightColors:"false",subtitle:"",controlIndex:D};if(B.attr("metricName")){C.metricName=B.attr("metricName")}if(B.attr("granularity")){C.granularity=B.attr("granularity")}if(B.attr("sortOrder")){C.sortOrder=B.attr("sortOrder")}if(B.attr("scorecard")){C.scorecard=B.attr("scorecard")}if(B.attr("useStoplightColors")){C.useStoplightColors=B.attr("useStoplightColors")==="true"?"true":"false"}if(B.attr("recordLimit")){C.recordLimit=B.attr("recordLimit")}if(B.attr("valueOnTop")){C.valueOnTop=B.attr("valueOnTop")}if(B.attr("subtitle")){C.subtitle=B.attr("subtitle")}if(B.attr("abbreviateValues")){C.abbreviateValues=B.attr("abbreviateValues")}if(B.attr("viewName")){C.viewName=B.attr("viewName")}if(B.attr("dataSourceId")){C.dataSourceId=B.attr("dataSourceId")}if(B.attr("valueField")){C.valueField=B.attr("valueField")}if(B.attr("labelField")){C.labelField=B.attr("labelField")}return C}function getPlotData(B,I){var E=[];try{if(valueExists(dwr.engine._scriptSessionId)){var R;var C;if(B.metricName){R=Ab.workflow.Workflow.callMethod("AbCommonResources-MetricsService-getTrendValuesForMetric",B.metricName,B.granularity,B.sortOrder);C=R.data}else{var P={viewName:B.viewName,dataSourceId:B.dataSourceId,restriction:B.restriction};R=Ab.workflow.Workflow.call("AbCommonResources-getDataRecords",P);C=R.data.records;var Q=B.valueField;var D=B.labelField}if(Ab.workflow.Workflow.sessionTimeoutDetected){E=false}else{if(!C||C.length===0){chartBucketErrorMessage(B,I,"nodata");E=false}else{if(C.length<B.recordLimit){B.recordLimit=C.length}var A=B.recordLimit;for(var G=0;G<A;G++){var H=C[G];if(!H){break}var M=0;var N="N/A";var K="None";var O="";if(B.metricName){M=H.metricValueRaw;N=H.metricValue;if(typeof (H.granularityValue)!=="undefined"&&B.granularity!=="all"){K=H.granularityValue}else{K=getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_ALL)}O=H.drillDownView}else{N=H[Q];M=H[Q+".raw"];if(!M){M=N}K=H[D]}var F={value:convertValue(M.toString()),formattedValue:N,barLabel:K,pointLabel:(B.abbreviateValues==="true"&&!B.metricName)?abbreviateValue(M.toString(),2,1):N,barClass:getBarClass(B.useStoplightColors,H.stoplightColor,M),drillDownView:O};E.push(F)}if(isReOrderDataNeeded(B,E)){E.reverse()}}}}else{console.log("Get plot data No DWR sessionId !")}}catch(J){chartBucketErrorMessage(B,I,"wfrerror");E=false}return E}function isReOrderDataNeeded(C,F){var E=false;var D=F[0].value;var B=F[F.length-1].value;var A=(D>=B)?"desc":"asc";if((A==="desc"&&C.valueOnTop==="smallest")||(A==="asc"&&C.valueOnTop==="largest")){E=true}return E}function getBarClass(D,A,C){var B="pos";if(D&&D==="true"){B=A}else{if(C<0){B="neg"}}return B}function preprocessBarChartData(B,E){var A=B.bucketWidth-75;var F=getMaxRecordValue(E);var D=E.length;for(var C=0;C<D;C++){if(E[C].value<0){E[C].value=E[C].value*-1}E[C].barLength=(E[C].value===0)?1:(E[C].value*A)/F}return E}function horizontalBarChartBucket_Plot(B,K,E){var A=B.elementId;$("#"+A).addClass("bar-metrics");var F="";if(K!=="modal-drilldown"){F+='<div id="'+K+'" class="hchart">'}else{F+='<div class="jsscroll hchart">'}if(B.subtitle&&B.subtitle.length>0){if(B.subtitle==="hidden"){B.subtitle="&nbsp;"}F+='<div class="hchart-title">'+B.subtitle+"</div>"}var N=E.length;for(var G=0;G<N;G++){var H=E[G];var J=H.drillDownView;var O="";var I="";if(J&&J.length>0){var C=H.barLabel.split(";");var M=C.length;for(var D=0;D<M;D++){J=J.replace("{"+D+"}",C[D])}O=' rel="'+J+'" onMouseUp="openAlertDrilldown(this, event);"';I="ellipses"}F+='<div class="bar-row"><span class="bar-title">'+H.barLabel+'</span><div class="bar '+H.barClass+" "+I+'" style="width:'+H.barLength+'px;"'+O+'>&nbsp;</div><div class="bar-point">'+H.pointLabel+"</div></div>"}F+="</div>";return F}function getMaxRecordValue(A){var E=0;var C=A.length;for(var B=0;B<C;B++){var D=Math.abs(A[B].value);if(D>E){E=D}}return E}function bindDrilldownBarHover(){$(".ellipses").hover(function(){$(this).html("...")},function(){$(this).html("&nbsp;")})}function abbreviateValue(C,H,G){var B=["K","M","B","T"];var A="";var F=C?C.replace(/,/g,""):0;if(F<0){F=Math.abs(F);A="-"}if(F>=1000){for(var E=B.length-1;E>=0;E--){var D=Math.pow(10,(E+1)*3);if(D<=F){F=Math.round(F*Math.pow(10,H)/D)/Math.pow(10,H);if((F===1000)&&(E<B.length-1)){F=1;E++}F=F.toLocaleString(PageNavUserInfo.locale.replace(/_/g,"-"),{minimumFractionDigits:H});F=(G===1)?A+F+B[E]:A+F;break}}}else{F=parseFloat(F).toLocaleString(PageNavUserInfo.locale.replace(/_/g,"-"),{minimumFractionDigits:H})}return F}function convertValue(A){var B=A?A.replace(/,/g,""):0;return B/1000}function loadProcessMetricsControls(){jQuery("div.processMetrics").each(function(G){var F=jQuery(this);var A=F.parents(".bucket-process").attr("id");var D=A+"_prmetric_"+G;var C=getProcessMetricsConfig(F,A,G);if(valueExists(dwr.engine._scriptSessionId)){var E=getProcessMetricData(C,D);if(E){var B=constructProcessMetricsMarkup(C,D,E);F.append(B);percentCompleteCharts(C.useStoplightColors);sparklineCharts(E,G);bindAssumptions();bindProcessMetricDrilldown()}}})}function getProcessMetricsConfig(B,A,D){var C={elementId:A,bucketWidth:jQuery("#"+A).width(),useStoplightColors:"false",controlIndex:D};if(B.attr("granularity")){C.granularity=B.attr("granularity")}if(B.attr("scorecard")){C.scorecard=B.attr("scorecard")}if(B.attr("useStoplightColors")){C.useStoplightColors=B.attr("useStoplightColors")}return C}function getProcessMetricData(A,F){var B=null;try{var I=Ab.workflow.Workflow.callMethod("AbCommonResources-MetricsService-getTrendValuesForScorecard",A.scorecard,A.granularity);if(Ab.workflow.Workflow.sessionTimeoutDetected){B=false}else{B=[];var H=I.data.length;for(var D=0;I.data&&D<H;D++){var E=I.data[D];var C={metricName:"",metricTitle:encodeURIComponent(E.metricTitle),metricValue:0,metricValueRaw:0,metricPreviousValues:0,metricValueChange:0,metricValueChangePerYear:0,reportLimitTarget:-1,reportTrendDir:0,barClass:"",description:"",assumptions:"",businessImplication:"",recurrence:""};if(E.metricName){C.metricName=encodeURIComponent(E.metricName)}if(E.assumptions){C.assumptions=encodeURIComponent(E.assumptions).replace(/%0D%0A/g,"<br/>")}if(E.description){C.description=encodeURIComponent(E.description).replace(/%0D%0A/g,"<br/>")}if(E.businessImplication){C.businessImplication=encodeURIComponent(E.businessImplication).replace(/%0D%0A/g,"<br/>")}if(E.recurrence){C.recurrence=encodeURIComponent(E.recurrence)}if(E.metricValue){C.metricValue=E.metricValue;C.metricValueRaw=E.metricValueRaw;C.reportLimitTarget=E.reportLimitTarget;C.metricValueChange=E.metricValueChange;C.metricValueChangePerYear=E.metricValueChangePerYear;C.reportTrendDir=E.reportTrendDir;C.metricPreviousValues=E.metricPreviousValues+";"+E.metricValueRaw;C.metricPreviousValues=C.metricPreviousValues.replace(/,/g,"").replace(/;/g,",");if(A.useStoplightColors&&A.useStoplightColors==="true"){C.barClass=E.stoplightColor}}B.push(C)}}}catch(G){chartBucketErrorMessage(A,F,"wfrerror");B=false}return B}function constructProcessMetricsMarkup(C,I,F){var P="";if(!C.elementId){return P}var A=getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_CHANGE);P+='<table id="'+I+'" class="process-metrics" style="width: '+C.bucketWidth+'px">';P+='<thead><tr><th class="mtitle">'+getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_METRIC)+'</th><th class="value">'+getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_CURRENT)+'</th><th class="value">'+A+'</th><th class="value">'+A+"<br>"+getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_PER_YEAR)+'</th><th class="chart">'+getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_TARGET_PERCENT)+'</th><th class="spark">'+getLocalizedString(pageNavStrings.z_PAGENAV_METRICS_TREND)+"</th></tr></thead>";var M=F.length;for(var K=0;K<M;K++){var H=F[K];var N=H.metricValue;var J=H.reportLimitTarget;var G=(K%2===0)?"even":"odd";var B=(C.useStoplightColors==="true")?H.barClass:"";var E=(H.reportTrendDir!=3)?"pchart":"";var O=getPmCurrentValue(N,J,H.metricValueRaw);var D=getCurrentValueType(J);P+='<tr class="'+G+'"><td class="pmtitle" data-description="'+H.description+'" data-assumptions="'+H.assumptions+'" data-business-implication="'+H.businessImplication+'" data-recurrence="'+H.recurrence+'"><span>'+decodeURIComponent(H.metricTitle)+'</span></td><td class="value">'+N+'</td><td class="value '+B+'">'+H.metricValueChange+'</td><td class="value '+B+'">'+H.metricValueChangePerYear+'</td><td style="padding-left: 15px" class="'+E+' processMetricDrilldown" data-metric-name="'+H.metricName+'" data-bar-class="'+B+'" data-current-value="'+O+'" data-value-type="'+D+'"><div class="target"></div></td><td id="sparkline_'+C.controlIndex+"_"+K+'" class="sparkline">'+H.metricPreviousValues+"</td></tr>"}P+="</table>";return P}function getPmCurrentValue(B,C,A){var D=-1;if(C>0){D=((A/C)*100).toFixed(0)}else{if(C===0){D=B}}return D}function getCurrentValueType(A){var B="none";if(A>0){B="pct"}else{if(A===0){B="int"}}return B}function sparklineCharts(C,B){var I=C.length;for(var G=0;G<I;G++){var D=C[G];var H=D.reportLimitTarget;var A=PageNavUserInfo.locale.substr(0,2);var E=A==="en"||A==="zh"||A==="ja"||A==="ko"?".":",";var K=E==="."?",":".";var J={width:"70px",normalRangeMin:H,normalRangeMax:H,numberDecimalMark:E,numberDigitGroupSep:K};var F=jQuery("#sparkline_"+B+"_"+G);if(F){jQuery("#sparkline_"+B+"_"+G).sparkline("html",J)}}}function percentCompleteCharts(A){jQuery(".pchart").each(function(){var E=jQuery(this).width();var C=this.dataset;if(!C){C={currentValue:jQuery(this).attr("data-current-value"),valueType:jQuery(this).attr("data-value-type")}}var D=C.currentValue;var H=C.valueType;var B=(H==="pct")?((E*D)/100)+1:E;if(B>E){B=E}var G=(H==="pct")?D+"%":D;if(H!=="none"){var F="bar100";if(A==="true"){F=jQuery(this).attr("data-bar-class")}else{if(D>=0&&D<=25){F="bar25"}else{if(D>25&&D<=50){F="bar50"}else{if(D>50&&D<=75){F="bar75"}}}}jQuery(this).html('<div class="target" style="width: '+E+'px"><div class="current '+F+'" style="width:'+B+'px"></div></div><span class="'+F+'">'+G+"</span>")}})}function chartBucketErrorMessage(A,C,D){if(!A.elementId){return }var B=(D==="wfrerror")?getLocalizedString(pageNavStrings.z_PAGENAV_BUCKET_DEF_ERROR):getLocalizedString(pageNavStrings.z_PAGENAV_NO_DATA_AVAILABLE);if(C==="modal-drilldown"){jQuery("#modal-drilldown").html(B)}else{var F=A.elementId;var E=jQuery("#"+F);jQuery("#"+C).remove();E.addClass("bar-metrics");E.append('<div id="'+C+'" class="hchart error"><span class="error">'+B+"</span></div>")}}function bindProcessMetricDrilldown(){jQuery.contextMenu({selector:".processMetricDrilldown",trigger:"left",build:function(C,K){var J=jQuery(K.currentTarget).attr("data-metric-name");var M=jQuery(K.currentTarget).prevAll(".pmtitle").children().html();var D="afm_metric_grans.metric_name='"+J+"'";try{var O={viewName:"ab-metric-drilldown-granularities",dataSourceId:"metricDrilldownData_ds",restriction:D};var P=Ab.workflow.Workflow.call("AbCommonResources-getDataRecords",O);var E=P.data.records;if(Ab.workflow.Workflow.sessionTimeoutDetected){return{name:"timeout",role:"timeout"}}else{if(E&&E.length>0){var N={};var G=E.length;for(var H=0;H<G;H++){var I=E[H];var F=I["afm_metric_gran_defs.collect_group_by"];var A=I["afm_metric_gran_defs.granularity_title"];var B={};B[F]={name:A,icon:"chart",callback:function(R,Q){popupBarchart(J,M,R)}};jQuery.extend(N,B);if(F.indexOf("bl_id")>=0||F.indexOf("site_id")>=0){var B={};B[F+" Location"]={name:A+" Location",icon:"map",callback:function(R,Q){popupMap(J,M,R)}};jQuery.extend(N,B)}}return{callback:function(S,R){var Q="clicked: "+S;window.console&&console.log(Q)},items:N}}}return false}catch(K){Workflow.handleError(K)}}})}function popupBarchart(D,F,E){var C='<div id="modal-drilldown" style="padding:12px 8px"></div>';var A=jQuery(C).dialog({title:F,autoOpen:false,height:400,width:280,resizable:false,modal:true,open:function(){jQuery(".ui-dialog-titlebar-close").show()},close:function(){jQuery("#modal-drilldown").remove()}});var B={elementId:"modal-drilldown",bucketWidth:260,sortOrder:"desc",valueOnTop:"largest",recordLimit:"200",useStoplightColors:"true",abbreviateValues:"true",subtitle:"",metricName:D,granularity:E};A.dialog("open");getDataAndConstructBarChart(B,"modal-drilldown",jQuery("#modal-drilldown"));Ab.view.Scroller(jQuery(".jsscroll"));return false}function popupMap(E,G,F){var D='<div id="modal-drilldown" style="padding:12px 8px"></div>';var A=jQuery(D).dialog({title:G,autoOpen:false,height:"auto",width:"auto",resizable:false,modal:true,open:function(){jQuery(".ui-dialog-titlebar-close").show()},close:function(){jQuery("#modal-drilldown").remove()}});if(F.indexOf(" Location")>=0){F=F.replace(" Location","")}var C;if(F.indexOf("bl_id")>=0){C="bl"}else{if(F.indexOf("site_id")>=0){C="site"}}var B={elementId:"modal-drilldown",bucketWidth:550,sortOrder:"desc",valueOnTop:"largest",recordLimit:"200",useStoplightColors:"true",abbreviateValues:"true",subtitle:"",metricName:E,granularity:F,granularityLocation:C,mapImplementation:"ESRI",basemapLayer:"World Light Gray Canvas",markerRadius:"5",popupMap:true};A.dialog("open");getDataAndConstructMap(B,"modal-drilldown",jQuery("#modal-drilldown"));Ab.view.Scroller(jQuery(".jsscroll"));return false}function bindAssumptions(){jQuery(".pmtitle").click(function(){var B=this.dataset;if(!B){B={description:jQuery(this).attr("data-description"),assumptions:jQuery(this).attr("data-assumptions"),businessImplication:jQuery(this).attr("data-business-implication"),recurrence:jQuery(this).attr("data-recurrence")}}var A=jQuery(this).children("span").html().replace(/&amp;/g,"&");popupAssumptions(B.description,B.assumptions,B.businessImplication,B.recurrence,A)})}function popupAssumptions(H,B,E,G,A){var C='<div id="modal-otherdata" style="padding:16px"></div>';var F=jQuery(C).dialog({title:A,autoOpen:false,height:350,width:500,resizable:false,modal:true,open:function(){jQuery(".ui-dialog-titlebar-close").show()},close:function(){jQuery("#modal-otherdata").remove()}});var D='<div class="jsscroll" style="padding: 16px">';D+='<div style="font-weight: bold">'+getLocalizedString(pageNavStrings.Z_PAGENAV_METRICS_ASSUMPTIONS_DESCRIPTION)+":</div>";D+='<div style="margin-bottom: 8px">'+decodeURIComponent(H)+"</div>";D+='<div style="font-weight: bold">'+getLocalizedString(pageNavStrings.Z_PAGENAV_METRICS_ASSUMPTIONS)+":</div>";D+='<div style="margin-bottom: 8px">'+decodeURIComponent(B)+"</div>";D+='<div style="font-weight: bold">'+getLocalizedString(pageNavStrings.Z_PAGENAV_METRICS_ASSUMPTIONS_BSN_IMPL)+":</div>";D+='<div style="margin-bottom: 8px">'+decodeURIComponent(E)+"</div>";D+='<div style="font-weight: bold">'+getLocalizedString(pageNavStrings.Z_PAGENAV_METRICS_ASSUMPTIONS_RECURRENCE)+":</div>";D+='<div style="margin-bottom: 8px">'+decodeURIComponent(G)+"</div>";D+="</div>";F.dialog("open").html(D);Ab.view.Scroller(jQuery(".jsscroll"));return false}function includeMapControlRuntimes(){var B=false;var A=jQuery("#homeTabView").find("div.pgnav-map");if(A&&A.length>0){B=true;if(typeof loadMapControls!=="function"){dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/vendor/leaflet.js");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/css/vendor/leaflet.css");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/css/ab-pgnav-map.css");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/css/MarkerCluster.Default.css");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/css/MarkerCluster.css");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/vendor/esri-leaflet.js");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/vendor/google-maps-api.js");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/leaflet-google.js");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/ab-pgnav-map.js");dynamicallyLoadCodeFile(PageNavUserInfo.webAppContextPath+"schema/ab-core/page-navigation/js/leaflet-markercluster.js")}}return B}function setBreadCrumbs(C,N){if(!C||C.length===0){return }var D=$("#breadCrumbContent");var E=D.find("ol");var B=E.length>0;var H=false;if(!B){var J=D.find(".hovertip_wrap3");var F=$(C).parents(".bucket-process").siblings(".application-process-title").filter(":first");if(F&&F.length>0){J.append('<div class="bread-crumb-application-title">'+toCapitalized(F.text())+"</div>")}var P=$(C).parents(".bucket-wrapper").siblings(".process-title").filter(":first");if(P&&P.length>0){J.append('<div class="bread-crumb-process-title">'+P.text()+"</div>")}var A=$(C).parents(".bucket-wrapper").find("ol.ptask-labels");if(A.length>0){var I=A.length;for(var G=0;G<I;G++){var M=$(A[G]).clone();$(M).removeClass("ptask-labels").addClass("bread-crumb-ptask-label");$(M).find(".process-tasks").removeClass("process-tasks").addClass("bread-crumb-process-tasks");J.append($(M).first());H=true}}else{var K=[];var O=[];getSiblingTaskLabelsAndLinkIds(C,K,O);if(K.length>1){J.append(createListElementFromTaskSiblings(K,O,N));H=true}}D.find("a").click(function(){return false})}if(H){$("#breadCrumbContainer").show()}}function positionBreadCrumbs(){var F=285;var D=30;var C=$(".ui-tabs-nav li a");var A=parseFloat(C.first().css("padding-left"));var E=parseFloat(C.first().css("padding-right"));var B=$("#tabLabelHome").width()+$("#tabLabelApplication").width()+(2*A)+(2*E);$("#breadCrumbContainer").css("left",F+B+D)}function getSiblingTaskLabelsAndLinkIds(E,H,D){var B=$(E).parent();var G=$(B).parent().parent().children("ol").children().children();var A=G.length;for(var C=0;C<A;C++){if($(G[C]).hasClass("favorites-target")){continue}var F=removeImgElemIfExists(G[C].innerHTML);if(H&&H.length>0&&H.indexOf(F)<0){H.push(F);D.push($(G[C]).attr("href"))}}}function createListElementFromTaskSiblings(F,E,B){var D='<ul class="bread-crumb-list">';var A=F.length;for(var C=0;C<A;C++){D+='<li class="bread-crumb-link"><a href="'+E[C]+'" rel="'+B+'">'+F[C]+"</a></li>"}D+="</ul>";return D}function breadCrumbSelectChanged(F,A){A=A||window.event;if(A){F=A.target||A.srcElement}$("#breadCrumbContent").hide();var K=F.rel;var B=window.location.href;var J=B.lastIndexOf(PageNavUserInfo.webAppContextPath);var C=$(F).attr("href");if(C.substr(0,7)!=="http://"&&C.lastIndexOf("/")>0){C=C.substr(C.lastIndexOf("/")+1)}if((K==="eTask"||K==="pTask")&&J>0){var H=(K==="eTask")?"#tabPageNavigationHome":"#applicationsViewParent";var I=(K==="eTask")?"taskFrame":"pTaskFrame";var G="#"+I;$(G).remove();$(H).prepend('<iframe class="task-view" id="'+I+'"></iframe>');var E=C.substr(0,7)==="http://"?C:B.substring(0,J+PageNavUserInfo.webAppContextPath.length)+C;$(G).attr("src",E);pushState(K,C)}else{if(K==="process"&&J>0){var D=window.location.href.substring(0,J+9)+PageNavUserInfo.generationDirectory+C;var M=$("#applicationsProcessView");M.empty();M.load(D);M.show();hideTaskFrame();hidePTaskFrame()}}setPageDimensions()}function removeImgElemIfExists(C){var A=C.indexOf("<img ");if(A>=0){var B=C.indexOf(">",A);C=C.substr(0,A)+C.substr(B+1)}return $.trim(C)}function toCapitalized(A){var C=A.toLowerCase().split(" ");var B="";for(var D=0,E;E=C[D];D++){if($.trim(E).length>0){B+=E.charAt(0).toUpperCase()+E.substr(1)+" "}}return $.trim(B)}function setUserHeader(H){if(H&&H.name){var J=getArrayFromContextString(context.homeTabTitles);var G=getArrayFromContextString(context.homeTabFileNames);if(G&&G.length>0){PageNavUserInfo.homeTabHtmlFragment=PageNavUserInfo.generationDirectory+PageNavUserInfo.localeDirectory+PageNavUserInfo.roleDirectory+G[0]}var A='<div><table class="profile-menu" id="profileMenuTable"><tr><td id="userMenuProject" class="profile-item-title">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PROJECT)+"</td></tr><tr><td>"+H.projectName+'</td></tr><tr><td id="userMenuRole" class="profile-item-title">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_ROLE)+"</td></tr><tr><td>"+H.role+'</td></tr><tr><td id="userMenuVersion" class="profile-item-title">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_VERSION)+"</td></tr><tr><td>V "+H.serverVersion+'</td></tr><tr><td style="height:1px;"></td></tr><tr><td><a id="myProfileMenuLink" href="ab-my-user-profile.axvw" onClick="openSoloTask(this, event);" rel="eTask">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PROFILE)+'</a></td></tr><tr><td><a id="myJobsMenuLink" href="ab-my-jobs.axvw" onClick="openSoloTask(this, event);" rel="eTask">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_JOBS)+'</a></td></tr><tr><td><a id="myPresentationsMenuLink" href="ab.axvw" onClick="writeAppSpecificBucketReport(this, event);" rel="eTask">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_PRESENTATIONS)+'</a><div id="presentation_job_spinner" style="display:none" class="spinner"></div></td></tr>';var F=J.length>0;var B=H.groups.length;for(var E=0;F&&E<B;E++){if(H.groups[E]==="SYS-VIEW-ALTER"){A+='<tr><td><a id="myEditorMenuLink" href="ab-pgnav-manage-homepage-editor.axvw" onClick="openPageEditorTask(this, event);" rel="eTask">'+getLocalizedString(pageNavStrings.z_NAVIGATOR_USERMENU_EDITOR)+"</a></td></tr>";break}}if(F){A+='<tr><td><hr style="margin:0.2em 0;"></td></tr>'}for(var D=0,C;C=J[D];D++){A+='<tr><td><a href="'+G[D]+'" onclick="changeHomeTab(this,event)">'+C+"</a></td></tr>"}A+="</table></div>";$("#bannerMenu").append('<a id="bannerMenuUserLink"><div class="banner-user-menu-container">'+H.name.substr(0,28).trim()+'<b class="caret"/></div></a><div class="hovertip" target="bannerMenuUserLink">&nbsp;</div>');var I=$("div.hovertip[target='bannerMenuUserLink']");$(I).empty();$(I).append(A);$("a#bannerMenuUserLink").click(function(){return false});$("#profileMenuTable").find("a").click(function(){return false})}}function openTask(C,B){B=B||window.event;if(B){C=B.target||B.srcElement}if(B&&(B.button===2||B.which===3||signOutOnTimeOut()||wasFavoritesDrag(C))){return false}var D=$(C).attr("href");var A=$(C).attr("rel");if(D&&A){window.taskInfo=getTaskInfo(C);setBreadCrumbs(C,A);if("http"===D.substr(0,4)&&D.indexOf("_help/archibus_help/archibus.htm#")>0){D=context.archibusHelpLink.substring(0,context.archibusHelpLink.indexOf("archibus_help/user")+18)+context.userHelpExtension+"/archibus.htm#"+D.substring(D.indexOf("archibus.htm#")+13);D=D.replace(/\\/g,"/")}else{if("http"!==D.substr(0,4)){D=D.replace("(user.helpExtension)",context.userHelpExtension);setDisplayContainers("#taskFrame",D)}}pushState(A,D);setPageDimensions()}return false}function openPtask(E,D){D=D||window.event;if(D){E=D.target||D.srcElement}if(D&&(D.button===2||D.which===3||signOutOnTimeOut())){return false}if(wasElementDragged(E)&&$(E).is("a")){returnElementToUndraggedPosition(E);return false}var B=$(E).attr("href");var A=$(E).attr("rel");if(B&&A){window.taskInfo=getTaskInfo(E);setBreadCrumbs(E,A);B=standardizeTaskFile(B);pushState(A,B);setDisplayContainers("#pTaskFrame",B);var C=$("#applicationsProcessView");C.hide();C.css("display","none");$("#applicationsTabView").hide();setPageDimensions()}return false}function openProcess(C,B){B=B||window.event;if(B){C=B.target||B.srcElement}if(B.button===2||B.which===3){return false}if(signOutOnTimeOut()){return false}var D=$(C).attr("href");var A=$(C).attr("rel");if(D&&A){pushState("process",D);setDisplayContainers("#applicationsProcessView",D);$("#applicationsTabView").hide()}return false}function wasElementDragged(B){var C=false;var A=parseFloat($(B).css("left"));var D=parseFloat($(B).css("top"));if(isNumber(A)&&(Math.abs(A)>2||isNumber(D))&&Math.abs(D)>2){C=true}return C}function isNumber(A){return !isNaN(parseFloat(A))&&isFinite(A)}function loadQuasiFrameAndDisplay(E,D,A){var C=$(E).attr("rel");if(!C||(C&&C!==D)||(C&&$(E).children().length===0)){var B=A+D;$(E).empty();$(E).attr("rel",D);$(E).load(B)}$(E).show()}function setDisplayContainers(E,D){var B=window.location.href;var A=B.substring(0,B.lastIndexOf(PageNavUserInfo.webAppContextPath)+PageNavUserInfo.webAppContextPath.length);var F=D.indexOf("http")===0?D:A+D;$("ul.ui-tabs-nav > li").removeClass("ui-task-tab-active").addClass("ui-state-default");if(E==="#applicationsProcessView"){loadQuasiFrameAndDisplay(E,PageNavUserInfo.generationDirectory+PageNavUserInfo.localeDirectory+PageNavUserInfo.roleDirectory+D,A);$(".nav-pages").show();$("#navPagesApps").hide();hideTaskFrame();hidePTaskFrame();$("li.ui-tabs-active").removeClass("ui-task-tab-active").addClass("ui-state-active").addClass("ui-state-default")}else{if((E==="#taskFrame"||E==="#pTaskFrame")&&$(E).length){var C=$(E).attr("src");if(!C||(C&&C.lastIndexOf("/")>0&&C.substr(C.lastIndexOf("/")+1)!==D)){$(E).attr("src",F);$(".nav-pages").hide();$(E).show();$("#homeTabView").hide();$("li.ui-tabs-active").removeClass("ui-task-tab-active").addClass("ui-state-active").addClass("ui-state-default")}}else{if(E==="#taskFrame"){showTaskFrame(E,$("#tabPageNavigationHome"),$("#homeTabView"),F)}else{if(E==="#pTaskFrame"){showTaskFrame(E,$("#applicationsViewParent"),null,F)}}}}setPageDimensions()}function showTaskFrame(E,C,A,G){$("li.ui-tabs-active").removeClass("ui-state-active").removeClass("ui-state-default").addClass("ui-task-tab-active");if($(E).length===0){$(C).prepend('<iframe class="task-view" id="'+E.substr(1)+'"></iframe>')}else{$(E).show()}var D=$(E).contents().find("body");var B=$("#navigationTabs").find("ul.ui-widget-header").find('li.ui-task-tab-active[aria-selected="true"]:first');var F=$(B).css("background-color");$(D).append('<div style="position:relative;top:-8px;left:-10px;height:28px;width:100%;margin:0;background:'+F+';">&nbsp;</div>');$(E).show();if(A){$(A).hide()}$(".nav-pages").hide();setPageDimensions();$(E).attr("src",G)}function openSoloTask(B,A){restoreTab(0);if($("#tabPageNavigationHome").length){openTask(B,A)}else{$(B).attr("rel","pTask");openPtask(B,A)}}function openPageEditorTask(F,E){var A=$(F).attr("href");var D=A.indexOf("?");A=D>0?A.substr(0,D):A;var B=PageNavUserInfo.homeTabHtmlFragment;B=B.substr(B.lastIndexOf("/")+1);B=B.replace(".html",".xml");var G=$("#tabLabelHome").html();var C=A+"?descriptorfile="+B+"&processid="+G;$(F).attr("href",C);openSoloTask(F,E)}function getActiveTabId(){var A;if($("#tabHome").parent("li").hasClass("ui-state-active")){A="#tabPageNavigationHome"}else{if($("#tabApplications").parent("li").hasClass("ui-state-active")){A="#tabPageApplications"}else{A="unknown"}}return A}function standardizeTaskFile(A){var B=A;if(B.indexOf("ab-products")===0){B="schema/"+B}return B}function getTaskInfo(B){var A={activityId:"",processId:"",taskId:$(B).attr("data-taskId")};var D=$(B).attr("data-activityId");if(D){A.activityId=D;A.processId=$(B).attr("data-processId")}else{var C=$(B).parents(".bucket-application,.bucket-process");if(C.length>0){C=$(C)[0];A.activityId=$(C).attr("data-activityId");A.processId=$(C).attr("data-processId")}}return A}Ab.namespace("view");Ab.view.type="page-navigation";window.location.parameters={};if(!(window.console&&console.log)){(function(){var D=function(){};var B=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","markTimeline","table","time","timeEnd","timeStamp","trace","warn"];var C=B.length;var A=window.console={};while(C--){A[B[C]]=D}}())}Ab.namespace("homepage");Ab.homepage.EditorController=new (Base.extend({maxColumnsPerRow:4,loadDescriptor:function(A,B){var C=Ab.homepage.EditorServices.fetchDescriptor("",A,B);this.loadDescriptorIntoEditor(C)},loadDescriptorIntoEditor:function(C){var E=jQuery("#pageEditorPanel_title");var D="";var A="";var B=jQuery("#applicationsTabView");jQuery(B).empty();jQuery("#pageAttributes").data("abstractBlockCounter","0");jQuery("#pageAttributes").data("pagePanelCounter","0");if(C!=null&&C.descriptorXml!=null&&C.descriptorXml.length>0){D=decodeURI(C.processId);A=C.descriptorFileName;jQuery(B).append(this.getViewFromDescriptorXml(C.descriptorXml));jQuery(B).show();this.initializeRowMovementControls();this.initializeRowHeightSelections();this.initializeRowDividerButtons();this.setRowNames();Ab.homepage.EditorSortable.initializeDragDropSortables()}jQuery("#pageAttributes").data("currentDescriptorProcess",D);jQuery("#pageAttributes").data("currentDescriptorFile",A);jQuery(E).text(D);jQuery(E).attr("title",A);pgnavPageEditorController.isDirty=false},getViewFromDescriptorXml:function(B){var D=new DOMParser();var C=D.parseFromString(B,"text/xml");var A=Ab.homepage.EditorParser.parseDescriptorToModel(C);return Ab.homepage.EditorView.createDisplayFromModel(A)},initializeRowHeightSelections:function(){jQuery(".row-palette").each(function(){var B=jQuery(this).data("height");var A=jQuery(this).find("a.row-height-"+B);jQuery(A).addClass("active")})},initializeRowMovementControls:function(){var C=jQuery("div.row-palette");var A=C.length;var B=0;jQuery(C).each(function(){var D=jQuery(this).find("a.row-move-up");var E=jQuery(this).find("a.row-move-down");jQuery(D).css("display",(B==0)?"none":"block");jQuery(E).css("display",(B==(A-1))?"none":"block");B++})},initializeRowDividerButtons:function(){var F=jQuery("#editorPage");var D=jQuery(F).children("div").filter(".page-row,.page-break-banner");var G=D.length;for(var C=1;C<G;C++){var H=D[C];var E=D[C-1];var A=jQuery(E).find(".page-divider-button");var B="block";if(jQuery(H).hasClass("page-break-banner")&&jQuery(E).hasClass("page-row")){B="none"}jQuery(A).css("display",B)}},deleteRow:function(B){var D=jQuery(B).closest(".page-row");var A=this;var C=getLocalizedString(Ab.homepage.EditorView.z_MESSAGE_CONFIRM_ROW_DELETE);View.confirm(C,function(E){if(E==="yes"){pgnavPageEditorController.isDirty=true;jQuery(D).remove();A.initializeRowMovementControls();A.initializeRowDividerButtons();A.setRowNames()}})},deleteBucket:function(C){var B=jQuery(C).closest(".bucket-process");var D=getLocalizedString(Ab.homepage.EditorView.z_MESSAGE_CONFIRM_PANEL_DELETE);var A=this;View.confirm(D,function(E){if(E==="yes"){pgnavPageEditorController.isDirty=true;jQuery(B).remove();A.addNewBucketControlWhereNeeded()}})},duplicateBucket:function(B){pgnavPageEditorController.isDirty=true;var C=jQuery(B).closest(".bucket-process");var A={attributes:Ab.homepage.EditorParser.getBucketDataAttributes(C,false)};var D=Ab.homepage.EditorView.getBucketHtml(A);jQuery(C).after(D);this.flowBucketsToMaxFourColumnsPerRow();this.initializeRowMovementControls();this.addNewBucketControlWhereNeeded();this.setRowNames();Ab.homepage.EditorSortable.initializeDragDropSortables()},addPageDivider:function(B){pgnavPageEditorController.isDirty=true;var C=jQuery(B).closest("div.page-row");var A=Ab.homepage.EditorView.getPageDividerHtml({attributes:{title:getLocalizedString(Ab.homepage.EditorView.z_TOOLTIP_ADDITIONAL_TASKS),index:Ab.homepage.EditorView.getNextAbstractBlockIndex()}});jQuery(C).after(A);jQuery(B).css("display","none")},editPageDividerProperties:function(B){var C=jQuery(B).closest(".page-break-banner");var D=jQuery(C).attr("id");var A=Ab.homepage.EditorParser.getBucketDataAttributes(C,false);pgnavPageEditorController.pageDividerForm.showInWindow({width:600,closeButton:true,modal:true,title:getLocalizedString(Ab.homepage.EditorView.z_TOOLTIP_DIVIDER_PROPERTIES)});pgnavPageEditorController.initializePageDividerForm(A,D)},deletePageDivider:function(A){var B=jQuery(A).closest(".page-break-banner");var C=getLocalizedString(Ab.homepage.EditorView.z_MESSAGE_CONFIRM_DIVIDER_DELETE);View.confirm(C,function(E){if(E==="yes"){pgnavPageEditorController.isDirty=true;var D=jQuery(B).prev();var F=jQuery(D).find(".row-palette");var E=jQuery(F).find(".page-divider-button");jQuery(E).css("display","block");jQuery(B).remove()}})},flowBucketsToMaxFourColumnsPerRow:function(){var F=jQuery(".editor-page").children("div.page-row");var C=F.length;for(var H=0;H<C;H++){var G=jQuery(F.get(H));var A=this.getRowBucketsColumnSpan(jQuery(G).children(".bucket-process"));while(A>this.maxColumnsPerRow){if(H>=(F.length-1)){this.addEmptyRow()}var E=jQuery(G).children(".bucket-process");var D=jQuery(E)[E.length-1];var B=jQuery(F.get(H+1)).find(".row-palette");jQuery(D).insertAfter(B);F=jQuery(".editor-page").children("div.page-row");G=jQuery(F.get(H));A=this.getRowBucketsColumnSpan(jQuery(G).children(".bucket-process"))}}Ab.homepage.EditorSortable.initializeDragDropSortables()},shiftRowUp:function(A){this.shiftRow(A,true)},shiftRowDown:function(A){this.shiftRow(A,false)},shiftRow:function(C,F){var E=jQuery(".page-row");var D=jQuery(C).closest("div.page-row");var H=jQuery(D).attr("id");var A=E.length;for(var B=0;B<A;B++){var G=jQuery(E[B]).attr("id");if(H===G){pgnavPageEditorController.isDirty=true;if(F){jQuery(E[B-1]).before(jQuery(D))}else{if((B<A-1)){jQuery(D).before(jQuery(E[B+1]))}}this.initializeRowMovementControls();this.initializeRowDividerButtons();this.setRowNames();break}}},editBucketProperties:function(C){var B=jQuery(C).closest(".bucket-process");var F=jQuery(B).attr("id");var E=Ab.homepage.EditorParser.getBucketDataAttributes(B,false);var D=this.getRestrictionFromAttributes(E);var A=400;if("horizontalBarChart"===E.controltype||"pgnav-map"===E.controltype){A=500}View.dialogRestriction=D;pgnavPageEditorController.bucketPropertiesForm.showInWindow({width:600,closeButton:true,modal:true,height:A,title:getLocalizedString(Ab.homepage.EditorView.z_LABEL_PROPERTIES)+": "+E.title});pgnavPageEditorController.initializeBucketPropertiesForm(D,F)},editBucketAssociate:function(D){var C=jQuery(D).closest(".bucket-process");var E=jQuery(C).attr("id");var F=Ab.homepage.EditorParser.getBucketDataAttributes(C,false);var B=this.getRestrictionFromAttributes(F);View.dialogRestriction=B;var A=this;if("process"===F.type&&F.activity_id&&F.process_id){pgnavPageEditorController.assignedTasksGrid.showInWindow({width:1200,modal:true,closeButton:true,title:getLocalizedString(Ab.homepage.EditorView.z_LABEL_TASKS_ASSIGNED)+": "+F.process_id});pgnavPageEditorController.assignedTasksGrid.refresh(B,false,false)}else{if("processMetrics"===F.controltype||"alertsList"===F.controltype){View.openDialog("ab-metric-scorecard-def.axvw?scorecard="+F.scorecard+"&parentview=homepageeditor",null,true,{width:1050,height:1200,closeButton:false,title:getLocalizedString(Ab.homepage.EditorView.z_LABEL_DEFINE_SCORECARD),callback:function(G){A.updateAppSpecificScorecard(E,G)}})}else{if("horizontalBarChart"===F.controltype||"pgnav-map"===F.controltype){if(F.metricname){View.openDialog("ab-metric-metrics-def.axvw?metricname="+F.metricname+"&parentview=homepageeditor",null,true,{width:1050,height:1200,closeButton:false,title:getLocalizedString(Ab.homepage.EditorView.z_LABEL_DEFINE_METRIC),callback:function(G){A.updateAppSpecificMetric(E,G)}})}else{if(F.viewname){View.showMessage(getLocalizedString(Ab.homepage.EditorView.z_TOOLTIP_VIEWNAME_CHART_EDIT))}}}else{if("process"===F.type){View.showMessage(getLocalizedString(Ab.homepage.EditorView.z_MESSAGE_ASSIGN_ACTIVITY_PROCESS))}else{View.showMessage(getLocalizedString(Ab.homepage.EditorView.z_MESSAGE_ASSIGN_CONTROL_TYPE))}}}}},updateAppSpecificMetric:function(D,C){pgnavPageEditorController.isDirty=true;var A=jQuery("#"+D);jQuery(A).data("metricname",C);var E=D.substr("bucket_".length);var B=jQuery(A).data();jQuery("#table_"+E).replaceWith(Ab.homepage.EditorView.getAppSpecificBucketPropertiesTable(E,B))},updateAppSpecificScorecard:function(D,C){pgnavPageEditorController.isDirty=true;var A=jQuery("#"+D);jQuery(A).data("scorecard",C);var E=D.substr("bucket_".length);var B=jQuery(A).data();jQuery("#table_"+E).replaceWith(Ab.homepage.EditorView.getAppSpecificBucketPropertiesTable(E,B))},addNewBucketControlWhereNeeded:function(){var D=jQuery(".editor-page").children("div.page-row");var B=D.length;for(var H=0;H<B;H++){var F=jQuery(D.get(H));var A=this.getRowBucketsColumnSpan(jQuery(F).children(".bucket-process"));var E=jQuery(F).children(".new-panel-container");if(A<this.maxColumnsPerRow&&E.length===0){jQuery(F).append(Ab.homepage.EditorView.getNewBucketControlHtml())}else{if(A==this.maxColumnsPerRow&&E.length>0){jQuery(E).css("display","none")}else{if(A<this.maxColumnsPerRow&&E.length===1){var G=jQuery(F).children();var C=G[G.length-1];if(jQuery(C).hasClass("bucket-process")){jQuery(E).remove();jQuery(F).append(Ab.homepage.EditorView.getNewBucketControlHtml())}else{if(jQuery(C).hasClass("new-panel-container")&&"none"===jQuery(C).css("display")){jQuery(C).css("display","block")}}}}}}},addNewRow:function(){this.addEmptyRow();this.setRowNames();this.initializeRowMovementControls();Ab.homepage.EditorSortable.initializeDragDropSortables()},addEmptyRow:function(){pgnavPageEditorController.isDirty=true;var A=Ab.homepage.EditorView.getNextAbstractBlockIndex();var B={index:A,attributes:{height:"half"}};var C='<div class="page-row half-height" id="pageRow_'+A+'">'+Ab.homepage.EditorView.getRowPaletteHtml(B)+Ab.homepage.EditorView.getNewBucketControlHtml()+"</div>";jQuery("#newRowControlContainer").before(C);return A},addEmptyBucketToRow:function(B){var C=jQuery(B).closest("div.page-row");if(C&&C.length>0){var A=this.getRowBucketsColumnSpan(jQuery(C).children(".bucket-process"));if(A>=this.maxColumnsPerRow){alert("You've had enough!");return }pgnavPageEditorController.isDirty=true;var D=jQuery(C).find(".new-panel-container");jQuery(D).before(Ab.homepage.EditorView.getEmptyBucketHtml());A=this.getRowBucketsColumnSpan(jQuery(C).children(".bucket-process"));if(A>=this.maxColumnsPerRow){jQuery(D).hide()}}},getRowBucketsColumnSpan:function(D){var C=0;var B=D.length;for(var A=0;A<B;A++){C+=this.getBucketColumnSpan(D[A])}return C},getBucketColumnSpan:function(D){var A=1;var B=D.attributes.columnSpan||D.attributes.columnspan;var C=jQuery(D).data("columnspan")||jQuery(D).data("columnSpan");if((B&&B==="2")||(C&&C===2)){A=2}return A},setRowNames:function(){var B=jQuery(".row-palette");var A=1;jQuery(B).each(function(F){var D=jQuery(this).find("h2");var E=jQuery(D).html();var C=E.substr(0,E.indexOf(" "))+" "+A+E.substr(E.indexOf("<a "));jQuery(D).html(C);A++})},setRowHeight:function(B,E,A){pgnavPageEditorController.isDirty=true;var D=jQuery("#pageRow_"+E);var C=jQuery(B).closest("div.bucket-wrapper");jQuery(D).removeClass("three-quarter-height half-height full-height");jQuery(D).addClass(A+"-height");jQuery(D).children(".row-palette").data("height",A);jQuery(C).find("a.row-height").removeClass("active");jQuery(B).addClass("active")},getRestrictionFromAttributes:function(C){var B=new Ab.view.Restriction();for(var A in C){if(C.hasOwnProperty(A)){B.addClause("afm_ptasks."+A,C[A],"=")}}return B}}));Ab.namespace("homepage");Ab.homepage.EditorSortable=new (Base.extend({initializeDragDropSortables:function(){jQuery(".page-row").sortable({handle:".process-title",containment:"#editorPage",cancel:".row-palette",connectWith:".page-row",helper:"clone",placeholder:"sortable-placeholder",update:Ab.homepage.EditorSortable.onChange})},onChange:function(A,B){Ab.homepage.EditorController.flowBucketsToMaxFourColumnsPerRow();Ab.homepage.EditorController.addNewBucketControlWhereNeeded();Ab.homepage.EditorController.initializeRowMovementControls();Ab.homepage.EditorController.setRowNames();pgnavPageEditorController.isDirty=true}}));Ab.namespace("homepage");Ab.homepage.EditorParser=new (Base.extend({descriptorAttributeNames:JSON.parse('{"activityid": "activity_id","abbreviatevalues": "abbreviateValues","backgroundshading": "backgroundShading","basemaplayer": "basemapLayer","columnspan": "columnSpan","controltype": "controlType","datasourceid": "dataSourceId","granularitylocation": "granularityLocation","labelfield": "labelField","mapimplementation": "mapImplementation","markerradius": "markerRadius","metricname": "metricName","processid": "process_id","recordlimit": "recordLimit","sortorder": "sortOrder","type": "type","usestoplightcolors": "useStoplightColors","valuefield": "valueField","valueontop": "valueOnTop","viewname": "viewName"}'),parseDescriptorToModel:function(D){var B={};B.abstractNavBlocks=[];if(D!=null){var A=D.getElementsByTagName("navigation-page");if(A.length>0){var G=A[0].childNodes;var E=G.length;for(var C=0;G!=null&&C<E;C++){var F=G[C];if(F.nodeName!=="row"&&F.nodeName!=="page-divider"){continue}B.abstractNavBlocks.push({type:F.nodeName,index:C,attributes:this.getAttributesObject(F.attributes),buckets:this.parseBucketCollection(F.childNodes)})}}}return B},getAttributesObject:function(D){var E={};var B=D.length;for(var A=0;A<B;A++){var C=D.item(A);var F=C.name.toLowerCase().replace("_","").replace("-","");E[F]=C.value;if("height"===C.name&&"three-quarters"===C.value){E[C.name]="three-quarter"}}return E},parseBucketCollection:function(A){var E=[];var C=A.length;for(var B=0;A!=null&&B<C;B++){var D=A[B];if(D.nodeName!=="bucket"){continue}E.push({type:D.getAttribute("type"),title:D.getAttribute("title"),index:B,attributes:this.getAttributesObject(D.attributes)})}return E},parseDisplayToModel:function(){var B={};B.abstractNavBlocks=[];var A=jQuery(".editor-page");if(A.length>0&&A[0].hasChildNodes){var C=jQuery(A[0]).children("div");var J=C.length;for(var H=0;H<J;H++){var E=C[H];var F=jQuery(E).hasClass("page-row");var K=jQuery(E).hasClass("page-break-banner");B.abstractNavBlocks.push({index:H,blockType:F?"row":K?"page-divider":"rule",attributes:this.getAbstractNavBlockAttributes(E,F,K),buckets:[]});if(F){var D=jQuery(E).find(".bucket-process");var I=D.length;for(var G=0;G<I;G++){B.abstractNavBlocks[H].buckets.push({index:G,id:jQuery(D[G]).attr("id"),title:jQuery(D[G]).attr("title"),attributes:this.getBucketDataAttributes(D[G],true)})}}}}else{alert("No editor-page found!")}return B},parseDisplayToXml:function(){var B=this.parseDisplayToModel();var C="<navigation-page>";var I=B.abstractNavBlocks.length;for(var E=0;E<I;E++){var A=B.abstractNavBlocks[E];if("page-divider"===A.blockType){C+="<page-divider";if(A.attributes.title){C+=' title="'+A.attributes.title+'"'}if(A.attributes.backgroundshading){C+=' backgroundShading="'+A.attributes.backgroundshading+'"'}C+="></page-divider>"}else{if("row"===A.blockType){C+='<row height="'+A.attributes.height+'">';var H=A.buckets.length;for(var D=0;D<H;D++){var F=A.buckets[D].attributes;C+="<bucket ";for(var G in F){if(F.hasOwnProperty(G)&&(""!==F[G]||"activityid"===G||"processid"===G)){C+=" "+G+'="'+F[G]+'"'}}C+="/>"}C+="</row>"}}}C+="</navigation-page>";return C},getAbstractNavBlockAttributes:function(D,G,C){var B={};var H=jQuery(D).data();if(C){for(attributeName in H){B[attributeName]=H[attributeName]}}else{if(G){var E=jQuery(D).hasClass("half-height");var F=jQuery(D).hasClass("three-quarter-height");var A=jQuery(D).hasClass("full-height");B.height=E?"half":F?"three-quarters":A?"full":""}}return B},getBucketDataAttributes:function(D,E){var F={};var C=jQuery(D).data();for(var B in C){if(C.hasOwnProperty(B)){var G=this.descriptorAttributeNames[B]?this.descriptorAttributeNames[B]:B;var A=G.toLowerCase();if("sortableitem"===A||"rowindex"===A||"columnindex"===A){continue}G=E?G:A;F[G]=convertToXMLValue(C[B])}}return F},ensureDescriptorFileNameValidity:function(C){var B=C.trim();while(B.indexOf(" ")>0){B=B.replace(" ","-")}if(B&&B.length>0){var A=B.toLowerCase().indexOf(".xml");if(A<0||A!==(B.length-4)){B=B+".xml"}}return B}}));Ab.namespace("homepage");Ab.homepage.EditorServices=new (Base.extend({fetchDescriptor:function(C,F,B){var D={};try{var A=Workflow.callMethod("AbSystemAdministration-HomePageDescriptorService-getPageDescriptorFile",C,F,B);D=JSON.parse(A.jsonExpression);D.processId=F}catch(E){Workflow.handleError(E)}return D},saveDescriptor:function(C,D){var B="na";try{var A=Workflow.callMethod("AbSystemAdministration-HomePageDescriptorService-savePageDescriptorFile",C,D);B=A.code}catch(E){B=E.code}return B},copyDescriptorProcess:function(C){var B="na";try{var A=Workflow.callMethod("AbSystemAdministration-HomePageDescriptorService-copyPageDescriptorFile",C);B=A.code}catch(D){B=D.code}return B},createLinkingRoleProcsRecord:function(C){var B="na";try{var A=Workflow.callMethod("AbSystemAdministration-HomePageDescriptorService-createRoleProcsRecord",C);B=A.code}catch(D){B=D.code;Workflow.handleError(D)}return B},saveAddedProcessTasks:function(D,E){var B="na";try{var C=new Ab.data.DataSetList();C.addRecords(D);var A=Workflow.callMethod("AbSystemAdministration-HomePageDescriptorService-saveTransferredTaskRecords",C,E);B=A.code}catch(F){B=F.code;Workflow.handleError(F)}return B},publishDescriptor:function(D,F,E){var B=false;try{var A=Ab.workflow.Workflow.call("AbCommonResources-publishHomePageForRole",{descriptorFileName:D,title:E,processId:F});if(Ab.workflow.Workflow.sessionTimeoutDetected){B=false}else{if(A.data&&A.data.value>0){View.showMessage("Publishing error: "+A.data.message);B=false}else{B=true}}}catch(C){Workflow.handleError(C)}return B}}));Ab.namespace("homepage");Ab.homepage.EditorView=new (Base.extend({z_LABEL_TITLE:"Title",z_LABEL_EDIT:"Edit",z_LABEL_EDIT_PROPERTIES:"Edit Properties",z_LABEL_EDIT_TASKS:"Edit Tasks",z_LABEL_EDIT_METRICS:"Edit Metrics",z_LABEL_BACK_TO_TOP:"Back to Top",z_LABEL_ROW:"Row",z_LABEL_NEW_PANEL:"New Panel",z_LABEL_NEW_ROW:"New Row",z_LABEL_PROCESS:"Process",z_LABEL_CONTROL_TYPE:"Control Type",z_LABEL_PROPERTIES:"Properties",z_LABEL_TASKS_ASSIGNED:"Tasks Assigned",z_LABEL_DEFINE_SCORECARD:"Define Scorecard",z_LABEL_DEFINE_METRIC:"Define Metric",z_MESSAGE_CONFIRM_DIVIDER_DELETE:"Do you really want to delete this page divider?",z_MESSAGE_CONFIRM_ROW_DELETE:"Do you really want to delete this whole row?",z_MESSAGE_CONFIRM_PANEL_DELETE:"Do you really want to delete this panel?",z_MESSAGE_ASSIGN_ACTIVITY_PROCESS:"Assign an activity and process.",z_MESSAGE_ASSIGN_CONTROL_TYPE:"Assign a type and control type.",z_TOOLTIP_ADDITIONAL_TASKS:"Additional Tasks",z_TOOLTIP_DIVIDER_PROPERTIES:"Page Divider Properties",z_TOOLTIP_DELETE_ROW:"Delete row",z_TOOLTIP_DUPLICATE_PANEL:"Duplicate panel",z_TOOLTIP_DELETE_PANEL:"Delete panel",z_TOOLTIP_VIEWNAME_CHART_EDIT:"A chart based on viewname and datasource is completely editable in the properties form.",z_TOOLTIP_FAVORITES_EDIT:"A favorites panel is completely editable in the properties form.",z_TOOLTIP_MOVE_UP:"Move up",z_TOOLTIP_MOVE_DOWN:"Move down",z_TOOLTIP_HALF_HEIGHT:"Half height",z_TOOLTIP_THREE_QUARTER_HEIGHT:"Three quarter height",z_TOOLTIP_FULL_HEIGHT:"Full height",z_TOOLTIP_ADD_PANEL:"Add a new panel",z_TOOLTIP_ADD_ROW:"Add a new row",z_TOOLTIP_ADD_PAGE_DIVIDER:"Add page divider",z_TOOLTIP_DELETE_DIVIDER:"Delete divider",createDisplayFromModel:function(F){var A='<div class="nav-pages"><div id="editorPage" class="editor-page">';var E=F.abstractNavBlocks;var C=E.length;for(var B=0;B<C;B++){var D=E[B];if("page-divider"===D.type){A+=this.getPageDividerHtml(D)}else{if("row"===D.type){A+=this.getPageRowHtml(D,this.getNextAbstractBlockIndex())}else{if("rule"===D.type){}}}}A+=this.getNewRowControlHtml()+"</div></div>";return A},getPageDividerHtml:function(B){var A=B.attributes.backgroundshading?B.attributes.backgroundshading:"";return'<div class="page-break-banner"  id="pageDivider_'+B.index+'" data-title="'+B.attributes.title+'" data-backgroundshading="'+A+'"><div class="page-break-palette"><button type="button" class="page-divider-properties" onmouseup="Ab.homepage.EditorController.editPageDividerProperties(this);"><span>'+getLocalizedString(this.z_LABEL_EDIT)+'</span></button><a class="page-divider-delete bucket-image-delete" onmouseup="Ab.homepage.EditorController.deletePageDivider(this)"title="'+getLocalizedString(this.z_TOOLTIP_DELETE_DIVIDER)+'"/></div><div class="page-break-archibus"><div class="page-break-logo"></div><span>'+B.attributes.title+'</span></div><a class="page-top-link" onClick="goToTop();">'+getLocalizedString(this.z_LABEL_BACK_TO_TOP)+"</a></div>"},getPageRowHtml:function(E,G){var F=E.attributes.height;var A='<div class="page-row '+F+'-height" id="pageRow_'+G+'">';A+=this.getRowPaletteHtml({index:G,attributes:{height:F}});var D=0;var C=E.buckets.length;for(var B=0;B<C;B++){A+=this.getBucketHtml(E.buckets[B]);D+=Ab.homepage.EditorController.getBucketColumnSpan(E.buckets[B])}if(E.buckets.length<4&&D<4){A+=this.getNewBucketControlHtml()}A+="</div>";return A},getRowPaletteHtml:function(B){var A=B.attributes;var C=B.index;var D='<div id="rowPalette_'+C+'" class="row-palette"';D+=this.getElementDataAttributesHtml(A);D+=' oncontextmenu="return false;">';D+='<h2 class="process-title">'+getLocalizedString(this.z_LABEL_ROW)+C+'<a class="row-palette-title-menu bucket-image-delete" onmouseup="Ab.homepage.EditorController.deleteRow(this)" title="'+getLocalizedString(this.z_TOOLTIP_DELETE_ROW)+'"></a></h2><div class="bucket-wrapper" id="wrapper_rowPalette_'+C+'"><table class="row-palette-controls"><tr><td class="row-palette-shift"><a class="row-move-up" title="'+getLocalizedString(this.z_TOOLTIP_MOVE_UP)+'" onmouseup="Ab.homepage.EditorController.shiftRowUp(this)" ></a></td><td><a class="row-move-down" title="'+getLocalizedString(this.z_TOOLTIP_MOVE_DOWN)+'" onmouseup="Ab.homepage.EditorController.shiftRowDown(this)" /></td></tr>';D+='<tr><td>&nbsp;</td></tr><tr><td colspan="2"><a class="row-height row-height-half" title="'+getLocalizedString(this.z_TOOLTIP_HALF_HEIGHT)+'" onmouseup="Ab.homepage.EditorController.setRowHeight(this,'+C+',\'half\')"></a></td></tr><tr><td colspan="2"><a class="row-height row-height-three-quarter" title="'+getLocalizedString(this.z_TOOLTIP_THREE_QUARTER_HEIGHT)+'" onmouseup="Ab.homepage.EditorController.setRowHeight(this,'+C+',\'three-quarter\')"></a></td></tr><tr><td colspan="2"><a class="row-height row-height-full" title="'+getLocalizedString(this.z_TOOLTIP_FULL_HEIGHT)+'" onmouseup="Ab.homepage.EditorController.setRowHeight(this,'+C+",'full')\"></a></td></tr></table>";D+='<table class="row-palette-divider-button"><tr><td><a class="page-divider-button" title="'+getLocalizedString(this.z_TOOLTIP_ADD_PAGE_DIVIDER)+'" onmouseup="Ab.homepage.EditorController.addPageDivider(this)"></a></td></tr></table>';D+="</div></div>";return D},getElementDataAttributesHtml:function(A){var C="";for(var B in A){if(A.hasOwnProperty(B)){C+=" data-"+B+'="'+A[B]+'"'}}return C},getBucketHtml:function(C){var A="";var B=C.attributes.type;if("process"===B){A=this.getProcessBucketHtml(C)}else{if("app-specific"===B){A=this.getAppSpecificBucketHtml(C)}else{if("favorites"===B){A=this.getFavoritesBucketHtml(C)}}}return A},getProcessBucketHtml:function(F){var B=F.attributes;var A=B.activityid||B.activity_id;var E=B.processid||B.process_id;var D=A+"_"+getCamelCasedString(E)+"_b_"+this.getNextPanelIndex();var C='<div id="bucket_'+D+'" class="bucket-process"'+this.getElementDataAttributesHtml(B)+' oncontextmenu="return false;">'+this.getBucketTitleHtml(B);C+='<div class="bucket-wrapper process-bucket" id="wrapper_'+D+'">'+this.getProcessBucketPropertiesTable(D,A,E,B.controltype)+this.getBucketActionsTable(B)+"</div></div>";return C},getNextAbstractBlockIndex:function(){var B=jQuery("#pageAttributes");var A=jQuery(B).data("abstractBlockCounter");jQuery(B).data("abstractBlockCounter",++A);return A},getNextPanelIndex:function(){var A=jQuery("#pageAttributes");var B=jQuery(A).data("pagePanelCounter");jQuery(A).data("pagePanelCounter",++B);return B},getAppSpecificBucketHtml:function(F){var B=F.attributes;var E=getCamelCasedString(B.title)+"_b_"+this.getNextPanelIndex();var C=B.columnspan;var A=(C&&(C===2||C==="2"))?"bucket-process double-wide":"bucket-process";var D='<div id="bucket_'+E+'" class="'+A+'"'+this.getElementDataAttributesHtml(B)+' oncontextmenu="return false;">'+this.getBucketTitleHtml(B);D+='<div class="bucket-wrapper app-specific-bucket" id="wrapper_'+E+'">'+this.getAppSpecificBucketPropertiesTable(E,B)+this.getBucketActionsTable(B)+"</div></div>";return D},getFavoritesBucketHtml:function(C){var B=this.getNextPanelIndex();var A='<div id="homeFavoritesBucket_f_'+B+'" class="bucket-process" '+this.getElementDataAttributesHtml(C.attributes)+'oncontextmenu="return false;">';A+=this.getBucketTitleHtml(C.attributes);A+='<div class="bucket-wrapper favorites-bucket" id="wrapper_favorites_'+B+'">'+this.getFavoritesBucketPropertiesTable()+this.getBucketActionsTable(C.attributes)+"</div></div>";return A},getBucketTitleHtml:function(A){var D=A.title;var B=D;if(D.length>28&&(!A.columnspan||parseInt(A.columnspan,10)<2)){B=D.substr(0,27)+"..."}var C='<h2 class="process-title" title="'+A.tooltip+'"><span class="bucket-title" title="'+D+'">'+B+'</span><table class="bucket-title-menu"><tr><td>';if("process"===A.type||"app-specific"===A.type){C+='<a class="bucket-image-duplicate panel-title-button" title="'+getLocalizedString(this.z_TOOLTIP_DUPLICATE_PANEL)+'" onmouseup="Ab.homepage.EditorController.duplicateBucket(this)"/></td><td>'}C+='<a class="bucket-image-delete panel-title-button" title="'+getLocalizedString(this.z_TOOLTIP_DELETE_PANEL)+'" onmouseup="Ab.homepage.EditorController.deleteBucket(this)"/></td></tr></table></h2>';return C},getProcessBucketPropertiesTable:function(C,B,F,A){var E=B?B:"";var D=F?F:"";return'<table id="table_'+C+'" class="bucket-properties-table"><tr> <td><b>'+getLocalizedString(this.z_LABEL_PROCESS)+": </b></td></tr><tr><td>"+E+"</td></tr><tr><td>"+D+"</td></tr>"+this.getBucketTypeImageHTML(A)+"</table>"},getAppSpecificBucketPropertiesTable:function(C,A){var B='<table id="table_'+C+'" class="bucket-properties-table"> <tr> <td><b>'+getLocalizedString(this.z_LABEL_CONTROL_TYPE)+":</b></td></tr><tr><td>"+A.controltype+"</td> </tr>";if(A.scorecard){B+="<tr><tr><td>"+A.scorecard+"</td> </tr>"}if(A.metricname){B+="<tr><tr><td>"+A.metricname+"</td> </tr>"}if(A.granularity){B+="<tr><tr><td>"+A.granularity+"</td></tr>"}B+=this.getBucketTypeImageHTML(A.controltype);B+="</table>";return B},getFavoritesBucketPropertiesTable:function(){return'<div class="favorites-drop-target"><span class="favorites-add-target"></span><span class="favorites-delete-target">&nbsp;</span></div><div class="favorites"></div>'},getBucketTypeImageHTML:function(B){var A="<tr><td>";if(!B||""===B){A+='<a class="bucket-thumbnail-process" ></a>'}else{if(B==="processMetrics"){A+='<a class="bucket-thumbnail-metrics-scorecard" ></a>'}else{if(B==="horizontalBarChart"){A+='<a class="bucket-thumbnail-bar-chart" ></a>'}else{if(B==="alertsList"){A+='<a class="bucket-thumbnail-alerts-list" ></a>'}else{if(B==="metricsChart"){A+='<a class="bucket-thumbnail-metric-chart" ></a>'}else{if(B==="pgnav-map"){A+='<a class="bucket-thumbnail-map" ></a>'}}}}}}A+="</td></tr>";return A},getBucketActionsTable:function(B){var D="";var A="";var C="app-specific"===B.type?[getLocalizedString(Ab.homepage.EditorView.z_LABEL_EDIT_PROPERTIES),getLocalizedString(Ab.homepage.EditorView.z_LABEL_EDIT_METRICS)]:[getLocalizedString(Ab.homepage.EditorView.z_LABEL_EDIT_PROPERTIES),getLocalizedString(Ab.homepage.EditorView.z_LABEL_EDIT_TASKS)];if("horizontalBarChart"===B.controltype&&B.viewname){D=' disabled="disabled"';A=' title="'+getLocalizedString(this.z_TOOLTIP_VIEWNAME_CHART_EDIT)+'"'}else{if("favorites"===B.type){D=' disabled="disabled"';A=' title="'+getLocalizedString(this.z_TOOLTIP_FAVORITES_EDIT)+'"'}}return'<table class="bucket-properties-buttons"><tr><td><button type="button" class="prop-button" onclick="Ab.homepage.EditorController.editBucketProperties(this);"><span>'+C[0]+'</span></button></td><td class="spacer">&nbsp;</td><td><button type="button" class="assoc-button" onclick="Ab.homepage.EditorController.editBucketAssociate(this);"'+D+A+"><span>"+C[1]+"</span></button></td></tr></table>"},getEmptyBucketHtml:function(){var A={attributes:{title:getLocalizedString(this.z_LABEL_TITLE),type:"",activityId:"",processId:"",scorecard:"",metricname:"",granularity:"",columnspan:1,tooltip:""}};return this.getProcessBucketHtml(A)},getNewBucketControlHtml:function(){return'<div id="newBucketControlContainer_'+this.getNextPanelIndex()+'"  class="new-panel-container"><button type="button" title="'+getLocalizedString(this.z_TOOLTIP_ADD_PANEL)+'" onclick="Ab.homepage.EditorController.addEmptyBucketToRow(this)"><span>'+getLocalizedString(this.z_LABEL_NEW_PANEL)+"</span></button></div>"},getNewRowControlHtml:function(){return'<div id="newRowControlContainer" class="new-row-container"><button type="button" title="'+getLocalizedString(this.z_TOOLTIP_ADD_ROW)+'" onclick="Ab.homepage.EditorController.addNewRow();" ><span>'+getLocalizedString(this.z_LABEL_NEW_ROW)+"</span></button></div>"},showNewRowControl:function(A){var B=A?"block":"none";jQuery("#newRowControlContainer").css("display",B)},showNewBucketControl:function(A){var B=A?"block":"none";jQuery(".new-panel-container").css("display",B)}}));!function(C,E,B){var G=C.L,F={};F.version="0.7.3","object"==typeof module&&"object"==typeof module.exports?module.exports=F:"function"==typeof define&&define.amd&&define(F),F.noConflict=function(){return C.L=G,this},C.L=F,F.Util={extend:function(I){var K,H,N,M,J=Array.prototype.slice.call(arguments,1);for(H=0,N=J.length;N>H;H++){M=J[H]||{};for(K in M){M.hasOwnProperty(K)&&(I[K]=M[K])}}return I},bind:function(I,J){var H=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return I.apply(J,H||arguments)}},stamp:function(){var H=0,I="_leaflet_id";return function(J){return J[I]=J[I]||++H,J[I]}}(),invokeEach:function(I,J,H){var M,K;if("object"==typeof I){K=Array.prototype.slice.call(arguments,3);for(M in I){J.apply(H,[M,I[M]].concat(K))}return !0}return !1},limitExecByInterval:function(I,K,H){var N,M;return function J(){var O=arguments;return N?void (M=!0):(N=!0,setTimeout(function(){N=!1,M&&(J.apply(H,O),M=!1)},K),void I.apply(H,O))}},falseFn:function(){return !1},formatNum:function(I,J){var H=Math.pow(10,J||5);return Math.round(I*H)/H},trim:function(H){return H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")},splitWords:function(H){return F.Util.trim(H).split(/\s+/)},setOptions:function(H,I){return H.options=F.extend({},H.options,I),H.options},getParamString:function(I,J,H){var M=[];for(var K in I){M.push(encodeURIComponent(H?K.toUpperCase():K)+"="+encodeURIComponent(I[K]))}return(J&&-1!==J.indexOf("?")?"&":"?")+M.join("&")},template:function(H,I){return H.replace(/\{ *([\w_]+) *\}/g,function(J,M){var K=I[M];if(K===B){throw new Error("No value provided for variable "+J)}return"function"==typeof K&&(K=K(I)),K})},isArray:Array.isArray||function(H){return"[object Array]"===Object.prototype.toString.call(H)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function K(O){var N,Q,P=["webkit","moz","o","ms"];for(N=0;N<P.length&&!Q;N++){Q=C[P[N]+O]}return Q}function I(O){var N=+new Date,P=Math.max(0,16-(N-M));return M=N+P,C.setTimeout(O,P)}var M=0,J=C.requestAnimationFrame||K("RequestAnimationFrame")||I,H=C.cancelAnimationFrame||K("CancelAnimationFrame")||K("CancelRequestAnimationFrame")||function(N){C.clearTimeout(N)};F.Util.requestAnimFrame=function(P,Q,N,O){return P=F.bind(P,Q),N&&J===I?void P():J.call(C,P,O)},F.Util.cancelAnimFrame=function(N){N&&H.call(C,N)}}(),F.extend=F.Util.extend,F.bind=F.Util.bind,F.stamp=F.Util.stamp,F.setOptions=F.Util.setOptions,F.Class=function(){},F.Class.extend=function(J){var M=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},I=function(){};I.prototype=this.prototype;var N=new I;N.constructor=M,M.prototype=N;for(var K in this){this.hasOwnProperty(K)&&"prototype"!==K&&(M[K]=this[K])}J.statics&&(F.extend(M,J.statics),delete J.statics),J.includes&&(F.Util.extend.apply(null,[N].concat(J.includes)),delete J.includes),J.options&&N.options&&(J.options=F.extend({},N.options,J.options)),F.extend(N,J),N._initHooks=[];var H=this;return M.__super__=H.prototype,N.callInitHooks=function(){if(!this._initHooksCalled){H.prototype.callInitHooks&&H.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,P=N._initHooks.length;P>O;O++){N._initHooks[O].call(this)}}},M},F.Class.include=function(H){F.extend(this.prototype,H)},F.Class.mergeOptions=function(H){F.extend(this.prototype.options,H)},F.Class.addInitHook=function(I){var J=Array.prototype.slice.call(arguments,1),H="function"==typeof I?I:function(){this[I].apply(this,J)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(H)};var D="_leaflet_events";F.Mixin={},F.Mixin.Events={addEventListener:function(T,O,M){if(F.Util.invokeEach(T,this.addEventListener,this,O,M)){return this}var J,R,H,N,K,S,Q,P=this[D]=this[D]||{},I=M&&M!==this&&F.stamp(M);for(T=F.Util.splitWords(T),J=0,R=T.length;R>J;J++){H={action:O,context:M||this},N=T[J],I?(K=N+"_idx",S=K+"_len",Q=P[K]=P[K]||{},Q[I]||(Q[I]=[],P[S]=(P[S]||0)+1),Q[I].push(H)):(P[N]=P[N]||[],P[N].push(H))}return this},hasEventListeners:function(H){var I=this[D];return !!I&&(H in I&&I[H].length>0||H+"_idx" in I&&I[H+"_idx_len"]>0)},removeEventListener:function(V,P,N){if(!this[D]){return this}if(!V){return this.clearAllEventListeners()}if(F.Util.invokeEach(V,this.removeEventListener,this,P,N)){return this}var J,S,H,O,M,U,R,Q,I,T=this[D],K=N&&N!==this&&F.stamp(N);for(V=F.Util.splitWords(V),J=0,S=V.length;S>J;J++){if(H=V[J],U=H+"_idx",R=U+"_len",Q=T[U],P){if(O=K&&Q?Q[K]:T[H]){for(M=O.length-1;M>=0;M--){O[M].action!==P||N&&O[M].context!==N||(I=O.splice(M,1),I[0].action=F.Util.falseFn)}N&&Q&&0===O.length&&(delete Q[K],T[R]--)}}else{delete T[H],delete T[U],delete T[R]}}return this},clearAllEventListeners:function(){return delete this[D],this},fireEvent:function(Q,N){if(!this.hasEventListeners(Q)){return this}var K,I,O,H,M,J=F.Util.extend({},N,{type:Q,target:this}),P=this[D];if(P[Q]){for(K=P[Q].slice(),I=0,O=K.length;O>I;I++){K[I].action.call(K[I].context,J)}}H=P[Q+"_idx"];for(M in H){if(K=H[M].slice()){for(I=0,O=K.length;O>I;I++){K[I].action.call(K[I].context,J)}}}return this},addOneTimeEventListener:function(I,J,H){if(F.Util.invokeEach(I,this.addOneTimeEventListener,this,J,H)){return this}var K=F.bind(function(){this.removeEventListener(I,J,H).removeEventListener(I,K,H)},this);return this.addEventListener(I,J,H).addEventListener(I,K,H)}},F.Mixin.Events.on=F.Mixin.Events.addEventListener,F.Mixin.Events.off=F.Mixin.Events.removeEventListener,F.Mixin.Events.once=F.Mixin.Events.addOneTimeEventListener,F.Mixin.Events.fire=F.Mixin.Events.fireEvent,function(){var T="ActiveXObject" in C,Q=T&&!E.addEventListener,e=navigator.userAgent.toLowerCase(),R=-1!==e.indexOf("webkit"),W=-1!==e.indexOf("chrome"),V=-1!==e.indexOf("phantom"),O=-1!==e.indexOf("android"),b=-1!==e.search("android [23]"),Z=-1!==e.indexOf("gecko"),S=typeof orientation!=B+"",i=C.navigator&&C.navigator.msPointerEnabled&&C.navigator.msMaxTouchPoints&&!C.PointerEvent,U=C.PointerEvent&&C.navigator.pointerEnabled&&C.navigator.maxTouchPoints||i,Y="devicePixelRatio" in C&&C.devicePixelRatio>1||"matchMedia" in C&&C.matchMedia("(min-resolution:144dpi)")&&C.matchMedia("(min-resolution:144dpi)").matches,X=E.documentElement,N=T&&"transition" in X.style,J="WebKitCSSMatrix" in C&&"m11" in new C.WebKitCSSMatrix&&!b,H="MozPerspective" in X.style,I="OTransition" in X.style,K=!C.L_DISABLE_3D&&(N||J||H||I)&&!V,M=!C.L_NO_TOUCH&&!V&&function(){var c="ontouchstart";if(U||c in X){return !0}var P=E.createElement("div"),d=!1;return P.setAttribute?(P.setAttribute(c,"return;"),"function"==typeof P[c]&&(d=!0),P.removeAttribute(c),P=null,d):!1}();F.Browser={ie:T,ielt9:Q,webkit:R,gecko:Z&&!R&&!C.opera&&!T,android:O,android23:b,chrome:W,ie3d:N,webkit3d:J,gecko3d:H,opera3d:I,any3d:K,mobile:S,mobileWebkit:S&&R,mobileWebkit3d:S&&J,mobileOpera:S&&C.opera,touch:M,msPointer:i,pointer:U,retina:Y}}(),F.Point=function(I,J,H){this.x=H?Math.round(I):I,this.y=H?Math.round(J):J},F.Point.prototype={clone:function(){return new F.Point(this.x,this.y)},add:function(H){return this.clone()._add(F.point(H))},_add:function(H){return this.x+=H.x,this.y+=H.y,this},subtract:function(H){return this.clone()._subtract(F.point(H))},_subtract:function(H){return this.x-=H.x,this.y-=H.y,this},divideBy:function(H){return this.clone()._divideBy(H)},_divideBy:function(H){return this.x/=H,this.y/=H,this},multiplyBy:function(H){return this.clone()._multiplyBy(H)},_multiplyBy:function(H){return this.x*=H,this.y*=H,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(I){I=F.point(I);var J=I.x-this.x,H=I.y-this.y;return Math.sqrt(J*J+H*H)},equals:function(H){return H=F.point(H),H.x===this.x&&H.y===this.y},contains:function(H){return H=F.point(H),Math.abs(H.x)<=Math.abs(this.x)&&Math.abs(H.y)<=Math.abs(this.y)},toString:function(){return"Point("+F.Util.formatNum(this.x)+", "+F.Util.formatNum(this.y)+")"}},F.point=function(H,I,J){return H instanceof F.Point?H:F.Util.isArray(H)?new F.Point(H[0],H[1]):H===B||null===H?H:new F.Point(H,I,J)},F.Bounds=function(I,J){if(I){for(var H=J?[I,J]:I,M=0,K=H.length;K>M;M++){this.extend(H[M])}}},F.Bounds.prototype={extend:function(H){return H=F.point(H),this.min||this.max?(this.min.x=Math.min(H.x,this.min.x),this.max.x=Math.max(H.x,this.max.x),this.min.y=Math.min(H.y,this.min.y),this.max.y=Math.max(H.y,this.max.y)):(this.min=H.clone(),this.max=H.clone()),this},getCenter:function(H){return new F.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,H)},getBottomLeft:function(){return new F.Point(this.min.x,this.max.y)},getTopRight:function(){return new F.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(I){var J,H;return I="number"==typeof I[0]||I instanceof F.Point?F.point(I):F.bounds(I),I instanceof F.Bounds?(J=I.min,H=I.max):J=H=I,J.x>=this.min.x&&H.x<=this.max.x&&J.y>=this.min.y&&H.y<=this.max.y},intersects:function(J){J=F.bounds(J);var N=this.min,I=this.max,O=J.min,K=J.max,H=K.x>=N.x&&O.x<=I.x,M=K.y>=N.y&&O.y<=I.y;return H&&M},isValid:function(){return !(!this.min||!this.max)}},F.bounds=function(H,I){return !H||H instanceof F.Bounds?H:new F.Bounds(H,I)},F.Transformation=function(I,J,H,K){this._a=I,this._b=J,this._c=H,this._d=K},F.Transformation.prototype={transform:function(H,I){return this._transform(H.clone(),I)},_transform:function(H,I){return I=I||1,H.x=I*(this._a*H.x+this._b),H.y=I*(this._c*H.y+this._d),H},untransform:function(H,I){return I=I||1,new F.Point((H.x/I-this._b)/this._a,(H.y/I-this._d)/this._c)}},F.DomUtil={get:function(H){return"string"==typeof H?E.getElementById(H):H},getStyle:function(I,H){var K=I.style[H];if(!K&&I.currentStyle&&(K=I.currentStyle[H]),(!K||"auto"===K)&&E.defaultView){var J=E.defaultView.getComputedStyle(I,null);K=J?J[H]:null}return"auto"===K?null:K},getViewportOffset:function(Q){var K,I=0,R=0,O=Q,H=E.body,M=E.documentElement;do{if(I+=O.offsetTop||0,R+=O.offsetLeft||0,I+=parseInt(F.DomUtil.getStyle(O,"borderTopWidth"),10)||0,R+=parseInt(F.DomUtil.getStyle(O,"borderLeftWidth"),10)||0,K=F.DomUtil.getStyle(O,"position"),O.offsetParent===H&&"absolute"===K){break}if("fixed"===K){I+=H.scrollTop||M.scrollTop||0,R+=H.scrollLeft||M.scrollLeft||0;break}if("relative"===K&&!O.offsetLeft){var J=F.DomUtil.getStyle(O,"width"),P=F.DomUtil.getStyle(O,"max-width"),N=O.getBoundingClientRect();("none"!==J||"none"!==P)&&(R+=N.left+O.clientLeft),I+=N.top+(H.scrollTop||M.scrollTop||0);break}O=O.offsetParent}while(O);O=Q;do{if(O===H){break}I-=O.scrollTop||0,R-=O.scrollLeft||0,O=O.parentNode}while(O);return new F.Point(R,I)},documentIsLtr:function(){return F.DomUtil._docIsLtrCached||(F.DomUtil._docIsLtrCached=!0,F.DomUtil._docIsLtr="ltr"===F.DomUtil.getStyle(E.body,"direction")),F.DomUtil._docIsLtr},create:function(I,H,K){var J=E.createElement(I);return J.className=H,K&&K.appendChild(J),J},hasClass:function(H,I){if(H.classList!==B){return H.classList.contains(I)}var J=F.DomUtil._getClass(H);return J.length>0&&new RegExp("(^|\\s)"+I+"(\\s|$)").test(J)},addClass:function(I,M){if(I.classList!==B){for(var N=F.Util.splitWords(M),J=0,H=N.length;H>J;J++){I.classList.add(N[J])}}else{if(!F.DomUtil.hasClass(I,M)){var K=F.DomUtil._getClass(I);F.DomUtil._setClass(I,(K?K+" ":"")+M)}}},removeClass:function(H,I){H.classList!==B?H.classList.remove(I):F.DomUtil._setClass(H,F.Util.trim((" "+F.DomUtil._getClass(H)+" ").replace(" "+I+" "," ")))},_setClass:function(H,I){H.className.baseVal===B?H.className=I:H.className.baseVal=I},_getClass:function(H){return H.className.baseVal===B?H.className:H.className.baseVal},setOpacity:function(I,J){if("opacity" in I.style){I.style.opacity=J}else{if("filter" in I.style){var H=!1,M="DXImageTransform.Microsoft.Alpha";try{H=I.filters.item(M)}catch(K){if(1===J){return }}J=Math.round(100*J),H?(H.Enabled=100!==J,H.Opacity=J):I.style.filter+=" progid:"+M+"(opacity="+J+")"}}},testProp:function(I){for(var H=E.documentElement.style,J=0;J<I.length;J++){if(I[J] in H){return I[J]}}return !1},getTranslateString:function(I){var J=F.Browser.webkit3d,H="translate"+(J?"3d":"")+"(",K=(J?",0":"")+")";return H+I.x+"px,"+I.y+"px"+K},getScaleString:function(I,J){var H=F.DomUtil.getTranslateString(J.add(J.multiplyBy(-1*I))),K=" scale("+I+") ";return H+K},setPosition:function(I,J,H){I._leaflet_pos=J,!H&&F.Browser.any3d?I.style[F.DomUtil.TRANSFORM]=F.DomUtil.getTranslateString(J):(I.style.left=J.x+"px",I.style.top=J.y+"px")},getPosition:function(H){return H._leaflet_pos}},F.DomUtil.TRANSFORM=F.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),F.DomUtil.TRANSITION=F.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),F.DomUtil.TRANSITION_END="webkitTransition"===F.DomUtil.TRANSITION||"OTransition"===F.DomUtil.TRANSITION?F.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart" in E){F.extend(F.DomUtil,{disableTextSelection:function(){F.DomEvent.on(C,"selectstart",F.DomEvent.preventDefault)},enableTextSelection:function(){F.DomEvent.off(C,"selectstart",F.DomEvent.preventDefault)}})}else{var H=F.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);F.extend(F.DomUtil,{disableTextSelection:function(){if(H){var I=E.documentElement.style;this._userSelect=I[H],I[H]="none"}},enableTextSelection:function(){H&&(E.documentElement.style[H]=this._userSelect,delete this._userSelect)}})}F.extend(F.DomUtil,{disableImageDrag:function(){F.DomEvent.on(C,"dragstart",F.DomEvent.preventDefault)},enableImageDrag:function(){F.DomEvent.off(C,"dragstart",F.DomEvent.preventDefault)}})}(),F.LatLng=function(H,I,J){if(H=parseFloat(H),I=parseFloat(I),isNaN(H)||isNaN(I)){throw new Error("Invalid LatLng object: ("+H+", "+I+")")}this.lat=H,this.lng=I,J!==B&&(this.alt=parseFloat(J))},F.extend(F.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),F.LatLng.prototype={equals:function(H){if(!H){return !1}H=F.latLng(H);var I=Math.max(Math.abs(this.lat-H.lat),Math.abs(this.lng-H.lng));return I<=F.LatLng.MAX_MARGIN},toString:function(H){return"LatLng("+F.Util.formatNum(this.lat,H)+", "+F.Util.formatNum(this.lng,H)+")"},distanceTo:function(Q){Q=F.latLng(Q);var N=6378137,K=F.LatLng.DEG_TO_RAD,I=(Q.lat-this.lat)*K,R=(Q.lng-this.lng)*K,O=this.lat*K,H=Q.lat*K,M=Math.sin(I/2),J=Math.sin(R/2),P=M*M+J*J*Math.cos(O)*Math.cos(H);return 2*N*Math.atan2(Math.sqrt(P),Math.sqrt(1-P))},wrap:function(I,J){var H=this.lng;return I=I||-180,J=J||180,H=(H+J)%(J-I)+(I>H||H===J?J:I),new F.LatLng(this.lat,H)}},F.latLng=function(H,I){return H instanceof F.LatLng?H:F.Util.isArray(H)?"number"==typeof H[0]||"string"==typeof H[0]?new F.LatLng(H[0],H[1],H[2]):null:H===B||null===H?H:"object"==typeof H&&"lat" in H?new F.LatLng(H.lat,"lng" in H?H.lng:H.lon):I===B?null:new F.LatLng(H,I)},F.LatLngBounds=function(I,J){if(I){for(var H=J?[I,J]:I,M=0,K=H.length;K>M;M++){this.extend(H[M])}}},F.LatLngBounds.prototype={extend:function(H){if(!H){return this}var I=F.latLng(H);return H=null!==I?I:F.latLngBounds(H),H instanceof F.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(H.lat,this._southWest.lat),this._southWest.lng=Math.min(H.lng,this._southWest.lng),this._northEast.lat=Math.max(H.lat,this._northEast.lat),this._northEast.lng=Math.max(H.lng,this._northEast.lng)):(this._southWest=new F.LatLng(H.lat,H.lng),this._northEast=new F.LatLng(H.lat,H.lng)):H instanceof F.LatLngBounds&&(this.extend(H._southWest),this.extend(H._northEast)),this},pad:function(I){var K=this._southWest,H=this._northEast,M=Math.abs(K.lat-H.lat)*I,J=Math.abs(K.lng-H.lng)*I;return new F.LatLngBounds(new F.LatLng(K.lat-M,K.lng-J),new F.LatLng(H.lat+M,H.lng+J))},getCenter:function(){return new F.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new F.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new F.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(I){I="number"==typeof I[0]||I instanceof F.LatLng?F.latLng(I):F.latLngBounds(I);var K,H,M=this._southWest,J=this._northEast;return I instanceof F.LatLngBounds?(K=I.getSouthWest(),H=I.getNorthEast()):K=H=I,K.lat>=M.lat&&H.lat<=J.lat&&K.lng>=M.lng&&H.lng<=J.lng},intersects:function(J){J=F.latLngBounds(J);var N=this._southWest,I=this._northEast,O=J.getSouthWest(),K=J.getNorthEast(),H=K.lat>=N.lat&&O.lat<=I.lat,M=K.lng>=N.lng&&O.lng<=I.lng;return H&&M},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(H){return H?(H=F.latLngBounds(H),this._southWest.equals(H.getSouthWest())&&this._northEast.equals(H.getNorthEast())):!1},isValid:function(){return !(!this._southWest||!this._northEast)}},F.latLngBounds=function(H,I){return !H||H instanceof F.LatLngBounds?H:new F.LatLngBounds(H,I)},F.Projection={},F.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(J){var M=F.LatLng.DEG_TO_RAD,I=this.MAX_LATITUDE,N=Math.max(Math.min(I,J.lat),-I),K=J.lng*M,H=N*M;return H=Math.log(Math.tan(Math.PI/4+H/2)),new F.Point(K,H)},unproject:function(I){var J=F.LatLng.RAD_TO_DEG,H=I.x*J,K=(2*Math.atan(Math.exp(I.y))-Math.PI/2)*J;return new F.LatLng(K,H)}},F.Projection.LonLat={project:function(H){return new F.Point(H.lng,H.lat)},unproject:function(H){return new F.LatLng(H.y,H.x)}},F.CRS={latLngToPoint:function(I,J){var H=this.projection.project(I),K=this.scale(J);return this.transformation._transform(H,K)},pointToLatLng:function(I,J){var H=this.scale(J),K=this.transformation.untransform(I,H);return this.projection.unproject(K)},project:function(H){return this.projection.project(H)},scale:function(H){return 256*Math.pow(2,H)},getSize:function(H){var I=this.scale(H);return F.point(I,I)}},F.CRS.Simple=F.extend({},F.CRS,{projection:F.Projection.LonLat,transformation:new F.Transformation(1,0,-1,0),scale:function(H){return Math.pow(2,H)}}),F.CRS.EPSG3857=F.extend({},F.CRS,{code:"EPSG:3857",projection:F.Projection.SphericalMercator,transformation:new F.Transformation(0.5/Math.PI,0.5,-0.5/Math.PI,0.5),project:function(I){var J=this.projection.project(I),H=6378137;return J.multiplyBy(H)}}),F.CRS.EPSG900913=F.extend({},F.CRS.EPSG3857,{code:"EPSG:900913"}),F.CRS.EPSG4326=F.extend({},F.CRS,{code:"EPSG:4326",projection:F.Projection.LonLat,transformation:new F.Transformation(1/360,0.5,-1/360,0.5)}),F.Map=F.Class.extend({includes:F.Mixin.Events,options:{crs:F.CRS.EPSG3857,fadeAnimation:F.DomUtil.TRANSITION&&!F.Browser.android23,trackResize:!0,markerZoomAnimation:F.DomUtil.TRANSITION&&F.Browser.any3d},initialize:function(H,I){I=F.setOptions(this,I),this._initContainer(H),this._initLayout(),this._onResize=F.bind(this._onResize,this),this._initEvents(),I.maxBounds&&this.setMaxBounds(I.maxBounds),I.center&&I.zoom!==B&&this.setView(F.latLng(I.center),I.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(I.layers)},setView:function(H,I){return I=I===B?this.getZoom():I,this._resetView(F.latLng(H),this._limitZoom(I)),this},setZoom:function(H,I){return this._loaded?this.setView(this.getCenter(),H,{zoom:I}):(this._zoom=this._limitZoom(H),this)},zoomIn:function(H,I){return this.setZoom(this._zoom+(H||1),I)},zoomOut:function(H,I){return this.setZoom(this._zoom-(H||1),I)},setZoomAround:function(J,O,I){var P=this.getZoomScale(O),M=this.getSize().divideBy(2),H=J instanceof F.Point?J:this.latLngToContainerPoint(J),N=H.subtract(M).multiplyBy(1-1/P),K=this.containerPointToLatLng(M.add(N));return this.setView(K,O,{zoom:I})},fitBounds:function(P,N){N=N||{},P=P.getBounds?P.getBounds():F.latLngBounds(P);var K=F.point(N.paddingTopLeft||N.padding||[0,0]),I=F.point(N.paddingBottomRight||N.padding||[0,0]),Q=this.getBoundsZoom(P,!1,K.add(I)),O=I.subtract(K).divideBy(2),H=this.project(P.getSouthWest(),Q),M=this.project(P.getNorthEast(),Q),J=this.unproject(H.add(M).divideBy(2).add(O),Q);return Q=N&&N.maxZoom?Math.min(N.maxZoom,Q):Q,this.setView(J,Q,N)},fitWorld:function(H){return this.fitBounds([[-90,-180],[90,180]],H)},panTo:function(H,I){return this.setView(H,this._zoom,{pan:I})},panBy:function(H){return this.fire("movestart"),this._rawPanBy(F.point(H)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(H){return H=F.latLngBounds(H),this.options.maxBounds=H,H?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(I,J){var H=this.getCenter(),K=this._limitCenter(H,this._zoom,I);return H.equals(K)?this:this.panTo(K,J)},addLayer:function(H){var I=F.stamp(H);return this._layers[I]?this:(this._layers[I]=H,!H.options||isNaN(H.options.maxZoom)&&isNaN(H.options.minZoom)||(this._zoomBoundLayers[I]=H,this._updateZoomLevels()),this.options.zoomAnimation&&F.TileLayer&&H instanceof F.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,H.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(H),this)},removeLayer:function(H){var I=F.stamp(H);return this._layers[I]?(this._loaded&&H.onRemove(this),delete this._layers[I],this._loaded&&this.fire("layerremove",{layer:H}),this._zoomBoundLayers[I]&&(delete this._zoomBoundLayers[I],this._updateZoomLevels()),this.options.zoomAnimation&&F.TileLayer&&H instanceof F.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,H.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(H){return H?F.stamp(H) in this._layers:!1},eachLayer:function(I,J){for(var H in this._layers){I.call(J,this._layers[H])}return this},invalidateSize:function(J){if(!this._loaded){return this}J=F.extend({animate:!1,pan:!0},J===!0?{animate:!0}:J);var M=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var I=this.getSize(),N=M.divideBy(2).round(),K=I.divideBy(2).round(),H=N.subtract(K);return H.x||H.y?(J.animate&&J.pan?this.panBy(H):(J.pan&&this._rawPanBy(H),this.fire("move"),J.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(F.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:M,newSize:I})):this},addHandler:function(I,J){if(!J){return this}var H=this[I]=new J(this);return this._handlers.push(H),this.options[I]&&H.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(H){this._container._leaflet=B}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var I=this.getPixelBounds(),J=this.unproject(I.getBottomLeft()),H=this.unproject(I.getTopRight());return new F.LatLngBounds(J,H)},getMinZoom:function(){return this.options.minZoom===B?this._layersMinZoom===B?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===B?this._layersMaxZoom===B?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(Q,N,K){Q=F.latLngBounds(Q);var I,R=this.getMinZoom()-(N?1:0),O=this.getMaxZoom(),H=this.getSize(),M=Q.getNorthWest(),J=Q.getSouthEast(),P=!0;K=F.point(K||[0,0]);do{R++,I=this.project(J,R).subtract(this.project(M,R)).add(K),P=N?I.x<H.x||I.y<H.y:H.contains(I)}while(P&&O>=R);return P&&N?null:N?R:R-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new F.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var H=this._getTopLeftPoint();return new F.Bounds(H,H.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(H){var I=this.options.crs;return I.scale(H)/I.scale(this._zoom)},getScaleZoom:function(H){return this._zoom+Math.log(H)/Math.LN2},project:function(H,I){return I=I===B?this._zoom:I,this.options.crs.latLngToPoint(F.latLng(H),I)},unproject:function(H,I){return I=I===B?this._zoom:I,this.options.crs.pointToLatLng(F.point(H),I)},layerPointToLatLng:function(H){var I=F.point(H).add(this.getPixelOrigin());return this.unproject(I)},latLngToLayerPoint:function(H){var I=this.project(F.latLng(H))._round();return I._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(H){return F.point(H).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(H){return F.point(H).add(this._getMapPanePos())},containerPointToLatLng:function(H){var I=this.containerPointToLayerPoint(F.point(H));return this.layerPointToLatLng(I)},latLngToContainerPoint:function(H){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F.latLng(H)))},mouseEventToContainerPoint:function(H){return F.DomEvent.getMousePosition(H,this._container)},mouseEventToLayerPoint:function(H){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(H))},mouseEventToLatLng:function(H){return this.layerPointToLatLng(this.mouseEventToLayerPoint(H))},_initContainer:function(H){var I=this._container=F.DomUtil.get(H);if(!I){throw new Error("Map container not found.")}if(I._leaflet){throw new Error("Map container is already initialized.")}I._leaflet=!0},_initLayout:function(){var H=this._container;F.DomUtil.addClass(H,"leaflet-container"+(F.Browser.touch?" leaflet-touch":"")+(F.Browser.retina?" leaflet-retina":"")+(F.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var I=F.DomUtil.getStyle(H,"position");"absolute"!==I&&"relative"!==I&&"fixed"!==I&&(H.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var H=this._panes={};this._mapPane=H.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=H.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),H.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),H.shadowPane=this._createPane("leaflet-shadow-pane"),H.overlayPane=this._createPane("leaflet-overlay-pane"),H.markerPane=this._createPane("leaflet-marker-pane"),H.popupPane=this._createPane("leaflet-popup-pane");var I=" leaflet-zoom-hide";this.options.markerZoomAnimation||(F.DomUtil.addClass(H.markerPane,I),F.DomUtil.addClass(H.shadowPane,I),F.DomUtil.addClass(H.popupPane,I))},_createPane:function(H,I){return F.DomUtil.create("div",H,I||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(I){I=I?F.Util.isArray(I)?I:[I]:[];for(var J=0,H=I.length;H>J;J++){this.addLayer(I[J])}},_resetView:function(J,M,I,N){var K=this._zoom!==M;N||(this.fire("movestart"),K&&this.fire("zoomstart")),this._zoom=M,this._initialCenter=J,this._initialTopLeftPoint=this._getNewTopLeftPoint(J),I?this._initialTopLeftPoint._add(this._getMapPanePos()):F.DomUtil.setPosition(this._mapPane,new F.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var H=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!I}),H&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(K||N)&&this.fire("zoomend"),this.fire("moveend",{hard:!I})},_rawPanBy:function(H){F.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(H))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var H,J=1/0,M=-1/0,K=this._getZoomSpan();for(H in this._zoomBoundLayers){var I=this._zoomBoundLayers[H];isNaN(I.options.minZoom)||(J=Math.min(J,I.options.minZoom)),isNaN(I.options.maxZoom)||(M=Math.max(M,I.options.maxZoom))}H===B?this._layersMaxZoom=this._layersMinZoom=B:(this._layersMaxZoom=M,this._layersMinZoom=J),K!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded){throw new Error("Set map center and zoom first.")}},_initEvents:function(J){if(F.DomEvent){J=J||"on",F.DomEvent[J](this._container,"click",this._onMouseClick,this);var H,K,I=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(H=0,K=I.length;K>H;H++){F.DomEvent[J](this._container,I[H],this._fireMouseEvent,this)}this.options.trackResize&&F.DomEvent[J](C,"resize",this._onResize,this)}},_onResize:function(){F.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=F.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(H){!this._loaded||!H._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||F.DomEvent._skipped(H)||(this.fire("preclick"),this._fireMouseEvent(H))},_fireMouseEvent:function(I){if(this._loaded&&!F.DomEvent._skipped(I)){var K=I.type;if(K="mouseenter"===K?"mouseover":"mouseleave"===K?"mouseout":K,this.hasEventListeners(K)){"contextmenu"===K&&F.DomEvent.preventDefault(I);var H=this.mouseEventToContainerPoint(I),M=this.containerPointToLayerPoint(H),J=this.layerPointToLatLng(M);this.fire(K,{latlng:J,layerPoint:M,containerPoint:H,originalEvent:I})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var H=0,I=this._handlers.length;I>H;H++){this._handlers[H].disable()}},whenReady:function(H,I){return this._loaded?H.call(I||this,this):this.on("load",H,I),this},_layerAdd:function(H){H.onAdd(this),this.fire("layeradd",{layer:H})},_getMapPanePos:function(){return F.DomUtil.getPosition(this._mapPane)},_moved:function(){var H=this._getMapPanePos();return H&&!H.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(I,J){var H=this.getSize()._divideBy(2);return this.project(I,J)._subtract(H)._round()},_latLngToNewLayerPoint:function(I,J,H){var K=this._getNewTopLeftPoint(H,J).add(this._getMapPanePos());return this.project(I,J)._subtract(K)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(H){return this.latLngToLayerPoint(H).subtract(this._getCenterLayerPoint())},_limitCenter:function(J,N,I){if(!I){return J}var O=this.project(J,N),K=this.getSize().divideBy(2),H=new F.Bounds(O.subtract(K),O.add(K)),M=this._getBoundsOffset(H,I,N);return this.unproject(O.add(M),N)},_limitOffset:function(I,J){if(!J){return I}var H=this.getPixelBounds(),K=new F.Bounds(H.min.add(I),H.max.add(I));return I.add(this._getBoundsOffset(K,J))},_getBoundsOffset:function(J,N,I){var O=this.project(N.getNorthWest(),I).subtract(J.min),K=this.project(N.getSouthEast(),I).subtract(J.max),H=this._rebound(O.x,-K.x),M=this._rebound(O.y,-K.y);return new F.Point(H,M)},_rebound:function(H,I){return H+I>0?Math.round(H-I)/2:Math.max(0,Math.ceil(H))-Math.max(0,Math.floor(I))},_limitZoom:function(I){var J=this.getMinZoom(),H=this.getMaxZoom();return Math.max(J,Math.min(H,I))}}),F.map=function(H,I){return new F.Map(H,I)},F.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(S){var N=F.LatLng.DEG_TO_RAD,K=this.MAX_LATITUDE,I=Math.max(Math.min(K,S.lat),-K),T=this.R_MAJOR,Q=this.R_MINOR,H=S.lng*N*T,M=I*N,J=Q/T,R=Math.sqrt(1-J*J),P=R*Math.sin(M);P=Math.pow((1-P)/(1+P),0.5*R);var O=Math.tan(0.5*(0.5*Math.PI-M))/P;return M=-T*Math.log(O),new F.Point(H,M)},unproject:function(U){for(var O,M=F.LatLng.RAD_TO_DEG,J=this.R_MAJOR,V=this.R_MINOR,R=U.x*M/J,H=V/J,N=Math.sqrt(1-H*H),K=Math.exp(-U.y/J),T=Math.PI/2-2*Math.atan(K),Q=15,P=1e-7,I=Q,S=0.1;Math.abs(S)>P&&--I>0;){O=N*Math.sin(T),S=Math.PI/2-2*Math.atan(K*Math.pow((1-O)/(1+O),0.5*N))-T,T+=S}return new F.LatLng(T*M,R)}},F.CRS.EPSG3395=F.extend({},F.CRS,{code:"EPSG:3395",projection:F.Projection.Mercator,transformation:function(){var I=F.Projection.Mercator,J=I.R_MAJOR,H=0.5/(Math.PI*J);return new F.Transformation(H,0.5,-H,0.5)}()}),F.TileLayer=F.Class.extend({includes:F.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:F.Browser.mobile,updateWhenIdle:F.Browser.mobile},initialize:function(I,J){J=F.setOptions(this,J),J.detectRetina&&F.Browser.retina&&J.maxZoom>0&&(J.tileSize=Math.floor(J.tileSize/2),J.zoomOffset++,J.minZoom>0&&J.minZoom--,this.options.maxZoom--),J.bounds&&(J.bounds=F.latLngBounds(J.bounds)),this._url=I;var H=this.options.subdomains;"string"==typeof H&&(this.options.subdomains=H.split(""))},onAdd:function(H){this._map=H,this._animated=H._zoomAnimated,this._initContainer(),H.on({viewreset:this._reset,moveend:this._update},this),this._animated&&H.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=F.Util.limitExecByInterval(this._update,150,this),H.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(H){return H.addLayer(this),this},onRemove:function(H){this._container.parentNode.removeChild(this._container),H.off({viewreset:this._reset,moveend:this._update},this),this._animated&&H.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||H.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var H=this._map._panes.tilePane;return this._container&&(H.appendChild(this._container),this._setAutoZIndex(H,Math.max)),this},bringToBack:function(){var H=this._map._panes.tilePane;return this._container&&(H.insertBefore(this._container,H.firstChild),this._setAutoZIndex(H,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(H){return this.options.opacity=H,this._map&&this._updateOpacity(),this},setZIndex:function(H){return this.options.zIndex=H,this._updateZIndex(),this},setUrl:function(H,I){return this._url=H,I||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==B&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(J,M){var I,O,N,K=J.children,H=-M(1/0,-1/0);for(O=0,N=K.length;N>O;O++){K[O]!==this._container&&(I=parseInt(K[O].style.zIndex,10),isNaN(I)||(H=M(H,I)))}this.options.zIndex=this._container.style.zIndex=(isFinite(H)?H:0)+M(1,-1)},_updateOpacity:function(){var H,I=this._tiles;if(F.Browser.ielt9){for(H in I){F.DomUtil.setOpacity(I[H],this.options.opacity)}}else{F.DomUtil.setOpacity(this._container,this.options.opacity)}},_initContainer:function(){var H=this._map._panes.tilePane;if(!this._container){if(this._container=F.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var I="leaflet-tile-container";this._bgBuffer=F.DomUtil.create("div",I,this._container),this._tileContainer=F.DomUtil.create("div",I,this._container)}else{this._tileContainer=this._container}H.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(H){for(var I in this._tiles){this.fire("tileunload",{tile:this._tiles[I]})}this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&H&&H.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var I=this._map,J=I.getZoom()+this.options.zoomOffset,H=this.options.maxNativeZoom,K=this.options.tileSize;return H&&J>H&&(K=Math.round(I.getZoomScale(J)/I.getZoomScale(H)*K)),K},_update:function(){if(this._map){var I=this._map,K=I.getPixelBounds(),H=I.getZoom(),M=this._getTileSize();if(!(H>this.options.maxZoom||H<this.options.minZoom)){var J=F.bounds(K.min.divideBy(M)._floor(),K.max.divideBy(M)._floor());this._addTilesFromCenterOut(J),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(J)}}},_addTilesFromCenterOut:function(K){var J,P,N,I=[],O=K.getCenter();for(J=K.min.y;J<=K.max.y;J++){for(P=K.min.x;P<=K.max.x;P++){N=new F.Point(P,J),this._tileShouldBeLoaded(N)&&I.push(N)}}var M=I.length;if(0!==M){I.sort(function(Q,R){return Q.distanceTo(O)-R.distanceTo(O)});var H=E.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=M,P=0;M>P;P++){this._addTile(I[P],H)}this._tileContainer.appendChild(H)}},_tileShouldBeLoaded:function(J){if(J.x+":"+J.y in this._tiles){return !1}var N=this.options;if(!N.continuousWorld){var I=this._getWrapTileNum();if(N.noWrap&&(J.x<0||J.x>=I.x)||J.y<0||J.y>=I.y){return !1}}if(N.bounds){var P=N.tileSize,O=J.multiplyBy(P),K=O.add([P,P]),H=this._map.unproject(O),M=this._map.unproject(K);if(N.continuousWorld||N.noWrap||(H=H.wrap(),M=M.wrap()),!N.bounds.intersects([H,M])){return !1}}return !0},_removeOtherTiles:function(I){var J,H,M,K;for(K in this._tiles){J=K.split(":"),H=parseInt(J[0],10),M=parseInt(J[1],10),(H<I.min.x||H>I.max.x||M<I.min.y||M>I.max.y)&&this._removeTile(K)}},_removeTile:function(H){var I=this._tiles[H];this.fire("tileunload",{tile:I,url:I.src}),this.options.reuseTiles?(F.DomUtil.removeClass(I,"leaflet-tile-loaded"),this._unusedTiles.push(I)):I.parentNode===this._tileContainer&&this._tileContainer.removeChild(I),F.Browser.android||(I.onload=null,I.src=F.Util.emptyImageUrl),delete this._tiles[H]},_addTile:function(I,J){var H=this._getTilePos(I),K=this._getTile();F.DomUtil.setPosition(K,H,F.Browser.chrome),this._tiles[I.x+":"+I.y]=K,this._loadTile(K,I),K.parentNode!==this._tileContainer&&J.appendChild(K)},_getZoomForUrl:function(){var H=this.options,I=this._map.getZoom();return H.zoomReverse&&(I=H.maxZoom-I),I+=H.zoomOffset,H.maxNativeZoom?Math.min(I,H.maxNativeZoom):I},_getTilePos:function(I){var J=this._map.getPixelOrigin(),H=this._getTileSize();return I.multiplyBy(H).subtract(J)},getTileUrl:function(H){return F.Util.template(this._url,F.extend({s:this._getSubdomain(H),z:H.z,x:H.x,y:H.y},this.options))},_getWrapTileNum:function(){var H=this._map.options.crs,I=H.getSize(this._map.getZoom());return I.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(H){var I=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(H.x=(H.x%I.x+I.x)%I.x),this.options.tms&&(H.y=I.y-H.y-1),H.z=this._getZoomForUrl()},_getSubdomain:function(H){var I=Math.abs(H.x+H.y)%this.options.subdomains.length;return this.options.subdomains[I]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var H=this._unusedTiles.pop();return this._resetTile(H),H}return this._createTile()},_resetTile:function(){},_createTile:function(){var H=F.DomUtil.create("img","leaflet-tile");return H.style.width=H.style.height=this._getTileSize()+"px",H.galleryimg="no",H.onselectstart=H.onmousemove=F.Util.falseFn,F.Browser.ielt9&&this.options.opacity!==B&&F.DomUtil.setOpacity(H,this.options.opacity),F.Browser.mobileWebkit3d&&(H.style.WebkitBackfaceVisibility="hidden"),H},_loadTile:function(H,I){H._layer=this,H.onload=this._tileOnLoad,H.onerror=this._tileOnError,this._adjustTilePoint(I),H.src=this.getTileUrl(I),this.fire("tileloadstart",{tile:H,url:H.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&F.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(F.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var H=this._layer;this.src!==F.Util.emptyImageUrl&&(F.DomUtil.addClass(this,"leaflet-tile-loaded"),H.fire("tileload",{tile:this,url:this.src})),H._tileLoaded()},_tileOnError:function(){var H=this._layer;H.fire("tileerror",{tile:this,url:this.src});var I=H.options.errorTileUrl;I&&(this.src=I),H._tileLoaded()}}),F.tileLayer=function(H,I){return new F.TileLayer(H,I)},F.TileLayer.WMS=F.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(I,K){this._url=I;var H=F.extend({},this.defaultWmsParams),M=K.tileSize||this.options.tileSize;H.width=H.height=K.detectRetina&&F.Browser.retina?2*M:M;for(var J in K){this.options.hasOwnProperty(J)||"crs"===J||(H[J]=K[J])}this.wmsParams=H,F.setOptions(this,K)},onAdd:function(H){this._crs=this.options.crs||H.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var I=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[I]=this._crs.code,F.TileLayer.prototype.onAdd.call(this,H)},getTileUrl:function(P){var N=this._map,K=this.options.tileSize,I=P.multiplyBy(K),Q=I.add([K,K]),O=this._crs.project(N.unproject(I,P.z)),H=this._crs.project(N.unproject(Q,P.z)),M=this._wmsVersion>=1.3&&this._crs===F.CRS.EPSG4326?[H.y,O.x,O.y,H.x].join(","):[O.x,H.y,H.x,O.y].join(","),J=F.Util.template(this._url,{s:this._getSubdomain(P)});return J+F.Util.getParamString(this.wmsParams,J,!0)+"&BBOX="+M},setParams:function(H,I){return F.extend(this.wmsParams,H),I||this.redraw(),this}}),F.tileLayer.wms=function(H,I){return new F.TileLayer.WMS(H,I)},F.TileLayer.Canvas=F.TileLayer.extend({options:{async:!1},initialize:function(H){F.setOptions(this,H)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var H in this._tiles){this._redrawTile(this._tiles[H])}return this},_redrawTile:function(H){this.drawTile(H,H._tilePoint,this._map._zoom)},_createTile:function(){var H=F.DomUtil.create("canvas","leaflet-tile");return H.width=H.height=this.options.tileSize,H.onselectstart=H.onmousemove=F.Util.falseFn,H},_loadTile:function(H,I){H._layer=this,H._tilePoint=I,this._redrawTile(H),this.options.async||this.tileDrawn(H)},drawTile:function(){},tileDrawn:function(H){this._tileOnLoad.call(H)}}),F.tileLayer.canvas=function(H){return new F.TileLayer.Canvas(H)},F.ImageOverlay=F.Class.extend({includes:F.Mixin.Events,options:{opacity:1},initialize:function(I,J,H){this._url=I,this._bounds=F.latLngBounds(J),F.setOptions(this,H)},onAdd:function(H){this._map=H,this._image||this._initImage(),H._panes.overlayPane.appendChild(this._image),H.on("viewreset",this._reset,this),H.options.zoomAnimation&&F.Browser.any3d&&H.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(H){H.getPanes().overlayPane.removeChild(this._image),H.off("viewreset",this._reset,this),H.options.zoomAnimation&&H.off("zoomanim",this._animateZoom,this)},addTo:function(H){return H.addLayer(this),this},setOpacity:function(H){return this.options.opacity=H,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var H=this._map._panes.overlayPane;return this._image&&H.insertBefore(this._image,H.firstChild),this},setUrl:function(H){this._url=H,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=F.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&F.Browser.any3d?F.DomUtil.addClass(this._image,"leaflet-zoom-animated"):F.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),F.extend(this._image,{galleryimg:"no",onselectstart:F.Util.falseFn,onmousemove:F.Util.falseFn,onload:F.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(P){var N=this._map,K=this._image,I=N.getZoomScale(P.zoom),Q=this._bounds.getNorthWest(),O=this._bounds.getSouthEast(),H=N._latLngToNewLayerPoint(Q,P.zoom,P.center),M=N._latLngToNewLayerPoint(O,P.zoom,P.center)._subtract(H),J=H._add(M._multiplyBy(0.5*(1-1/I)));K.style[F.DomUtil.TRANSFORM]=F.DomUtil.getTranslateString(J)+" scale("+I+") "},_reset:function(){var I=this._image,J=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),H=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(J);F.DomUtil.setPosition(I,J),I.style.width=H.x+"px",I.style.height=H.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){F.DomUtil.setOpacity(this._image,this.options.opacity)}}),F.imageOverlay=function(I,J,H){return new F.ImageOverlay(I,J,H)},F.Icon=F.Class.extend({options:{className:""},initialize:function(H){F.setOptions(this,H)},createIcon:function(H){return this._createIcon("icon",H)},createShadow:function(H){return this._createIcon("shadow",H)},_createIcon:function(I,J){var H=this._getIconUrl(I);if(!H){if("icon"===I){throw new Error("iconUrl not set in Icon options (see the docs).")}return null}var K;return K=J&&"IMG"===J.tagName?this._createImg(H,J):this._createImg(H),this._setIconStyles(K,I),K},_setIconStyles:function(I,K){var H,M=this.options,J=F.point(M[K+"Size"]);H=F.point("shadow"===K?M.shadowAnchor||M.iconAnchor:M.iconAnchor),!H&&J&&(H=J.divideBy(2,!0)),I.className="leaflet-marker-"+K+" "+M.className,H&&(I.style.marginLeft=-H.x+"px",I.style.marginTop=-H.y+"px"),J&&(I.style.width=J.x+"px",I.style.height=J.y+"px")},_createImg:function(I,H){return H=H||E.createElement("img"),H.src=I,H},_getIconUrl:function(H){return F.Browser.retina&&this.options[H+"RetinaUrl"]?this.options[H+"RetinaUrl"]:this.options[H+"Url"]}}),F.icon=function(H){return new F.Icon(H)},F.Icon.Default=F.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(I){var J=I+"Url";if(this.options[J]){return this.options[J]}F.Browser.retina&&"icon"===I&&(I+="-2x");var H=F.Icon.Default.imagePath;if(!H){throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.")}return H+"/marker-"+I+".png"}}),F.Icon.Default.imagePath=function(){var J,I,O,N,K,H=E.getElementsByTagName("script"),M=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(J=0,I=H.length;I>J;J++){if(O=H[J].src,N=O.match(M)){return K=O.split(M)[0],(K?K+"/":"")+"images"}}}(),F.Marker=F.Class.extend({includes:F.Mixin.Events,options:{icon:new F.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(H,I){F.setOptions(this,I),this._latlng=F.latLng(H)},onAdd:function(H){this._map=H,H.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),H.options.zoomAnimation&&H.options.markerZoomAnimation&&H.on("zoomanim",this._animateZoom,this)},addTo:function(H){return H.addLayer(this),this},onRemove:function(H){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),H.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(H){return this._latlng=F.latLng(H),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(H){return this.options.zIndexOffset=H,this.update(),this},setIcon:function(H){return this.options.icon=H,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var H=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(H)}return this},_initIcon:function(){var P=this.options,N=this._map,K=N.options.zoomAnimation&&N.options.markerZoomAnimation,I=K?"leaflet-zoom-animated":"leaflet-zoom-hide",Q=P.icon.createIcon(this._icon),O=!1;Q!==this._icon&&(this._icon&&this._removeIcon(),O=!0,P.title&&(Q.title=P.title),P.alt&&(Q.alt=P.alt)),F.DomUtil.addClass(Q,I),P.keyboard&&(Q.tabIndex="0"),this._icon=Q,this._initInteraction(),P.riseOnHover&&F.DomEvent.on(Q,"mouseover",this._bringToFront,this).on(Q,"mouseout",this._resetZIndex,this);var H=P.icon.createShadow(this._shadow),M=!1;H!==this._shadow&&(this._removeShadow(),M=!0),H&&F.DomUtil.addClass(H,I),this._shadow=H,P.opacity<1&&this._updateOpacity();var J=this._map._panes;O&&J.markerPane.appendChild(this._icon),H&&M&&J.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&F.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(H){F.DomUtil.setPosition(this._icon,H),this._shadow&&F.DomUtil.setPosition(this._shadow,H),this._zIndex=H.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(H){this._icon.style.zIndex=this._zIndex+H},_animateZoom:function(H){var I=this._map._latLngToNewLayerPoint(this._latlng,H.zoom,H.center).round();this._setPos(I)},_initInteraction:function(){if(this.options.clickable){var I=this._icon,J=["dblclick","mousedown","mouseover","mouseout","contextmenu"];F.DomUtil.addClass(I,"leaflet-clickable"),F.DomEvent.on(I,"click",this._onMouseClick,this),F.DomEvent.on(I,"keypress",this._onKeyPress,this);for(var H=0;H<J.length;H++){F.DomEvent.on(I,J[H],this._fireMouseEvent,this)}F.Handler.MarkerDrag&&(this.dragging=new F.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(H){var I=this.dragging&&this.dragging.moved();(this.hasEventListeners(H.type)||I)&&F.DomEvent.stopPropagation(H),I||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(H.type,{originalEvent:H,latlng:this._latlng})},_onKeyPress:function(H){13===H.keyCode&&this.fire("click",{originalEvent:H,latlng:this._latlng})},_fireMouseEvent:function(H){this.fire(H.type,{originalEvent:H,latlng:this._latlng}),"contextmenu"===H.type&&this.hasEventListeners(H.type)&&F.DomEvent.preventDefault(H),"mousedown"!==H.type?F.DomEvent.stopPropagation(H):F.DomEvent.preventDefault(H)},setOpacity:function(H){return this.options.opacity=H,this._map&&this._updateOpacity(),this},_updateOpacity:function(){F.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&F.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),F.marker=function(H,I){return new F.Marker(H,I)},F.DivIcon=F.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(I){var H=I&&"DIV"===I.tagName?I:E.createElement("div"),J=this.options;return H.innerHTML=J.html!==!1?J.html:"",J.bgPos&&(H.style.backgroundPosition=-J.bgPos.x+"px "+-J.bgPos.y+"px"),this._setIconStyles(H,"icon"),H},createShadow:function(){return null}}),F.divIcon=function(H){return new F.DivIcon(H)},F.Map.mergeOptions({closePopupOnClick:!0}),F.Popup=F.Class.extend({includes:F.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(H,I){F.setOptions(this,H),this._source=I,this._animated=F.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(H){this._map=H,this._container||this._initLayout();var I=H.options.fadeAnimation;I&&F.DomUtil.setOpacity(this._container,0),H._panes.popupPane.appendChild(this._container),H.on(this._getEvents(),this),this.update(),I&&F.DomUtil.setOpacity(this._container,1),this.fire("open"),H.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(H){return H.addLayer(this),this},openOn:function(H){return H.openPopup(this),this},onRemove:function(H){H._panes.popupPane.removeChild(this._container),F.Util.falseFn(this._container.offsetWidth),H.off(this._getEvents(),this),H.options.fadeAnimation&&F.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),H.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(H){return this._latlng=F.latLng(H),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(H){return this._content=H,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var H={viewreset:this._updatePosition};return this._animated&&(H.zoomanim=this._zoomAnimation),("closeOnClick" in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(H.preclick=this._close),this.options.keepInView&&(H.moveend=this._adjustPan),H},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var I,K="leaflet-popup",H=K+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),M=this._container=F.DomUtil.create("div",H);this.options.closeButton&&(I=this._closeButton=F.DomUtil.create("a",K+"-close-button",M),I.href="#close",I.innerHTML="&#215;",F.DomEvent.disableClickPropagation(I),F.DomEvent.on(I,"click",this._onCloseButtonClick,this));var J=this._wrapper=F.DomUtil.create("div",K+"-content-wrapper",M);F.DomEvent.disableClickPropagation(J),this._contentNode=F.DomUtil.create("div",K+"-content",J),F.DomEvent.disableScrollPropagation(this._contentNode),F.DomEvent.on(J,"contextmenu",F.DomEvent.stopPropagation),this._tipContainer=F.DomUtil.create("div",K+"-tip-container",M),this._tip=F.DomUtil.create("div",K+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content){this._contentNode.innerHTML=this._content}else{for(;this._contentNode.hasChildNodes();){this._contentNode.removeChild(this._contentNode.firstChild)}this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var J=this._contentNode,M=J.style;M.width="",M.whiteSpace="nowrap";var I=J.offsetWidth;I=Math.min(I,this.options.maxWidth),I=Math.max(I,this.options.minWidth),M.width=I+1+"px",M.whiteSpace="",M.height="";var N=J.offsetHeight,K=this.options.maxHeight,H="leaflet-popup-scrolled";K&&N>K?(M.height=K+"px",F.DomUtil.addClass(J,H)):F.DomUtil.removeClass(J,H),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var I=this._map.latLngToLayerPoint(this._latlng),J=this._animated,H=F.point(this.options.offset);J&&F.DomUtil.setPosition(this._container,I),this._containerBottom=-H.y-(J?0:I.y),this._containerLeft=-Math.round(this._containerWidth/2)+H.x+(J?0:I.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(H){var I=this._map._latLngToNewLayerPoint(this._latlng,H.zoom,H.center);F.DomUtil.setPosition(this._container,I)},_adjustPan:function(){if(this.options.autoPan){var R=this._map,N=this._container.offsetHeight,K=this._containerWidth,I=new F.Point(this._containerLeft,-N-this._containerBottom);this._animated&&I._add(F.DomUtil.getPosition(this._container));var S=R.layerPointToContainerPoint(I),P=F.point(this.options.autoPanPadding),H=F.point(this.options.autoPanPaddingTopLeft||P),M=F.point(this.options.autoPanPaddingBottomRight||P),J=R.getSize(),Q=0,O=0;S.x+K+M.x>J.x&&(Q=S.x+K-J.x+M.x),S.x-Q-H.x<0&&(Q=S.x-H.x),S.y+N+M.y>J.y&&(O=S.y+N-J.y+M.y),S.y-O-H.y<0&&(O=S.y-H.y),(Q||O)&&R.fire("autopanstart").panBy([Q,O])}},_onCloseButtonClick:function(H){this._close(),F.DomEvent.stop(H)}}),F.popup=function(H,I){return new F.Popup(H,I)},F.Map.include({openPopup:function(I,J,H){if(this.closePopup(),!(I instanceof F.Popup)){var K=I;I=new F.Popup(H).setLatLng(J).setContent(K)}return I._isOpen=!0,this._popup=I,this.addLayer(I)},closePopup:function(H){return H&&H!==this._popup||(H=this._popup,this._popup=null),H&&(this.removeLayer(H),H._isOpen=!1),this}}),F.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(I,J){var H=F.point(this.options.icon.options.popupAnchor||[0,0]);return H=H.add(F.Popup.prototype.options.offset),J&&J.offset&&(H=H.add(J.offset)),J=F.extend({offset:H},J),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),I instanceof F.Popup?(F.setOptions(I,J),this._popup=I):this._popup=new F.Popup(J,this).setContent(I),this},setPopupContent:function(H){return this._popup&&this._popup.setContent(H),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(H){this._popup.setLatLng(H.latlng)}}),F.LayerGroup=F.Class.extend({initialize:function(I){this._layers={};var J,H;if(I){for(J=0,H=I.length;H>J;J++){this.addLayer(I[J])}}},addLayer:function(H){var I=this.getLayerId(H);return this._layers[I]=H,this._map&&this._map.addLayer(H),this},removeLayer:function(H){var I=H in this._layers?H:this.getLayerId(H);return this._map&&this._layers[I]&&this._map.removeLayer(this._layers[I]),delete this._layers[I],this},hasLayer:function(H){return H?H in this._layers||this.getLayerId(H) in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(I){var J,H,K=Array.prototype.slice.call(arguments,1);for(J in this._layers){H=this._layers[J],H[I]&&H[I].apply(H,K)}return this},onAdd:function(H){this._map=H,this.eachLayer(H.addLayer,H)},onRemove:function(H){this.eachLayer(H.removeLayer,H),this._map=null},addTo:function(H){return H.addLayer(this),this},eachLayer:function(I,J){for(var H in this._layers){I.call(J,this._layers[H])}return this},getLayer:function(H){return this._layers[H]},getLayers:function(){var H=[];for(var I in this._layers){H.push(this._layers[I])}return H},setZIndex:function(H){return this.invoke("setZIndex",H)},getLayerId:function(H){return F.stamp(H)}}),F.layerGroup=function(H){return new F.LayerGroup(H)},F.FeatureGroup=F.LayerGroup.extend({includes:F.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(H){return this.hasLayer(H)?this:("on" in H&&H.on(F.FeatureGroup.EVENTS,this._propagateEvent,this),F.LayerGroup.prototype.addLayer.call(this,H),this._popupContent&&H.bindPopup&&H.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:H}))},removeLayer:function(H){return this.hasLayer(H)?(H in this._layers&&(H=this._layers[H]),H.off(F.FeatureGroup.EVENTS,this._propagateEvent,this),F.LayerGroup.prototype.removeLayer.call(this,H),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:H})):this},bindPopup:function(H,I){return this._popupContent=H,this._popupOptions=I,this.invoke("bindPopup",H,I)},openPopup:function(H){for(var I in this._layers){this._layers[I].openPopup(H);break}return this},setStyle:function(H){return this.invoke("setStyle",H)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var H=new F.LatLngBounds;return this.eachLayer(function(I){H.extend(I instanceof F.Marker?I.getLatLng():I.getBounds())}),H},_propagateEvent:function(H){H=F.extend({layer:H.target,target:this},H),this.fire(H.type,H)}}),F.featureGroup=function(H){return new F.FeatureGroup(H)},F.Path=F.Class.extend({includes:[F.Mixin.Events],statics:{CLIP_PADDING:function(){var I=F.Browser.mobile?1280:2000,H=(I/Math.max(C.outerWidth,C.outerHeight)-1)/2;return Math.max(0,Math.min(0.5,H))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:0.5,fill:!1,fillColor:null,fillOpacity:0.2,clickable:!0},initialize:function(H){F.setOptions(this,H)},onAdd:function(H){this._map=H,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),H.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(H){return H.addLayer(this),this},onRemove:function(H){H._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,F.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),H.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(H){return F.setOptions(this,H),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),F.Map.include({_updatePathViewport:function(){var I=F.Path.CLIP_PADDING,K=this.getSize(),H=F.DomUtil.getPosition(this._mapPane),M=H.multiplyBy(-1)._subtract(K.multiplyBy(I)._round()),J=M.add(K.multiplyBy(1+2*I)._round());this._pathViewport=new F.Bounds(M,J)}}),F.Path.SVG_NS="http://www.w3.org/2000/svg",F.Browser.svg=!(!E.createElementNS||!E.createElementNS(F.Path.SVG_NS,"svg").createSVGRect),F.Path=F.Path.extend({statics:{SVG:F.Browser.svg},bringToFront:function(){var H=this._map._pathRoot,I=this._container;return I&&H.lastChild!==I&&H.appendChild(I),this},bringToBack:function(){var I=this._map._pathRoot,J=this._container,H=I.firstChild;return J&&H!==J&&I.insertBefore(J,H),this},getPathString:function(){},_createElement:function(H){return E.createElementNS(F.Path.SVG_NS,H)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&F.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var H=this.getPathString();H||(H="M0 0"),this._path.setAttribute("d",H)},_initEvents:function(){if(this.options.clickable){(F.Browser.svg||!F.Browser.vml)&&F.DomUtil.addClass(this._path,"leaflet-clickable"),F.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var H=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],I=0;I<H.length;I++){F.DomEvent.on(this._container,H[I],this._fireMouseEvent,this)}}},_onMouseClick:function(H){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(H)},_fireMouseEvent:function(I){if(this.hasEventListeners(I.type)){var K=this._map,H=K.mouseEventToContainerPoint(I),M=K.containerPointToLayerPoint(H),J=K.layerPointToLatLng(M);this.fire(I.type,{latlng:J,layerPoint:M,containerPoint:H,originalEvent:I}),"contextmenu"===I.type&&F.DomEvent.preventDefault(I),"mousemove"!==I.type&&F.DomEvent.stopPropagation(I)}}}),F.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=F.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&F.Browser.any3d?(F.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):F.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(I){var J=this.getZoomScale(I.zoom),H=this._getCenterOffset(I.center)._multiplyBy(-J)._add(this._pathViewport.min);this._pathRoot.style[F.DomUtil.TRANSFORM]=F.DomUtil.getTranslateString(H)+" scale("+J+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var J=this._pathViewport,N=J.min,I=J.max,O=I.x-N.x,K=I.y-N.y,H=this._pathRoot,M=this._panes.overlayPane;F.Browser.mobileWebkit&&M.removeChild(H),F.DomUtil.setPosition(H,N),H.setAttribute("width",O),H.setAttribute("height",K),H.setAttribute("viewBox",[N.x,N.y,O,K].join(" ")),F.Browser.mobileWebkit&&M.appendChild(H)}}}),F.Path.include({bindPopup:function(H,I){return H instanceof F.Popup?this._popup=H:((!this._popup||I)&&(this._popup=new F.Popup(I,this)),this._popup.setContent(H)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(H){return this._popup&&(H=H||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:H})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(H){this._popup.setLatLng(H.latlng),this._map.openPopup(this._popup)}}),F.Browser.vml=!F.Browser.svg&&function(){try{var I=E.createElement("div");I.innerHTML='<v:shape adj="1"/>';var H=I.firstChild;return H.style.behavior="url(#default#VML)",H&&"object"==typeof H.adj}catch(J){return !1}}(),F.Path=F.Browser.svg||!F.Browser.vml?F.Path:F.Path.extend({statics:{VML:!0,CLIP_PADDING:0.02},_createElement:function(){try{return E.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(I){return E.createElement("<lvml:"+I+' class="lvml">')}}catch(H){return function(I){return E.createElement("<"+I+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var H=this._container=this._createElement("shape");F.DomUtil.addClass(H,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&F.DomUtil.addClass(H,"leaflet-clickable"),H.coordsize="1 1",this._path=this._createElement("path"),H.appendChild(this._path),this._map._pathRoot.appendChild(H)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var I=this._stroke,J=this._fill,H=this.options,K=this._container;K.stroked=H.stroke,K.filled=H.fill,H.stroke?(I||(I=this._stroke=this._createElement("stroke"),I.endcap="round",K.appendChild(I)),I.weight=H.weight+"px",I.color=H.color,I.opacity=H.opacity,I.dashStyle=H.dashArray?F.Util.isArray(H.dashArray)?H.dashArray.join(" "):H.dashArray.replace(/( *, *)/g," "):"",H.lineCap&&(I.endcap=H.lineCap.replace("butt","flat")),H.lineJoin&&(I.joinstyle=H.lineJoin)):I&&(K.removeChild(I),this._stroke=null),H.fill?(J||(J=this._fill=this._createElement("fill"),K.appendChild(J)),J.color=H.fillColor||H.color,J.opacity=H.fillOpacity):J&&(K.removeChild(J),this._fill=null)},_updatePath:function(){var H=this._container.style;H.display="none",this._path.v=this.getPathString()+" ",H.display=""}}),F.Map.include(F.Browser.svg||!F.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var H=this._pathRoot=E.createElement("div");H.className="leaflet-vml-container",this._panes.overlayPane.appendChild(H),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),F.Browser.canvas=function(){return !!E.createElement("canvas").getContext}(),F.Path=F.Path.SVG&&!C.L_PREFER_CANVAS||!F.Browser.canvas?F.Path:F.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(H){return F.setOptions(this,H),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(H){H.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!F.Path._updateRequest&&(F.Path._updateRequest=F.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){F.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var H=this.options;H.stroke&&(this._ctx.lineWidth=H.weight,this._ctx.strokeStyle=H.color),H.fill&&(this._ctx.fillStyle=H.fillColor||H.color)},_drawPath:function(){var J,M,I,N,K,H;for(this._ctx.beginPath(),J=0,I=this._parts.length;I>J;J++){for(M=0,N=this._parts[J].length;N>M;M++){K=this._parts[J][M],H=(0===M?"move":"line")+"To",this._ctx[H](K.x,K.y)}this instanceof F.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return !this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var H=this._ctx,I=this.options;this._drawPath(),H.save(),this._updateStyle(),I.fill&&(H.globalAlpha=I.fillOpacity,H.fill()),I.stroke&&(H.globalAlpha=I.opacity,H.stroke()),H.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(H){this._containsPoint(H.layerPoint)&&this.fire("click",H)},_onMouseMove:function(H){this._map&&!this._map._animatingZoom&&(this._containsPoint(H.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",H)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",H)))}}),F.Map.include(F.Path.SVG&&!C.L_PREFER_CANVAS||!F.Browser.canvas?{}:{_initPathRoot:function(){var I,H=this._pathRoot;H||(H=this._pathRoot=E.createElement("canvas"),H.style.position="absolute",I=this._canvasCtx=H.getContext("2d"),I.lineCap="round",I.lineJoin="round",this._panes.overlayPane.appendChild(H),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var I=this._pathViewport,J=I.min,H=I.max.subtract(J),K=this._pathRoot;F.DomUtil.setPosition(K,J),K.width=H.x,K.height=H.y,K.getContext("2d").translate(-J.x,-J.y)}}}),F.LineUtil={simplify:function(I,J){if(!J||!I.length){return I.slice()}var H=J*J;return I=this._reducePoints(I,H),I=this._simplifyDP(I,H)},pointToSegmentDistance:function(I,J,H){return Math.sqrt(this._sqClosestPointOnSegment(I,J,H,!0))},closestPointOnSegment:function(I,J,H){return this._sqClosestPointOnSegment(I,J,H)},_simplifyDP:function(I,M){var O=I.length,N=typeof Uint8Array!=B+""?Uint8Array:Array,J=new N(O);J[0]=J[O-1]=1,this._simplifyDPStep(I,J,M,0,O-1);var H,K=[];for(H=0;O>H;H++){J[H]&&K.push(I[H])}return K},_simplifyDPStep:function(P,N,K,J,I){var Q,O,H,M=0;for(O=J+1;I-1>=O;O++){H=this._sqClosestPointOnSegment(P[O],P[J],P[I],!0),H>M&&(Q=O,M=H)}M>K&&(N[Q]=1,this._simplifyDPStep(P,N,K,J,Q),this._simplifyDPStep(P,N,K,Q,I))},_reducePoints:function(I,K){for(var H=[I[0]],N=1,M=0,J=I.length;J>N;N++){this._sqDist(I[N],I[M])>K&&(H.push(I[N]),M=N)}return J-1>M&&H.push(I[J-1]),H},clipSegment:function(P,N,K,J){var I,Q,O,H=J?this._lastCode:this._getBitCode(P,K),M=this._getBitCode(N,K);for(this._lastCode=M;;){if(!(H|M)){return[P,N]}if(H&M){return !1}I=H||M,Q=this._getEdgeIntersection(P,N,I,K),O=this._getBitCode(Q,K),I===H?(P=Q,H=O):(N=Q,M=O)}},_getEdgeIntersection:function(J,O,I,P){var M=O.x-J.x,H=O.y-J.y,N=P.min,K=P.max;return 8&I?new F.Point(J.x+M*(K.y-J.y)/H,K.y):4&I?new F.Point(J.x+M*(N.y-J.y)/H,N.y):2&I?new F.Point(K.x,J.y+H*(K.x-J.x)/M):1&I?new F.Point(N.x,J.y+H*(N.x-J.x)/M):void 0},_getBitCode:function(I,J){var H=0;return I.x<J.min.x?H|=1:I.x>J.max.x&&(H|=2),I.y<J.min.y?H|=4:I.y>J.max.y&&(H|=8),H},_sqDist:function(I,J){var H=J.x-I.x,K=J.y-I.y;return H*H+K*K},_sqClosestPointOnSegment:function(Q,N,K,I){var R,O=N.x,H=N.y,M=K.x-O,J=K.y-H,P=M*M+J*J;return P>0&&(R=((Q.x-O)*M+(Q.y-H)*J)/P,R>1?(O=K.x,H=K.y):R>0&&(O+=M*R,H+=J*R)),M=Q.x-O,J=Q.y-H,I?M*M+J*J:new F.Point(O,H)}},F.Polyline=F.Path.extend({initialize:function(H,I){F.Path.prototype.initialize.call(this,I),this._latlngs=this._convertLatLngs(H)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var H=0,I=this._latlngs.length;I>H;H++){this._originalPoints[H]=this._map.latLngToLayerPoint(this._latlngs[H])}},getPathString:function(){for(var I=0,J=this._parts.length,H="";J>I;I++){H+=this._getPathPartStr(this._parts[I])}return H},getLatLngs:function(){return this._latlngs},setLatLngs:function(H){return this._latlngs=this._convertLatLngs(H),this.redraw()},addLatLng:function(H){return this._latlngs.push(F.latLng(H)),this.redraw()},spliceLatLngs:function(){var H=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),H},closestLayerPoint:function(S){for(var N,K,I=1/0,T=this._parts,Q=null,H=0,M=T.length;M>H;H++){for(var J=T[H],R=1,P=J.length;P>R;R++){N=J[R-1],K=J[R];var O=F.LineUtil._sqClosestPointOnSegment(S,N,K,!0);I>O&&(I=O,Q=F.LineUtil._sqClosestPointOnSegment(S,N,K))}}return Q&&(Q.distance=Math.sqrt(I)),Q},getBounds:function(){return new F.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(I,K){var H,M,J=K?I:[];for(H=0,M=I.length;M>H;H++){if(F.Util.isArray(I[H])&&"number"!=typeof I[H][0]){return }J[H]=F.latLng(I[H])}return J},_initEvents:function(){F.Path.prototype._initEvents.call(this)},_getPathPartStr:function(J){for(var M,I=F.Path.VML,N=0,K=J.length,H="";K>N;N++){M=J[N],I&&M._round(),H+=(N?"L":"M")+M.x+" "+M.y}return H},_clipPoints:function(){var J,O,I,P=this._originalPoints,M=P.length;if(this.options.noClip){return void (this._parts=[P])}this._parts=[];var H=this._parts,N=this._map._pathViewport,K=F.LineUtil;for(J=0,O=0;M-1>J;J++){I=K.clipSegment(P[J],P[J+1],N,J),I&&(H[O]=H[O]||[],H[O].push(I[0]),(I[1]!==P[J+1]||J===M-2)&&(H[O].push(I[1]),O++))}},_simplifyPoints:function(){for(var I=this._parts,J=F.LineUtil,H=0,K=I.length;K>H;H++){I[H]=J.simplify(I[H],this.options.smoothFactor)}},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),F.Path.prototype._updatePath.call(this))}}),F.polyline=function(H,I){return new F.Polyline(H,I)},F.PolyUtil={},F.PolyUtil.clipPolygon=function(T,O){var M,J,U,R,H,N,K,S,Q,P=[1,4,2,8],I=F.LineUtil;for(J=0,K=T.length;K>J;J++){T[J]._code=I._getBitCode(T[J],O)}for(R=0;4>R;R++){for(S=P[R],M=[],J=0,K=T.length,U=K-1;K>J;U=J++){H=T[J],N=T[U],H._code&S?N._code&S||(Q=I._getEdgeIntersection(N,H,S,O),Q._code=I._getBitCode(Q,O),M.push(Q)):(N._code&S&&(Q=I._getEdgeIntersection(N,H,S,O),Q._code=I._getBitCode(Q,O),M.push(Q)),M.push(H))}T=M}return T},F.Polygon=F.Polyline.extend({options:{fill:!0},initialize:function(H,I){F.Polyline.prototype.initialize.call(this,H,I),this._initWithHoles(H)},_initWithHoles:function(I){var J,H,K;if(I&&F.Util.isArray(I[0])&&"number"!=typeof I[0][0]){for(this._latlngs=this._convertLatLngs(I[0]),this._holes=I.slice(1),J=0,H=this._holes.length;H>J;J++){K=this._holes[J]=this._convertLatLngs(this._holes[J]),K[0].equals(K[K.length-1])&&K.pop()}}I=this._latlngs,I.length>=2&&I[0].equals(I[I.length-1])&&I.pop()},projectLatlngs:function(){if(F.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var I,J,H,K;for(I=0,H=this._holes.length;H>I;I++){for(this._holePoints[I]=[],J=0,K=this._holes[I].length;K>J;J++){this._holePoints[I][J]=this._map.latLngToLayerPoint(this._holes[I][J])}}}},setLatLngs:function(H){return H&&F.Util.isArray(H[0])&&"number"!=typeof H[0][0]?(this._initWithHoles(H),this.redraw()):F.Polyline.prototype.setLatLngs.call(this,H)},_clipPoints:function(){var I=this._originalPoints,K=[];if(this._parts=[I].concat(this._holePoints),!this.options.noClip){for(var H=0,M=this._parts.length;M>H;H++){var J=F.PolyUtil.clipPolygon(this._parts[H],this._map._pathViewport);J.length&&K.push(J)}this._parts=K}},_getPathPartStr:function(H){var I=F.Polyline.prototype._getPathPartStr.call(this,H);return I+(F.Browser.svg?"z":"x")}}),F.polygon=function(H,I){return new F.Polygon(H,I)},function(){function H(I){return F.FeatureGroup.extend({initialize:function(J,K){this._layers={},this._options=K,this.setLatLngs(J)},setLatLngs:function(K){var J=0,M=K.length;for(this.eachLayer(function(N){M>J?N.setLatLngs(K[J++]):this.removeLayer(N)},this);M>J;){this.addLayer(new I(K[J++],this._options))}return this},getLatLngs:function(){var J=[];return this.eachLayer(function(K){J.push(K.getLatLngs())}),J}})}F.MultiPolyline=H(F.Polyline),F.MultiPolygon=H(F.Polygon),F.multiPolyline=function(I,J){return new F.MultiPolyline(I,J)},F.multiPolygon=function(I,J){return new F.MultiPolygon(I,J)}}(),F.Rectangle=F.Polygon.extend({initialize:function(H,I){F.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(H),I)},setBounds:function(H){this.setLatLngs(this._boundsToLatLngs(H))},_boundsToLatLngs:function(H){return H=F.latLngBounds(H),[H.getSouthWest(),H.getNorthWest(),H.getNorthEast(),H.getSouthEast()]}}),F.rectangle=function(H,I){return new F.Rectangle(H,I)},F.Circle=F.Path.extend({initialize:function(I,J,H){F.Path.prototype.initialize.call(this,H),this._latlng=F.latLng(I),this._mRadius=J},options:{fill:!0},setLatLng:function(H){return this._latlng=F.latLng(H),this.redraw()},setRadius:function(H){return this._mRadius=H,this.redraw()},projectLatlngs:function(){var I=this._getLngRadius(),J=this._latlng,H=this._map.latLngToLayerPoint([J.lat,J.lng-I]);this._point=this._map.latLngToLayerPoint(J),this._radius=Math.max(this._point.x-H.x,1)},getBounds:function(){var I=this._getLngRadius(),J=this._mRadius/40075017*360,H=this._latlng;return new F.LatLngBounds([H.lat-J,H.lng-I],[H.lat+J,H.lng+I])},getLatLng:function(){return this._latlng},getPathString:function(){var H=this._point,I=this._radius;return this._checkIfEmpty()?"":F.Browser.svg?"M"+H.x+","+(H.y-I)+"A"+I+","+I+",0,1,1,"+(H.x-0.1)+","+(H.y-I)+" z":(H._round(),I=Math.round(I),"AL "+H.x+","+H.y+" "+I+","+I+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(F.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map){return !1}var I=this._map._pathViewport,J=this._radius,H=this._point;return H.x-J>I.max.x||H.y-J>I.max.y||H.x+J<I.min.x||H.y+J<I.min.y}}),F.circle=function(I,J,H){return new F.Circle(I,J,H)},F.CircleMarker=F.Circle.extend({options:{radius:10,weight:2},initialize:function(H,I){F.Circle.prototype.initialize.call(this,H,null,I),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){F.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(H){return F.Circle.prototype.setLatLng.call(this,H),this._popup&&this._popup._isOpen&&this._popup.setLatLng(H),this},setRadius:function(H){return this.options.radius=this._radius=H,this.redraw()},getRadius:function(){return this._radius}}),F.circleMarker=function(H,I){return new F.CircleMarker(H,I)},F.Polyline.include(F.Path.CANVAS?{_containsPoint:function(Q,N){var K,I,R,O,H,M,J,P=this.options.weight/2;for(F.Browser.touch&&(P+=10),K=0,O=this._parts.length;O>K;K++){for(J=this._parts[K],I=0,H=J.length,R=H-1;H>I;R=I++){if((N||0!==I)&&(M=F.LineUtil.pointToSegmentDistance(Q,J[R],J[I]),P>=M)){return !0}}}return !1}}:{}),F.Polygon.include(F.Path.CANVAS?{_containsPoint:function(Q){var N,K,I,R,O,H,M,J,P=!1;if(F.Polyline.prototype._containsPoint.call(this,Q,!0)){return !0}for(R=0,M=this._parts.length;M>R;R++){for(N=this._parts[R],O=0,J=N.length,H=J-1;J>O;H=O++){K=N[O],I=N[H],K.y>Q.y!=I.y>Q.y&&Q.x<(I.x-K.x)*(Q.y-K.y)/(I.y-K.y)+K.x&&(P=!P)}}return P}}:{}),F.Circle.include(F.Path.CANVAS?{_drawPath:function(){var H=this._point;this._ctx.beginPath(),this._ctx.arc(H.x,H.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(I){var J=this._point,H=this.options.stroke?this.options.weight/2:0;return I.distanceTo(J)<=this._radius+H}}:{}),F.CircleMarker.include(F.Path.CANVAS?{_updateStyle:function(){F.Path.prototype._updateStyle.call(this)}}:{}),F.GeoJSON=F.FeatureGroup.extend({initialize:function(H,I){F.setOptions(this,I),this._layers={},H&&this.addData(H)},addData:function(J){var N,I,O,K=F.Util.isArray(J)?J:J.features;if(K){for(N=0,I=K.length;I>N;N++){O=K[N],(O.geometries||O.geometry||O.features||O.coordinates)&&this.addData(K[N])}return this}var H=this.options;if(!H.filter||H.filter(J)){var M=F.GeoJSON.geometryToLayer(J,H.pointToLayer,H.coordsToLatLng,H);return M.feature=F.GeoJSON.asFeature(J),M.defaultOptions=M.options,this.resetStyle(M),H.onEachFeature&&H.onEachFeature(J,M),this.addLayer(M)}},resetStyle:function(H){var I=this.options.style;I&&(F.Util.extend(H.options,H.defaultOptions),this._setLayerStyle(H,I))},setStyle:function(H){this.eachLayer(function(I){this._setLayerStyle(I,H)},this)},_setLayerStyle:function(H,I){"function"==typeof I&&(I=I(H.feature)),H.setStyle&&H.setStyle(I)}}),F.extend(F.GeoJSON,{geometryToLayer:function(R,N,K,I){var S,P,H,M,J="Feature"===R.type?R.geometry:R,Q=J.coordinates,O=[];switch(K=K||this.coordsToLatLng,J.type){case"Point":return S=K(Q),N?N(R,S):new F.Marker(S);case"MultiPoint":for(H=0,M=Q.length;M>H;H++){S=K(Q[H]),O.push(N?N(R,S):new F.Marker(S))}return new F.FeatureGroup(O);case"LineString":return P=this.coordsToLatLngs(Q,0,K),new F.Polyline(P,I);case"Polygon":if(2===Q.length&&!Q[1].length){throw new Error("Invalid GeoJSON object.")}return P=this.coordsToLatLngs(Q,1,K),new F.Polygon(P,I);case"MultiLineString":return P=this.coordsToLatLngs(Q,1,K),new F.MultiPolyline(P,I);case"MultiPolygon":return P=this.coordsToLatLngs(Q,2,K),new F.MultiPolygon(P,I);case"GeometryCollection":for(H=0,M=J.geometries.length;M>H;H++){O.push(this.geometryToLayer({geometry:J.geometries[H],type:"Feature",properties:R.properties},N,K,I))}return new F.FeatureGroup(O);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(H){return new F.LatLng(H[1],H[0],H[2])},coordsToLatLngs:function(J,M,I){var O,N,K,H=[];for(N=0,K=J.length;K>N;N++){O=M?this.coordsToLatLngs(J[N],M-1,I):(I||this.coordsToLatLng)(J[N]),H.push(O)}return H},latLngToCoords:function(H){var I=[H.lng,H.lat];return H.alt!==B&&I.push(H.alt),I},latLngsToCoords:function(I){for(var J=[],H=0,K=I.length;K>H;H++){J.push(F.GeoJSON.latLngToCoords(I[H]))}return J},getFeature:function(H,I){return H.feature?F.extend({},H.feature,{geometry:I}):F.GeoJSON.asFeature(I)},asFeature:function(H){return"Feature"===H.type?H:{type:"Feature",properties:{},geometry:H}}});var A={toGeoJSON:function(){return F.GeoJSON.getFeature(this,{type:"Point",coordinates:F.GeoJSON.latLngToCoords(this.getLatLng())})}};F.Marker.include(A),F.Circle.include(A),F.CircleMarker.include(A),F.Polyline.include({toGeoJSON:function(){return F.GeoJSON.getFeature(this,{type:"LineString",coordinates:F.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),F.Polygon.include({toGeoJSON:function(){var I,J,H,K=[F.GeoJSON.latLngsToCoords(this.getLatLngs())];if(K[0].push(K[0][0]),this._holes){for(I=0,J=this._holes.length;J>I;I++){H=F.GeoJSON.latLngsToCoords(this._holes[I]),H.push(H[0]),K.push(H)}}return F.GeoJSON.getFeature(this,{type:"Polygon",coordinates:K})}}),function(){function H(I){return function(){var J=[];return this.eachLayer(function(K){J.push(K.toGeoJSON().geometry.coordinates)}),F.GeoJSON.getFeature(this,{type:I,coordinates:J})}}F.MultiPolyline.include({toGeoJSON:H("MultiLineString")}),F.MultiPolygon.include({toGeoJSON:H("MultiPolygon")}),F.LayerGroup.include({toGeoJSON:function(){var K,I=this.feature&&this.feature.geometry,M=[];if(I&&"MultiPoint"===I.type){return H("MultiPoint").call(this)}var J=I&&"GeometryCollection"===I.type;return this.eachLayer(function(N){N.toGeoJSON&&(K=N.toGeoJSON(),M.push(J?K.geometry:F.GeoJSON.asFeature(K)))}),J?F.GeoJSON.getFeature(this,{geometries:M,type:"GeometryCollection"}):{type:"FeatureCollection",features:M}}})}(),F.geoJson=function(H,I){return new F.GeoJSON(H,I)},F.DomEvent={addListener:function(P,N,K,I){var Q,O,H,M=F.stamp(K),J="_leaflet_"+N+M;return P[J]?this:(Q=function(R){return K.call(I||P,R||F.DomEvent._getEvent())},F.Browser.pointer&&0===N.indexOf("touch")?this.addPointerListener(P,N,Q,M):(F.Browser.touch&&"dblclick"===N&&this.addDoubleTapListener&&this.addDoubleTapListener(P,Q,M),"addEventListener" in P?"mousewheel"===N?(P.addEventListener("DOMMouseScroll",Q,!1),P.addEventListener(N,Q,!1)):"mouseenter"===N||"mouseleave"===N?(O=Q,H="mouseenter"===N?"mouseover":"mouseout",Q=function(R){return F.DomEvent._checkMouse(P,R)?O(R):void 0},P.addEventListener(H,Q,!1)):"click"===N&&F.Browser.android?(O=Q,Q=function(R){return F.DomEvent._filterClick(R,O)},P.addEventListener(N,Q,!1)):P.addEventListener(N,Q,!1):"attachEvent" in P&&P.attachEvent("on"+N,Q),P[J]=Q,this))},removeListener:function(J,M,I){var N=F.stamp(I),K="_leaflet_"+M+N,H=J[K];return H?(F.Browser.pointer&&0===M.indexOf("touch")?this.removePointerListener(J,M,N):F.Browser.touch&&"dblclick"===M&&this.removeDoubleTapListener?this.removeDoubleTapListener(J,N):"removeEventListener" in J?"mousewheel"===M?(J.removeEventListener("DOMMouseScroll",H,!1),J.removeEventListener(M,H,!1)):"mouseenter"===M||"mouseleave"===M?J.removeEventListener("mouseenter"===M?"mouseover":"mouseout",H,!1):J.removeEventListener(M,H,!1):"detachEvent" in J&&J.detachEvent("on"+M,H),J[K]=null,this):this},stopPropagation:function(H){return H.stopPropagation?H.stopPropagation():H.cancelBubble=!0,F.DomEvent._skipped(H),this},disableScrollPropagation:function(H){var I=F.DomEvent.stopPropagation;return F.DomEvent.on(H,"mousewheel",I).on(H,"MozMousePixelScroll",I)},disableClickPropagation:function(I){for(var J=F.DomEvent.stopPropagation,H=F.Draggable.START.length-1;H>=0;H--){F.DomEvent.on(I,F.Draggable.START[H],J)}return F.DomEvent.on(I,"click",F.DomEvent._fakeStop).on(I,"dblclick",J)},preventDefault:function(H){return H.preventDefault?H.preventDefault():H.returnValue=!1,this},stop:function(H){return F.DomEvent.preventDefault(H).stopPropagation(H)},getMousePosition:function(I,J){if(!J){return new F.Point(I.clientX,I.clientY)}var H=J.getBoundingClientRect();return new F.Point(I.clientX-H.left-J.clientLeft,I.clientY-H.top-J.clientTop)},getWheelDelta:function(H){var I=0;return H.wheelDelta&&(I=H.wheelDelta/120),H.detail&&(I=-H.detail/3),I},_skipEvents:{},_fakeStop:function(H){F.DomEvent._skipEvents[H.type]=!0},_skipped:function(H){var I=this._skipEvents[H.type];return this._skipEvents[H.type]=!1,I},_checkMouse:function(I,J){var H=J.relatedTarget;if(!H){return !0}try{for(;H&&H!==I;){H=H.parentNode}}catch(K){return !1}return H!==I},_getEvent:function(){var I=C.event;if(!I){for(var H=arguments.callee.caller;H&&(I=H.arguments[0],!I||C.Event!==I.constructor);){H=H.caller}}return I},_filterClick:function(I,J){var H=I.timeStamp||I.originalEvent.timeStamp,K=F.DomEvent._lastClick&&H-F.DomEvent._lastClick;return K&&K>100&&500>K||I.target._simulatedClick&&!I._simulated?void F.DomEvent.stop(I):(F.DomEvent._lastClick=H,J(I))}},F.DomEvent.on=F.DomEvent.addListener,F.DomEvent.off=F.DomEvent.removeListener,F.Draggable=F.Class.extend({includes:F.Mixin.Events,statics:{START:F.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(H,I){this._element=H,this._dragStartTarget=I||H},enable:function(){if(!this._enabled){for(var H=F.Draggable.START.length-1;H>=0;H--){F.DomEvent.on(this._dragStartTarget,F.Draggable.START[H],this._onDown,this)}this._enabled=!0}},disable:function(){if(this._enabled){for(var H=F.Draggable.START.length-1;H>=0;H--){F.DomEvent.off(this._dragStartTarget,F.Draggable.START[H],this._onDown,this)}this._enabled=!1,this._moved=!1}},_onDown:function(I){if(this._moved=!1,!(I.shiftKey||1!==I.which&&1!==I.button&&!I.touches||(F.DomEvent.stopPropagation(I),F.Draggable._disabled||(F.DomUtil.disableImageDrag(),F.DomUtil.disableTextSelection(),this._moving)))){var H=I.touches?I.touches[0]:I;this._startPoint=new F.Point(H.clientX,H.clientY),this._startPos=this._newPos=F.DomUtil.getPosition(this._element),F.DomEvent.on(E,F.Draggable.MOVE[I.type],this._onMove,this).on(E,F.Draggable.END[I.type],this._onUp,this)}},_onMove:function(I){if(I.touches&&I.touches.length>1){return void (this._moved=!0)}var H=I.touches&&1===I.touches.length?I.touches[0]:I,K=new F.Point(H.clientX,H.clientY),J=K.subtract(this._startPoint);(J.x||J.y)&&(F.Browser.touch&&Math.abs(J.x)+Math.abs(J.y)<3||(F.DomEvent.preventDefault(I),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=F.DomUtil.getPosition(this._element).subtract(J),F.DomUtil.addClass(E.body,"leaflet-dragging"),this._lastTarget=I.target||I.srcElement,F.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(J),this._moving=!0,F.Util.cancelAnimFrame(this._animRequest),this._animRequest=F.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),F.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){F.DomUtil.removeClass(E.body,"leaflet-dragging"),this._lastTarget&&(F.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var H in F.Draggable.MOVE){F.DomEvent.off(E,F.Draggable.MOVE[H],this._onMove).off(E,F.Draggable.END[H],this._onUp)}F.DomUtil.enableImageDrag(),F.DomUtil.enableTextSelection(),this._moved&&this._moving&&(F.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),F.Handler=F.Class.extend({initialize:function(H){this._map=H},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return !!this._enabled}}),F.Map.mergeOptions({dragging:!0,inertia:!F.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:F.Browser.touch?32:18,easeLinearity:0.25,worldCopyJump:!1}),F.Map.Drag=F.Handler.extend({addHooks:function(){if(!this._draggable){var H=this._map;this._draggable=new F.Draggable(H._mapPane,H._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),H.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),H.on("viewreset",this._onViewReset,this),H.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var H=this._map;H._panAnim&&H._panAnim.stop(),H.fire("movestart").fire("dragstart"),H.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var H=this._lastTime=+new Date,I=this._lastPos=this._draggable._newPos;this._positions.push(I),this._times.push(H),H-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var H=this._map.getSize()._divideBy(2),I=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=I.subtract(H).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var J=this._worldWidth,M=Math.round(J/2),I=this._initialWorldOffset,O=this._draggable._newPos.x,N=(O-M+I)%J+M-I,K=(O+M+I)%J-M-I,H=Math.abs(N+I)<Math.abs(K+I)?N:K;this._draggable._newPos.x=H},_onDragEnd:function(U){var O=this._map,M=O.options,J=+new Date-this._lastTime,V=!M.inertia||J>M.inertiaThreshold||!this._positions[0];if(O.fire("dragend",U),V){O.fire("moveend")}else{var R=this._lastPos.subtract(this._positions[0]),H=(this._lastTime+J-this._times[0])/1000,N=M.easeLinearity,K=R.multiplyBy(N/H),T=K.distanceTo([0,0]),Q=Math.min(M.inertiaMaxSpeed,T),P=K.multiplyBy(Q/T),I=Q/(M.inertiaDeceleration*N),S=P.multiplyBy(-I/2).round();S.x&&S.y?(S=O._limitOffset(S,O.options.maxBounds),F.Util.requestAnimFrame(function(){O.panBy(S,{duration:I,easeLinearity:N,noMoveStart:!0})})):O.fire("moveend")}}}),F.Map.addInitHook("addHandler","dragging",F.Map.Drag),F.Map.mergeOptions({doubleClickZoom:!0}),F.Map.DoubleClickZoom=F.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(I){var J=this._map,H=J.getZoom()+(I.originalEvent.shiftKey?-1:1);"center"===J.options.doubleClickZoom?J.setZoom(H):J.setZoomAround(I.containerPoint,H)}}),F.Map.addInitHook("addHandler","doubleClickZoom",F.Map.DoubleClickZoom),F.Map.mergeOptions({scrollWheelZoom:!0}),F.Map.ScrollWheelZoom=F.Handler.extend({addHooks:function(){F.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),F.DomEvent.on(this._map._container,"MozMousePixelScroll",F.DomEvent.preventDefault),this._delta=0},removeHooks:function(){F.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),F.DomEvent.off(this._map._container,"MozMousePixelScroll",F.DomEvent.preventDefault)},_onWheelScroll:function(I){var J=F.DomEvent.getWheelDelta(I);this._delta+=J,this._lastMousePos=this._map.mouseEventToContainerPoint(I),this._startTime||(this._startTime=+new Date);var H=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(F.bind(this._performZoom,this),H),F.DomEvent.preventDefault(I),F.DomEvent.stopPropagation(I)},_performZoom:function(){var I=this._map,J=this._delta,H=I.getZoom();J=J>0?Math.ceil(J):Math.floor(J),J=Math.max(Math.min(J,4),-4),J=I._limitZoom(H+J)-H,this._delta=0,this._startTime=null,J&&("center"===I.options.scrollWheelZoom?I.setZoom(H+J):I.setZoomAround(this._lastMousePos,H+J))}}),F.Map.addInitHook("addHandler","scrollWheelZoom",F.Map.ScrollWheelZoom),F.extend(F.DomEvent,{_touchstart:F.Browser.msPointer?"MSPointerDown":F.Browser.pointer?"pointerdown":"touchstart",_touchend:F.Browser.msPointer?"MSPointerUp":F.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(U,N,J){function V(X){var Y;if(F.Browser.pointer?(S.push(X.pointerId),Y=S.length):Y=X.touches.length,!(Y>1)){var W=Date.now(),Z=W-(H||W);O=X.touches?X.touches[0]:X,M=Z>0&&T>=Z,H=W}}function R(X){if(F.Browser.pointer){var Z=S.indexOf(X.pointerId);if(-1===Z){return }S.splice(Z,1)}if(M){if(F.Browser.pointer){var b,Y={};for(var W in O){b=O[W],Y[W]="function"==typeof b?b.bind(O):b}O=Y}O.type="dblclick",N(O),H=null}}var H,O,M=!1,T=250,Q="_leaflet_",P=this._touchstart,I=this._touchend,S=[];U[Q+P+J]=V,U[Q+I+J]=R;var K=F.Browser.pointer?E.documentElement:U;return U.addEventListener(P,V,!1),K.addEventListener(I,R,!1),F.Browser.pointer&&K.addEventListener(F.DomEvent.POINTER_CANCEL,R,!1),this},removeDoubleTapListener:function(I,H){var J="_leaflet_";return I.removeEventListener(this._touchstart,I[J+this._touchstart+H],!1),(F.Browser.pointer?E.documentElement:I).removeEventListener(this._touchend,I[J+this._touchend+H],!1),F.Browser.pointer&&E.documentElement.removeEventListener(F.DomEvent.POINTER_CANCEL,I[J+this._touchend+H],!1),this}}),F.extend(F.DomEvent,{POINTER_DOWN:F.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:F.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:F.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:F.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(I,J,H,K){switch(J){case"touchstart":return this.addPointerListenerStart(I,J,H,K);case"touchend":return this.addPointerListenerEnd(I,J,H,K);case"touchmove":return this.addPointerListenerMove(I,J,H,K);default:throw"Unknown touch event type"}},addPointerListenerStart:function(K,J,P,N){var I="_leaflet_",O=this._pointers,M=function(R){F.DomEvent.preventDefault(R);for(var S=!1,Q=0;Q<O.length;Q++){if(O[Q].pointerId===R.pointerId){S=!0;break}}S||O.push(R),R.touches=O.slice(),R.changedTouches=[R],P(R)};if(K[I+"touchstart"+N]=M,K.addEventListener(this.POINTER_DOWN,M,!1),!this._pointerDocumentListener){var H=function(Q){for(var R=0;R<O.length;R++){if(O[R].pointerId===Q.pointerId){O.splice(R,1);break}}};E.documentElement.addEventListener(this.POINTER_UP,H,!1),E.documentElement.addEventListener(this.POINTER_CANCEL,H,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(J,M,I,O){function N(P){if(P.pointerType!==P.MSPOINTER_TYPE_MOUSE&&"mouse"!==P.pointerType||0!==P.buttons){for(var Q=0;Q<H.length;Q++){if(H[Q].pointerId===P.pointerId){H[Q]=P;break}}P.touches=H.slice(),P.changedTouches=[P],I(P)}}var K="_leaflet_",H=this._pointers;return J[K+"touchmove"+O]=N,J.addEventListener(this.POINTER_MOVE,N,!1),this},addPointerListenerEnd:function(J,M,I,O){var N="_leaflet_",K=this._pointers,H=function(P){for(var Q=0;Q<K.length;Q++){if(K[Q].pointerId===P.pointerId){K.splice(Q,1);break}}P.touches=K.slice(),P.changedTouches=[P],I(P)};return J[N+"touchend"+O]=H,J.addEventListener(this.POINTER_UP,H,!1),J.addEventListener(this.POINTER_CANCEL,H,!1),this},removePointerListener:function(I,J,H){var M="_leaflet_",K=I[M+J+H];switch(J){case"touchstart":I.removeEventListener(this.POINTER_DOWN,K,!1);break;case"touchmove":I.removeEventListener(this.POINTER_MOVE,K,!1);break;case"touchend":I.removeEventListener(this.POINTER_UP,K,!1),I.removeEventListener(this.POINTER_CANCEL,K,!1)}return this}}),F.Map.mergeOptions({touchZoom:F.Browser.touch&&!F.Browser.android23,bounceAtZoomLimits:!0}),F.Map.TouchZoom=F.Handler.extend({addHooks:function(){F.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){F.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(J){var I=this._map;if(J.touches&&2===J.touches.length&&!I._animatingZoom&&!this._zooming){var M=I.mouseEventToLayerPoint(J.touches[0]),K=I.mouseEventToLayerPoint(J.touches[1]),H=I._getCenterLayerPoint();this._startCenter=M.add(K)._divideBy(2),this._startDist=M.distanceTo(K),this._moved=!1,this._zooming=!0,this._centerOffset=H.subtract(this._startCenter),I._panAnim&&I._panAnim.stop(),F.DomEvent.on(E,"touchmove",this._onTouchMove,this).on(E,"touchend",this._onTouchEnd,this),F.DomEvent.preventDefault(J)}},_onTouchMove:function(I){var J=this._map;if(I.touches&&2===I.touches.length&&this._zooming){var H=J.mouseEventToLayerPoint(I.touches[0]),K=J.mouseEventToLayerPoint(I.touches[1]);this._scale=H.distanceTo(K)/this._startDist,this._delta=H._add(K)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(J.options.bounceAtZoomLimits||!(J.getZoom()===J.getMinZoom()&&this._scale<1||J.getZoom()===J.getMaxZoom()&&this._scale>1))&&(this._moved||(F.DomUtil.addClass(J._mapPane,"leaflet-touching"),J.fire("movestart").fire("zoomstart"),this._moved=!0),F.Util.cancelAnimFrame(this._animRequest),this._animRequest=F.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),F.DomEvent.preventDefault(I))}},_updateOnMove:function(){var I=this._map,J=this._getScaleOrigin(),H=I.layerPointToLatLng(J),K=I.getScaleZoom(this._scale);I._animateZoom(H,K,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming){return void (this._zooming=!1)}var K=this._map;this._zooming=!1,F.DomUtil.removeClass(K._mapPane,"leaflet-touching"),F.Util.cancelAnimFrame(this._animRequest),F.DomEvent.off(E,"touchmove",this._onTouchMove).off(E,"touchend",this._onTouchEnd);var J=this._getScaleOrigin(),P=K.layerPointToLatLng(J),N=K.getZoom(),I=K.getScaleZoom(this._scale)-N,O=I>0?Math.ceil(I):Math.floor(I),M=K._limitZoom(N+O),H=K.getZoomScale(M)/this._scale;K._animateZoom(P,M,J,H)},_getScaleOrigin:function(){var H=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(H)}}),F.Map.addInitHook("addHandler","touchZoom",F.Map.TouchZoom),F.Map.mergeOptions({tap:!0,tapTolerance:15}),F.Map.Tap=F.Handler.extend({addHooks:function(){F.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){F.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(I){if(I.touches){if(F.DomEvent.preventDefault(I),this._fireClick=!0,I.touches.length>1){return this._fireClick=!1,void clearTimeout(this._holdTimeout)}var H=I.touches[0],J=H.target;this._startPos=this._newPos=new F.Point(H.clientX,H.clientY),J.tagName&&"a"===J.tagName.toLowerCase()&&F.DomUtil.addClass(J,"leaflet-active"),this._holdTimeout=setTimeout(F.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",H))},this),1000),F.DomEvent.on(E,"touchmove",this._onMove,this).on(E,"touchend",this._onUp,this)}},_onUp:function(I){if(clearTimeout(this._holdTimeout),F.DomEvent.off(E,"touchmove",this._onMove,this).off(E,"touchend",this._onUp,this),this._fireClick&&I&&I.changedTouches){var H=I.changedTouches[0],J=H.target;J&&J.tagName&&"a"===J.tagName.toLowerCase()&&F.DomUtil.removeClass(J,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",H)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(H){var I=H.touches[0];this._newPos=new F.Point(I.clientX,I.clientY)},_simulateEvent:function(H,J){var I=E.createEvent("MouseEvents");I._simulated=!0,J.target._simulatedClick=!0,I.initMouseEvent(H,!0,!0,C,1,J.screenX,J.screenY,J.clientX,J.clientY,!1,!1,!1,!1,0,null),J.target.dispatchEvent(I)}}),F.Browser.touch&&!F.Browser.pointer&&F.Map.addInitHook("addHandler","tap",F.Map.Tap),F.Map.mergeOptions({boxZoom:!0}),F.Map.BoxZoom=F.Handler.extend({initialize:function(H){this._map=H,this._container=H._container,this._pane=H._panes.overlayPane,this._moved=!1},addHooks:function(){F.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){F.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(H){return this._moved=!1,!H.shiftKey||1!==H.which&&1!==H.button?!1:(F.DomUtil.disableTextSelection(),F.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(H),void F.DomEvent.on(E,"mousemove",this._onMouseMove,this).on(E,"mouseup",this._onMouseUp,this).on(E,"keydown",this._onKeyDown,this))},_onMouseMove:function(J){this._moved||(this._box=F.DomUtil.create("div","leaflet-zoom-box",this._pane),F.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var M=this._startLayerPoint,I=this._box,N=this._map.mouseEventToLayerPoint(J),K=N.subtract(M),H=new F.Point(Math.min(N.x,M.x),Math.min(N.y,M.y));F.DomUtil.setPosition(I,H),this._moved=!0,I.style.width=Math.max(0,Math.abs(K.x)-4)+"px",I.style.height=Math.max(0,Math.abs(K.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),F.DomUtil.enableTextSelection(),F.DomUtil.enableImageDrag(),F.DomEvent.off(E,"mousemove",this._onMouseMove).off(E,"mouseup",this._onMouseUp).off(E,"keydown",this._onKeyDown)},_onMouseUp:function(I){this._finish();var J=this._map,H=J.mouseEventToLayerPoint(I);if(!this._startLayerPoint.equals(H)){var K=new F.LatLngBounds(J.layerPointToLatLng(this._startLayerPoint),J.layerPointToLatLng(H));J.fitBounds(K),J.fire("boxzoomend",{boxZoomBounds:K})}},_onKeyDown:function(H){27===H.keyCode&&this._finish()}}),F.Map.addInitHook("addHandler","boxZoom",F.Map.BoxZoom),F.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),F.Map.Keyboard=F.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(H){this._map=H,this._setPanOffset(H.options.keyboardPanOffset),this._setZoomOffset(H.options.keyboardZoomOffset)},addHooks:function(){var H=this._map._container;-1===H.tabIndex&&(H.tabIndex="0"),F.DomEvent.on(H,"focus",this._onFocus,this).on(H,"blur",this._onBlur,this).on(H,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var H=this._map._container;F.DomEvent.off(H,"focus",this._onFocus,this).off(H,"blur",this._onBlur,this).off(H,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var H=E.body,K=E.documentElement,J=H.scrollTop||K.scrollTop,I=H.scrollLeft||K.scrollLeft;this._map._container.focus(),C.scrollTo(I,J)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(I){var J,H,M=this._panKeys={},K=this.keyCodes;for(J=0,H=K.left.length;H>J;J++){M[K.left[J]]=[-1*I,0]}for(J=0,H=K.right.length;H>J;J++){M[K.right[J]]=[I,0]}for(J=0,H=K.down.length;H>J;J++){M[K.down[J]]=[0,I]}for(J=0,H=K.up.length;H>J;J++){M[K.up[J]]=[0,-1*I]}},_setZoomOffset:function(I){var J,H,M=this._zoomKeys={},K=this.keyCodes;for(J=0,H=K.zoomIn.length;H>J;J++){M[K.zoomIn[J]]=I}for(J=0,H=K.zoomOut.length;H>J;J++){M[K.zoomOut[J]]=-I}},_addHooks:function(){F.DomEvent.on(E,"keydown",this._onKeyDown,this)},_removeHooks:function(){F.DomEvent.off(E,"keydown",this._onKeyDown,this)},_onKeyDown:function(I){var J=I.keyCode,H=this._map;if(J in this._panKeys){if(H._panAnim&&H._panAnim._inProgress){return }H.panBy(this._panKeys[J]),H.options.maxBounds&&H.panInsideBounds(H.options.maxBounds)}else{if(!(J in this._zoomKeys)){return }H.setZoom(H.getZoom()+this._zoomKeys[J])}F.DomEvent.stop(I)}}),F.Map.addInitHook("addHandler","keyboard",F.Map.Keyboard),F.Handler.MarkerDrag=F.Handler.extend({initialize:function(H){this._marker=H},addHooks:function(){var H=this._marker._icon;this._draggable||(this._draggable=new F.Draggable(H,H)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),F.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),F.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var I=this._marker,J=I._shadow,H=F.DomUtil.getPosition(I._icon),K=I._map.layerPointToLatLng(H);J&&F.DomUtil.setPosition(J,H),I._latlng=K,I.fire("move",{latlng:K}).fire("drag")},_onDragEnd:function(H){this._marker.fire("moveend").fire("dragend",H)}}),F.Control=F.Class.extend({options:{position:"topright"},initialize:function(H){F.setOptions(this,H)},getPosition:function(){return this.options.position},setPosition:function(H){var I=this._map;return I&&I.removeControl(this),this.options.position=H,I&&I.addControl(this),this},getContainer:function(){return this._container},addTo:function(I){this._map=I;var J=this._container=this.onAdd(I),H=this.getPosition(),K=I._controlCorners[H];return F.DomUtil.addClass(J,"leaflet-control"),-1!==H.indexOf("bottom")?K.insertBefore(J,K.firstChild):K.appendChild(J),this},removeFrom:function(I){var J=this.getPosition(),H=I._controlCorners[J];return H.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(I),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),F.control=function(H){return new F.Control(H)},F.Map.include({addControl:function(H){return H.addTo(this),this},removeControl:function(H){return H.removeFrom(this),this},_initControlPos:function(){function I(N,O){var M=H+N+" "+H+O;J[N+O]=F.DomUtil.create("div",M,K)}var J=this._controlCorners={},H="leaflet-",K=this._controlContainer=F.DomUtil.create("div",H+"control-container",this._container);I("top","left"),I("top","right"),I("bottom","left"),I("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),F.Control.Zoom=F.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(I){var J="leaflet-control-zoom",H=F.DomUtil.create("div",J+" leaflet-bar");return this._map=I,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,J+"-in",H,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,J+"-out",H,this._zoomOut,this),this._updateDisabled(),I.on("zoomend zoomlevelschange",this._updateDisabled,this),H},onRemove:function(H){H.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(H){this._map.zoomIn(H.shiftKey?3:1)},_zoomOut:function(H){this._map.zoomOut(H.shiftKey?3:1)},_createButton:function(J,O,I,P,M,H){var N=F.DomUtil.create("a",I,P);N.innerHTML=J,N.href="#",N.title=O;var K=F.DomEvent.stopPropagation;return F.DomEvent.on(N,"click",K).on(N,"mousedown",K).on(N,"dblclick",K).on(N,"click",F.DomEvent.preventDefault).on(N,"click",M,H).on(N,"click",this._refocusOnMap,H),N},_updateDisabled:function(){var H=this._map,I="leaflet-disabled";F.DomUtil.removeClass(this._zoomInButton,I),F.DomUtil.removeClass(this._zoomOutButton,I),H._zoom===H.getMinZoom()&&F.DomUtil.addClass(this._zoomOutButton,I),H._zoom===H.getMaxZoom()&&F.DomUtil.addClass(this._zoomInButton,I)}}),F.Map.mergeOptions({zoomControl:!0}),F.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new F.Control.Zoom,this.addControl(this.zoomControl))}),F.control.zoom=function(H){return new F.Control.Zoom(H)},F.Control.Attribution=F.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(H){F.setOptions(this,H),this._attributions={}},onAdd:function(H){this._container=F.DomUtil.create("div","leaflet-control-attribution"),F.DomEvent.disableClickPropagation(this._container);for(var I in H._layers){H._layers[I].getAttribution&&this.addAttribution(H._layers[I].getAttribution())}return H.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(H){H.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(H){return this.options.prefix=H,this._update(),this},addAttribution:function(H){return H?(this._attributions[H]||(this._attributions[H]=0),this._attributions[H]++,this._update(),this):void 0},removeAttribution:function(H){return H?(this._attributions[H]&&(this._attributions[H]--,this._update()),this):void 0},_update:function(){if(this._map){var I=[];for(var J in this._attributions){this._attributions[J]&&I.push(J)}var H=[];this.options.prefix&&H.push(this.options.prefix),I.length&&H.push(I.join(", ")),this._container.innerHTML=H.join(" | ")}},_onLayerAdd:function(H){H.layer.getAttribution&&this.addAttribution(H.layer.getAttribution())},_onLayerRemove:function(H){H.layer.getAttribution&&this.removeAttribution(H.layer.getAttribution())}}),F.Map.mergeOptions({attributionControl:!0}),F.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new F.Control.Attribution).addTo(this))}),F.control.attribution=function(H){return new F.Control.Attribution(H)},F.Control.Scale=F.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(I){this._map=I;var J="leaflet-control-scale",H=F.DomUtil.create("div",J),K=this.options;return this._addScales(K,J,H),I.on(K.updateWhenIdle?"moveend":"move",this._update,this),I.whenReady(this._update,this),H},onRemove:function(H){H.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(I,J,H){I.metric&&(this._mScale=F.DomUtil.create("div",J+"-line",H)),I.imperial&&(this._iScale=F.DomUtil.create("div",J+"-line",H))},_update:function(){var J=this._map.getBounds(),M=J.getCenter().lat,I=6378137*Math.PI*Math.cos(M*Math.PI/180),O=I*(J.getNorthEast().lng-J.getSouthWest().lng)/180,N=this._map.getSize(),K=this.options,H=0;N.x>0&&(H=O*(K.maxWidth/N.x)),this._updateScales(K,H)},_updateScales:function(H,I){H.metric&&I&&this._updateMetric(I),H.imperial&&I&&this._updateImperial(I)},_updateMetric:function(H){var I=this._getRoundNum(H);this._mScale.style.width=this._getScaleWidth(I/H)+"px",this._mScale.innerHTML=1000>I?I+" m":I/1000+" km"},_updateImperial:function(I){var K,H,N,M=3.2808399*I,J=this._iScale;M>5280?(K=M/5280,H=this._getRoundNum(K),J.style.width=this._getScaleWidth(H/K)+"px",J.innerHTML=H+" mi"):(N=this._getRoundNum(M),J.style.width=this._getScaleWidth(N/M)+"px",J.innerHTML=N+" ft")},_getScaleWidth:function(H){return Math.round(this.options.maxWidth*H)-10},_getRoundNum:function(I){var J=Math.pow(10,(Math.floor(I)+"").length-1),H=I/J;return H=H>=10?10:H>=5?5:H>=3?3:H>=2?2:1,J*H}}),F.control.scale=function(H){return new F.Control.Scale(H)},F.Control.Layers=F.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(I,J,H){F.setOptions(this,H),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var K in I){this._addLayer(I[K],K)}for(K in J){this._addLayer(J[K],K,!0)}},onAdd:function(H){return this._initLayout(),this._update(),H.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(H){H.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(H,I){return this._addLayer(H,I),this._update(),this},addOverlay:function(H,I){return this._addLayer(H,I,!0),this._update(),this},removeLayer:function(H){var I=F.stamp(H);return delete this._layers[I],this._update(),this},_initLayout:function(){var I="leaflet-control-layers",J=this._container=F.DomUtil.create("div",I);J.setAttribute("aria-haspopup",!0),F.Browser.touch?F.DomEvent.on(J,"click",F.DomEvent.stopPropagation):F.DomEvent.disableClickPropagation(J).disableScrollPropagation(J);var H=this._form=F.DomUtil.create("form",I+"-list");if(this.options.collapsed){F.Browser.android||F.DomEvent.on(J,"mouseover",this._expand,this).on(J,"mouseout",this._collapse,this);var K=this._layersLink=F.DomUtil.create("a",I+"-toggle",J);K.href="#",K.title="Layers",F.Browser.touch?F.DomEvent.on(K,"click",F.DomEvent.stop).on(K,"click",this._expand,this):F.DomEvent.on(K,"focus",this._expand,this),F.DomEvent.on(H,"click",function(){setTimeout(F.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else{this._expand()}this._baseLayersList=F.DomUtil.create("div",I+"-base",H),this._separator=F.DomUtil.create("div",I+"-separator",H),this._overlaysList=F.DomUtil.create("div",I+"-overlays",H),J.appendChild(H)},_addLayer:function(I,J,H){var K=F.stamp(I);this._layers[K]={layer:I,name:J,overlay:H},this.options.autoZIndex&&I.setZIndex&&(this._lastZIndex++,I.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var I,J,H=!1,K=!1;for(I in this._layers){J=this._layers[I],this._addItem(J),K=K||J.overlay,H=H||!J.overlay}this._separator.style.display=K&&H?"":"none"}},_onLayerChange:function(I){var J=this._layers[F.stamp(I.layer)];if(J){this._handlingClick||this._update();var H=J.overlay?"layeradd"===I.type?"overlayadd":"overlayremove":"layeradd"===I.type?"baselayerchange":null;H&&this._map.fire(H,J)}},_createRadioElement:function(I,H){var K='<input type="radio" class="leaflet-control-layers-selector" name="'+I+'"';H&&(K+=' checked="checked"'),K+="/>";var J=E.createElement("div");return J.innerHTML=K,J.firstChild},_addItem:function(J){var I,N=E.createElement("label"),K=this._map.hasLayer(J.layer);J.overlay?(I=E.createElement("input"),I.type="checkbox",I.className="leaflet-control-layers-selector",I.defaultChecked=K):I=this._createRadioElement("leaflet-base-layers",K),I.layerId=F.stamp(J.layer),F.DomEvent.on(I,"click",this._onInputClick,this);var H=E.createElement("span");H.innerHTML=" "+J.name,N.appendChild(I),N.appendChild(H);var M=J.overlay?this._overlaysList:this._baseLayersList;return M.appendChild(N),N},_onInputClick:function(){var I,J,H,M=this._form.getElementsByTagName("input"),K=M.length;for(this._handlingClick=!0,I=0;K>I;I++){J=M[I],H=this._layers[J.layerId],J.checked&&!this._map.hasLayer(H.layer)?this._map.addLayer(H.layer):!J.checked&&this._map.hasLayer(H.layer)&&this._map.removeLayer(H.layer)}this._handlingClick=!1,this._refocusOnMap()},_expand:function(){F.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),F.control.layers=function(I,J,H){return new F.Control.Layers(I,J,H)},F.PosAnimation=F.Class.extend({includes:F.Mixin.Events,run:function(I,J,H,K){this.stop(),this._el=I,this._inProgress=!0,this._newPos=J,this.fire("start"),I.style[F.DomUtil.TRANSITION]="all "+(H||0.25)+"s cubic-bezier(0,0,"+(K||0.5)+",1)",F.DomEvent.on(I,F.DomUtil.TRANSITION_END,this._onTransitionEnd,this),F.DomUtil.setPosition(I,J),F.Util.falseFn(I.offsetWidth),this._stepTimer=setInterval(F.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(F.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),F.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var H=this._getPos();return H?(this._el._leaflet_pos=H,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var K,I,M,J=this._el,H=C.getComputedStyle(J);if(F.Browser.any3d){if(M=H[F.DomUtil.TRANSFORM].match(this._transformRe),!M){return }K=parseFloat(M[1]),I=parseFloat(M[2])}else{K=parseFloat(H.left),I=parseFloat(H.top)}return new F.Point(K,I,!0)},_onTransitionEnd:function(){F.DomEvent.off(this._el,F.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[F.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),F.Map.include({setView:function(H,J,K){if(J=J===B?this._zoom:this._limitZoom(J),H=this._limitCenter(F.latLng(H),J,this.options.maxBounds),K=K||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!K.reset&&K!==!0){K.animate!==B&&(K.zoom=F.extend({animate:K.animate},K.zoom),K.pan=F.extend({animate:K.animate},K.pan));var I=this._zoom!==J?this._tryAnimatedZoom&&this._tryAnimatedZoom(H,J,K.zoom):this._tryAnimatedPan(H,K.pan);if(I){return clearTimeout(this._sizeTimer),this}}return this._resetView(H,J),this},panBy:function(I,J){if(I=F.point(I).round(),J=J||{},!I.x&&!I.y){return this}if(this._panAnim||(this._panAnim=new F.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),J.noMoveStart||this.fire("movestart"),J.animate!==!1){F.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var H=this._getMapPanePos().subtract(I);this._panAnim.run(this._mapPane,H,J.duration||0.25,J.easeLinearity)}else{this._rawPanBy(I),this.fire("move").fire("moveend")}return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){F.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(I,J){var H=this._getCenterOffset(I)._floor();return(J&&J.animate)===!0||this.getSize().contains(H)?(this.panBy(H,J),!0):!1}}),F.PosAnimation=F.DomUtil.TRANSITION?F.PosAnimation:F.PosAnimation.extend({run:function(I,J,H,K){this.stop(),this._el=I,this._inProgress=!0,this._duration=H||0.25,this._easeOutPower=1/Math.max(K||0.5,0.2),this._startPos=F.DomUtil.getPosition(I),this._offset=J.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=F.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var H=+new Date-this._startTime,I=1000*this._duration;I>H?this._runFrame(this._easeOut(H/I)):(this._runFrame(1),this._complete())},_runFrame:function(H){var I=this._startPos.add(this._offset.multiplyBy(H));F.DomUtil.setPosition(this._el,I),this.fire("step")},_complete:function(){F.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(H){return 1-Math.pow(1-H,this._easeOutPower)}}),F.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),F.DomUtil.TRANSITION&&F.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&F.DomUtil.TRANSITION&&F.Browser.any3d&&!F.Browser.android23&&!F.Browser.mobileOpera,this._zoomAnimated&&F.DomEvent.on(this._mapPane,F.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),F.Map.include(F.DomUtil.TRANSITION?{_catchTransitionEnd:function(H){this._animatingZoom&&H.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return !this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(I,K,H){if(this._animatingZoom){return !0}if(H=H||{},!this._zoomAnimated||H.animate===!1||this._nothingToAnimate()||Math.abs(K-this._zoom)>this.options.zoomAnimationThreshold){return !1}var N=this.getZoomScale(K),M=this._getCenterOffset(I)._divideBy(1-1/N),J=this._getCenterLayerPoint()._add(M);return H.animate===!0||this.getSize().contains(M)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(I,K,J,N,null,!0),!0):!1},_animateZoom:function(J,N,I,O,K,H,M){M||(this._animatingZoom=!0),F.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=J,this._animateToZoom=N,F.Draggable&&(F.Draggable._disabled=!0),F.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:J,zoom:N,origin:I,scale:O,delta:K,backwards:H})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,F.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),F.Draggable&&(F.Draggable._disabled=!1)}}:{}),F.TileLayer.include({_animateZoom:function(I){this._animating||(this._animating=!0,this._prepareBgBuffer());var K=this._bgBuffer,H=F.DomUtil.TRANSFORM,M=I.delta?F.DomUtil.getTranslateString(I.delta):K.style[H],J=F.DomUtil.getScaleString(I.scale,I.origin);K.style[H]=I.backwards?J+" "+M:M+" "+J},_endZoomAnim:function(){var H=this._tileContainer,I=this._bgBuffer;H.style.visibility="",H.parentNode.appendChild(H),F.Util.falseFn(I.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var H=this._map;!H||H._animatingZoom||H.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[F.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var I=this._tileContainer,J=this._bgBuffer,H=this._getLoadedTilesPercentage(J),K=this._getLoadedTilesPercentage(I);return J&&H>0.5&&0.5>K?(I.style.visibility="hidden",void this._stopLoadingImages(I)):(J.style.visibility="hidden",J.style[F.DomUtil.TRANSFORM]="",this._tileContainer=J,J=this._bgBuffer=I,this._stopLoadingImages(J),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(I){var J,H,M=I.getElementsByTagName("img"),K=0;for(J=0,H=M.length;H>J;J++){M[J].complete&&K++}return K/H},_stopLoadingImages:function(I){var K,H,M,J=Array.prototype.slice.call(I.getElementsByTagName("img"));for(K=0,H=J.length;H>K;K++){M=J[K],M.complete||(M.onload=F.Util.falseFn,M.onerror=F.Util.falseFn,M.src=F.Util.emptyImageUrl,M.parentNode.removeChild(M))}}}),F.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:10000,maximumAge:0,enableHighAccuracy:!1},locate:function(I){if(I=this._locateOptions=F.extend(this._defaultLocateOptions,I),!navigator.geolocation){return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this}var J=F.bind(this._handleGeolocationResponse,this),H=F.bind(this._handleGeolocationError,this);return I.watch?this._locationWatchId=navigator.geolocation.watchPosition(J,H,I):navigator.geolocation.getCurrentPosition(J,H,I),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(I){var J=I.code,H=I.message||(1===J?"permission denied":2===J?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:J,message:"Geolocation error: "+H+"."})},_handleGeolocationResponse:function(R){var N=R.coords.latitude,K=R.coords.longitude,I=new F.LatLng(N,K),S=180*R.coords.accuracy/40075017,P=S/Math.cos(F.LatLng.DEG_TO_RAD*N),H=F.latLngBounds([N-S,K-P],[N+S,K+P]),M=this._locateOptions;if(M.setView){var J=Math.min(this.getBoundsZoom(H),M.maxZoom);this.setView(I,J)}var Q={latlng:I,bounds:H,timestamp:R.timestamp};for(var O in R.coords){"number"==typeof R.coords[O]&&(Q[O]=R.coords[O])}this.fire("locationfound",Q)}})}(window,document);(function(A){if(typeof define==="function"&&define.amd){define(["leaflet"],function(B){return A(B)})}else{if(typeof module==="object"&&typeof module.exports==="object"){module.exports=A(require("leaflet"))}}if(typeof window!=="undefined"&&window.L){A(window.L)}}(function(A){var B={VERSION:"1.0.0-rc.5",Layers:{},Services:{},Controls:{},Tasks:{},Util:{},Support:{CORS:!!(window.XMLHttpRequest&&"withCredentials" in new XMLHttpRequest),pointerEvents:""===document.documentElement.style.pointerEvents}};"undefined"!=typeof window&&window.L&&(window.L.esri=B),function(P){function O(R){var Q={};for(var S in R){R.hasOwnProperty(S)&&(Q[S]=R[S])}return Q}function N(R,Q){for(var S=0;S<R.length;S++){if(R[S]!==Q[S]){return !1}}return !0}function M(Q){return N(Q[0],Q[Q.length-1])||Q.push(Q[0]),Q}function K(R){var Q,V=0,U=0,T=R.length,S=R[U];for(U;T-1>U;U++){Q=R[U+1],V+=(Q[0]-S[0])*(Q[1]+S[1]),S=Q}return V>=0}function J(Y,X,W,V){var U=(V[0]-W[0])*(Y[1]-W[1])-(V[1]-W[1])*(Y[0]-W[0]),T=(X[0]-Y[0])*(Y[1]-W[1])-(X[1]-Y[1])*(Y[0]-W[0]),S=(V[1]-W[1])*(X[0]-Y[0])-(V[0]-W[0])*(X[1]-Y[1]);if(0!==S){var R=U/S,Q=T/S;if(R>=0&&1>=R&&Q>=0&&1>=Q){return !0}}return !1}function I(R,Q){for(var T=0;T<R.length-1;T++){for(var S=0;S<Q.length-1;S++){if(J(R[T],R[T+1],Q[S],Q[S+1])){return !0}}}return !1}function H(R,Q){for(var V=!1,U=-1,T=R.length,S=T-1;++U<T;S=U){(R[U][1]<=Q[1]&&Q[1]<R[S][1]||R[S][1]<=Q[1]&&Q[1]<R[U][1])&&Q[0]<(R[S][0]-R[U][0])*(Q[1]-R[U][1])/(R[S][1]-R[U][1])+R[U][0]&&(V=!V)}return V}function G(R,Q){var T=I(R,Q),S=H(R,Q[0]);return !T&&S?!0:!1}function F(e){for(var d,Z,Y,X=[],W=[],V=0;V<e.length;V++){var U=M(e[V].slice(0));if(!(U.length<4)){if(K(U)){var T=[U];X.push(T)}else{W.push(U)}}}for(var S=[];W.length;){Y=W.pop();var R=!1;for(d=X.length-1;d>=0;d--){if(Z=X[d][0],G(Z,Y)){X[d].push(Y),R=!0;break}}R||S.push(Y)}for(;S.length;){Y=S.pop();var Q=!1;for(d=X.length-1;d>=0;d--){if(Z=X[d][0],I(Z,Y)){X[d].push(Y),Q=!0;break}}Q||X.push([Y.reverse()])}return 1===X.length?{type:"Polygon",coordinates:X[0]}:{type:"MultiPolygon",coordinates:X}}function E(R){var Q=[],V=R.slice(0),U=M(V.shift().slice(0));if(U.length>=4){K(U)||U.reverse(),Q.push(U);for(var T=0;T<V.length;T++){var S=M(V[T].slice(0));S.length>=4&&(K(S)&&S.reverse(),Q.push(S))}}return Q}function D(R){for(var Q=[],V=0;V<R.length;V++){for(var U=E(R[V]),T=U.length-1;T>=0;T--){var S=U[T].slice(0);Q.push(S)}}return Q}var C=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Q){return window.setTimeout(Q,1000/60)};P.Util.extentToBounds=function(R){var Q=new A.LatLng(R.ymin,R.xmin),S=new A.LatLng(R.ymax,R.xmax);return new A.LatLngBounds(Q,S)},P.Util.boundsToExtent=function(Q){return Q=A.latLngBounds(Q),{xmin:Q.getSouthWest().lng,ymin:Q.getSouthWest().lat,xmax:Q.getNorthEast().lng,ymax:Q.getNorthEast().lat,spatialReference:{wkid:4326}}},P.Util.arcgisToGeojson=function(S,R){var Q={};return"number"==typeof S.x&&"number"==typeof S.y&&(Q.type="Point",Q.coordinates=[S.x,S.y]),S.points&&(Q.type="MultiPoint",Q.coordinates=S.points.slice(0)),S.paths&&(1===S.paths.length?(Q.type="LineString",Q.coordinates=S.paths[0].slice(0)):(Q.type="MultiLineString",Q.coordinates=S.paths.slice(0))),S.rings&&(Q=F(S.rings.slice(0))),(S.geometry||S.attributes)&&(Q.type="Feature",Q.geometry=S.geometry?P.Util.arcgisToGeojson(S.geometry):null,Q.properties=S.attributes?O(S.attributes):null,S.attributes&&(Q.id=S.attributes[R]||S.attributes.OBJECTID||S.attributes.FID)),Q},P.Util.geojsonToArcGIS=function(U,T){T=T||"OBJECTID";var S,R={wkid:4326},Q={};switch(U.type){case"Point":Q.x=U.coordinates[0],Q.y=U.coordinates[1],Q.spatialReference=R;break;case"MultiPoint":Q.points=U.coordinates.slice(0),Q.spatialReference=R;break;case"LineString":Q.paths=[U.coordinates.slice(0)],Q.spatialReference=R;break;case"MultiLineString":Q.paths=U.coordinates.slice(0),Q.spatialReference=R;break;case"Polygon":Q.rings=E(U.coordinates.slice(0)),Q.spatialReference=R;break;case"MultiPolygon":Q.rings=D(U.coordinates.slice(0)),Q.spatialReference=R;break;case"Feature":U.geometry&&(Q.geometry=P.Util.geojsonToArcGIS(U.geometry,T)),Q.attributes=U.properties?O(U.properties):{},U.id&&(Q.attributes[T]=U.id);break;case"FeatureCollection":for(Q=[],S=0;S<U.features.length;S++){Q.push(P.Util.geojsonToArcGIS(U.features[S],T))}break;case"GeometryCollection":for(Q=[],S=0;S<U.geometries.length;S++){Q.push(P.Util.geojsonToArcGIS(U.geometries[S],T))}}return Q},P.Util.responseToFeatureCollection=function(Q,W){var V;if(W){V=W}else{if(Q.objectIdFieldName){V=Q.objectIdFieldName}else{if(Q.fields){for(var U=0;U<=Q.fields.length-1;U++){if("esriFieldTypeOID"===Q.fields[U].type){V=Q.fields[U].name;break}}}else{V="OBJECTID"}}}var T={type:"FeatureCollection",features:[]},S=Q.features||Q.results;if(S.length){for(var R=S.length-1;R>=0;R--){T.features.push(P.Util.arcgisToGeojson(S[R],V))}}return T},P.Util.cleanUrl=function(Q){return Q=Q.replace(/\s\s*/g,""),"/"!==Q[Q.length-1]&&(Q+="/"),Q},P.Util.isArcgisOnline=function(Q){return/\.arcgis\.com/g.test(Q)},P.Util.geojsonTypeToArcGIS=function(R){var Q;switch(R){case"Point":Q="esriGeometryPoint";break;case"MultiPoint":Q="esriGeometryMultipoint";break;case"LineString":Q="esriGeometryPolyline";break;case"MultiLineString":Q="esriGeometryPolyline";break;case"Polygon":Q="esriGeometryPolygon";break;case"MultiPolygon":Q="esriGeometryPolygon"}return Q},P.Util.requestAnimationFrame=A.Util.bind(C,window)}(B),function(D){function C(H){var G="";H.f=H.f||"json";for(var M in H){if(H.hasOwnProperty(M)){var K,J=H[M],I=Object.prototype.toString.call(J);G.length&&(G+="&"),K="[object Array]"===I?"[object Object]"===Object.prototype.toString.call(J[0])?JSON.stringify(J):J.join(","):"[object Object]"===I?JSON.stringify(J):"[object Date]"===I?J.valueOf():J,G+=encodeURIComponent(M)+"="+encodeURIComponent(K)}}return G}function F(H,G){var I=new XMLHttpRequest;return I.onerror=function(){H.call(G,{error:{code:500,message:"XMLHttpRequest error"}},null)},I.onreadystatechange=function(){var M,K;if(4===I.readyState){try{M=JSON.parse(I.responseText)}catch(J){M=null,K={code:500,message:"Could not parse response as JSON."}}!K&&M.error&&(K=M.error,M=null),H.call(G,K,M)}},I}var E=0;window._EsriLeafletCallbacks={},D.Request={request:function(G,N,M,K){var J=C(N),I=F(M,K),H=(G+"?"+J).length;if(2000>=H&&A.esri.Support.CORS){I.open("GET",G+"?"+J),I.send(null)}else{if(H>2000&&A.esri.Support.CORS){I.open("POST",G),I.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),I.send(J)}else{if(2000>=H&&!A.esri.Support.CORS){return A.esri.Request.get.JSONP(G,N,M,K)}if(console&&console.warn){return void console.warn("a request to "+G+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html")}}}return I},post:{XMLHTTP:function(G,K,J,I){var H=F(J,I);return H.open("POST",G),H.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),H.send(C(K)),H}},get:{CORS:function(G,K,J,I){var H=F(J,I);return H.open("GET",G+"?"+C(K),!0),H.send(null),H},JSONP:function(G,M,K,J){var I="c"+E;M.callback="window._EsriLeafletCallbacks."+I;var H=A.DomUtil.create("script",null,document.body);return H.type="text/javascript",H.src=G+"?"+C(M),H.id=I,window._EsriLeafletCallbacks[I]=function(O){if(window._EsriLeafletCallbacks[I]!==!0){var N,P=Object.prototype.toString.call(O);"[object Object]"!==P&&"[object Array]"!==P&&(N={error:{code:500,message:"Expected array or object as JSONP response"}},O=null),!N&&O.error&&(N=O,O=null),K.call(J,N,O),window._EsriLeafletCallbacks[I]=!0}},E++,{id:I,url:H.src,abort:function(){window._EsriLeafletCallbacks._callback[I]({code:0,message:"Request aborted."})}}}}},D.get=D.Support.CORS?D.Request.get.CORS:D.Request.get.JSONP,D.post=D.Request.post.XMLHTTP,D.request=D.Request.request}(B),B.Services.Service=A.Class.extend({includes:A.Mixin.Events,options:{proxy:!1,useCors:B.Support.CORS},initialize:function(C){C=C||{},this._requestQueue=[],this._authenticating=!1,A.Util.setOptions(this,C),this.options.url=B.Util.cleanUrl(this.options.url)},get:function(D,C,F,E){return this._request("get",D,C,F,E)},post:function(D,C,F,E){return this._request("post",D,C,F,E)},request:function(D,C,F,E){return this._request("request",D,C,F,E)},metadata:function(D,C){return this._request("get","",{},D,C)},authenticate:function(C){return this._authenticating=!1,this.options.token=C,this._runQueue(),this},_request:function(D,C,I,H,G){this.fire("requeststart",{url:this.options.url+C,params:I,method:D});var F=this._createServiceCallback(D,C,I,H,G);if(this.options.token&&(I.token=this.options.token),this._authenticating){return void this._requestQueue.push([D,C,I,H,G])}var E=this.options.proxy?this.options.proxy+"?"+this.options.url+C:this.options.url+C;return"get"!==D&&"request"!==D||this.options.useCors?B[D](E,I,F):B.Request.get.JSONP(E,I,F)},_createServiceCallback:function(D,C,H,G,F){var E=[D,C,H,G,F];return A.Util.bind(function(J,I){!J||499!==J.code&&498!==J.code?(G.call(F,J,I),J?this.fire("requesterror",{url:this.options.url+C,params:H,message:J.message,code:J.code,method:D}):this.fire("requestsuccess",{url:this.options.url+C,params:H,response:I,method:D}),this.fire("requestend",{url:this.options.url+C,params:H,method:D})):(this._authenticating=!0,this._requestQueue.push(E),this.fire("authenticationrequired",{authenticate:A.Util.bind(this.authenticate,this)}))},this)},_runQueue:function(){for(var D=this._requestQueue.length-1;D>=0;D--){var C=this._requestQueue[D],E=C.shift();this[E].apply(this,C)}this._requestQueue=[]}}),B.Services.service=function(C){return new B.Services.Service(C)},B.Services.FeatureLayer=B.Services.Service.extend({options:{idAttribute:"OBJECTID"},query:function(){return new B.Tasks.Query(this)},addFeature:function(D,C,E){return delete D.id,D=B.Util.geojsonToArcGIS(D),this.post("addFeatures",{features:[D]},function(F,H){var G=H&&H.addResults?H.addResults[0]:void 0;C&&C.call(this,F||H.addResults[0].error,G)},E)},updateFeature:function(D,C,E){return D=B.Util.geojsonToArcGIS(D,this.options.idAttribute),this.post("updateFeatures",{features:[D]},function(F,H){var G=H&&H.updateResults?H.updateResults[0]:void 0;C&&C.call(E,F||H.updateResults[0].error,G)},E)},deleteFeature:function(D,C,E){return this.post("deleteFeatures",{objectIds:D},function(F,H){var G=H&&H.deleteResults?H.deleteResults[0]:void 0;C&&C.call(E,F||H.deleteResults[0].error,G)},E)}}),B.Services.featureLayer=function(C){return new B.Services.FeatureLayer(C)},B.Services.MapService=B.Services.Service.extend({identify:function(){return new B.Tasks.identifyFeatures(this)},find:function(){return new B.Tasks.Find(this)},query:function(){return new B.Tasks.Query(this)}}),B.Services.mapService=function(C){return new B.Services.MapService(C)},B.Services.ImageService=B.Services.Service.extend({query:function(){return new B.Tasks.Query(this)},identify:function(){return new B.Tasks.IdentifyImage(this)}}),B.Services.imageService=function(C){return new B.Services.ImageService(C)},B.Tasks.Task=A.Class.extend({options:{proxy:!1,useCors:B.Support.CORS},generateSetter:function(D,C){return A.Util.bind(function(E){return this.params[D]=E,this},C)},initialize:function(D){if(D.request&&D.options?(this._service=D,A.Util.setOptions(this,D.options)):(A.Util.setOptions(this,D),this.options.url=A.esri.Util.cleanUrl(D.url)),this.params=A.Util.extend({},this.params||{}),this.setters){for(var C in this.setters){var E=this.setters[C];this[C]=this.generateSetter(E,this)}}},token:function(C){return this._service?this._service.authenticate(C):this.params.token=C,this},request:function(D,C){return this._service?this._service.request(this.path,this.params,D,C):this._request("request",this.path,this.params,D,C)},_request:function(D,C,H,G,F){var E=this.options.proxy?this.options.proxy+"?"+this.options.url+C:this.options.url+C;return"get"!==D&&"request"!==D||this.options.useCors?B[D](E,H,G,F):B.Request.get.JSONP(E,H,G,F)}}),B.Tasks.Query=B.Tasks.Task.extend({setters:{offset:"offset",limit:"limit",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(C){return this._setGeometry(C),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(C){return this._setGeometry(C),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(C){return this._setGeometry(C),this.params.spatialRel="esriSpatialRelWithin",this},overlaps:function(C){return this._setGeometry(C),this.params.spatialRel="esriSpatialRelOverlaps",this},nearby:function(D,C){return D=A.latLng(D),this.params.geometry=[D.lng,D.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=C,this.params.inSr=4326,this},where:function(C){return this.params.where=C.replace(/"/g,"'"),this},between:function(D,C){return this.params.time=[D.valueOf(),C.valueOf()],this},simplify:function(D,C){var E=Math.abs(D.getBounds().getWest()-D.getBounds().getEast());return this.params.maxAllowableOffset=E/D.getSize().y*C,this},orderBy:function(D,C){return C=C||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[D,C].join(" "),this},run:function(D,C){return this._cleanParams(),B.Util.isArcgisOnline(this.options.url)?(this.params.f="geojson",this.request(function(F,E){D.call(C,F,E,E)},C)):this.request(function(F,E){D.call(C,F,E&&B.Util.responseToFeatureCollection(E),E)},C)},count:function(D,C){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(E,F){D.call(this,E,F&&F.count,F)},C)},ids:function(D,C){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(E,F){D.call(this,E,F&&F.objectIds,F)},C)},bounds:function(D,C){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(F,E){D.call(C,F,E&&E.extent&&B.Util.extentToBounds(E.extent),E)},C)},pixelSize:function(C){return C=A.point(C),this.params.pixelSize=[C.x,C.y],this},layer:function(C){return this.path=C+"/query",this},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometry:function(C){return this.params.inSr=4326,C instanceof A.LatLngBounds?(this.params.geometry=B.Util.boundsToExtent(C),void (this.params.geometryType="esriGeometryEnvelope")):(C.getLatLng&&(C=C.getLatLng()),C instanceof A.LatLng&&(C={type:"Point",coordinates:[C.lng,C.lat]}),C instanceof A.GeoJSON&&(C=C.getLayers()[0].feature.geometry,this.params.geometry=B.Util.geojsonToArcGIS(C),this.params.geometryType=B.Util.geojsonTypeToArcGIS(C.type)),C.toGeoJSON&&(C=C.toGeoJSON()),"Feature"===C.type&&(C=C.geometry),"Point"===C.type||"LineString"===C.type||"Polygon"===C.type?(this.params.geometry=B.Util.geojsonToArcGIS(C),void (this.params.geometryType=B.Util.geojsonTypeToArcGIS(C.type))):void (console&&console.warn&&console.warn("invalid geometry passed to spatial query. Should be an L.LatLng, L.LatLngBounds or L.Marker or a GeoJSON Point Line or Polygon object")))}}),B.Tasks.query=function(C){return new B.Tasks.Query(C)},B.Tasks.Find=B.Tasks.Task.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(D,C){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[D,C].join(":"),this},simplify:function(D,C){var E=Math.abs(D.getBounds().getWest()-D.getBounds().getEast());return this.params.maxAllowableOffset=E/D.getSize().y*C,this},run:function(D,C){return this.request(function(F,E){D.call(C,F,E&&B.Util.responseToFeatureCollection(E),E)},C)}}),B.Tasks.find=function(C){return new B.Tasks.Find(C)},B.Tasks.Identify=B.Tasks.Task.extend({path:"identify",between:function(D,C){return this.params.time=[D.valueOf(),C.valueOf()],this}}),B.Tasks.IdentifyImage=B.Tasks.Identify.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(C){return C=A.latLng(C),this.params.geometry=JSON.stringify({x:C.lng,y:C.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(D,C){return this.request(function(F,E){D.call(C,F,E&&this._responseToGeoJSON(E),E)},this)},_responseToGeoJSON:function(D){var C=D.location,H=D.catalogItems,G=D.catalogItemVisibilities,F={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[C.x,C.y]},crs:{type:"EPSG",properties:{code:C.spatialReference.wkid}},properties:{OBJECTID:D.objectId,name:D.name,value:D.value},id:D.objectId}};if(D.properties&&D.properties.Values&&(F.pixel.properties.values=D.properties.Values),H&&H.features&&(F.catalogItems=B.Util.responseToFeatureCollection(H),G&&G.length===F.catalogItems.features.length)){for(var E=G.length-1;E>=0;E--){F.catalogItems.features[E].properties.catalogItemVisibility=G[E]}}return F}}),B.Tasks.identifyImage=function(C){return new B.Tasks.IdentifyImage(C)},B.Tasks.IdentifyFeatures=B.Tasks.Identify.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(D){var C=B.Util.boundsToExtent(D.getBounds()),E=D.getSize();return this.params.imageDisplay=[E.x,E.y,96],this.params.mapExtent=[C.xmin,C.ymin,C.xmax,C.ymax],this},at:function(C){return C=A.latLng(C),this.params.geometry=[C.lng,C.lat],this.params.geometryType="esriGeometryPoint",this},layerDef:function(D,C){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[D,C].join(":"),this},simplify:function(D,C){var E=Math.abs(D.getBounds().getWest()-D.getBounds().getEast());return this.params.maxAllowableOffset=E/D.getSize().y*(1-C),this},run:function(D,C){return this.request(function(F,E){D.call(C,F,E&&B.Util.responseToFeatureCollection(E),E)},C)}}),B.Tasks.identifyFeatures=function(C){return new B.Tasks.IdentifyFeatures(C)},function(D){var C="https:"!==window.location.protocol?"http:":"https:";D.Layers.BasemapLayer=A.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"Esri"}},Topographic:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"Esri"}},Oceans:{urlTemplate:C+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"Esri"}},OceansLabels:{urlTemplate:C+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"]}},NationalGeographic:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"Esri"}},DarkGray:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"Esri, DeLorme, HERE"}},DarkGrayLabels:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"]}},Gray:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"Esri, NAVTEQ, DeLorme"}},GrayLabels:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:16,subdomains:["server","services"]}},Imagery:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"Esri, DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:19,subdomains:["server","services"]}},ImageryTransportation:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:19,subdomains:["server","services"]}},ShadedRelief:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"ESRI, NAVTEQ, DeLorme"}},ShadedReliefLabels:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:12,subdomains:["server","services"]}},Terrain:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!1,logoPosition:"bottomright",minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"Esri, USGS, NOAA"}},TerrainLabels:{urlTemplate:C+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{hideLogo:!0,logoPosition:"bottomright",minZoom:1,maxZoom:13,subdomains:["server","services"]}}}},initialize:function(E,H){var G;if("object"==typeof E&&E.urlTemplate&&E.options){G=E}else{if("string"!=typeof E||!D.BasemapLayer.TILES[E]){throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain" or "TerrainLabels"')}G=D.BasemapLayer.TILES[E]}var F=A.Util.extend(G.options,H);A.TileLayer.prototype.initialize.call(this,G.urlTemplate,A.Util.setOptions(this,F)),G.attributionUrl&&this._getAttributionData(G.attributionUrl),this._logo=new D.Controls.Logo({position:this.options.logoPosition})},onAdd:function(E){this.options.hideLogo||E._hasEsriLogo||(this._logo.addTo(E),E._hasEsriLogo=!0),A.TileLayer.prototype.onAdd.call(this,E),E.on("moveend",this._updateMapAttribution,this)},onRemove:function(E){this._logo&&(E.removeControl(this._logo),E._hasEsriLogo=!1),A.TileLayer.prototype.onRemove.call(this,E),E.off("moveend",this._updateMapAttribution,this)},getAttribution:function(){var E='<span class="esri-attributions" style="line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block;">'+this.options.attribution+"</span>";return E},_getAttributionData:function(E){D.get(E,{},function(G,F){this._attributions=[];for(var N=0;N<F.contributors.length;N++){for(var M=F.contributors[N],K=0;K<M.coverageAreas.length;K++){var J=M.coverageAreas[K],I=new A.LatLng(J.bbox[0],J.bbox[1]),H=new A.LatLng(J.bbox[2],J.bbox[3]);this._attributions.push({attribution:M.attribution,score:J.score,bounds:new A.LatLngBounds(I,H),minZoom:J.zoomMin,maxZoom:J.zoomMax})}}this._attributions.sort(function(P,O){return O.score-P.score}),this._updateMapAttribution()},this)},_updateMapAttribution:function(){if(this._map&&this._map.attributionControl&&this._attributions){for(var F="",E=this._map.getBounds(),K=this._map.getZoom(),J=0;J<this._attributions.length;J++){var I=this._attributions[J],H=I.attribution;!F.match(H)&&E.intersects(I.bounds)&&K>=I.minZoom&&K<=I.maxZoom&&(F+=", "+H)}F=F.substr(2);var G=this._map.attributionControl._container.querySelector(".esri-attributions");G.innerHTML=F,G.style.maxWidth=0.65*this._map.getSize().x+"px",this.fire("attributionupdated",{attribution:F})}}}),D.BasemapLayer=D.Layers.BasemapLayer,D.Layers.basemapLayer=function(E,F){return new D.Layers.BasemapLayer(E,F)},D.basemapLayer=function(E,F){return new D.Layers.BasemapLayer(E,F)}}(B),B.Layers.RasterLayer=A.Class.extend({includes:A.Mixin.Events,options:{opacity:1,position:"front",f:"image"},onAdd:function(D){if(this._map=D,this._update=A.Util.limitExecByInterval(this._update,this.options.updateInterval,this),D.options.crs&&D.options.crs.code){var C=D.options.crs.code.split(":")[1];this.options.bboxSR=C,this.options.imageSR=C}D.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?D.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this))},bindPopup:function(D,C){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=A.popup(C),this._popupFunction=D,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},onRemove:function(){this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this),this._map=null},addTo:function(C){return C.addLayer(this),this},removeFrom:function(C){return C.removeLayer(this),this},bringToFront:function(){return this.options.position="front",this._currentImage&&this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage&&this._currentImage.bringToBack(),this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(C){return this.options.opacity=C,this._currentImage.setOpacity(C),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(D,C){return this.options.from=D,this.options.to=C,this._update(),this},metadata:function(D,C){return this._service.metadata(D,C),this},authenticate:function(C){return this._service.authenticate(C),this},_renderImage:function(D,C){if(this._map){var E=new A.ImageOverlay(D,C,{opacity:0}).addTo(this._map);E.once("load",function(F){var H=F.target,G=this._currentImage;H._bounds.equals(C)?(this._currentImage=H,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),G&&this._map&&this._map.removeLayer(G),G&&G._map&&G._map.removeLayer(G)):this._map.removeLayer(H),this.fire("load",{bounds:C})},this),this.fire("loading",{bounds:C})}},_update:function(){if(this._map){var D=this._map.getZoom(),C=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress||D>this.options.maxZoom||D<this.options.minZoom)){var E=this._buildExportParams();this._requestExport(E,C)}}},_renderPopup:function(D,C,G,F){if(D=A.latLng(D),this._shouldRenderPopup&&this._lastClick.equals(D)){var E=this._popupFunction(C,G,F);E&&this._popup.setLatLng(D).setContent(E).openOn(this._map)}},_resetPopupState:function(C){this._shouldRenderPopup=!1,this._lastClick=C.latlng},_propagateEvent:function(C){C=A.extend({layer:C.target,target:this},C),this.fire(C.type,C)}}),B.Layers.DynamicMapLayer=B.Layers.RasterLayer.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0},initialize:function(D,C){C=C||{},C.url=B.Util.cleanUrl(D),this._service=new B.Services.MapService(C),this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess",this._propagateEvent,this),A.Util.setOptions(this,C)},getLayers:function(){return this.options.layers},setLayers:function(C){return this.options.layers=C,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(C){return this.options.layerDefs=C,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(C){return this.options.timeOptions=C,this._update(),this},query:function(){return this._service.query()},identify:function(){return this._service.identify()},find:function(){return this._service.find()},_getPopupData:function(D){var C=A.Util.bind(function(F,H,G){setTimeout(A.Util.bind(function(){this._renderPopup(D.latlng,F,H,G)},this),300)},this),E=this.identify().on(this._map).at(D.latlng);E.layers(this.options.layers?"visible:"+this.options.layers.join(","):"visible"),E.run(C),this._shouldRenderPopup=!0,this._lastClick=D.latlng},_buildExportParams:function(){var D=this._map.getBounds(),C=this._map.getSize(),G=this._map.options.crs.project(D._northEast),F=this._map.options.crs.project(D._southWest),E={bbox:[F.x,F.y,G.x,G.y].join(","),size:C.x+","+C.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:this.options.bboxSR,imageSR:this.options.imageSR};return this.options.layers&&(E.layers="show:"+this.options.layers.join(",")),this.options.layerDefs&&(E.layerDefs=JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(E.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(E.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this._service.options.token&&(E.token=this._service.options.token),E},_requestExport:function(D,C){"json"===this.options.f?this._service.get("export",D,function(E,F){this._renderImage(F.href,C)},this):(D.f="image",this._renderImage(this.options.url+"export"+A.Util.getParamString(D),C))}}),B.DynamicMapLayer=B.Layers.DynamicMapLayer,B.Layers.dynamicMapLayer=function(D,C){return new B.Layers.DynamicMapLayer(D,C)},B.dynamicMapLayer=function(D,C){return new B.Layers.DynamicMapLayer(D,C)},B.Layers.ImageMapLayer=B.Layers.RasterLayer.extend({options:{updateInterval:150,format:"jpgpng"},query:function(){return this._service.query()},identify:function(){return this._service.identify()},initialize:function(D,C){C=C||{},C.url=B.Util.cleanUrl(D),this._service=new B.Services.ImageService(C),this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess",this._propagateEvent,this),A.Util.setOptions(this,C)},setPixelType:function(C){return this.options.pixelType=C,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(C){return this.options.bandIds=A.Util.isArray(C)?C.join(","):C.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(D,C){return this.options.noData=A.Util.isArray(D)?D.join(","):D.toString(),C&&(this.options.noDataInterpretation=C),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(C){this.options.renderingRule=C,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(C){this.options.mosaicRule=C,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(D){var C=A.Util.bind(function(F,H,G){setTimeout(A.Util.bind(function(){this._renderPopup(D.latlng,F,H,G)},this),300)},this),E=this.identify().at(D.latlng);this.options.mosaicRule&&E.setMosaicRule(this.options.mosaicRule),E.run(C),this._shouldRenderPopup=!0,this._lastClick=D.latlng},_buildExportParams:function(){var D=this._map.getBounds(),C=this._map.getSize(),G=this._map.options.crs.project(D._northEast),F=this._map.options.crs.project(D._southWest),E={bbox:[F.x,F.y,G.x,G.y].join(","),size:C.x+","+C.y,format:this.options.format,bboxSR:this.options.bboxSR,imageSR:this.options.imageSR};return this.options.from&&this.options.to&&(E.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(E.pixelType=this.options.pixelType),this.options.interpolation&&(E.interpolation=this.options.interpolation),this.options.compressionQuality&&(E.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(E.bandIds=this.options.bandIds),this.options.noData&&(E.noData=this.options.noData),this.options.noDataInterpretation&&(E.noDataInterpretation=this.options.noDataInterpretation),this._service.options.token&&(E.token=this._service.options.token),this.options.renderingRule&&(E.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(E.mosaicRule=JSON.stringify(this.options.mosaicRule)),E},_requestExport:function(D,C){"json"===this.options.f?this._service.get("exportImage",D,function(E,F){this._renderImage(F.href,C)},this):(D.f="image",this._renderImage(this.options.url+"exportImage"+A.Util.getParamString(D),C))}}),B.ImageMapLayer=B.Layers.ImageMapLayer,B.Layers.imageMapLayer=function(D,C){return new B.Layers.ImageMapLayer(D,C)},B.imageMapLayer=function(D,C){return new B.Layers.ImageMapLayer(D,C)},B.Layers.TiledMapLayer=A.TileLayer.extend({initialize:function(D,C){C=C||{},C.url=B.Util.cleanUrl(D),C=A.Util.setOptions(this,C),this.tileUrl=A.esri.Util.cleanUrl(D)+"tile/{z}/{y}/{x}",this._service=new A.esri.Services.MapService(C),this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess",this._propagateEvent,this),this.tileUrl.match("://tiles.arcgisonline.com")&&(this.tileUrl=this.tileUrl.replace("://tiles.arcgisonline.com","://tiles{s}.arcgisonline.com"),C.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),A.TileLayer.prototype.initialize.call(this,this.tileUrl,C)},metadata:function(D,C){return this._service.metadata(D,C),this},identify:function(){return this._service.identify()},authenticate:function(D){var C="?token="+D;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,C):this.tileUrl+C,this.options.token=D,this._service.authenticate(D),this},_propagateEvent:function(C){C=A.extend({layer:C.target,target:this},C),this.fire(C.type,C)}}),A.esri.TiledMapLayer=A.esri.Layers.tiledMapLayer,A.esri.Layers.tiledMapLayer=function(D,C){return new A.esri.Layers.TiledMapLayer(D,C)},A.esri.tiledMapLayer=function(D,C){return new A.esri.Layers.TiledMapLayer(D,C)},B.Layers.FeatureGrid=A.Class.extend({includes:A.Mixin.Events,options:{cellSize:512,updateInterval:150},initialize:function(C){C=A.setOptions(this,C)},onAdd:function(C){this._map=C,this._update=A.Util.limitExecByInterval(this._update,this.options.updateInterval,this),this._map.addEventListener(this.getEvents(),this),this._reset(),this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this),this._removeCells()},getEvents:function(){var C={viewreset:this._reset,moveend:this._update,zoomend:this._onZoom};return C},addTo:function(C){return C.addLayer(this),this},removeFrom:function(C){return C.removeLayer(this),this},_onZoom:function(){var C=this._map.getZoom();C>this.options.maxZoom||C<this.options.minZoom?(this.removeFrom(this._map),this._map.addEventListener("zoomend",this.getEvents().zoomend,this)):this._map.hasLayer(this)||(this._map.removeEventListener("zoomend",this.getEvents().zoomend,this),this.addTo(this._map))},_reset:function(){this._removeCells(),this._cells={},this._activeCells={},this._cellsToLoad=0,this._cellsTotal=0,this._resetWrap()},_resetWrap:function(){var D=this._map,C=D.options.crs;if(!C.infinite){var E=this._getCellSize();C.wrapLng&&(this._wrapLng=[Math.floor(D.project([0,C.wrapLng[0]]).x/E),Math.ceil(D.project([0,C.wrapLng[1]]).x/E)]),C.wrapLat&&(this._wrapLat=[Math.floor(D.project([C.wrapLat[0],0]).y/E),Math.ceil(D.project([C.wrapLat[1],0]).y/E)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var D=this._map.getPixelBounds(),C=this._map.getZoom(),H=this._getCellSize(),G=[H/2,H/2];if(!(C>this.options.maxZoom||C<this.options.minZoom)){var F=D.min.subtract(G).divideBy(H).floor();F.x=Math.max(F.x,0),F.y=Math.max(F.y,0);var E=A.bounds(F,D.max.add(G).divideBy(H).floor());this._removeOtherCells(E),this._addCells(E)}}},_addCells:function(D){var C,J,I,H=[],G=D.getCenter(),F=this._map.getZoom();for(C=D.min.y;C<=D.max.y;C++){for(J=D.min.x;J<=D.max.x;J++){I=new A.Point(J,C),I.z=F,H.push(I)}}var E=H.length;if(0!==E){for(this._cellsToLoad+=E,this._cellsTotal+=E,H.sort(function(M,K){return M.distanceTo(G)-K.distanceTo(G)}),J=0;E>J;J++){this._addCell(H[J])}}},_cellCoordsToBounds:function(D){var C=this._map,I=this.options.cellSize,H=D.multiplyBy(I),G=H.add([I,I]),F=C.unproject(H,D.z).wrap(),E=C.unproject(G,D.z).wrap();return new A.LatLngBounds(F,E)},_cellCoordsToKey:function(C){return C.x+":"+C.y},_keyToCellCoords:function(D){var C=D.split(":"),F=parseInt(C[0],10),E=parseInt(C[1],10);return new A.Point(F,E)},_removeOtherCells:function(D){for(var C in this._cells){D.contains(this._keyToCellCoords(C))||this._removeCell(C)}},_removeCell:function(D){var C=this._activeCells[D];C&&(delete this._activeCells[D],this.cellLeave&&this.cellLeave(C.bounds,C.coords),this.fire("cellleave",{bounds:C.bounds,coords:C.coords}))},_removeCells:function(){for(var D in this._cells){var C=this._cells[D].bounds,E=this._cells[D].coords;this.cellLeave&&this.cellLeave(C,E),this.fire("cellleave",{bounds:C,coords:E})}},_addCell:function(D){this._wrapCoords(D);var C=this._cellCoordsToKey(D),E=this._cells[C];E&&!this._activeCells[C]&&(this.cellEnter&&this.cellEnter(E.bounds,D),this.fire("cellenter",{bounds:E.bounds,coords:D}),this._activeCells[C]=E),E||(E={coords:D,bounds:this._cellCoordsToBounds(D)},this._cells[C]=E,this._activeCells[C]=E,this.createCell&&this.createCell(E.bounds,D),this.fire("cellcreate",{bounds:E.bounds,coords:D}))},_wrapCoords:function(C){C.x=this._wrapLng?A.Util.wrapNum(C.x,this._wrapLng):C.x,C.y=this._wrapLat?A.Util.wrapNum(C.y,this._wrapLat):C.y}}),function(D){function C(E){this.values=E||[]}D.Layers.FeatureManager=D.Layers.FeatureGrid.extend({options:{where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(H,G){if(D.Layers.FeatureGrid.prototype.initialize.call(this,G),G=G||{},G.url=D.Util.cleanUrl(H),G=A.setOptions(this,G),this._service=new D.Services.FeatureLayer(G),"*"!==this.options.fields[0]){for(var F=!1,E=0;E<this.options.fields.length;E++){this.options.fields[E].match(/^(OBJECTID|FID|OID|ID)$/i)&&(F=!0)}F===!1&&console&&console.warn&&console.warn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this._service.on("authenticationrequired requeststart requestend requesterror requestsuccess",function(I){I=A.extend({target:this},I),this.fire(I.type,I)},this),this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new C,this._endTimeIndex=new C):this.options.timeField&&(this._timeIndex=new C),this._cache={},this._currentSnapshot=[],this._activeRequests=0,this._pendingRequests=[]},onAdd:function(E){return D.Layers.FeatureGrid.prototype.onAdd.call(this,E)},onRemove:function(E){return D.Layers.FeatureGrid.prototype.onRemove.call(this,E)},getAttribution:function(){return this.options.attribution},createCell:function(F,E){this._requestFeatures(F,E)},_requestFeatures:function(E,G,F){return this._activeRequests++,1===this._activeRequests&&this.fire("loading",{bounds:E}),this._buildQuery(E).run(function(J,I,H){H&&H.exceededTransferLimit&&this.fire("drawlimitexceeded"),this._activeRequests--,!J&&I.features.length&&D.Util.requestAnimationFrame(A.Util.bind(function(){this._addFeatures(I.features,G)},this)),F&&F.call(this,J,I),this._activeRequests<=0&&this.fire("load",{bounds:E})},this)},_cacheKey:function(E){return E.z+":"+E.x+":"+E.y},_addFeatures:function(F,E){var J=this._cacheKey(E);this._cache[J]=this._cache[J]||[];for(var I=F.length-1;I>=0;I--){var H=F[I].id;this._currentSnapshot.push(H),this._cache[J].push(H)}this.options.timeField&&this._buildTimeIndexes(F);var G=this._map.getZoom();G>this.options.maxZoom||G<this.options.minZoom||this.createLayers(F)},_buildQuery:function(F){var E=this._service.query().intersects(F).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.simplifyFactor&&E.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&E.between(this.options.from,this.options.to),E},setWhere:function(Q,P,O){this.options.where=Q&&Q.length?Q:"1=1";for(var N=[],M=[],K=0,J=null,I=A.Util.bind(function(R,T){if(R&&(J=R),T){for(var S=T.features.length-1;S>=0;S--){M.push(T.features[S].id)}}K--,0>=K&&(this._currentSnapshot=M,D.Util.requestAnimationFrame(A.Util.bind(function(){this.removeLayers(N),this.addLayers(M),P&&P.call(O,J)},this)))},this),H=this._currentSnapshot.length-1;H>=0;H--){N.push(this._currentSnapshot[H])}for(var G in this._activeCells){K++;var F=this._keyToCellCoords(G),E=this._cellCoordsToBounds(F);this._requestFeatures(E,G,I)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(Q,P,O,N){var M=this.options.from,K=this.options.to,J=0,I=null,H=A.Util.bind(function(R){R&&(I=R),this._filterExistingFeatures(M,K,Q,P),J--,O&&0>=J&&O.call(N,I)},this);if(this.options.from=Q,this.options.to=P,this._filterExistingFeatures(M,K,Q,P),"server"===this.options.timeFilterMode){for(var G in this._activeCells){J++;var F=this._keyToCellCoords(G),E=this._cellCoordsToBounds(F);this._requestFeatures(E,G,H)}}},refresh:function(){for(var F in this._activeCells){var E=this._keyToCellCoords(F),G=this._cellCoordsToBounds(E);this._requestFeatures(G,F)}},_filterExistingFeatures:function(E,M,K,J){var I=E&&M?this._getFeaturesInTimeRange(E,M):this._currentSnapshot,H=this._getFeaturesInTimeRange(K,J);if(H.indexOf){for(var G=0;G<H.length;G++){var F=I.indexOf(H[G]);F>=0&&I.splice(F,1)}}D.Util.requestAnimationFrame(A.Util.bind(function(){this.removeLayers(I),this.addLayers(H)},this))},_getFeaturesInTimeRange:function(F,E){var K,J=[];if(this.options.timeField.start&&this.options.timeField.end){var I=this._startTimeIndex.between(F,E),H=this._endTimeIndex.between(F,E);K=I.concat(H)}else{K=this._timeIndex.between(F,E)}for(var G=K.length-1;G>=0;G--){J.push(K[G].id)}return J},_buildTimeIndexes:function(F){var E,J;if(this.options.timeField.start&&this.options.timeField.end){var I=[],H=[];for(E=F.length-1;E>=0;E--){J=F[E],I.push({id:J.id,value:new Date(J.properties[this.options.timeField.start])}),H.push({id:J.id,value:new Date(J.properties[this.options.timeField.end])})}this._startTimeIndex.bulkAdd(I),this._endTimeIndex.bulkAdd(H)}else{var G=[];for(E=F.length-1;E>=0;E--){J=F[E],G.push({id:J.id,value:new Date(J.properties[this.options.timeField])})}this._timeIndex.bulkAdd(G)}},_featureWithinTimeRange:function(F){if(!this.options.from||!this.options.to){return !0}var E=+this.options.from.valueOf(),J=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var I=+F.properties[this.options.timeField];return I>=E&&J>=I}if(this.options.timeField.start&&this.options.timeField.end){var H=+F.properties[this.options.timeField.start],G=+F.properties[this.options.timeField.end];return H>=E&&J>=H||G>=E&&J>=G}},authenticate:function(E){return this._service.authenticate(E),this},metadata:function(F,E){return this._service.metadata(F,E),this},query:function(){return this._service.query()},addFeature:function(F,E,G){return this._service.addFeature(F,function(H,I){H||this.refresh(),E&&E.call(G,H,I)},this),this},updateFeature:function(F,E,G){return this._service.updateFeature(F,function(H,I){H||this.refresh(),E&&E.call(G,H,I)},this)},deleteFeature:function(F,E,G){return this._service.deleteFeature(F,function(H,I){!H&&I.objectId&&this.removeLayers([I.objectId],!0),E&&E.call(G,H,I)},this)}}),C.prototype._query=function(F){for(var E,J,I,H=0,G=this.values.length-1;G>=H;){if(I=E=(H+G)/2|0,J=this.values[Math.round(E)],+J.value<+F){H=E+1}else{if(!(+J.value>+F)){return E}G=E-1}}return ~G},C.prototype.sort=function(){this.values.sort(function(F,E){return +E.value-+F.value}).reverse(),this.dirty=!1},C.prototype.between=function(F,E){this.dirty&&this.sort();var H=this._query(F),G=this._query(E);return 0===H&&0===G?[]:(H=Math.abs(H),G=0>G?Math.abs(G):G+1,this.values.slice(H,G))},C.prototype.bulkAdd=function(E){this.dirty=!0,this.values=this.values.concat(E)}}(B),B.Layers.FeatureLayer=B.Layers.FeatureManager.extend({statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},options:{cacheLayers:!0},initialize:function(D,C){B.Layers.FeatureManager.prototype.initialize.call(this,D,C),C=A.setOptions(this,C),this._layers={},this._leafletIds={},this._key="c"+(1000000000*Math.random()).toString(36).replace(".","_")},onAdd:function(C){return C.on("zoomstart zoomend",function(D){this._zooming="zoomstart"===D.type},this),B.Layers.FeatureManager.prototype.onAdd.call(this,C)},onRemove:function(D){for(var C in this._layers){D.removeLayer(this._layers[C])}return B.Layers.FeatureManager.prototype.onRemove.call(this,D)},createNewLayer:function(C){return A.GeoJSON.geometryToLayer(C,this.options.pointToLayer,A.GeoJSON.coordsToLatLng,this.options)},createLayers:function(D){for(var C=D.length-1;C>=0;C--){var H,G=D[C],F=this._layers[G.id];if(F&&!this._map.hasLayer(F)&&this._map.addLayer(F),F&&F.setLatLngs){var E=this.createNewLayer(G);F.setLatLngs(E.getLatLngs())}F||(H=this.createNewLayer(G),H.feature=G,H.defaultOptions=H.options,H._leaflet_id=this._key+"_"+G.id,this._leafletIds[H._leaflet_id]=G.id,H.on(B.Layers.FeatureLayer.EVENTS,this._propagateEvent,this),this._popup&&H.bindPopup&&H.bindPopup(this._popup(H.feature,H),this._popupOptions),this.options.onEachFeature&&this.options.onEachFeature(H.feature,H),this._layers[H.feature.id]=H,this.resetStyle(H.feature.id),this.fire("createfeature",{feature:H.feature}),(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(G))&&this._map.addLayer(H))}},addLayers:function(D){for(var C=D.length-1;C>=0;C--){var E=this._layers[D[C]];E&&(this.fire("addfeature",{feature:E.feature}),this._map.addLayer(E))}},removeLayers:function(D,C){for(var G=D.length-1;G>=0;G--){var F=D[G],E=this._layers[F];E&&(this.fire("removefeature",{feature:E.feature,permanent:C}),this._map.removeLayer(E)),E&&C&&delete this._layers[F]}},cellEnter:function(D,C){this._zooming||B.Util.requestAnimationFrame(A.Util.bind(function(){var E=this._cacheKey(C),G=this._cellCoordsToKey(C),F=this._cache[E];this._activeCells[G]&&F&&this.addLayers(F)},this))},cellLeave:function(D,C){this._zooming||B.Util.requestAnimationFrame(A.Util.bind(function(){var E=this._cacheKey(C),K=this._cellCoordsToKey(C),J=this._cache[E],I=this._map.getBounds();if(!this._activeCells[K]&&J){for(var H=!0,G=0;G<J.length;G++){var F=this._layers[J[G]];F&&F.getBounds&&I.intersects(F.getBounds())&&(H=!1)}H&&this.removeLayers(J,!this.options.cacheLayers),!this.options.cacheLayers&&H&&(delete this._cache[E],delete this._cells[K],delete this._activeCells[K])}},this))},resetStyle:function(D){var C=this._layers[D];return C&&(C.options=C.defaultOptions,this.setFeatureStyle(C.feature.id,this.options.style)),this},setStyle:function(C){return this.options.style=C,this.eachFeature(function(D){this.setFeatureStyle(D.feature.id,C)},this),this},setFeatureStyle:function(D,C){var E=this._layers[D];if("function"==typeof C){C=C(E.feature)}else{if(!C&&!E.defaultOptions){new A.Path;C=A.Path.prototype.options,C.fill=!0}}E.setStyle&&E.setStyle(C)},bindPopup:function(D,C){this._popup=D,this._popupOptions=C;for(var G in this._layers){var F=this._layers[G],E=this._popup(F.feature,F);F.bindPopup(E,C)}return this},unbindPopup:function(){this._popup=!1;for(var D in this._layers){var C=this._layers[D];if(C.unbindPopup){C.unbindPopup()}else{if(C.getLayers){var G=C.getLayers();for(var F in G){var E=G[F];E.unbindPopup()}}}}return this},eachFeature:function(D,C){for(var E in this._layers){D.call(C,this._layers[E])}return this},getFeature:function(C){return this._layers[C]},_propagateEvent:function(C){C.layer=this._layers[this._leafletIds[C.target._leaflet_id]],C.target=this,this.fire(C.type,C)}}),B.FeatureLayer=B.Layers.FeatureLayer,B.Layers.featureLayer=function(D,C){return new B.Layers.FeatureLayer(D,C)},B.featureLayer=function(D,C){return new B.Layers.FeatureLayer(D,C)},B.Controls.Logo=A.Control.extend({options:{position:"bottomright",marginTop:0,marginLeft:0,marginBottom:0,marginRight:0},onAdd:function(){var C=A.DomUtil.create("div","esri-leaflet-logo");return C.style.marginTop=this.options.marginTop,C.style.marginLeft=this.options.marginLeft,C.style.marginBottom=this.options.marginBottom,C.style.marginRight=this.options.marginRight,C.innerHTML='<a href="https://developers.arcgis.com" style="border: none;"><img src="https://js.arcgis.com/3.11/esri/images/map/logo-med.png" style="border: none;"></a>',C}}),B.Controls.logo=function(C){return new A.esri.Controls.Logo(C)};return B}));window.google=window.google||{};google.maps=google.maps||{};(function(){function A(D){document.write('<script src="'+D+'"><\/script>')}var B=google.maps.modules={};google.maps.__gjsload__=function(D,E){B[D]=E};google.maps.Load=function(D){delete google.maps.Load;D([0.009999999776482582,[[["http://mt0.googleapis.com/maps/vt?lyrs=m@339000000\u0026src=api\u0026hl=en-US\u0026","http://mt1.googleapis.com/maps/vt?lyrs=m@339000000\u0026src=api\u0026hl=en-US\u0026"],null,null,null,null,"m@339000000",["https://mts0.google.com/maps/vt?lyrs=m@339000000\u0026src=api\u0026hl=en-US\u0026","https://mts1.google.com/maps/vt?lyrs=m@339000000\u0026src=api\u0026hl=en-US\u0026"]],[["http://khm0.googleapis.com/kh?v=198\u0026hl=en-US\u0026","http://khm1.googleapis.com/kh?v=198\u0026hl=en-US\u0026"],null,null,null,1,"198",["https://khms0.google.com/kh?v=198\u0026hl=en-US\u0026","https://khms1.google.com/kh?v=198\u0026hl=en-US\u0026"]],null,[["http://mt0.googleapis.com/maps/vt?lyrs=t@132,r@339000000\u0026src=api\u0026hl=en-US\u0026","http://mt1.googleapis.com/maps/vt?lyrs=t@132,r@339000000\u0026src=api\u0026hl=en-US\u0026"],null,null,null,null,"t@132,r@339000000",["https://mts0.google.com/maps/vt?lyrs=t@132,r@339000000\u0026src=api\u0026hl=en-US\u0026","https://mts1.google.com/maps/vt?lyrs=t@132,r@339000000\u0026src=api\u0026hl=en-US\u0026"]],null,null,[["http://cbk0.googleapis.com/cbk?","http://cbk1.googleapis.com/cbk?"]],[["http://khm0.googleapis.com/kh?v=96\u0026hl=en-US\u0026","http://khm1.googleapis.com/kh?v=96\u0026hl=en-US\u0026"],null,null,null,null,"96",["https://khms0.google.com/kh?v=96\u0026hl=en-US\u0026","https://khms1.google.com/kh?v=96\u0026hl=en-US\u0026"]],[["http://mt0.googleapis.com/mapslt?hl=en-US\u0026","http://mt1.googleapis.com/mapslt?hl=en-US\u0026"]],[["http://mt0.googleapis.com/mapslt/ft?hl=en-US\u0026","http://mt1.googleapis.com/mapslt/ft?hl=en-US\u0026"]],[["http://mt0.googleapis.com/maps/vt?hl=en-US\u0026","http://mt1.googleapis.com/maps/vt?hl=en-US\u0026"]],[["http://mt0.googleapis.com/mapslt/loom?hl=en-US\u0026","http://mt1.googleapis.com/mapslt/loom?hl=en-US\u0026"]],[["https://mts0.googleapis.com/mapslt?hl=en-US\u0026","https://mts1.googleapis.com/mapslt?hl=en-US\u0026"]],[["https://mts0.googleapis.com/mapslt/ft?hl=en-US\u0026","https://mts1.googleapis.com/mapslt/ft?hl=en-US\u0026"]],[["https://mts0.googleapis.com/mapslt/loom?hl=en-US\u0026","https://mts1.googleapis.com/mapslt/loom?hl=en-US\u0026"]]],["en-US","US",null,0,null,null,"http://maps.gstatic.com/mapfiles/","http://csi.gstatic.com","https://maps.googleapis.com","http://maps.googleapis.com",null,"https://maps.google.com","https://gg.google.com","http://maps.gstatic.com/maps-api-v3/api/images/","https://www.google.com/maps",0,"https://www.google.com"],["http://maps.google.com/maps-api-v3/api/js/23/7","3.23.7"],[3801039637],1,null,null,null,null,null,"",null,null,0,"http://khm.googleapis.com/mz?v=198\u0026",null,"https://earthbuilder.googleapis.com","https://earthbuilder.googleapis.com",null,"http://mt.googleapis.com/maps/vt/icon",[["http://maps.google.com/maps/vt"],["https://maps.google.com/maps/vt"],null,null,null,null,null,null,null,null,null,null,["https://www.google.com/maps/vt"],"/maps/vt",339000000,132],2,500,[null,"http://g0.gstatic.com/landmark/tour","http://g0.gstatic.com/landmark/config",null,"http://www.google.com/maps/preview/log204","","http://static.panoramio.com.storage.googleapis.com/photos/",["http://geo0.ggpht.com/cbk","http://geo1.ggpht.com/cbk","http://geo2.ggpht.com/cbk","http://geo3.ggpht.com/cbk"],"https://maps.googleapis.com/maps/api/js/GeoPhotoService.GetMetadata","https://maps.googleapis.com/maps/api/js/GeoPhotoService.SingleImageSearch",["http://lh3.ggpht.com/","http://lh4.ggpht.com/","http://lh5.ggpht.com/","http://lh6.ggpht.com/"]],["https://www.google.com/maps/api/js/master?pb=!1m2!1u23!2s7!2sen-US!3sUS!4s23/7","https://www.google.com/maps/api/js/widget?pb=!1m2!1u23!2s7!2sen-US"],null,0,null,"/maps/api/js/ApplicationService.GetEntityDetails",0,null,null,null,null,[],["23.7"]],C)};var C=(new Date).getTime()})();(function(Bb){var n,c,k,Bs,Ao,AT,AC,p,Bv,Bf,Ax,y,A9,l,V,Ak,B7,A8,x,A1,B2,BF,A3,AS,o,B8,An,AB,Bd,Aw,AZ,U,B5,Bt,Au,AY,AK,v,R,CC,Bl,BD,BP,BT,A2,b,M,BK,T,G,CE,AX,AJ,i,CB,Bk,By,BO,BS,BE,AQ,K,B6,Bu,Bc,Av,AL,w,j,S,F,CD,Bz,Ah,m,Y,AW,AH,t,h,P,A0,Ag,Bp,BR,Aj,AO,B4,BZ,At,u,X,CG,BW,BI,A6,As,AF,r,f,Bj,BC,Ai,AP,CH,BX,BJ,AI,Q,D,W,H,Bq,BV,BH,A5,Ar,Am,AR;Bb.aa="ERROR";Bb.ba="INVALID_REQUEST";Bb.ca="MAX_DIMENSIONS_EXCEEDED";Bb.da="MAX_ELEMENTS_EXCEEDED";Bb.ea="MAX_WAYPOINTS_EXCEEDED";Bb.ga="NOT_FOUND";Bb.ha="OK";Bb.ia="OVER_QUERY_LIMIT";Bb.ja="REQUEST_DENIED";Bb.ka="UNKNOWN_ERROR";Bb.la="ZERO_RESULTS";Bb.ma=function(){return function(Aa){return Aa}};Bb.k=function(){return function(){}};Bb.na=function(Aa){return function(Ae){this[Aa]=Ae}};Bb.m=function(Aa){return function(){return this[Aa]}};Bb.oa=function(Aa){return function(){return Aa}};Bb.qa=function(Aa){return function(){return Bb.pa[Aa].apply(this,arguments)}};Bb.ra=function(Aa){return void 0!==Aa};Bb.ta=Bb.k();Bb.ua=function(Aa){Aa.Mc=function(){return Aa.Ob?Aa.Ob:Aa.Ob=new Aa}};Bb.va=function(Ae){var Aa=typeof Ae;if("object"==Aa){if(Ae){if(Ae instanceof Array){return"array"}if(Ae instanceof Object){return Aa}var Ba=Object.prototype.toString.call(Ae);if("[object Window]"==Ba){return"object"}if("[object Array]"==Ba||"number"==typeof Ae.length&&"undefined"!=typeof Ae.splice&&"undefined"!=typeof Ae.propertyIsEnumerable&&!Ae.propertyIsEnumerable("splice")){return"array"}if("[object Function]"==Ba||"undefined"!=typeof Ae.call&&"undefined"!=typeof Ae.propertyIsEnumerable&&!Ae.propertyIsEnumerable("call")){return"function"}}else{return"null"}}else{if("function"==Aa&&"undefined"==typeof Ae.call){return"object"}}return Aa};Bb.wa=function(Ae){var Aa=Bb.va(Ae);return"array"==Aa||"object"==Aa&&"number"==typeof Ae.length};Bb.xa=function(Aa){return"string"==typeof Aa};Bb.ya=function(Aa){return"number"==typeof Aa};Bb.za=function(Ae){var Aa=typeof Ae;return"object"==Aa&&null!=Ae||"function"==Aa};Bb.Ca=function(Aa){return Aa[Am]||(Aa[Am]=++AR)};n=function(Ae,Aa,Ba){return Ae.call.apply(Ae.bind,arguments)};c=function(Ae,Aa,Be){if(!Ae){throw Error()}if(2<arguments.length){var Ba=Array.prototype.slice.call(arguments,2);return function(){var Bi=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(Bi,Ba);return Ae.apply(Aa,Bi)}}return function(){return Ae.apply(Aa,arguments)}};Bb.u=function(Ae,Aa,Ba){Bb.u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:c;return Bb.u.apply(null,arguments)};Bb.Fa=function(){return +new Date};Bb.v=function(Ae,Aa){function Ba(){}Ba.prototype=Aa.prototype;Ae.qd=Aa.prototype;Ae.prototype=new Ba;Ae.prototype.constructor=Ae;Ae.Kr=function(Be,CM,CL){for(var CK=Array(arguments.length-2),Bi=2;Bi<arguments.length;Bi++){CK[Bi-2]=arguments[Bi]}return Aa.prototype[CM].apply(Be,CK)}};Bb.x=function(Aa){return Aa?Aa.length:0};Bb.Ga=function(Ae,Aa){return function(Ba){return Aa(Ae(Ba))}};Bb.Ia=function(Ae,Aa){Bb.Ha(Aa,function(Ba){Ae[Ba]=Aa[Ba]})};Bb.Ja=function(Ae){for(var Aa in Ae){return !1}return !0};Bb.Ka=function(Ae,Aa,Ba){null!=Aa&&(Ae=Math.max(Ae,Aa));null!=Ba&&(Ae=Math.min(Ae,Ba));return Ae};Bb.La=function(Ae,Aa,Ba){Ba=Ba-Aa;return((Ae-Aa)%Ba+Ba)%Ba+Aa};Bb.Ma=function(Ae,Aa,Ba){return Math.abs(Ae-Aa)<=(Ba||1e-9)};Bb.Na=function(Ae,Aa){for(var Bi=[],Be=Bb.x(Ae),Ba=0;Ba<Be;++Ba){Bi.push(Aa(Ae[Ba],Ba))}return Bi};Bb.Pa=function(Ae,Aa){for(var Be=Bb.Oa(void 0,Bb.x(Aa)),Ba=Bb.Oa(void 0,0);Ba<Be;++Ba){Ae.push(Aa[Ba])}};k=function(Aa){return null==Aa};Bb.B=function(Aa){return"undefined"!=typeof Aa};Bb.D=function(Aa){return"number"==typeof Aa};Bb.Ra=function(Aa){return"object"==typeof Aa};Bb.Oa=function(Ae,Aa){return null==Ae?Aa:Ae};Bb.Sa=function(Aa){return"string"==typeof Aa};Bb.Ua=function(Aa){return Aa===!!Aa};Bb.G=function(Ae,Aa){for(var Be=0,Ba=Bb.x(Ae);Be<Ba;++Be){Aa(Ae[Be],Be)}};Bb.Ha=function(Ae,Aa){for(var Ba in Ae){Aa(Ba,Ae[Ba])}};Bb.Wa=function(Ae,Aa,Be){var Ba=Bb.Va(arguments,2);return function(){return Aa.apply(Ae,Ba)}};Bb.Va=function(Ae,Aa,Ba){return Function.prototype.call.apply(Array.prototype.slice,arguments)};Bb.Xa=function(Aa){return null!=Aa&&"object"==typeof Aa&&"number"==typeof Aa.length};Bb.Za=function(Aa){return function(){var Ae=this,Ba=arguments;Bb.Ya(function(){Aa.apply(Ae,Ba)})}};Bb.Ya=function(Aa){return window.setTimeout(Aa,0)};Bs=function(Ae,Aa){if(Object.prototype.hasOwnProperty.call(Ae,Aa)){return Ae[Aa]}};Bb.ab=function(Aa){window.console&&window.console.error&&window.console.error(Aa)};Bb.db=function(Aa){Aa=Aa||window.event;Bb.bb(Aa);Bb.cb(Aa)};Bb.bb=function(Aa){Aa.cancelBubble=!0;Aa.stopPropagation&&Aa.stopPropagation()};Bb.cb=function(Aa){Aa.preventDefault&&Bb.B(Aa.defaultPrevented)?Aa.preventDefault():Aa.returnValue=!1};Bb.eb=function(Aa){Aa.handled=!0;Bb.B(Aa.bubbles)||(Aa.returnValue="handled")};Ao=function(Ae,Aa){Ae.__e3_||(Ae.__e3_={});var Ba=Ae.__e3_;Ba[Aa]||(Ba[Aa]={});return Ba[Aa]};AT=function(Ae,Aa){var Bi,Be=Ae.__e3_||{};if(Aa){Bi=Be[Aa]||{}}else{Bi={};for(var Ba in Be){Bb.Ia(Bi,Be[Ba])}}return Bi};AC=function(Ae,Aa){return function(Ba){return Aa.call(Ae,Ba,this)}};p=function(Ae,Aa,Ba){return function(Bi){var Be=[Aa,Ae];Bb.Pa(Be,arguments);Bb.I.trigger.apply(this,Be);Ba&&Bb.eb.apply(null,arguments)}};Bv=function(Ae,Aa,Be,Ba){this.Ob=Ae;this.R=Aa;this.j=Be;this.S=null;this.U=Ba;this.id=++d;Ao(Ae,Aa)[this.id]=this;A&&"tagName" in Ae&&(B9[this.id]=this)};Bf=function(Aa){return Aa.S=function(Ae){Ae||(Ae=window.event);if(Ae&&!Ae.target){try{Ae.target=Ae.srcElement}catch(Ba){}}var Be;Be=Aa.j.apply(Aa.Ob,[Ae]);return Ae&&"click"==Ae.type&&(Ae=Ae.srcElement)&&"A"==Ae.tagName&&"javascript:void(0)"==Ae.href?!1:Be}};Bb.pb=function(Aa){return""+(Bb.za(Aa)?Bb.Ca(Aa):Aa)};Bb.J=Bb.k();Ax=function(Ae,Aa){var Bi=Aa+"_changed";if(Ae[Bi]){Ae[Bi]()}else{Ae.changed(Aa)}var Bi=A9(Ae,Aa),Be;for(Be in Bi){var Ba=Bi[Be];Ax(Ba.Rd,Ba.jc)}Bb.I.trigger(Ae,Aa.toLowerCase()+"_changed")};Bb.tb=function(Aa){return Ac[Aa]||(Ac[Aa]=Aa.substr(0,1).toUpperCase()+Aa.substr(1))};y=function(Aa){Aa.gm_accessors_||(Aa.gm_accessors_={});return Aa.gm_accessors_};A9=function(Ae,Aa){Ae.gm_bindings_||(Ae.gm_bindings_={});Ae.gm_bindings_.hasOwnProperty(Aa)||(Ae.gm_bindings_[Aa]={});return Ae.gm_bindings_[Aa]};l=Bb.k();V=function(Aa){this.message=Aa;this.name="InvalidValueError";this.stack=Error().stack};Bb.xb=function(Ae,Aa){var Ba="";if(null!=Aa){if(!(Aa instanceof V)){return Aa}Ba=": "+Aa.message}return new V(Ae+Ba)};Bb.yb=function(Aa){if(!(Aa instanceof V)){throw Aa}Bb.ab(Aa.name+": "+Aa.message)};Bb.zb=function(Ae,Aa){return function(CL){if(!CL||!Bb.Ra(CL)){throw Bb.xb("not an Object")}var CK={},Bi;for(Bi in CL){if(CK[Bi]=CL[Bi],!Aa&&!Ae[Bi]){throw Bb.xb("unknown property "+Bi)}}for(Bi in Ae){try{var Be=Ae[Bi](CK[Bi]);if(Bb.B(Be)||Object.prototype.hasOwnProperty.call(CL,Bi)){CK[Bi]=Ae[Bi](CK[Bi])}}catch(Ba){throw Bb.xb("in property "+Bi,Ba)}}return CK}};Ak=function(Ae){try{return !!Ae.cloneNode}catch(Aa){return !1}};Bb.Bb=function(Ae,Aa,Ba){return Ba?function(Bi){if(Bi instanceof Ae){return Bi}try{return new Ae(Bi)}catch(Be){throw Bb.xb("when calling new "+Aa,Be)}}:function(Be){if(Be instanceof Ae){return Be}throw Bb.xb("not an instance of "+Aa)}};Bb.Cb=function(Aa){return function(Ae){for(var Ba in Aa){if(Aa[Ba]==Ae){return Ae}}throw Bb.xb(Ae)}};Bb.Db=function(Aa){return function(Ae){if(!Bb.Xa(Ae)){throw Bb.xb("not an Array")}return Bb.Na(Ae,function(Ba,Bi){try{return Aa(Ba)}catch(Be){throw Bb.xb("at index "+Bi,Be)}})}};Bb.Eb=function(Ae,Aa){return function(Ba){if(Ae(Ba)){return Ba}throw Bb.xb(Aa||""+Ba)}};Bb.Fb=function(Ae){var Aa=arguments;return function(Ba){for(var CM=[],CL=0,CK=Aa.length;CL<CK;++CL){var Bi=Aa[CL];try{(Bi.Yh||Bi)(Ba)}catch(Be){if(!(Be instanceof V)){throw Be}CM.push(Be.message);continue}return(Bi.then||Bi)(Ba)}throw Bb.xb(CM.join("; and "))}};Bb.Gb=function(Aa){return function(Ae){return null==Ae?Ae:Aa(Ae)}};B7=function(Aa){return function(Ae){if(Ae&&null!=Ae[Aa]){return Ae}throw Bb.xb("no "+Aa+" property")}};Bb.Ib=function(Aa){return Aa.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};Bb.Kb=function(){return -1!=Bb.Jb.toLowerCase().indexOf("webkit")};Bb.Mb=function(CR,CQ){for(var CP=0,CO=Bb.Ib(String(CR)).split("."),CN=Bb.Ib(String(CQ)).split("."),CM=Math.max(CO.length,CN.length),CL=0;0==CP&&CL<CM;CL++){var CK=CO[CL]||"",Bi=CN[CL]||"",Be=/(\d*)(\D*)/g,Ba=/(\d*)(\D*)/g;do{var Ae=Be.exec(CK)||["","",""],Aa=Ba.exec(Bi)||["","",""];if(0==Ae[0].length&&0==Aa[0].length){break}CP=A8(0==Ae[1].length?0:(0,window.parseInt)(Ae[1],10),0==Aa[1].length?0:(0,window.parseInt)(Aa[1],10))||A8(0==Ae[2].length,0==Aa[2].length)||A8(Ae[2],Aa[2])}while(0==CP)}return CP};A8=function(Ae,Aa){return Ae<Aa?-1:Ae>Aa?1:0};Bb.Nb=function(Ae,Aa,Ba){Ba=null==Ba?0:0>Ba?Math.max(0,Ae.length+Ba):Ba;if(Bb.xa(Ae)){return Bb.xa(Aa)&&1==Aa.length?Ae.indexOf(Aa,Ba):-1}for(;Ba<Ae.length;Ba++){if(Ba in Ae&&Ae[Ba]===Aa){return Ba}}return -1};Bb.Ob=function(Ae,Aa,CK){for(var Bi=Ae.length,Be=Bb.xa(Ae)?Ae.split(""):Ae,Ba=0;Ba<Bi;Ba++){Ba in Be&&Aa.call(CK,Be[Ba],Ba,Ae)}};x=function(Ae,Aa){for(var Bi=Ae.length,Be=Bb.xa(Ae)?Ae.split(""):Ae,Ba=0;Ba<Bi;Ba++){if(Ba in Be&&Aa.call(void 0,Be[Ba],Ba,Ae)){return Ba}}return -1};Bb.Rb=function(Ae,Aa){var Be=Bb.Nb(Ae,Aa),Ba;(Ba=0<=Be)&&Bb.Qb(Ae,Be);return Ba};Bb.Qb=function(Ae,Aa){Array.prototype.splice.call(Ae,Aa,1)};Bb.Sb=function(Aa){return Aa*Math.PI/180};Bb.Ub=function(Aa){return 180*Aa/Math.PI};Bb.K=function(Ae,Aa,Be){if(Ae&&(Ae.lat||Ae.lng)){try{Bm(Ae),Aa=Ae.lng,Ae=Ae.lat,Be=!1}catch(Ba){Bb.yb(Ba)}}Ae-=0;Aa-=0;Be||(Ae=Bb.Ka(Ae,-90,90),180!=Aa&&(Aa=Bb.La(Aa,-180,180)));this.lat=function(){return Ae};this.lng=function(){return Aa}};Bb.Wb=function(Aa){return Bb.Sb(Aa.lat())};Bb.Xb=function(Aa){return Bb.Sb(Aa.lng())};A1=function(Ae,Aa){var Ba=Math.pow(10,Aa);return Math.round(Ae*Ba)/Ba};Bb.Zb=function(Ae){try{if(Ae instanceof Bb.K){return Ae}Ae=Bm(Ae);return new Bb.K(Ae.lat,Ae.lng)}catch(Aa){throw Bb.xb("not a LatLng or LatLngLiteral",Aa)}};Bb.$b=function(Aa){this.j=Bb.Zb(Aa)};B2=function(Ae){if(Ae instanceof l){return Ae}try{return new Bb.$b(Bb.Zb(Ae))}catch(Aa){}throw Bb.xb("not a Geometry or LatLng or LatLngLiteral object")};Bb.bc=function(Ae,Aa){if(Ae){return function(){--Ae||Aa()}}Aa();return Bb.ta};Bb.cc=function(Ae,Aa,Be){var Ba=Ae.getElementsByTagName("head")[0];Ae=Ae.createElement("script");Ae.type="text/javascript";Ae.charset="UTF-8";Ae.src=Aa;Be&&(Ae.onerror=Be);Ba.appendChild(Ae);return Ae};BF=function(Ae){for(var Aa="",Bi=0,Be=arguments.length;Bi<Be;++Bi){var Ba=arguments[Bi];Ba.length&&"/"==Ba[0]?Aa=Ba:(Aa&&"/"!=Aa[Aa.length-1]&&(Aa+="/"),Aa+=Ba)}return Aa};A3=function(Aa){this.S=window.document;this.j={};this.R=Aa};AS=function(){this.U={};this.R={};this.V={};this.j={};this.S=new An};o=function(Ae,Aa){Ae.U[Aa]||(Ae.U[Aa]=!0,AB(Ae.S,function(CL){for(var CK=CL.Dj[Aa],Bi=CK?CK.length:0,Be=0;Be<Bi;++Be){var Ba=CK[Be];Ae.j[Ba]||o(Ae,Ba)}CL=CL.Qo;CL.j[Aa]||Bb.cc(CL.S,BF(CL.R,Aa)+".js")}))};B8=function(CN,CM){var CL=CJ;this.Qo=CN;this.Dj=CL;var CK={},Bi;for(Bi in CL){for(var Be=CL[Bi],Ba=0,Ae=Be.length;Ba<Ae;++Ba){var Aa=Be[Ba];CK[Aa]||(CK[Aa]=[]);CK[Aa].push(Bi)}}this.hq=CK;this.mn=CM};An=function(){this.j=[]};AB=function(Ae,Aa){Ae.R?Aa(Ae.R):Ae.j.push(Aa)};Bb.L=function(Ae,Aa,Be){var Ba=AS.Mc();Ae=""+Ae;Ba.j[Ae]?Aa(Ba.j[Ae]):((Ba.R[Ae]=Ba.R[Ae]||[]).push(Aa),Be||o(Ba,Ae))};Bb.nc=function(Ae,Aa){AS.Mc().j[""+Ae]=Aa};Bd=function(Ae,Aa,Bi){var Be=[],Ba=Bb.bc(Ae.length,function(){Aa.apply(null,Be)});Bb.Ob(Ae,function(CL,CK){Bb.L(CL,function(CM){Be[CK]=CM;Ba()},Bi)})};Bb.pc=function(Ae){Ae=Ae||{};this.S=Ae.id;this.j=null;try{this.j=Ae.geometry?B2(Ae.geometry):null}catch(Aa){Bb.yb(Aa)}this.R=Ae.properties||{}};Bb.M=function(Ae,Aa){this.x=Ae;this.y=Aa};Aw=function(Ae){if(Ae instanceof Bb.M){return Ae}try{Bb.zb({x:Bb.qc,y:Bb.qc},!0)(Ae)}catch(Aa){throw Bb.xb("not a Point",Aa)}return new Bb.M(Ae.x,Ae.y)};Bb.N=function(Ae,Aa,Be,Ba){this.width=Ae;this.height=Aa;this.ma=Be||"px";this.W=Ba||"px"};AZ=function(Ae){if(Ae instanceof Bb.N){return Ae}try{Bb.zb({height:Bb.qc,width:Bb.qc},!0)(Ae)}catch(Aa){throw Bb.xb("not a Size",Aa)}return new Bb.N(Ae.width,Ae.height)};Bb.O=function(Aa){return function(){return this.get(Aa)}};Bb.tc=function(Ae,Aa){return Aa?function(Be){try{this.set(Ae,Aa(Be))}catch(Ba){Bb.yb(Bb.xb("set"+Bb.tb(Ae),Ba))}}:function(Ba){this.set(Ae,Ba)}};Bb.vc=function(Ae,Aa){Bb.Ha(Aa,function(Ba,Bi){var Be=Bb.O(Ba);Ae["get"+Bb.tb(Ba)]=Be;Bi&&(Be=Bb.tc(Ba,Bi),Ae["set"+Bb.tb(Ba)]=Be)})};Bb.xc=function(Aa){this.j=Aa||[];U(this)};U=function(Aa){Aa.set("length",Aa.j.length)};Bb.yc=function(Aa){this.S=Aa||Bb.pb;this.R={}};Bb.zc=function(Ae,Aa){var Be=Ae.R,Ba=Ae.S(Aa);Be[Ba]||(Be[Ba]=Aa,Bb.I.trigger(Ae,"insert",Aa),Ae.j&&Ae.j(Aa))};Bb.Ac=function(Ae,Aa,Ba){this.heading=Ae;this.pitch=Bb.Ka(Aa,-90,90);this.zoom=Math.max(0,Ba)};Bb.Bc=function(){this.__gm=new Bb.J;this.S=null};Bb.Cc=Bb.ma();Bb.Dc=function(Ae,Aa,Be){for(var Ba in Ae){Aa.call(Be,Ae[Ba],Ba,Ae)}};Bb.Ec=function(Aa){return -1!=Bb.Jb.indexOf(Aa)};Bb.Fc=function(){return Bb.Ec("Opera")||Bb.Ec("OPR")};Bb.Gc=function(){return Bb.Ec("Trident")||Bb.Ec("MSIE")};B5=function(){return(Bb.Ec("Chrome")||Bb.Ec("CriOS"))&&!Bb.Fc()&&!Bb.Ec("Edge")};Bt=function(Ae,Aa,Ba){this.U=Ba;this.S=Ae;this.V=Aa;this.R=0;this.j=null};Au=function(){this.R=this.j=null};AY=function(){this.next=this.j=this.Md=null};AK=function(Ae,Aa){return function(Ba){return Ba.Md==Ae&&Ba.context==(Aa||null)}};v=function(Aa){this.Ea=[];this.j=Aa&&Aa.Fe||Bb.ta;this.R=Aa&&Aa.He||Bb.ta};Bb.Qc=function(){this.Ea=new v({Fe:(0,Bb.u)(this.Fe,this),He:(0,Bb.u)(this.He,this)})};R=Bb.k();CC=function(Ae){var Aa=Ae;if(Ae instanceof Array){Aa=Array(Ae.length),Bb.Sc(Aa,Ae)}else{if(Ae instanceof Object){var Be=Aa={},Ba;for(Ba in Ae){Ae.hasOwnProperty(Ba)&&(Be[Ba]=CC(Ae[Ba]))}}}return Aa};Bb.Sc=function(Ae,Aa){for(var Ba=0;Ba<Aa.length;++Ba){Aa.hasOwnProperty(Ba)&&(Ae[Ba]=CC(Aa[Ba]))}};Bb.P=function(Ae,Aa){Ae[Aa]||(Ae[Aa]=[]);return Ae[Aa]};Bb.Uc=function(Ae,Aa){return Ae[Aa]?Ae[Aa].length:0};Bl=Bb.k();BD=function(Ae,Aa,CL){for(var CK=1;CK<Aa.ra.length;++CK){var Bi=Aa.ra[CK],Be=Ae[CK+Aa.qa];if(null!=Be&&Bi){if(3==Bi.label){for(var Ba=0;Ba<Be.length;++Ba){BP(Be[Ba],CK,Bi,CL)}}else{BP(Be,CK,Bi,CL)}}}};BP=function(Ae,Aa,Bi,Be){if("m"==Bi.type){var Ba=Be.length;BD(Ae,Bi.ka,Be);Be.splice(Ba,0,[Aa,"m",Be.length-Ba].join(""))}else{"b"==Bi.type&&(Ae=Ae?"1":"0"),Be.push([Aa,Bi.type,(0,window.encodeURIComponent)(Ae)].join(""))}};Bb.Yc=function(){return Bb.Ec("iPhone")&&!Bb.Ec("iPod")&&!Bb.Ec("iPad")};BT=function(){var Aa=Bb.Jb;if(Bb.Zc){return/rv\:([^\);]+)(\)|;)/.exec(Aa)}if(Bb.$c){return/Edge\/([\d\.]+)/.exec(Aa)}if(Bb.ad){return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Aa)}if(Bb.bd){return/WebKit\/(\S+)/.exec(Aa)}};A2=function(){var Aa=Bb.dd.document;return Aa?Aa.documentMode:void 0};Bb.hd=function(Aa){return Al[Aa]||(Al[Aa]=0<=Bb.Mb(Bb.gd,Aa))};Bb.id=function(Ae,Aa){this.j=Ae||0;this.R=Aa||0};b=Bb.k();M=function(Ae,Aa){-180==Ae&&180!=Aa&&(Ae=180);-180==Aa&&180!=Ae&&(Aa=180);this.j=Ae;this.R=Aa};Bb.ld=function(Aa){return Aa.j>Aa.R};Bb.nd=function(Ae,Aa){return 1e-9>=Math.abs(Aa.j-Ae.j)%360+Math.abs(Bb.md(Aa)-Bb.md(Ae))};Bb.od=function(Ae,Aa){var Ba=Aa-Ae;return 0<=Ba?Ba:Aa+180-(Ae-180)};Bb.md=function(Aa){return Aa.isEmpty()?0:Bb.ld(Aa)?360-(Aa.j-Aa.R):Aa.R-Aa.j};BK=function(Ae,Aa){this.R=Ae;this.j=Aa};Bb.qd=function(Aa){return Aa.isEmpty()?0:Aa.j-Aa.R};Bb.rd=function(Ae,Aa){Ae=Ae&&Bb.Zb(Ae);Aa=Aa&&Bb.Zb(Aa);if(Ae){Aa=Aa||Ae;var Be=Bb.Ka(Ae.lat(),-90,90),Ba=Bb.Ka(Aa.lat(),-90,90);this.R=new BK(Be,Ba);Be=Ae.lng();Ba=Aa.lng();360<=Ba-Be?this.j=new M(-180,180):(Be=Bb.La(Be,-180,180),Ba=Bb.La(Ba,-180,180),this.j=new M(Be,Ba))}else{this.R=new BK(1,-1),this.j=new M(180,-180)}};Bb.sd=function(Ae,Aa,Be,Ba){return new Bb.rd(new Bb.K(Ae,Aa,!0),new Bb.K(Be,Ba,!0))};Bb.ud=function(Ae){if(Ae instanceof Bb.rd){return Ae}try{return Ae=AM(Ae),Bb.sd(Ae.south,Ae.west,Ae.north,Ae.east)}catch(Aa){throw Bb.xb("not a LatLngBounds or LatLngBoundsLiteral",Aa)}};Bb.vd=Bb.na("__gm");T=function(){this.j={};this.S={};this.R={}};G=function(){this.j={}};CE=function(Ae){this.j=new G;var Aa=this;Bb.I.addListenerOnce(Ae,"addfeature",function(){Bb.L("data",function(Ba){Ba.j(Aa,Ae,Aa.j)})})};Bb.Cd=function(Ae){this.j=[];try{this.j=B0(Ae)}catch(Aa){Bb.yb(Aa)}};Bb.Ed=function(Aa){this.j=(0,Bb.Dd)(Aa)};Bb.Gd=function(Aa){this.j=J(Aa)};Bb.Hd=function(Aa){this.j=(0,Bb.Dd)(Aa)};Bb.Id=function(Aa){this.j=(0,Bb.Dd)(Aa)};Bb.Kd=function(Aa){this.j=BY(Aa)};Bb.Md=function(Aa){this.j=A7(Aa)};AX=function(Aa){Aa=Aa||{};Aa.clickable=Bb.Oa(Aa.clickable,!0);Aa.visible=Bb.Oa(Aa.visible,!0);this.setValues(Aa);Bb.L("marker",Bb.ta)};AJ=function(Ae){var Aa=Bb,Be=AS.Mc().S;Ae=Be.R=new B8(new A3(Ae),Aa);for(var Aa=0,Ba=Be.j.length;Aa<Ba;++Aa){Be.j[Aa](Ae)}Be.j.length=0};Bb.Pd=function(Aa){this.__gm={set:null,Ff:null};AX.call(this,Aa)};i=function(Aa){Aa=Aa||{};Aa.visible=Bb.Oa(Aa.visible,!0);return Aa};Bb.Rd=function(Aa){return Aa&&Aa.radius||6378137};CB=function(Aa){return Aa instanceof Bb.xc?E(Aa):new Bb.xc((0,Bb.Dd)(Aa))};Bk=function(Ae){var Aa;Bb.Xa(Ae)?0==Bb.x(Ae)?Aa=!0:(Aa=Ae instanceof Bb.xc?Ae.getAt(0):Ae[0],Aa=Bb.Xa(Aa)):Aa=!1;return Aa?Ae instanceof Bb.xc?By(E)(Ae):new Bb.xc(Bb.Db(CB)(Ae)):new Bb.xc([CB(Ae)])};By=function(Aa){return function(Ae){if(!(Ae instanceof Bb.xc)){throw Bb.xb("not an MVCArray")}Ae.forEach(function(Ba,Bi){try{Aa(Ba)}catch(Be){throw Bb.xb("at index "+Bi,Be)}});return Ae}};BO=function(Aa){this.set("latLngs",new Bb.xc([new Bb.xc]));this.setValues(i(Aa));Bb.L("poly",Bb.ta)};Bb.Zd=function(Aa){BO.call(this,Aa)};Bb.$d=function(Aa){BO.call(this,Aa)};Bb.ae=function(CT,CS,CQ){function CO(CW){if(!CW){throw Bb.xb("not a Feature")}if("Feature"!=CW.type){throw Bb.xb('type != "Feature"')}var CV=CW.geometry;try{CV=null==CV?null:CN(CV)}catch(CZ){throw Bb.xb('in property "geometry"',CZ)}var CY=CW.properties||{};if(!Bb.Ra(CY)){throw Bb.xb("properties is not an Object")}var CX=CQ.idPropertyName;CW=CX?CY[CX]:CW.id;if(null!=CW&&!Bb.D(CW)&&!Bb.Sa(CW)){throw Bb.xb((CX||"id")+" is not a string or number")}return{id:CW,geometry:CV,properties:CY}}function CN(CW){if(null==CW){throw Bb.xb("is null")}var CV=(CW.type+"").toLowerCase(),CY=CW.coordinates;try{switch(CV){case"point":return new Bb.$b(CK(CY));case"multipoint":return new Bb.Hd(Be(CY));case"linestring":return CL(CY);case"multilinestring":return new Bb.Gd(Ba(CY));case"polygon":return CM(CY);case"multipolygon":return new Bb.Md(Aa(CY))}}catch(CX){throw Bb.xb('in property "coordinates"',CX)}if("geometrycollection"==CV){try{return new Bb.Cd(CU(CW.geometries))}catch(CX){throw Bb.xb('in property "geometries"',CX)}}throw Bb.xb("invalid type")}function CM(CV){return new Bb.Kd(Ae(CV))}function CL(CV){return new Bb.Ed(Be(CV))}function CK(CV){CV=Bi(CV);return Bb.Zb({lat:CV[1],lng:CV[0]})}if(!CS){return[]}CQ=CQ||{};var Bi=Bb.Db(Bb.qc),Be=Bb.Db(CK),Ba=Bb.Db(CL),Ae=Bb.Db(function(CV){CV=Be(CV);if(!CV.length){throw Bb.xb("contains no elements")}if(!CV[0].j(CV[CV.length-1])){throw Bb.xb("first and last positions are not equal")}return new Bb.Id(CV.slice(0,-1))}),Aa=Bb.Db(CM),CU=Bb.Db(CN),CR=Bb.Db(CO);if("FeatureCollection"==CS.type){CS=CS.features;try{return Bb.Na(CR(CS),function(CV){return CT.add(CV)})}catch(CP){throw Bb.xb('in property "features"',CP)}}if("Feature"==CS.type){return[CT.add(CO(CS))]}throw Bb.xb("not a Feature or FeatureCollection")};BS=function(Ae){var Aa=this;this.setValues(Ae||{});this.j=new T;Bb.I.forward(this.j,"addfeature",this);Bb.I.forward(this.j,"removefeature",this);Bb.I.forward(this.j,"setgeometry",this);Bb.I.forward(this.j,"setproperty",this);Bb.I.forward(this.j,"removeproperty",this);this.R=new CE(this.j);this.R.bindTo("map",this);this.R.bindTo("style",this);Bb.G(Bb.be,function(Ba){Bb.I.forward(Aa.R,Ba,Aa)});this.S=!1};BE=function(Aa){Aa.S||(Aa.S=!0,Bb.L("drawing_impl",function(Ae){Ae.po(Aa)}))};Bb.ee=function(Aa){this.j=Aa||[]};Bb.fe=function(Aa){this.j=Aa||[]};AQ=function(Aa){this.j=Aa||[]};Bb.he=function(Aa){this.j=Aa||[]};Bb.ie=function(Aa){this.j=Aa||[]};Bb.je=function(Ae){function Aa(){Ba||(Ba=!0,Bb.L("infowindow",function(Bi){Bi.Om(Be)}))}window.setTimeout(function(){Bb.L("infowindow",Bb.ta)},100);var Be=this,Ba=!1;Bb.I.addListenerOnce(this,"anchor_changed",Aa);Bb.I.addListenerOnce(this,"map_changed",Aa);this.setValues(Ae)};K=function(Aa){this.setValues(Aa)};Bb.le=Bb.k();B6=Bb.k();Bu=Bb.k();Bc=Bb.k();Bb.pe=function(){Bb.L("geocoder",Bb.ta)};Bb.qe=function(Ae,Aa,Ba){this.va=null;this.set("url",Ae);this.set("bounds",Bb.Gb(Bb.ud)(Aa));this.setValues(Ba)};Av=function(Ae,Aa){Bb.Sa(Ae)?(this.set("url",Ae),this.setValues(Aa)):this.setValues(Ae)};Bb.se=function(){this.va=null;Bb.L("layers",Bb.ta)};AL=function(){this.va=null;Bb.L("layers",Bb.ta)};w=function(){this.va=null;Bb.L("layers",Bb.ta)};j=function(Aa){this.j=Aa||[]};S=function(Aa){this.j=Aa||[]};F=function(Aa){this.j=Aa||[]};CD=function(Aa){this.j=Aa||[]};Bz=function(Aa){this.j=Aa||[]};Ah=function(Aa){this.j=Aa||[]};m=function(){var Aa=AO().j[10];return Aa?new Bz(Aa):z};Y=function(){var Aa=m().j[8];return null!=Aa?Aa:0};Bb.Fe=function(Aa){this.j=Aa||[]};Bb.Ge=function(Aa){this.j=Aa||[]};Bb.He=function(Aa){this.j=Aa||[]};Bb.Ie=function(Aa){this.j=Aa||[]};AW=function(Aa){this.j=Aa||[]};AH=function(Aa){this.j=Aa||[]};t=function(Aa){this.j=Aa||[]};h=function(Aa){this.j=Aa||[]};P=function(Aa){this.j=Aa||[]};Bb.Se=function(Aa){this.j=Aa||[]};Bb.Te=function(Aa){this.j=Aa||[]};Bb.Ue=function(Aa){Aa=Aa.j[0];return null!=Aa?Aa:""};Bb.Ve=function(Aa){Aa=Aa.j[1];return null!=Aa?Aa:""};Bb.Xe=function(){var Aa=Bb.We(Bb.Q).j[9];return null!=Aa?Aa:""};A0=function(){var Aa=Bb.We(Bb.Q).j[7];return null!=Aa?Aa:""};Ag=function(){var Aa=Bb.We(Bb.Q).j[12];return null!=Aa?Aa:""};Bp=function(Aa){Aa=Aa.j[0];return null!=Aa?Aa:""};Bb.af=function(Aa){Aa=Aa.j[1];return null!=Aa?Aa:""};BR=function(){var Aa=Bb.Q.j[4],Aa=(Aa?new t(Aa):Bn).j[0];return null!=Aa?Aa:0};Bb.df=function(){var Aa=Bb.Q.j[0];return null!=Aa?Aa:1};Bb.ef=function(Aa){Aa=Aa.j[6];return null!=Aa?Aa:""};Aj=function(){var Aa=Bb.Q.j[11];return null!=Aa?Aa:""};Bb.gf=function(){var Aa=Bb.Q.j[16];return null!=Aa?Aa:""};Bb.We=function(Aa){return(Aa=Aa.j[2])?new AW(Aa):AA};Bb.kf=function(){var Aa=Bb.Q.j[3];return Aa?new AH(Aa):Z};AO=function(){var Aa=Bb.Q.j[33];return Aa?new S(Aa):CI};B4=function(Aa){return Bb.P(Bb.Q.j,8)[Aa]};BZ=function(){var Aa=Bb.Q.j[36],Aa=(Aa?new P(Aa):Br).j[0];return null!=Aa?Aa:""};At=function(Ae,Aa){Bb.Bc.call(this);this.__gm=new Bb.J;this.R=null;Aa&&Aa.client&&(this.R=Bb.pf[Aa.client]||null);var Ba=this.controls=[];Bb.Ha(Bb.qf,function(Bi,Be){Ba[Be]=new Bb.xc});this.U=!0;this.j=Ae;this.setPov(new Bb.Ac(0,0,1));Aa&&Aa.Dc&&!Bb.D(Aa.Dc.zoom)&&(Aa.Dc.zoom=Bb.D(Aa.zoom)?Aa.zoom:1);this.setValues(Aa);void 0==this.getVisible()&&this.setVisible(!0);this.__gm.Qd=Aa&&Aa.Qd||new Bb.yc;Bb.I.addListenerOnce(this,"pano_changed",Bb.Za(function(){Bb.L("marker",(0,Bb.u)(function(Be){Be.j(this.__gm.Qd,this)},this))}))};Bb.tf=function(){this.U=[];this.R=this.j=this.S=null};u=function(Ae,Aa,Be){this.Ia=Aa;this.V=new Bb.yc;this.Ca=new Bb.xc;this.ma=new Bb.yc;this.ta=new Bb.yc;this.S=new Bb.yc;this.Qd=new Bb.yc;this.wa=[];var Ba=this.Qd;Ba.j=function(){delete Ba.j;Bb.L("marker",Bb.Za(function(Bi){Bi.j(Ba,Ae)}))};this.R=new At(Aa,{visible:!1,enableCloseButton:!0,Qd:Ba});this.R.bindTo("reportErrorControl",Ae);this.R.U=!1;this.j=new Bb.tf;this.Ma=Be};Bb.vf=function(){this.Ea=new v};Bb.wf=function(){this.j=new Bb.M(128,128);this.S=256/360;this.U=256/(2*Math.PI);this.R=!0};Bb.xf=function(Aa){this.ya=this.Aa=window.Infinity;this.Fa=this.Da=-window.Infinity;Bb.G(Aa,(0,Bb.u)(this.extend,this))};Bb.yf=function(Ae,Aa,Bi,Be){var Ba=new Bb.xf;Ba.Aa=Ae;Ba.ya=Aa;Ba.Da=Bi;Ba.Fa=Be;return Ba};Bb.zf=function(Ae,Aa,Ba){if(Ae=Ae.fromLatLngToPoint(Aa)){Ba=Math.pow(2,Ba),Ae.x*=Ba,Ae.y*=Ba}return Ae};Bb.Af=function(Ae,Aa){var CK=Ae.lat()+Bb.Ub(Aa);90<CK&&(CK=90);var Bi=Ae.lat()-Bb.Ub(Aa);-90>Bi&&(Bi=-90);var Be=Math.sin(Aa),Ba=Math.cos(Bb.Sb(Ae.lat()));if(90==CK||-90==Bi||0.000001>Ba){return new Bb.rd(new Bb.K(Bi,-180),new Bb.K(CK,180))}Be=Bb.Ub(Math.asin(Be/Ba));return new Bb.rd(new Bb.K(Bi,Ae.lng()-Be),new Bb.K(CK,Ae.lng()+Be))};Bb.R=function(Aa){this.Wl=Aa||0;Bb.I.bind(this,"forceredraw",this,this.ma)};Bb.Bf=function(Ae,Aa){var Ba=Ae.style;Ba.width=Aa.width+Aa.ma;Ba.height=Aa.height+Aa.W};Bb.Cf=function(Aa){return new Bb.N(Aa.offsetWidth,Aa.offsetHeight)};Bb.Df=function(){return window.devicePixelRatio||window.screen.deviceXDPI&&window.screen.deviceXDPI/96||1};X=function(Aa){this.j=Aa||[]};CG=function(Aa){this.j=Aa||[]};Bb.Hf=function(){Bb.Qc.call(this)};Bb.If=function(Aa){Bb.Qc.call(this);this.j=Aa};BW=function(Aa){this.j=Aa||[]};BI=function(Aa){this.j=Aa||[]};A6=function(Aa){this.j=Aa||[]};As=function(Ae,Aa,Be,Ba){Bb.R.call(this);this.V=Aa;this.U=new Bb.wf;this.W=Be+"/maps/api/js/StaticMapService.GetMapImage";this.R=this.j=null;this.S=Ba;this.set("div",Ae);this.set("loading",!0)};AF=function(Ae){var Aa=Ae.get("tilt")||Ae.get("mapMaker")||Bb.x(Ae.get("styles"));Ae=Ae.get("mapTypeId");return Aa?null:AV[Ae]};r=function(Aa){Aa.parentNode&&Aa.parentNode.removeChild(Aa)};f=function(Ae,Aa,CL,CK,Bi){var Be=Bb.T[15]?Ag():A0();this.j=Ae;this.R=CK;this.S=Bb.ra(Bi)?Bi:Bb.Fa();var Ba=Be+"/csi?v=2&s=mapsapi3&v3v="+BZ()+"&action="+Ae;Bb.Dc(CL,function(CN,CM){Ba+="&"+(0,window.encodeURIComponent)(CM)+"="+(0,window.encodeURIComponent)(CN)});Aa&&(Ba+="&e="+Aa);this.U=Ba};Bb.Sf=function(Ae,Aa){var Ba={};Ba[Aa]=void 0;Bb.Rf(Ae,Ba)};Bb.Rf=function(Ae,Aa){var Bi="";Bb.Dc(Aa,function(CL,CK){var CM=(null!=CL?CL:Bb.Fa())-this.S;Bi&&(Bi+=",");Bi+=CK+"."+Math.round(CM);null==CL&&window.performance&&window.performance.mark&&window.performance.mark("mapsapi:"+this.j+":"+CK)},Ae);var Be=Ae.U+"&rt="+Bi;Ae.R.createElement("img").src=Be;var Ba=Bb.dd.__gm_captureCSI;Ba&&Ba(Be)};Bb.Tf=function(Ae,Aa){var CL=Aa||{},CK=CL.Mp||{},Bi=Bb.P(Bb.Q.j,12).join(",");Bi&&(CK.libraries=Bi);var Bi=Bb.ef(Bb.Q),Be=AO(),Ba=[];Bi&&Ba.push(Bi);Bb.Ob(Be.$(),function(CN,CM){CN&&Bb.Ob(CN,function(CO,CP){null!=CO&&Ba.push(CM+1+"_"+(CP+1)+"_"+CO)})});CL.Gn&&(Ba=Ba.concat(CL.Gn));return new f(Ae,Ba.join(","),CK,CL.document||window.document,CL.startTime)};Bj=function(){this.R=Bb.Tf("apiboot2",{startTime:Bb.Uf});Bb.Sf(this.R,"main");this.j=!1};BC=function(){var Aa=BN;Aa.j||(Aa.j=!0,Bb.Sf(Aa.R,"firstmap"))};Bb.Yf=Bb.k();Bb.Zf=function(){this.j=""};Bb.$f=function(Ae){var Aa=new Bb.Zf;Aa.j=Ae;return Aa};Bb.bg=function(){this.ah="";this.Xl=Bb.ag;this.j=null};Bb.cg=function(Ae,Aa){var Ba=new Bb.bg;Ba.ah=Ae;Ba.j=Aa;return Ba};Bb.dg=function(Ae,Aa){Aa.parentNode&&Aa.parentNode.insertBefore(Ae,Aa.nextSibling)};Bb.eg=function(Aa){return Aa&&Aa.parentNode?Aa.parentNode.removeChild(Aa):null};Ai=function(Ae,Aa,Bi,Be,Ba){this.j=!!Aa;this.node=null;this.R=0;this.S=!1;this.U=!Bi;Ae&&this.setPosition(Ae,Be);this.depth=void 0!=Ba?Ba:this.R||0;this.j&&(this.depth*=-1)};AP=function(Ae,Aa,Be,Ba){Ai.call(this,Ae,Aa,Be,null,Ba)};Bb.ig=function(Ae){for(var Aa;Aa=Ae.firstChild;){Bb.hg(Aa),Ae.removeChild(Aa)}};Bb.hg=function(Ae){Ae=new AP(Ae);try{for(;;){Bb.I.clearInstanceListeners(Ae.next())}}catch(Aa){if(Aa!==Bb.jg){throw Aa}}};Bb.ng=function(CQ,CP){var CO=Bb.Fa();BN&&BC();var CN=new Bb.vf;Bb.vd.call(this,new u(this,CQ,CN));var CM=CP||{};Bb.B(CM.mapTypeId)||(CM.mapTypeId="roadmap");this.setValues(CM);this.__gm.La=CM.La;this.mapTypes=new b;this.features=new Bb.J;Bb.kg.push(CQ);this.notify("streetView");var CL=Bb.Cf(CQ);CM.noClear||Bb.ig(CQ);var CK=this.__gm,Bi=Bb.dd.gm_force_experiments;Bi&&(CK.wa=Bi);var Be=null,CK=!!Bb.Q&&CH(CM.useStaticMap,CL);Bb.Q&&+Y()&&(CK=!1);CK&&(Be=new As(CQ,Bb.mg,Bb.Xe(),new Bb.If(null)),Bb.I.forward(Be,"staticmaploaded",this),Be.set("size",CL),Be.bindTo("center",this),Be.bindTo("zoom",this),Be.bindTo("mapTypeId",this),Be.bindTo("styles",this),Be.bindTo("mapMaker",this));this.overlayMapTypes=new Bb.xc;var Ba=this.controls=[];Bb.Ha(Bb.qf,function(CS,CR){Ba[CR]=new Bb.xc});var Ae=this,Aa=!0;Bb.L("map",function(CR){CR.R(Ae,CM,Be,Aa,CO,CN)});Aa=!1;this.data=new BS({map:this})};CH=function(Ae,Aa){if(Bb.B(Ae)){return !!Ae}var Be=Aa.width,Ba=Aa.height;return 384000>=Be*Ba&&800>=Be&&800>=Ba};BX=function(){Bb.L("maxzoom",Bb.ta)};BJ=function(Ae,Aa){!Ae||Bb.Sa(Ae)||Bb.D(Ae)?(this.set("tableId",Ae),this.setValues(Aa)):this.setValues(Ae)};Bb.qg=Bb.k();Bb.rg=function(Aa){this.setValues(i(Aa));Bb.L("poly",Bb.ta)};Bb.sg=function(Aa){this.setValues(i(Aa));Bb.L("poly",Bb.ta)};AI=function(){this.j=null};Bb.ug=function(){this.j=null};Bb.vg=function(Ae){this.tileSize=Ae.tileSize||new Bb.N(256,256);this.name=Ae.name;this.alt=Ae.alt;this.minZoom=Ae.minZoom;this.maxZoom=Ae.maxZoom;this.S=(0,Bb.u)(Ae.getTileUrl,Ae);this.j=new Bb.yc;this.R=null;this.set("opacity",Ae.opacity);Bb.dd.window&&Bb.I.addDomListener(window,"online",(0,Bb.u)(this.Ip,this));var Aa=this;Bb.L("map",function(Ba){var Bi=Aa.R=Ba.j,Be=Aa.tileSize||new Bb.N(256,256);Aa.j.forEach(function(CL){var CO=CL.__gmimt,CM=CO.Oa,CK=CO.zoom,CN=Aa.S(CM,CK);CO.Ec=Bi(CM,CK,Be,CL,CN,function(){Bb.I.trigger(CL,"load")})})})};Q=function(Ae,Aa){null!=Ae.style.opacity?Ae.style.opacity=Aa:Ae.style.filter=Aa&&"alpha(opacity="+Math.round(100*Aa)+")"};D=function(Aa){Aa=Aa.get("opacity");return"number"==typeof Aa?Aa:1};Bb.yg=Bb.k();Bb.zg=function(Ae,Aa){this.set("styles",Ae);var Ba=Aa||{};this.j=Ba.baseMapTypeId||"roadmap";this.minZoom=Ba.minZoom;this.maxZoom=Ba.maxZoom||20;this.name=Ba.name;this.alt=Ba.alt;this.projection=null;this.tileSize=new Bb.N(256,256)};Bb.Dg=function(Ae,Aa){Bb.Eb(Ak,"container is not a Node")(Ae);this.setValues(Aa);Bb.L("controls",(0,Bb.u)(function(Ba){Ba.fn(this,Ae)},this))};W=Bb.na("j");H=function(Ae,Aa,CK){for(var Bi=Array(Aa.length),Be=0,Ba=Aa.length;Be<Ba;++Be){Bi[Be]=Aa.charCodeAt(Be)}Bi.unshift(CK);Ae=Ae.j;CK=Aa=0;for(Be=Bi.length;CK<Be;++CK){Aa*=1729,Aa+=Bi[CK],Aa%=Ae}return Aa};Bq=function(){var Ae=BR(),Aa=new W(131071),Ba=(0,window.unescape)("%26%74%6F%6B%65%6E%3D");return function(Bi){Bi=Bi.replace(CF,"%27");var Be=Bi+Ba;B3||(B3=/(?:https?:\/\/[^/]+)?(.*)/);Bi=B3.exec(Bi);return Be+H(Aa,Bi&&Bi[1],Ae)}};BV=function(){var Aa=new W(2147483647);return function(Ae){return H(Aa,Ae,0)}};BH=function(Ae){for(var Aa=Ae.split("."),Bi=window,Be=window,Ba=0;Ba<Aa.length;Ba++){if(Be=Bi,Bi=Bi[Aa[Ba]],!Bi){throw Bb.xb(Ae+" is not a function")}}return function(){Bi.apply(Be)}};A5=function(){for(var Aa in Object.prototype){window.console&&window.console.error("This site adds property <"+Aa+"> to Object.prototype. Extending Object.prototype breaks JavaScript for..in loops, which are used heavily in Google Maps API v3.")}};Ar=function(Aa){(Aa="version" in Aa)&&window.console&&window.console.error("You have included the Google Maps API multiple times on this page. This may cause unexpected errors.");return Aa};Bb.pa=[];Bb.dd=this;Am="closure_uid_"+(1000000000*Math.random()>>>0);AR=0;var A,B9;Bb.I={};A="undefined"!=typeof window.navigator&&-1!=window.navigator.userAgent.toLowerCase().indexOf("msie");B9={};Bb.I.addListener=function(Ae,Aa,Ba){return new Bv(Ae,Aa,Ba,0)};Bb.I.hasListeners=function(Ae,Aa){var Ba=Ae.__e3_,Ba=Ba&&Ba[Aa];return !!Ba&&!Bb.Ja(Ba)};Bb.I.removeListener=function(Aa){Aa&&Aa.remove()};Bb.I.clearListeners=function(Ae,Aa){Bb.Ha(AT(Ae,Aa),function(Be,Ba){Ba&&Ba.remove()})};Bb.I.clearInstanceListeners=function(Aa){Bb.Ha(AT(Aa),function(Ae,Ba){Ba&&Ba.remove()})};Bb.I.trigger=function(Ae,Aa,CL){if(Bb.I.hasListeners(Ae,Aa)){var CK=Bb.Va(arguments,2),Bi=AT(Ae,Aa),Be;for(Be in Bi){var Ba=Bi[Be];Ba&&Ba.j.apply(Ba.Ob,CK)}}};Bb.I.addDomListener=function(Ae,Aa,Bi,Be){if(Ae.addEventListener){var Ba=Be?4:1;Ae.addEventListener(Aa,Bi,Be);Bi=new Bv(Ae,Aa,Bi,Ba)}else{Ae.attachEvent?(Bi=new Bv(Ae,Aa,Bi,2),Ae.attachEvent("on"+Aa,Bf(Bi))):(Ae["on"+Aa]=Bi,Bi=new Bv(Ae,Aa,Bi,3))}return Bi};Bb.I.addDomListenerOnce=function(Ae,Aa,Bi,Be){var Ba=Bb.I.addDomListener(Ae,Aa,function(){Ba.remove();return Bi.apply(this,arguments)},Be);return Ba};Bb.I.Ka=function(Ae,Aa,Be,Ba){return Bb.I.addDomListener(Ae,Aa,AC(Be,Ba))};Bb.I.bind=function(Ae,Aa,Be,Ba){return Bb.I.addListener(Ae,Aa,(0,Bb.u)(Ba,Be))};Bb.I.addListenerOnce=function(Ae,Aa,Be){var Ba=Bb.I.addListener(Ae,Aa,function(){Ba.remove();return Be.apply(this,arguments)});return Ba};Bb.I.forward=function(Ae,Aa,Ba){return Bb.I.addListener(Ae,Aa,p(Aa,Ba))};Bb.I.Cb=function(Ae,Aa,Be,Ba){return Bb.I.addDomListener(Ae,Aa,p(Aa,Be,!Ba))};Bb.I.xk=function(){var Ae=B9,Aa;for(Aa in Ae){Ae[Aa].remove()}B9={};(Ae=Bb.dd.CollectGarbage)&&Ae()};Bb.I.Yp=function(){A&&Bb.I.addDomListener(window,"unload",Bb.I.xk)};var d=0;Bv.prototype.remove=function(){if(this.Ob){switch(this.U){case 1:this.Ob.removeEventListener(this.R,this.j,!1);break;case 4:this.Ob.removeEventListener(this.R,this.j,!0);break;case 2:this.Ob.detachEvent("on"+this.R,this.S);break;case 3:this.Ob["on"+this.R]=null}delete Ao(this.Ob,this.R)[this.id];this.S=this.j=this.Ob=null;delete B9[this.id]}};Bb.t=Bb.J.prototype;Bb.t.get=function(Ae){var Aa=y(this);Ae=Ae+"";Aa=Bs(Aa,Ae);if(Bb.B(Aa)){if(Aa){Ae=Aa.jc;var Aa=Aa.Rd,Ba="get"+Bb.tb(Ae);return Aa[Ba]?Aa[Ba]():Aa.get(Ae)}return this[Ae]}};Bb.t.set=function(Ae,Aa){var Bi=y(this);Ae=Ae+"";var Be=Bs(Bi,Ae);if(Be){var Bi=Be.jc,Be=Be.Rd,Ba="set"+Bb.tb(Bi);if(Be[Ba]){Be[Ba](Aa)}else{Be.set(Bi,Aa)}}else{this[Ae]=Aa,Bi[Ae]=null,Ax(this,Ae)}};Bb.t.notify=function(Ae){var Aa=y(this);Ae=Ae+"";(Aa=Bs(Aa,Ae))?Aa.Rd.notify(Aa.jc):Ax(this,Ae)};Bb.t.setValues=function(Ae){for(var Aa in Ae){var Be=Ae[Aa],Ba="set"+Bb.tb(Aa);if(this[Ba]){this[Ba](Be)}else{this.set(Aa,Be)}}};Bb.t.setOptions=Bb.J.prototype.setValues;Bb.t.changed=Bb.k();var Ac={};Bb.J.prototype.bindTo=function(Ae,Aa,CK,Bi){Ae=Ae+"";CK=(CK||Ae)+"";this.unbind(Ae);var Be={Rd:this,jc:Ae},Ba={Rd:Aa,jc:CK,Ii:Be};y(this)[Ae]=Ba;A9(Aa,CK)[Bb.pb(Be)]=Be;Bi||Ax(this,Ae)};Bb.J.prototype.unbind=function(Ae){var Aa=y(this),Ba=Aa[Ae];Ba&&(Ba.Ii&&delete A9(Ba.Rd,Ba.jc)[Bb.pb(Ba.Ii)],this[Ae]=this.get(Ae),Aa[Ae]=null)};Bb.J.prototype.unbindAll=function(){var Ae=(0,Bb.u)(this.unbind,this),Aa=y(this),Ba;for(Ba in Aa){Ae(Ba)}};Bb.J.prototype.addListener=function(Ae,Aa){return Bb.I.addListener(this,Ae,Aa)};Bb.Ng={ROADMAP:"roadmap",SATELLITE:"satellite",HYBRID:"hybrid",TERRAIN:"terrain"};Bb.qf={TOP_LEFT:1,TOP_CENTER:2,TOP:2,TOP_RIGHT:3,LEFT_CENTER:4,LEFT_TOP:5,LEFT:5,LEFT_BOTTOM:6,RIGHT_TOP:7,RIGHT:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM:11,BOTTOM_RIGHT:12,CENTER:13};var AE={pr:"Point",nr:"LineString",POLYGON:"Polygon"};Bb.v(V,Error);Bb.qc=Bb.Eb(Bb.D,"not a number");Bb.Pg=Bb.Eb(Bb.Sa,"not a string");Bb.Qg=Bb.Gb(Bb.qc);Bb.Rg=Bb.Gb(Bb.Pg);Bb.Sg=Bb.Gb(Bb.Eb(Bb.Ua,"not a boolean"));var Bm=Bb.zb({lat:Bb.qc,lng:Bb.qc},!0);Bb.K.prototype.toString=function(){return"("+this.lat()+", "+this.lng()+")"};Bb.K.prototype.toJSON=function(){return{lat:this.lat(),lng:this.lng()}};Bb.K.prototype.j=function(Aa){return Aa?Bb.Ma(this.lat(),Aa.lat())&&Bb.Ma(this.lng(),Aa.lng()):!1};Bb.K.prototype.equals=Bb.K.prototype.j;Bb.K.prototype.toUrlValue=function(Aa){Aa=Bb.B(Aa)?Aa:6;return A1(this.lat(),Aa)+","+A1(this.lng(),Aa)};Bb.Dd=Bb.Db(Bb.Zb);Bb.v(Bb.$b,l);Bb.$b.prototype.getType=Bb.oa("Point");Bb.$b.prototype.get=Bb.m("j");var B0=Bb.Db(B2);Bb.ua(AS);AS.prototype.Rc=function(Ae,Aa){var Be=this,Ba=Be.V;AB(Be.S,function(CN){for(var CM=CN.Dj[Ae]||[],CL=CN.hq[Ae]||[],CK=Ba[Ae]=Bb.bc(CM.length,function(){delete Ba[Ae];Aa(CN.mn);for(var CR=Be.R[Ae],CQ=CR?CR.length:0,CP=0;CP<CQ;++CP){CR[CP](Be.j[Ae])}delete Be.R[Ae];CP=0;for(CR=CL.length;CP<CR;++CP){CQ=CL[CP],Ba[CQ]&&Ba[CQ]()}}),Bi=0,CO=CM.length;Bi<CO;++Bi){Be.j[CM[Bi]]&&CK()}})};Bb.t=Bb.pc.prototype;Bb.t.getId=Bb.m("S");Bb.t.getGeometry=Bb.m("j");Bb.t.setGeometry=function(Ae){var Aa=this.j;try{this.j=Ae?B2(Ae):null}catch(Ba){Bb.yb(Ba);return }Bb.I.trigger(this,"setgeometry",{feature:this,newGeometry:this.j,oldGeometry:Aa})};Bb.t.getProperty=function(Aa){return Bs(this.R,Aa)};Bb.t.setProperty=function(Ae,Aa){if(void 0===Aa){this.removeProperty(Ae)}else{var Ba=this.getProperty(Ae);this.R[Ae]=Aa;Bb.I.trigger(this,"setproperty",{feature:this,name:Ae,newValue:Aa,oldValue:Ba})}};Bb.t.removeProperty=function(Ae){var Aa=this.getProperty(Ae);delete this.R[Ae];Bb.I.trigger(this,"removeproperty",{feature:this,name:Ae,oldValue:Aa})};Bb.t.forEachProperty=function(Ae){for(var Aa in this.R){Ae(this.getProperty(Aa),Aa)}};Bb.t.toGeoJson=function(Ae){var Aa=this;Bb.L("data",function(Ba){Ba.R(Aa,Ae)})};Bb.Tg=new Bb.M(0,0);Bb.M.prototype.toString=function(){return"("+this.x+", "+this.y+")"};Bb.M.prototype.j=function(Aa){return Aa?Aa.x==this.x&&Aa.y==this.y:!1};Bb.M.prototype.equals=Bb.M.prototype.j;Bb.M.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y)};Bb.M.prototype.Lf=Bb.qa(0);Bb.Ug=new Bb.N(0,0);Bb.N.prototype.toString=function(){return"("+this.width+", "+this.height+")"};Bb.N.prototype.j=function(Aa){return Aa?Aa.width==this.width&&Aa.height==this.height:!1};Bb.N.prototype.equals=Bb.N.prototype.j;var Bh={CIRCLE:0,FORWARD_CLOSED_ARROW:1,FORWARD_OPEN_ARROW:2,BACKWARD_CLOSED_ARROW:3,BACKWARD_OPEN_ARROW:4};Bb.v(Bb.xc,Bb.J);Bb.t=Bb.xc.prototype;Bb.t.getAt=function(Aa){return this.j[Aa]};Bb.t.indexOf=function(Ae){for(var Aa=0,Ba=this.j.length;Aa<Ba;++Aa){if(Ae===this.j[Aa]){return Aa}}return -1};Bb.t.forEach=function(Ae){for(var Aa=0,Ba=this.j.length;Aa<Ba;++Aa){Ae(this.j[Aa],Aa)}};Bb.t.setAt=function(Ae,Aa){var Be=this.j[Ae],Ba=this.j.length;if(Ae<Ba){this.j[Ae]=Aa,Bb.I.trigger(this,"set_at",Ae,Be),this.U&&this.U(Ae,Be)}else{for(Be=Ba;Be<Ae;++Be){this.insertAt(Be,void 0)}this.insertAt(Ae,Aa)}};Bb.t.insertAt=function(Ae,Aa){this.j.splice(Ae,0,Aa);U(this);Bb.I.trigger(this,"insert_at",Ae);this.R&&this.R(Ae)};Bb.t.removeAt=function(Ae){var Aa=this.j[Ae];this.j.splice(Ae,1);U(this);Bb.I.trigger(this,"remove_at",Ae,Aa);this.S&&this.S(Ae,Aa);return Aa};Bb.t.push=function(Aa){this.insertAt(this.j.length,Aa);return this.j.length};Bb.t.pop=function(){return this.removeAt(this.j.length-1)};Bb.t.getArray=Bb.m("j");Bb.t.clear=function(){for(;this.get("length");){this.pop()}};Bb.vc(Bb.xc.prototype,{length:null});Bb.yc.prototype.remove=function(Ae){var Aa=this.R,Ba=this.S(Ae);Aa[Ba]&&(delete Aa[Ba],Bb.I.trigger(this,"remove",Ae),this.onRemove&&this.onRemove(Ae))};Bb.yc.prototype.contains=function(Aa){return !!this.R[this.S(Aa)]};Bb.yc.prototype.forEach=function(Ae){var Aa=this.R,Ba;for(Ba in Aa){Ae.call(this,Aa[Ba])}};var BM=Bb.zb({zoom:Bb.Qg,heading:Bb.qc,pitch:Bb.qc});Bb.v(Bb.Bc,Bb.J);var BB=function(Aa){return function(){return Aa}}(null);a:{var Az=Bb.dd.navigator;if(Az){var Af=Az.userAgent;if(Af){Bb.Jb=Af;break a}}Bb.Jb=""}Bt.prototype.get=function(){var Aa;0<this.R?(this.R--,Aa=this.j,this.j=Aa.next,Aa.next=null):Aa=this.S();return Aa};Bb.$g=new Bt(function(){return new AY},function(Aa){Aa.reset()},100);Au.prototype.add=function(Ae,Aa){var Ba=Bb.$g.get();Ba.set(Ae,Aa);this.R?this.R.next=Ba:this.j=Ba;this.R=Ba};Au.prototype.remove=function(){var Aa=null;this.j&&(Aa=this.j,this.j=this.j.next,this.j||(this.R=null),Aa.next=null);return Aa};AY.prototype.set=function(Ae,Aa){this.Md=Ae;this.j=Aa;this.next=null};AY.prototype.reset=function(){this.next=this.j=this.Md=null};Bb.ah=new Au;v.prototype.addListener=function(Ae,Aa,CK){CK=CK?{Li:!1}:null;var Bi=!this.Ea.length,Be;Be=this.Ea;var Ba=x(Be,AK(Ae,Aa));(Be=0>Ba?null:Bb.xa(Be)?Be.charAt(Ba):Be[Ba])?Be.Ie=Be.Ie&&CK:this.Ea.push({Md:Ae,context:Aa||null,Ie:CK});Bi&&this.R();return Ae};v.prototype.addListenerOnce=function(Ae,Aa){this.addListener(Ae,Aa,!0);return Ae};v.prototype.removeListener=function(Ae,Aa){if(this.Ea.length){var Be=this.Ea,Ba=x(Be,AK(Ae,Aa));0<=Ba&&Bb.Qb(Be,Ba);this.Ea.length||this.j()}};v.prototype.forEach=function(Ae,Aa){var Be=this.Ea.slice(0),Ba=this;(function(){Bb.Ob(Be,function(Bi){Ae.call(Aa||null,function(CK){if(Bi.Ie){if(Bi.Ie.Li){return }Bi.Ie.Li=!0;Bb.Rb(Ba.Ea,Bi);Ba.Ea.length||Ba.j()}Bi.Md.call(Bi.context,CK)})})})()};Bb.t=Bb.Qc.prototype;Bb.t.He=Bb.k();Bb.t.Fe=Bb.k();Bb.t.addListener=function(Ae,Aa){return this.Ea.addListener(Ae,Aa)};Bb.t.addListenerOnce=function(Ae,Aa){return this.Ea.addListenerOnce(Ae,Aa)};Bb.t.removeListener=function(Ae,Aa){return this.Ea.removeListener(Ae,Aa)};Bb.t.Of=function(){this.Ea.forEach(function(Aa){Aa(this.get())},this)};Bb.v(R,Bb.J);var BQ;Bb.bh=new Bl;BQ=/'/g;Bl.prototype.j=function(Ae,Aa){var Ba=[];BD(Ae,Aa,Ba);return Ba.join("&").replace(BQ,"%27")};var Al,I;Bb.dh=Bb.Fc();Bb.ad=Bb.Gc();Bb.$c=Bb.Ec("Edge");Bb.Zc=Bb.Ec("Gecko")&&!(Bb.Kb()&&!Bb.Ec("Edge"))&&!(Bb.Ec("Trident")||Bb.Ec("MSIE"))&&!Bb.Ec("Edge");Bb.bd=Bb.Kb()&&!Bb.Ec("Edge");Bb.eh=Bb.Ec("Macintosh");Bb.fh=Bb.Ec("Windows");Bb.gh=Bb.Ec("Linux")||Bb.Ec("CrOS");Bb.hh=Bb.Ec("Android");Bb.ih=Bb.Yc();Bb.jh=Bb.Ec("iPad");Bb.gd=function(){if(Bb.dh&&Bb.dd.opera){var Ae;var Aa=Bb.dd.opera.version;try{Ae=Aa()}catch(Ba){Ae=Aa}return Ae}Ae="";(Aa=BT())&&(Ae=Aa?Aa[1]:"");return Bb.ad&&(Aa=A2(),null!=Aa&&Aa>(0,window.parseFloat)(Ae))?String(Aa):Ae}();Al={};I=Bb.dd.document;Bb.lh=I&&Bb.ad?A2()||("CSS1Compat"==I.compatMode?(0,window.parseInt)(Bb.gd,10):5):void 0;Bb.mh=Bb.Ec("Firefox");Bb.nh=Bb.Yc()||Bb.Ec("iPod");Bb.oh=Bb.Ec("iPad");Bb.ph=Bb.Ec("Android")&&!(B5()||Bb.Ec("Firefox")||Bb.Fc()||Bb.Ec("Silk"));Bb.qh=B5();Bb.rh=Bb.Ec("Safari")&&!(B5()||Bb.Ec("Coast")||Bb.Fc()||Bb.Ec("Edge")||Bb.Ec("Silk")||Bb.Ec("Android"))&&!(Bb.Yc()||Bb.Ec("iPad")||Bb.Ec("iPod"));Bb.id.prototype.heading=Bb.m("j");Bb.id.prototype.Jb=Bb.qa(1);Bb.id.prototype.toString=function(){return this.j+","+this.R};Bb.sh=new Bb.id;Bb.v(b,Bb.J);b.prototype.set=function(Ae,Aa){if(null!=Aa&&!(Aa&&Bb.D(Aa.maxZoom)&&Aa.tileSize&&Aa.tileSize.width&&Aa.tileSize.height&&Aa.getTile&&Aa.getTile.apply)){throw Error("Expected value implementing google.maps.MapType")}return Bb.J.prototype.set.apply(this,arguments)};Bb.t=M.prototype;Bb.t.isEmpty=function(){return 360==this.j-this.R};Bb.t.intersects=function(Ae){var Aa=this.j,Ba=this.R;return this.isEmpty()||Ae.isEmpty()?!1:Bb.ld(this)?Bb.ld(Ae)||Ae.j<=this.R||Ae.R>=Aa:Bb.ld(Ae)?Ae.j<=Ba||Ae.R>=Aa:Ae.j<=Ba&&Ae.R>=Aa};Bb.t.contains=function(Ae){-180==Ae&&(Ae=180);var Aa=this.j,Ba=this.R;return Bb.ld(this)?(Ae>=Aa||Ae<=Ba)&&!this.isEmpty():Ae>=Aa&&Ae<=Ba};Bb.t.extend=function(Aa){this.contains(Aa)||(this.isEmpty()?this.j=this.R=Aa:Bb.od(Aa,this.j)<Bb.od(this.R,Aa)?this.j=Aa:this.R=Aa)};Bb.t.Kc=function(){var Aa=(this.j+this.R)/2;Bb.ld(this)&&(Aa=Bb.La(Aa+180,-180,180));return Aa};Bb.t=BK.prototype;Bb.t.isEmpty=function(){return this.R>this.j};Bb.t.intersects=function(Ae){var Aa=this.R,Ba=this.j;return Aa<=Ae.R?Ae.R<=Ba&&Ae.R<=Ae.j:Aa<=Ae.j&&Aa<=Ba};Bb.t.contains=function(Aa){return Aa>=this.R&&Aa<=this.j};Bb.t.extend=function(Aa){this.isEmpty()?this.j=this.R=Aa:Aa<this.R?this.R=Aa:Aa>this.j&&(this.j=Aa)};Bb.t.Kc=function(){return(this.j+this.R)/2};Bb.t=Bb.rd.prototype;Bb.t.getCenter=function(){return new Bb.K(this.R.Kc(),this.j.Kc())};Bb.t.toString=function(){return"("+this.getSouthWest()+", "+this.getNorthEast()+")"};Bb.t.toJSON=function(){return{south:this.R.R,west:this.j.j,north:this.R.j,east:this.j.R}};Bb.t.toUrlValue=function(Ae){var Aa=this.getSouthWest(),Ba=this.getNorthEast();return[Aa.toUrlValue(Ae),Ba.toUrlValue(Ae)].join()};Bb.t.fl=function(Ae){if(!Ae){return !1}Ae=Bb.ud(Ae);var Aa=this.R,Ba=Ae.R;return(Aa.isEmpty()?Ba.isEmpty():1e-9>=Math.abs(Ba.R-Aa.R)+Math.abs(Aa.j-Ba.j))&&Bb.nd(this.j,Ae.j)};Bb.rd.prototype.equals=Bb.rd.prototype.fl;Bb.t=Bb.rd.prototype;Bb.t.contains=function(Aa){return this.R.contains(Aa.lat())&&this.j.contains(Aa.lng())};Bb.t.intersects=function(Aa){Aa=Bb.ud(Aa);return this.R.intersects(Aa.R)&&this.j.intersects(Aa.j)};Bb.t.extend=function(Aa){this.R.extend(Aa.lat());this.j.extend(Aa.lng());return this};Bb.t.union=function(Aa){Aa=Bb.ud(Aa);if(!Aa||Aa.isEmpty()){return this}this.extend(Aa.getSouthWest());this.extend(Aa.getNorthEast());return this};Bb.t.getSouthWest=function(){return new Bb.K(this.R.R,this.j.j,!0)};Bb.t.getNorthEast=function(){return new Bb.K(this.R.j,this.j.R,!0)};Bb.t.toSpan=function(){return new Bb.K(Bb.qd(this.R),Bb.md(this.j),!0)};Bb.t.isEmpty=function(){return this.R.isEmpty()||this.j.isEmpty()};var AM=Bb.zb({south:Bb.qc,west:Bb.qc,north:Bb.qc,east:Bb.qc},!1);Bb.v(Bb.vd,Bb.J);Bb.kg=[];Bb.t=T.prototype;Bb.t.contains=function(Aa){return this.j.hasOwnProperty(Bb.pb(Aa))};Bb.t.getFeatureById=function(Aa){return Bs(this.R,Aa)};Bb.t.add=function(Ae){Ae=Ae||{};Ae=Ae instanceof Bb.pc?Ae:new Bb.pc(Ae);if(!this.contains(Ae)){var Aa=Ae.getId();if(Aa){var CK=this.getFeatureById(Aa);CK&&this.remove(CK)}CK=Bb.pb(Ae);this.j[CK]=Ae;Aa&&(this.R[Aa]=Ae);var Bi=Bb.I.forward(Ae,"setgeometry",this),Be=Bb.I.forward(Ae,"setproperty",this),Ba=Bb.I.forward(Ae,"removeproperty",this);this.S[CK]=function(){Bb.I.removeListener(Bi);Bb.I.removeListener(Be);Bb.I.removeListener(Ba)};Bb.I.trigger(this,"addfeature",{feature:Ae})}return Ae};Bb.t.remove=function(Ae){var Aa=Bb.pb(Ae),Ba=Ae.getId();if(this.j[Aa]){delete this.j[Aa];Ba&&delete this.R[Ba];if(Ba=this.S[Aa]){delete this.S[Aa],Ba()}Bb.I.trigger(this,"removefeature",{feature:Ae})}};Bb.t.forEach=function(Ae){for(var Aa in this.j){Ae(this.j[Aa])}};G.prototype.get=function(Aa){return this.j[Aa]};G.prototype.set=function(Ae,Aa){var Ba=this.j;Ba[Ae]||(Ba[Ae]={});Bb.Ia(Ba[Ae],Aa);Bb.I.trigger(this,"changed",Ae)};G.prototype.reset=function(Aa){delete this.j[Aa];Bb.I.trigger(this,"changed",Aa)};G.prototype.forEach=function(Aa){Bb.Ha(this.j,Aa)};Bb.v(CE,Bb.J);CE.prototype.overrideStyle=function(Ae,Aa){this.j.set(Bb.pb(Ae),Aa)};CE.prototype.revertStyle=function(Aa){Aa?this.j.reset(Bb.pb(Aa)):this.j.forEach((0,Bb.u)(this.j.reset,this.j))};Bb.v(Bb.Cd,l);Bb.Cd.prototype.getType=Bb.oa("GeometryCollection");Bb.Cd.prototype.getLength=function(){return this.j.length};Bb.Cd.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Cd.prototype.getArray=function(){return this.j.slice()};Bb.v(Bb.Ed,l);Bb.Ed.prototype.getType=Bb.oa("LineString");Bb.Ed.prototype.getLength=function(){return this.j.length};Bb.Ed.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Ed.prototype.getArray=function(){return this.j.slice()};var J=Bb.Db(Bb.Bb(Bb.Ed,"google.maps.Data.LineString",!0));Bb.v(Bb.Gd,l);Bb.Gd.prototype.getType=Bb.oa("MultiLineString");Bb.Gd.prototype.getLength=function(){return this.j.length};Bb.Gd.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Gd.prototype.getArray=function(){return this.j.slice()};Bb.v(Bb.Hd,l);Bb.Hd.prototype.getType=Bb.oa("MultiPoint");Bb.Hd.prototype.getLength=function(){return this.j.length};Bb.Hd.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Hd.prototype.getArray=function(){return this.j.slice()};Bb.v(Bb.Id,l);Bb.Id.prototype.getType=Bb.oa("LinearRing");Bb.Id.prototype.getLength=function(){return this.j.length};Bb.Id.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Id.prototype.getArray=function(){return this.j.slice()};var BY=Bb.Db(Bb.Bb(Bb.Id,"google.maps.Data.LinearRing",!0));Bb.v(Bb.Kd,l);Bb.Kd.prototype.getType=Bb.oa("Polygon");Bb.Kd.prototype.getLength=function(){return this.j.length};Bb.Kd.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Kd.prototype.getArray=function(){return this.j.slice()};var A7=Bb.Db(Bb.Bb(Bb.Kd,"google.maps.Data.Polygon",!0));Bb.v(Bb.Md,l);Bb.Md.prototype.getType=Bb.oa("MultiPolygon");Bb.Md.prototype.getLength=function(){return this.j.length};Bb.Md.prototype.getAt=function(Aa){return this.j[Aa]};Bb.Md.prototype.getArray=function(){return this.j.slice()};var AG=Bb.zb({source:Bb.Pg,webUrl:Bb.Rg,iosDeepLinkId:Bb.Rg});var s=Bb.Ga(Bb.zb({placeId:Bb.Rg,query:Bb.Rg,location:Bb.Zb}),function(Aa){if(Aa.placeId&&Aa.query){throw Bb.xb("cannot set both placeId and query")}if(!Aa.placeId&&!Aa.query){throw Bb.xb("must set one of placeId or query")}return Aa});Bb.v(AX,Bb.J);Bb.vc(AX.prototype,{position:Bb.Gb(Bb.Zb),title:Bb.Rg,icon:Bb.Gb(Bb.Fb(Bb.Pg,{Yh:B7("url"),then:Bb.zb({url:Bb.Pg,scaledSize:Bb.Gb(AZ),size:Bb.Gb(AZ),origin:Bb.Gb(Aw),anchor:Bb.Gb(Aw),labelOrigin:Bb.Gb(Aw),path:Bb.Eb(k)},!0)},{Yh:B7("path"),then:Bb.zb({path:Bb.Fb(Bb.Pg,Bb.Cb(Bh)),anchor:Bb.Gb(Aw),labelOrigin:Bb.Gb(Aw),fillColor:Bb.Rg,fillOpacity:Bb.Qg,rotation:Bb.Qg,scale:Bb.Qg,strokeColor:Bb.Rg,strokeOpacity:Bb.Qg,strokeWeight:Bb.Qg,url:Bb.Eb(k)},!0)})),label:Bb.Gb(Bb.Fb(Bb.Pg,{Yh:B7("text"),then:Bb.zb({text:Bb.Pg,fontSize:Bb.Rg,fontWeight:Bb.Rg,fontFamily:Bb.Rg},!0)})),shadow:Bb.Cc,shape:Bb.Cc,cursor:Bb.Rg,clickable:Bb.Sg,animation:Bb.Cc,draggable:Bb.Sg,visible:Bb.Sg,flat:Bb.Cc,zIndex:Bb.Qg,opacity:Bb.Qg,place:Bb.Gb(s),attribution:Bb.Gb(AG)});var CJ={main:[],common:["main"],util:["common"],adsense:["main"],controls:["util"],data:["util"],directions:["util","geometry"],distance_matrix:["util"],drawing:["main"],drawing_impl:["controls"],elevation:["util","geometry"],geocoder:["util"],geojson:["main"],imagery_viewer:["main"],geometry:["main"],infowindow:["util"],kml:["onion","util","map"],layers:["map"],map:["common"],marker:["util"],maxzoom:["util"],onion:["util","map"],overlay:["common"],panoramio:["main"],places:["main"],places_impl:["controls"],poly:["util","map","geometry"],search:["main"],search_impl:["onion"],stats:["util"],streetview:["util","geometry"],usage:["util"],visualization:["main"],visualization_impl:["onion"],weather:["main"],zombie:["main"]};var g=Bb.dd.google.maps,O=AS.Mc(),C=(0,Bb.u)(O.Rc,O);g.__gjsload__=C;Bb.Ha(g.modules,C);delete g.modules;Bb.yh=Bb.Gb(Bb.Bb(Bb.vd,"Map"));var Bx=Bb.Gb(Bb.Bb(Bb.Bc,"StreetViewPanorama"));Bb.v(Bb.Pd,AX);Bb.Pd.prototype.map_changed=function(){this.__gm.set&&this.__gm.set.remove(this);var Aa=this.get("map");this.__gm.set=Aa&&Aa.__gm.Qd;this.__gm.set&&Bb.zc(this.__gm.set,this)};Bb.Pd.MAX_ZINDEX=1000000;Bb.vc(Bb.Pd.prototype,{map:Bb.Fb(Bb.yh,Bx)});var E=By(Bb.Bb(Bb.K,"LatLng"));Bb.v(BO,Bb.J);BO.prototype.map_changed=BO.prototype.visible_changed=function(){var Aa=this;Bb.L("poly",function(Ae){Ae.R(Aa)})};BO.prototype.getPath=function(){return this.get("latLngs").getAt(0)};BO.prototype.setPath=function(Ae){try{this.get("latLngs").setAt(0,CB(Ae))}catch(Aa){Bb.yb(Aa)}};Bb.vc(BO.prototype,{draggable:Bb.Sg,editable:Bb.Sg,map:Bb.yh,visible:Bb.Sg});Bb.v(Bb.Zd,BO);Bb.Zd.prototype.Eb=!0;Bb.Zd.prototype.getPaths=function(){return this.get("latLngs")};Bb.Zd.prototype.setPaths=function(Aa){this.set("latLngs",Bk(Aa))};Bb.v(Bb.$d,BO);Bb.$d.prototype.Eb=!1;Bb.be="click dblclick mousedown mousemove mouseout mouseover mouseup rightclick".split(" ");Bb.v(BS,Bb.J);Bb.t=BS.prototype;Bb.t.contains=function(Aa){return this.j.contains(Aa)};Bb.t.getFeatureById=function(Aa){return this.j.getFeatureById(Aa)};Bb.t.add=function(Aa){return this.j.add(Aa)};Bb.t.remove=function(Aa){this.j.remove(Aa)};Bb.t.forEach=function(Aa){this.j.forEach(Aa)};Bb.t.addGeoJson=function(Ae,Aa){return Bb.ae(this.j,Ae,Aa)};Bb.t.loadGeoJson=function(Ae,Aa,Be){var Ba=this.j;Bb.L("data",function(Bi){Bi.In(Ba,Ae,Aa,Be)})};Bb.t.toGeoJson=function(Ae){var Aa=this.j;Bb.L("data",function(Ba){Ba.Fn(Aa,Ae)})};Bb.t.overrideStyle=function(Ae,Aa){this.R.overrideStyle(Ae,Aa)};Bb.t.revertStyle=function(Aa){this.R.revertStyle(Aa)};Bb.t.controls_changed=function(){this.get("controls")&&BE(this)};Bb.t.drawingMode_changed=function(){this.get("drawingMode")&&BE(this)};Bb.vc(BS.prototype,{map:Bb.yh,style:Bb.Cc,controls:Bb.Gb(Bb.Db(Bb.Cb(AE))),controlPosition:Bb.Gb(Bb.Cb(Bb.qf)),drawingMode:Bb.Gb(Bb.Cb(AE))});Bb.ee.prototype.$=Bb.m("j");Bb.fe.prototype.$=Bb.m("j");Bb.Ah=new Bb.ee;Bb.Bh=new Bb.ee;AQ.prototype.$=Bb.m("j");Bb.Ch=new Bb.he;Bb.he.prototype.$=Bb.m("j");Bb.Dh=new Bb.ee;Bb.Eh=new AQ;Bb.ie.prototype.$=Bb.m("j");Bb.Fh=new Bb.fe;Bb.Gh=new Bb.ie;Bb.Hh={METRIC:0,IMPERIAL:1};Bb.Ih={DRIVING:"DRIVING",WALKING:"WALKING",BICYCLING:"BICYCLING",TRANSIT:"TRANSIT"};Bb.Jh={BEST_GUESS:"bestguess",OPTIMISTIC:"optimistic",PESSIMISTIC:"pessimistic"};Bb.Kh={BUS:"BUS",RAIL:"RAIL",SUBWAY:"SUBWAY",TRAIN:"TRAIN",TRAM:"TRAM"};Bb.Lh={LESS_WALKING:"LESS_WALKING",FEWER_TRANSFERS:"FEWER_TRANSFERS"};var Ap=Bb.zb({routes:Bb.Db(Bb.Eb(Bb.Ra))},!0);Bb.v(Bb.je,Bb.J);Bb.vc(Bb.je.prototype,{content:Bb.Fb(Bb.Rg,Bb.Eb(Ak)),position:Bb.Gb(Bb.Zb),size:Bb.Gb(AZ),map:Bb.Fb(Bb.yh,Bx),anchor:Bb.Gb(Bb.Bb(Bb.J,"MVCObject")),zIndex:Bb.Qg});Bb.je.prototype.open=function(Ae,Aa){this.set("anchor",Aa);this.set("map",Ae)};Bb.je.prototype.close=function(){this.set("map",null)};Bb.v(K,Bb.J);K.prototype.changed=function(Ae){if("map"==Ae||"panel"==Ae){var Aa=this;Bb.L("directions",function(Ba){Ba.R(Aa,Ae)})}};Bb.vc(K.prototype,{directions:Ap,map:Bb.yh,panel:Bb.Gb(Bb.Eb(Ak)),routeIndex:Bb.Qg});Bb.Nh=new Bb.le;B6.prototype.route=function(Ae,Aa){Bb.L("directions",function(Ba){Ba.j(Ae,Aa,!0)})};Bu.prototype.getDistanceMatrix=function(Ae,Aa){Bb.L("distance_matrix",function(Ba){Ba.j(Ae,Aa)})};Bc.prototype.getElevationAlongPath=function(Ae,Aa){Bb.L("elevation",function(Ba){Ba.j(Ae,Aa)})};Bc.prototype.getElevationForLocations=function(Ae,Aa){Bb.L("elevation",function(Ba){Ba.R(Ae,Aa)})};Bb.Oh=Bb.Bb(Bb.rd,"LatLngBounds");Bb.pe.prototype.geocode=function(Ae,Aa){Bb.L("geocoder",function(Ba){Ba.geocode(Ae,Aa)})};Bb.v(Bb.qe,Bb.J);Bb.qe.prototype.map_changed=function(){var Aa=this;Bb.L("kml",function(Ae){Ae.j(Aa)})};Bb.vc(Bb.qe.prototype,{map:Bb.yh,url:null,bounds:null,opacity:Bb.Qg});Bb.Qh={UNKNOWN:"UNKNOWN",OK:Bb.ha,INVALID_REQUEST:Bb.ba,DOCUMENT_NOT_FOUND:"DOCUMENT_NOT_FOUND",FETCH_ERROR:"FETCH_ERROR",INVALID_DOCUMENT:"INVALID_DOCUMENT",DOCUMENT_TOO_LARGE:"DOCUMENT_TOO_LARGE",LIMITS_EXCEEDED:"LIMITS_EXECEEDED",TIMED_OUT:"TIMED_OUT"};Bb.v(Av,Bb.J);Bb.t=Av.prototype;Bb.t.We=function(){var Aa=this;Bb.L("kml",function(Ae){Ae.R(Aa)})};Bb.t.url_changed=Av.prototype.We;Bb.t.driveFileId_changed=Av.prototype.We;Bb.t.map_changed=Av.prototype.We;Bb.t.zIndex_changed=Av.prototype.We;Bb.vc(Av.prototype,{map:Bb.yh,defaultViewport:null,metadata:null,status:null,url:Bb.Rg,screenOverlays:Bb.Sg,zIndex:Bb.Qg});Bb.v(Bb.se,Bb.J);Bb.se.prototype.map_changed=function(){var Aa=this;Bb.L("layers",function(Ae){Ae.j(Aa)})};Bb.vc(Bb.se.prototype,{map:Bb.yh});Bb.v(AL,Bb.J);AL.prototype.map_changed=function(){var Aa=this;Bb.L("layers",function(Ae){Ae.R(Aa)})};Bb.vc(AL.prototype,{map:Bb.yh});Bb.v(w,Bb.J);w.prototype.map_changed=function(){var Aa=this;Bb.L("layers",function(Ae){Ae.S(Aa)})};Bb.vc(w.prototype,{map:Bb.yh});Bb.pf={japan_prequake:20,japan_postquake2010:24};Bb.Rh={NEAREST:"nearest",BEST:"best"};Bb.Sh={DEFAULT:"default",OUTDOOR:"outdoor"};j.prototype.$=Bb.m("j");Bb.Th=new j;var Bw,Bg,BL,BA,Ay;S.prototype.$=Bb.m("j");var Ad=new F,Bo=new CD,z=new Bz,B1=new Ah;F.prototype.$=Bb.m("j");CD.prototype.$=Bb.m("j");Bz.prototype.$=Bb.m("j");Ah.prototype.$=Bb.m("j");Bb.Fe.prototype.$=Bb.m("j");Bb.bi=new Bb.Fe;Bb.ci=new Bb.Fe;var AA,Z,Bn,CI,Br;Bb.Ge.prototype.$=Bb.m("j");Bb.Ge.prototype.getUrl=function(Aa){return Bb.P(this.j,0)[Aa]};Bb.Ge.prototype.setUrl=function(Ae,Aa){Bb.P(this.j,0)[Ae]=Aa};Bb.He.prototype.$=Bb.m("j");Bb.Ie.prototype.$=Bb.m("j");Bb.di=new Bb.Ge;Bb.ei=new Bb.Ge;Bb.fi=new Bb.Ge;Bb.gi=new Bb.Ge;Bb.hi=new Bb.Ge;AW.prototype.$=Bb.m("j");AH.prototype.$=Bb.m("j");t.prototype.$=Bb.m("j");h.prototype.$=Bb.m("j");Bb.ii=new Bb.Ie;Bb.ji=new Bb.He;AA=new AW;Z=new AH;Bn=new t;Bb.ki=new Bb.Se;Bb.li=new Bb.Te;CI=new S;Br=new P;P.prototype.$=Bb.m("j");Bb.Se.prototype.$=Bb.m("j");Bb.Te.prototype.$=Bb.m("j");Bb.v(At,Bb.Bc);At.prototype.visible_changed=function(){var Aa=this;!Aa.V&&Aa.getVisible()&&(Aa.V=!0,Bb.L("streetview",function(Ae){var Ba;Aa.R&&(Ba=Aa.R);Ae.Jp(Aa,Ba)}))};Bb.vc(At.prototype,{visible:Bb.Sg,pano:Bb.Rg,position:Bb.Gb(Bb.Zb),pov:Bb.Gb(BM),photographerPov:null,location:null,links:Bb.Db(Bb.Eb(Bb.Ra)),status:null,zoom:Bb.Qg,enableCloseButton:Bb.Sg});At.prototype.registerPanoProvider=Bb.tc("panoProvider");Bb.t=Bb.tf.prototype;Bb.t.jf=Bb.qa(2);Bb.t.tc=Bb.qa(3);Bb.t.Qe=Bb.qa(4);Bb.t.Pe=Bb.qa(5);Bb.t.Oe=Bb.qa(6);Bb.v(u,R);Bb.vf.prototype.addListener=function(Ae,Aa){this.Ea.addListener(Ae,Aa)};Bb.vf.prototype.addListenerOnce=function(Ae,Aa){this.Ea.addListenerOnce(Ae,Aa)};Bb.vf.prototype.removeListener=function(Ae,Aa){this.Ea.removeListener(Ae,Aa)};Bb.vf.prototype.j=Bb.qa(7);Bb.T={};Bb.wf.prototype.fromLatLngToPoint=function(Ae,Aa){var Bi=Aa||new Bb.M(0,0),Be=this.j;Bi.x=Be.x+Ae.lng()*this.S;var Ba=Bb.Ka(Math.sin(Bb.Sb(Ae.lat())),-(1-1e-15),1-1e-15);Bi.y=Be.y+0.5*Math.log((1+Ba)/(1-Ba))*-this.U;return Bi};Bb.wf.prototype.fromPointToLatLng=function(Ae,Aa){var Ba=this.j;return new Bb.K(Bb.Ub(2*Math.atan(Math.exp((Ae.y-Ba.y)/-this.U))-Math.PI/2),(Ae.x-Ba.x)/this.S,Aa)};Bb.xf.prototype.isEmpty=function(){return !(this.Aa<this.Da&&this.ya<this.Fa)};Bb.xf.prototype.extend=function(Aa){Aa&&(this.Aa=Math.min(this.Aa,Aa.x),this.Da=Math.max(this.Da,Aa.x),this.ya=Math.min(this.ya,Aa.y),this.Fa=Math.max(this.Fa,Aa.y))};Bb.xf.prototype.getCenter=function(){return new Bb.M((this.Aa+this.Da)/2,(this.ya+this.Fa)/2)};Bb.mi=Bb.yf(-window.Infinity,-window.Infinity,window.Infinity,window.Infinity);Bb.ni=Bb.yf(0,0,0,0);Bb.v(Bb.R,Bb.J);Bb.R.prototype.Ba=function(){var Aa=this;Aa.Ca||(Aa.Ca=window.setTimeout(function(){Aa.Ca=void 0;Aa.Na()},Aa.Wl))};Bb.R.prototype.ma=function(){this.Ca&&window.clearTimeout(this.Ca);this.Ca=void 0;this.Na()};var BU,BG;X.prototype.$=Bb.m("j");CG.prototype.$=Bb.m("j");var A4=new X;Bb.v(Bb.Hf,Bb.Qc);Bb.Hf.prototype.set=function(Aa){this.ik(Aa);this.notify()};Bb.Hf.prototype.notify=function(){this.Of()};Bb.v(Bb.If,Bb.Hf);Bb.If.prototype.get=Bb.m("j");Bb.If.prototype.ik=Bb.na("j");var Aq,AU;BW.prototype.$=Bb.m("j");BI.prototype.$=Bb.m("j");var AD;A6.prototype.$=Bb.m("j");A6.prototype.getZoom=function(){var Aa=this.j[2];return null!=Aa?Aa:0};A6.prototype.setZoom=function(Aa){this.j[2]=Aa};var q=new BW,e=new BI,N=new CG,B=new S;Bb.v(As,Bb.R);var AV={roadmap:0,satellite:2,hybrid:3,terrain:4},CA={0:1,2:2,3:2,4:2};Bb.t=As.prototype;Bb.t.fj=Bb.O("center");Bb.t.ui=Bb.O("zoom");Bb.t.changed=function(){var Ae=this.fj(),Aa=this.ui(),Ba=AF(this);if(Ae&&!Ae.j(this.ua)||this.ta!=Aa||this.wa!=Ba){r(this.R),this.Ba(),this.ta=Aa,this.wa=Ba}this.ua=Ae};Bb.t.Na=function(){var Ae="",Aa=this.fj(),CM=this.ui(),CL=AF(this),CK=this.get("size");if(Aa&&(0,window.isFinite)(Aa.lat())&&(0,window.isFinite)(Aa.lng())&&1<CM&&null!=CL&&CK&&CK.width&&CK.height&&this.j){Bb.Bf(this.j,CK);var Bi;(Aa=Bb.zf(this.U,Aa,CM))?(Bi=new Bb.xf,Bi.Aa=Math.round(Aa.x-CK.width/2),Bi.Da=Bi.Aa+CK.width,Bi.ya=Math.round(Aa.y-CK.height/2),Bi.Fa=Bi.ya+CK.height):Bi=null;Aa=CA[CL];if(Bi){var Ae=new A6,Be=1<(22>CM&&Bb.Df())?2:1,Ba=m().j[12];null!=Ba&&Ba&&(Be=1);Ae.j[0]=Ae.j[0]||[];Ba=new BW(Ae.j[0]);Ba.j[0]=Bi.Aa*Be;Ba.j[1]=Bi.ya*Be;Ae.j[1]=Aa;Ae.setZoom(CM);Ae.j[3]=Ae.j[3]||[];CM=new BI(Ae.j[3]);CM.j[0]=(Bi.Da-Bi.Aa)*Be;CM.j[1]=(Bi.Fa-Bi.ya)*Be;1<Be&&(CM.j[2]=2);Ae.j[4]=Ae.j[4]||[];CM=new CG(Ae.j[4]);CM.j[0]=CL;CM.j[4]=Bb.Ue(Bb.We(Bb.Q));CM.j[5]=Bb.Ve(Bb.We(Bb.Q)).toLowerCase();CM.j[9]=!0;CM.j[11]=!0;CL=this.W+(0,window.unescape)("%3F");AD||(CM=[],AD={qa:-1,ra:CM},Aq||(Aa=[],Aq={qa:-1,ra:Aa},Aa[1]={type:"i",label:1,T:0},Aa[2]={type:"i",label:1,T:0}),CM[1]={type:"m",label:1,T:q,ka:Aq},CM[2]={type:"e",label:1,T:0},CM[3]={type:"u",label:1,T:0},AU||(Aa=[],AU={qa:-1,ra:Aa},Aa[1]={type:"u",label:1,T:0},Aa[2]={type:"u",label:1,T:0},Aa[3]={type:"e",label:1,T:1}),CM[4]={type:"m",label:1,T:e,ka:AU},BG||(Aa=[],BG={qa:-1,ra:Aa},Aa[1]={type:"e",label:1,T:0},Aa[2]={type:"b",label:1,T:!1},Aa[3]={type:"b",label:1,T:!1},Aa[5]={type:"s",label:1,T:""},Aa[6]={type:"s",label:1,T:""},BU||(Bi=[],BU={qa:-1,ra:Bi},Bi[1]={type:"e",label:3},Bi[2]={type:"b",label:1,T:!1}),Aa[9]={type:"m",label:1,T:A4,ka:BU},Aa[10]={type:"b",label:1,T:!1},Aa[11]={type:"b",label:1,T:!1},Aa[12]={type:"b",label:1,T:!1},Aa[100]={type:"b",label:1,T:!1}),CM[5]={type:"m",label:1,T:N,ka:BG},Bw||(Aa=[],Bw={qa:-1,ra:Aa},Bg||(Bi=[],Bg={qa:-1,ra:Bi},Bi[1]={type:"b",label:1,T:!1}),Aa[1]={type:"m",label:1,T:Ad,ka:Bg},BL||(Bi=[],BL={qa:-1,ra:Bi},Bi[1]={type:"b",label:1,T:!1}),Aa[12]={type:"m",label:1,T:Bo,ka:BL},BA||(Bi=[],BA={qa:-1,ra:Bi},Bi[9]={type:"j",label:1,T:0},Bi[10]={type:"j",label:1,T:0},Bi[11]={type:"j",label:1,T:0},Bi[12]={type:"j",label:1,T:0},Bi[13]={type:"b",label:1,T:!1},Bi[14]={type:"s",label:1,T:""}),Aa[11]={type:"m",label:1,T:z,ka:BA},Ay||(Bi=[],Ay={qa:-1,ra:Bi},Bi[1]={type:"b",label:1,T:!1},Bi[2]={type:"b",label:1,T:!1}),Aa[10]={type:"m",label:1,T:B1,ka:Ay}),CM[6]={type:"m",label:1,T:B,ka:Bw});Ae=Bb.bh.j(Ae.j,AD);Ae=this.V(CL+Ae)}}this.R&&CK&&(Bb.Bf(this.R,CK),CK=Ae,Ae=this.R,CK!=Ae.src?(r(Ae),Ae.onload=Bb.Wa(this,this.vi,!0),Ae.onerror=Bb.Wa(this,this.vi,!1),Ae.src=CK):!Ae.parentNode&&CK&&this.j.appendChild(Ae))};Bb.t.vi=function(Ae){var Aa=this.R;Aa.onload=null;Aa.onerror=null;Ae&&(Aa.parentNode||this.j.appendChild(Aa),Bb.Bf(Aa,this.get("size")),Bb.I.trigger(this,"staticmaploaded"),this.S.set(Bb.Fa()));this.set("loading",!1)};Bb.t.div_changed=function(){var Ae=this.get("div"),Aa=this.j;if(Ae){if(Aa){Ae.appendChild(Aa)}else{Aa=this.j=window.document.createElement("div");Aa.style.overflow="hidden";var Ba=this.R=window.document.createElement("img");Bb.I.addDomListener(Aa,"contextmenu",Bb.cb);Ba.ontouchstart=Ba.ontouchmove=Ba.ontouchend=Ba.ontouchcancel=Bb.db;Bb.Bf(Ba,Bb.Ug);Ae.appendChild(Aa);this.Na()}}else{Aa&&(r(Aa),this.j=null)}};var BN;Bb.jg="StopIteration" in Bb.dd?Bb.dd.StopIteration:{message:"StopIteration",stack:""};Bb.Yf.prototype.next=function(){throw Bb.jg};Bb.Yf.prototype.Ag=function(){return this};Bb.Zf.prototype.dh=!0;Bb.Zf.prototype.nd=Bb.qa(9);Bb.Zf.prototype.sj=!0;Bb.Zf.prototype.Bf=Bb.qa(11);Bb.$f("about:blank");Bb.bg.prototype.sj=!0;Bb.bg.prototype.Bf=Bb.qa(10);Bb.bg.prototype.dh=!0;Bb.bg.prototype.nd=Bb.qa(8);Bb.ag={};Bb.cg("<!DOCTYPE html>",0);Bb.cg("",0);Bb.cg("<br>",0);!Bb.Zc&&!Bb.ad||Bb.ad&&9<=+Bb.lh||Bb.Zc&&Bb.hd("1.9.1");Bb.ad&&Bb.hd("9");Bb.v(Ai,Bb.Yf);Ai.prototype.setPosition=function(Ae,Aa,Ba){if(this.node=Ae){this.R=Bb.ya(Aa)?Aa:1!=this.node.nodeType?0:this.j?-1:1}Bb.ya(Ba)&&(this.depth=Ba)};Ai.prototype.next=function(){var Ae;if(this.S){if(!this.node||this.U&&0==this.depth){throw Bb.jg}Ae=this.node;var Aa=this.j?-1:1;if(this.R==Aa){var Ba=this.j?Ae.lastChild:Ae.firstChild;Ba?this.setPosition(Ba):this.setPosition(Ae,-1*Aa)}else{(Ba=this.j?Ae.previousSibling:Ae.nextSibling)?this.setPosition(Ba):this.setPosition(Ae.parentNode,-1*Aa)}this.depth+=this.R*(this.j?-1:1)}else{this.S=!0}Ae=this.node;if(!this.node){throw Bb.jg}return Ae};Ai.prototype.splice=function(Ae){var Aa=this.node,Be=this.j?1:-1;this.R==Be&&(this.R=-1*Be,this.depth+=this.R*(this.j?-1:1));this.j=!this.j;Ai.prototype.next.call(this);this.j=!this.j;for(var Be=Bb.wa(arguments[0])?arguments[0]:arguments,Ba=Be.length-1;0<=Ba;Ba--){Bb.dg(Be[Ba],Aa)}Bb.eg(Aa)};Bb.v(AP,Ai);AP.prototype.next=function(){do{AP.qd.next.call(this)}while(-1==this.R);return this.node};Bb.Ai=Bb.dd.document&&Bb.dd.document.createElement("div");Bb.v(Bb.ng,Bb.vd);Bb.t=Bb.ng.prototype;Bb.t.streetView_changed=function(){this.get("streetView")||this.set("streetView",this.__gm.R)};Bb.t.getDiv=function(){return this.__gm.Ia};Bb.t.panBy=function(Ae,Aa){var Ba=this.__gm;Bb.L("map",function(){Bb.I.trigger(Ba,"panby",Ae,Aa)})};Bb.t.panTo=function(Ae){var Aa=this.__gm;Ae=Bb.Zb(Ae);Bb.L("map",function(){Bb.I.trigger(Aa,"panto",Ae)})};Bb.t.panToBounds=function(Ae){var Aa=this.__gm,Ba=Bb.ud(Ae);Bb.L("map",function(){Bb.I.trigger(Aa,"pantolatlngbounds",Ba)})};Bb.t.fitBounds=function(Ae){var Aa=this;Ae=Bb.ud(Ae);Bb.L("map",function(Ba){Ba.fitBounds(Aa,Ae)})};Bb.vc(Bb.ng.prototype,{bounds:null,streetView:Bx,center:Bb.Gb(Bb.Zb),zoom:Bb.Qg,mapTypeId:Bb.Rg,projection:null,heading:Bb.Qg,tilt:Bb.Qg});BX.prototype.getMaxZoomAtLatLng=function(Ae,Aa){Bb.L("maxzoom",function(Ba){Ba.getMaxZoomAtLatLng(Ae,Aa)})};Bb.v(BJ,Bb.J);BJ.prototype.changed=function(Ae){if("suppressInfoWindows"!=Ae&&"clickable"!=Ae){var Aa=this;Bb.L("onion",function(Ba){Ba.j(Aa)})}};Bb.vc(BJ.prototype,{map:Bb.yh,tableId:Bb.Qg,query:Bb.Gb(Bb.Fb(Bb.Pg,Bb.Eb(Bb.Ra,"not an Object")))});Bb.v(Bb.qg,Bb.J);Bb.qg.prototype.map_changed=function(){var Aa=this;Bb.L("overlay",function(Ae){Ae.j(Aa)})};Bb.vc(Bb.qg.prototype,{panes:null,projection:null,map:Bb.Fb(Bb.yh,Bx)});Bb.v(Bb.rg,Bb.J);Bb.rg.prototype.map_changed=Bb.rg.prototype.visible_changed=function(){var Aa=this;Bb.L("poly",function(Ae){Ae.j(Aa)})};Bb.rg.prototype.center_changed=function(){Bb.I.trigger(this,"bounds_changed")};Bb.rg.prototype.radius_changed=Bb.rg.prototype.center_changed;Bb.rg.prototype.getBounds=function(){var Ae=this.get("radius"),Aa=this.get("center");if(Aa&&Bb.D(Ae)){var Ba=this.get("map"),Ba=Ba&&Ba.__gm.get("mapType");return Bb.Af(Aa,Ae/Bb.Rd(Ba))}return null};Bb.vc(Bb.rg.prototype,{center:Bb.Gb(Bb.Zb),draggable:Bb.Sg,editable:Bb.Sg,map:Bb.yh,radius:Bb.Qg,visible:Bb.Sg});Bb.v(Bb.sg,Bb.J);Bb.sg.prototype.map_changed=Bb.sg.prototype.visible_changed=function(){var Aa=this;Bb.L("poly",function(Ae){Ae.S(Aa)})};Bb.vc(Bb.sg.prototype,{draggable:Bb.Sg,editable:Bb.Sg,bounds:Bb.Gb(Bb.ud),map:Bb.yh,visible:Bb.Sg});Bb.v(AI,Bb.J);AI.prototype.map_changed=function(){var Aa=this;Bb.L("streetview",function(Ae){Ae.Pm(Aa)})};Bb.vc(AI.prototype,{map:Bb.yh});Bb.ug.prototype.getPanorama=function(Ae,Aa){var Ba=this.j||void 0;Bb.L("streetview",function(Be){Bb.L("geometry",function(Bi){Be.Tn(Ae,Aa,Bi.computeHeading,Ba)})})};Bb.ug.prototype.getPanoramaByLocation=function(Ae,Aa,Ba){this.getPanorama({location:Ae,radius:Aa,preference:50>(Aa||0)?"best":"nearest"},Ba)};Bb.ug.prototype.getPanoramaById=function(Ae,Aa){this.getPanorama({pano:Ae},Aa)};Bb.v(Bb.vg,Bb.J);Bb.t=Bb.vg.prototype;Bb.t.getTile=function(Ae,Aa,CK){if(!Ae||!CK){return null}var Bi=CK.createElement("div");CK={Oa:Ae,zoom:Aa,Ec:null};Bi.__gmimt=CK;Bb.zc(this.j,Bi);var Be=D(this);1!=Be&&Q(Bi,Be);if(this.R){var Be=this.tileSize||new Bb.N(256,256),Ba=this.S(Ae,Aa);CK.Ec=this.R(Ae,Aa,Be,Bi,Ba,function(){Bb.I.trigger(Bi,"load")})}return Bi};Bb.t.releaseTile=function(Aa){Aa&&this.j.contains(Aa)&&(this.j.remove(Aa),(Aa=Aa.__gmimt.Ec)&&Aa.release())};Bb.t.Tg=Bb.qa(12);Bb.t.Ip=function(){this.R&&this.j.forEach(function(Aa){Aa.__gmimt.Ec.dc()})};Bb.t.opacity_changed=function(){var Aa=D(this);this.j.forEach(function(Ae){Q(Ae,Aa)})};Bb.t.ae=!0;Bb.vc(Bb.vg.prototype,{opacity:Bb.Qg});Bb.v(Bb.yg,Bb.J);Bb.yg.prototype.getTile=BB;Bb.yg.prototype.tileSize=new Bb.N(256,256);Bb.yg.prototype.ae=!0;Bb.v(Bb.zg,Bb.yg);Bb.v(Bb.Dg,Bb.J);Bb.vc(Bb.Dg.prototype,{attribution:Bb.Gb(AG),place:Bb.Gb(s)});var AN={Animation:{BOUNCE:1,DROP:2,qr:3,or:4},Circle:Bb.rg,ControlPosition:Bb.qf,Data:BS,GroundOverlay:Bb.qe,ImageMapType:Bb.vg,InfoWindow:Bb.je,LatLng:Bb.K,LatLngBounds:Bb.rd,MVCArray:Bb.xc,MVCObject:Bb.J,Map:Bb.ng,MapTypeControlStyle:{DEFAULT:0,HORIZONTAL_BAR:1,DROPDOWN_MENU:2,INSET:3,INSET_LARGE:4},MapTypeId:Bb.Ng,MapTypeRegistry:b,Marker:Bb.Pd,MarkerImage:function(Ae,Aa,Bi,Be,Ba){this.url=Ae;this.size=Aa||Ba;this.origin=Bi;this.anchor=Be;this.scaledSize=Ba;this.labelOrigin=null},NavigationControlStyle:{DEFAULT:0,SMALL:1,ANDROID:2,ZOOM_PAN:3,rr:4,vm:5},OverlayView:Bb.qg,Point:Bb.M,Polygon:Bb.Zd,Polyline:Bb.$d,Rectangle:Bb.sg,ScaleControlStyle:{DEFAULT:0},Size:Bb.N,StreetViewPreference:Bb.Rh,StreetViewSource:Bb.Sh,StrokePosition:{CENTER:0,INSIDE:1,OUTSIDE:2},SymbolPath:Bh,ZoomControlStyle:{DEFAULT:0,SMALL:1,LARGE:2,vm:3},event:Bb.I};Bb.Ia(AN,{BicyclingLayer:Bb.se,DirectionsRenderer:K,DirectionsService:B6,DirectionsStatus:{OK:Bb.ha,UNKNOWN_ERROR:Bb.ka,OVER_QUERY_LIMIT:Bb.ia,REQUEST_DENIED:Bb.ja,INVALID_REQUEST:Bb.ba,ZERO_RESULTS:Bb.la,MAX_WAYPOINTS_EXCEEDED:Bb.ea,NOT_FOUND:Bb.ga},DirectionsTravelMode:Bb.Ih,DirectionsUnitSystem:Bb.Hh,DistanceMatrixService:Bu,DistanceMatrixStatus:{OK:Bb.ha,INVALID_REQUEST:Bb.ba,OVER_QUERY_LIMIT:Bb.ia,REQUEST_DENIED:Bb.ja,UNKNOWN_ERROR:Bb.ka,MAX_ELEMENTS_EXCEEDED:Bb.da,MAX_DIMENSIONS_EXCEEDED:Bb.ca},DistanceMatrixElementStatus:{OK:Bb.ha,NOT_FOUND:Bb.ga,ZERO_RESULTS:Bb.la},ElevationService:Bc,ElevationStatus:{OK:Bb.ha,UNKNOWN_ERROR:Bb.ka,OVER_QUERY_LIMIT:Bb.ia,REQUEST_DENIED:Bb.ja,INVALID_REQUEST:Bb.ba,lr:"DATA_NOT_AVAILABLE"},FusionTablesLayer:BJ,Geocoder:Bb.pe,GeocoderLocationType:{ROOFTOP:"ROOFTOP",RANGE_INTERPOLATED:"RANGE_INTERPOLATED",GEOMETRIC_CENTER:"GEOMETRIC_CENTER",APPROXIMATE:"APPROXIMATE"},GeocoderStatus:{OK:Bb.ha,UNKNOWN_ERROR:Bb.ka,OVER_QUERY_LIMIT:Bb.ia,REQUEST_DENIED:Bb.ja,INVALID_REQUEST:Bb.ba,ZERO_RESULTS:Bb.la,ERROR:Bb.aa},KmlLayer:Av,KmlLayerStatus:Bb.Qh,MaxZoomService:BX,MaxZoomStatus:{OK:Bb.ha,ERROR:Bb.aa},SaveWidget:Bb.Dg,StreetViewCoverageLayer:AI,StreetViewPanorama:At,StreetViewService:Bb.ug,StreetViewStatus:{OK:Bb.ha,UNKNOWN_ERROR:Bb.ka,ZERO_RESULTS:Bb.la},StyledMapType:Bb.zg,TrafficLayer:AL,TrafficModel:Bb.Jh,TransitLayer:w,TransitMode:Bb.Kh,TransitRoutePreference:Bb.Lh,TravelMode:Bb.Ih,UnitSystem:Bb.Hh});Bb.Ia(BS,{Feature:Bb.pc,Geometry:l,GeometryCollection:Bb.Cd,LineString:Bb.Ed,LinearRing:Bb.Id,MultiLineString:Bb.Gd,MultiPoint:Bb.Hd,MultiPolygon:Bb.Md,Point:Bb.$b,Polygon:Bb.Kd});var CF=/'/g,B3;Bb.nc("main",{});window.google.maps.Load(function(Ae,Aa){var Bi=window.google.maps;A5();var Be=Ar(Bi);Bb.Q=new h(Ae);Bb.Ci=Math.random()<Bb.df();Bb.Di=Math.round(1000000000000000*Math.random()).toString(36);Bb.mg=Bq();Bb.Ph=BV();Bb.zi=new Bb.xc;Bb.Uf=Aa;for(var Ba=0;Ba<Bb.Uc(Bb.Q.j,8);++Ba){Bb.T[B4(Ba)]=!0}Ba=Bb.kf();AJ(Bp(Ba));Bb.Ha(AN,function(CL,CK){Bi[CL]=CK});Bi.version=Bb.af(Ba);window.setTimeout(function(){Bd(["util","stats"],function(CL,CK){CL.R.j();CL.S();Be&&CK.j.j({ev:"api_alreadyloaded",client:Bb.ef(Bb.Q),key:Bb.gf()})})},5000);Bb.I.Yp();BN=new Bj;(Ba=Aj())&&Bd(Bb.P(Bb.Q.j,12),BH(Ba),!0)})}).call(this,{});L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:false,noWrap:false,mapOptions:{backgroundColor:"#dddddd"}},initialize:function(B,A){L.Util.setOptions(this,A);this._ready=google.maps.Map!==undefined;if(!this._ready){L.Google.asyncWait.push(this)}this._type=B||"SATELLITE"},onAdd:function(B,A){this._map=B;this._insertAtTheBottom=A;this._initContainer();this._initMapObject();B.on("viewreset",this._resetCallback,this);this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this);B.on("move",this._update,this);B.on("zoomanim",this._handleZoomAnim,this);B._controlCorners.bottomright.style.marginBottom="20px";this._reset();this._update()},onRemove:function(A){A._container.removeChild(this._container);A.off("viewreset",this._resetCallback,this);A.off("move",this._update,this);A.off("zoomanim",this._handleZoomAnim,this);A._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(A){this.options.opacity=A;if(A<1){L.DomUtil.setOpacity(this._container,A)}},setElementSize:function(B,A){B.style.width=A.x+"px";B.style.height=A.y+"px"},_initContainer:function(){var A=this._map._container,B=A.firstChild;if(!this._container){this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left");this._container.id="_GMapContainer_"+L.Util.stamp(this);this._container.style.zIndex="auto"}A.insertBefore(this._container,B);this.setOpacity(this.options.opacity);this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(!this._ready){return }this._google_center=new google.maps.LatLng(0,0);var A=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor});var B=this;this._reposition=google.maps.event.addListenerOnce(A,"center_changed",function(){B.onReposition()});this._google=A;google.maps.event.addListenerOnce(A,"idle",function(){B._checkZoomLevels()});this.fire("MapObjectInitialized",{mapObject:A})},_checkZoomLevels:function(){if(this._google.getZoom()!==this._map.getZoom()){this._map.setZoom(this._google.getZoom())}},_resetCallback:function(A){this._reset(A.hard)},_reset:function(A){this._initContainer()},_update:function(C){if(!this._google){return }this._resize();var A=this._map.getCenter();var B=new google.maps.LatLng(A.lat,A.lng);this._google.setCenter(B);this._google.setZoom(Math.round(this._map.getZoom()));this._checkZoomLevels()},_resize:function(){var A=this._map.getSize();if(this._container.style.width===A.x&&this._container.style.height===A.y){return }this.setElementSize(this._container,A);this.onReposition()},_handleZoomAnim:function(C){var A=C.center;var B=new google.maps.LatLng(A.lat,A.lng);this._google.setCenter(B);this._google.setZoom(Math.round(C.zoom))},onReposition:function(){if(!this._google){return }google.maps.event.trigger(this._google,"resize")}});L.Google.asyncWait=[];L.Google.asyncInitialize=function(){var A;for(A=0;A<L.Google.asyncWait.length;A++){var B=L.Google.asyncWait[A];B._ready=true;if(B._container){B._initMapObject();B._update()}}L.Google.asyncWait=[]};(function(B,A,C){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:true,showCoverageOnHover:true,zoomToBoundsOnClick:true,singleMarkerMode:false,disableClusteringAtZoom:null,removeOutsideVisibleBounds:true,animateAddingMarkers:false,spiderfyDistanceMultiplier:1,chunkedLoading:false,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(D){L.Util.setOptions(this,D);if(!this.options.iconCreateFunction){this.options.iconCreateFunction=this._defaultIconCreateFunction}this._featureGroup=L.featureGroup();this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[]},addLayer:function(G){if(G instanceof L.LayerGroup){var H=[];for(var F in G._layers){H.push(G._layers[F])}return this.addLayers(H)}if(!G.getLatLng){this._nonPointGroup.addLayer(G);return this}if(!this._map){this._needsClustering.push(G);return this}if(this.hasLayer(G)){return this}if(this._unspiderfy){this._unspiderfy()}this._addLayer(G,this._maxZoom);var D=G,E=this._map.getZoom();if(G.__parent){while(D.__parent._zoom>=E){D=D.__parent}}if(this._currentShownBounds.contains(D.getLatLng())){if(this.options.animateAddingMarkers){this._animationAddLayer(G,D)}else{this._animationAddLayerNonAnimated(G,D)}}return this},removeLayer:function(E){if(E instanceof L.LayerGroup){var F=[];for(var D in E._layers){F.push(E._layers[D])}return this.removeLayers(F)}if(!E.getLatLng){this._nonPointGroup.removeLayer(E);return this}if(!this._map){if(!this._arraySplice(this._needsClustering,E)&&this.hasLayer(E)){this._needsRemoving.push(E)}return this}if(!E.__parent){return this}if(this._unspiderfy){this._unspiderfy();this._unspiderfyLayer(E)}this._removeLayer(E,true);if(this._featureGroup.hasLayer(E)){this._featureGroup.removeLayer(E);if(E.setOpacity){E.setOpacity(1)}}return this},addLayers:function(H){var D=this._featureGroup,K=this._nonPointGroup,O=this.options.chunkedLoading,M=this.options.chunkInterval,P=this.options.chunkProgress,N,J,G,F;if(this._map){var I=0,Q=(new Date()).getTime();var E=L.bind(function(){var U=(new Date()).getTime();for(;I<H.length;I++){if(O&&I%200===0){var R=(new Date()).getTime()-U;if(R>M){break}}F=H[I];if(!F.getLatLng){K.addLayer(F);continue}if(this.hasLayer(F)){continue}this._addLayer(F,this._maxZoom);if(F.__parent){if(F.__parent.getChildCount()===2){var T=F.__parent.getAllChildMarkers(),S=T[0]===F?T[1]:T[0];D.removeLayer(S)}}}if(P){P(I,H.length,(new Date()).getTime()-Q)}if(I===H.length){this._featureGroup.eachLayer(function(V){if(V instanceof L.MarkerCluster&&V._iconNeedsUpdate){V._updateIcon()}});this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)}else{setTimeout(E,this.options.chunkDelay)}},this);E()}else{N=[];for(J=0,G=H.length;J<G;J++){F=H[J];if(!F.getLatLng){K.addLayer(F);continue}if(this.hasLayer(F)){continue}N.push(F)}this._needsClustering=this._needsClustering.concat(N)}return this},removeLayers:function(H){var G,F,D,E=this._featureGroup,I=this._nonPointGroup;if(!this._map){for(G=0,F=H.length;G<F;G++){D=H[G];this._arraySplice(this._needsClustering,D);I.removeLayer(D)}return this}for(G=0,F=H.length;G<F;G++){D=H[G];if(!D.__parent){I.removeLayer(D);continue}this._removeLayer(D,true,true);if(E.hasLayer(D)){E.removeLayer(D);if(D.setOpacity){D.setOpacity(1)}}}this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds);E.eachLayer(function(J){if(J instanceof L.MarkerCluster){J._updateIcon()}});return this},clearLayers:function(){if(!this._map){this._needsClustering=[];delete this._gridClusters;delete this._gridUnclustered}if(this._noanimationUnspiderfy){this._noanimationUnspiderfy()}this._featureGroup.clearLayers();this._nonPointGroup.clearLayers();this.eachLayer(function(D){delete D.__parent});if(this._map){this._generateInitialClusters()}return this},getBounds:function(){var E=new L.LatLngBounds();if(this._topClusterLevel){E.extend(this._topClusterLevel._bounds)}for(var D=this._needsClustering.length-1;D>=0;D--){E.extend(this._needsClustering[D].getLatLng())}E.extend(this._nonPointGroup.getBounds());return E},eachLayer:function(G,E){var F=this._needsClustering.slice(),D;if(this._topClusterLevel){this._topClusterLevel.getAllChildMarkers(F)}for(D=F.length-1;D>=0;D--){G.call(E,F[D])}this._nonPointGroup.eachLayer(G,E)},getLayers:function(){var D=[];this.eachLayer(function(E){D.push(E)});return D},getLayer:function(E){var D=null;this.eachLayer(function(F){if(L.stamp(F)===E){D=F}});return D},hasLayer:function(E){if(!E){return false}var D,F=this._needsClustering;for(D=F.length-1;D>=0;D--){if(F[D]===E){return true}}F=this._needsRemoving;for(D=F.length-1;D>=0;D--){if(F[D]===E){return false}}return !!(E.__parent&&E.__parent._group===this)||this._nonPointGroup.hasLayer(E)},zoomToShowLayer:function(E,G){var F=function(){if((E._icon||E.__parent._icon)&&!this._inZoomAnimation){this._map.off("moveend",F,this);this.off("animationend",F,this);if(E._icon){G()}else{if(E.__parent._icon){var H=function(){this.off("spiderfied",H,this);G()};this.on("spiderfied",H,this);E.__parent.spiderfy()}}}};if(E._icon&&this._map.getBounds().contains(E.getLatLng())){G()}else{if(E.__parent._zoom<this._map.getZoom()){this._map.on("moveend",F,this);this._map.panTo(E.getLatLng())}else{var D=function(){this._map.off("movestart",D,this);D=null};this._map.on("movestart",D,this);this._map.on("moveend",F,this);this.on("animationend",F,this);E.__parent.zoomToBounds();if(D){F.call(this)}}}},onAdd:function(G){this._map=G;var F,D,E;if(!isFinite(this._map.getMaxZoom())){throw"Map has no maxZoom specified"}this._featureGroup.onAdd(G);this._nonPointGroup.onAdd(G);if(!this._gridClusters){this._generateInitialClusters()}for(F=0,D=this._needsRemoving.length;F<D;F++){E=this._needsRemoving[F];this._removeLayer(E,true)}this._needsRemoving=[];this._zoom=this._map.getZoom();this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);if(this._spiderfierOnAdd){this._spiderfierOnAdd()}this._bindEvents();D=this._needsClustering;this._needsClustering=[];this.addLayers(D)},onRemove:function(D){D.off("zoomend",this._zoomEnd,this);D.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");if(this._spiderfierOnRemove){this._spiderfierOnRemove()}this._hideCoverage();this._featureGroup.onRemove(D);this._nonPointGroup.onRemove(D);this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(D){var E=D;while(E&&!E._icon){E=E.__parent}return E||null},_arraySplice:function(E,F){for(var D=E.length-1;D>=0;D--){if(E[D]===F){E.splice(D,1);return true}}},_removeLayer:function(J,G,M){var H=this._gridClusters,F=this._gridUnclustered,D=this._featureGroup,E=this._map;if(G){for(var K=this._maxZoom;K>=0;K--){if(!F[K].removeObject(J,E.project(J.getLatLng(),K))){break}}}var N=J.__parent,I=N._markers,O;this._arraySplice(I,J);while(N){N._childCount--;if(N._zoom<0){break}else{if(G&&N._childCount<=1){O=N._markers[0]===J?N._markers[1]:N._markers[0];H[N._zoom].removeObject(N,E.project(N._cLatLng,N._zoom));F[N._zoom].addObject(O,E.project(O.getLatLng(),N._zoom));this._arraySplice(N.__parent._childClusters,N);N.__parent._markers.push(O);O.__parent=N.__parent;if(N._icon){D.removeLayer(N);if(!M){D.addLayer(O)}}}else{N._recalculateBounds();if(!M||!N._icon){N._updateIcon()}}}N=N.__parent}delete J.__parent},_isOrIsParent:function(E,D){while(D){if(E===D){return true}D=D.parentNode}return false},_propagateEvent:function(D){if(D.layer instanceof L.MarkerCluster){if(D.originalEvent&&this._isOrIsParent(D.layer._icon,D.originalEvent.relatedTarget)){return }D.type="cluster"+D.type}this.fire(D.type,D)},_defaultIconCreateFunction:function(D){var E=D.getChildCount();var F=" marker-cluster-";if(E<10){F+="small"}else{if(E<100){F+="medium"}else{F+="large"}}return new L.DivIcon({html:"<div><span>"+E+"</span></div>",className:"marker-cluster"+F,iconSize:new L.Point(40,40)})},_bindEvents:function(){var G=this._map,E=this.options.spiderfyOnMaxZoom,D=this.options.showCoverageOnHover,F=this.options.zoomToBoundsOnClick;if(E||F){this.on("clusterclick",this._zoomOrSpiderfy,this)}if(D){this.on("clustermouseover",this._showCoverage,this);this.on("clustermouseout",this._hideCoverage,this);G.on("zoomend",this._hideCoverage,this)}},_zoomOrSpiderfy:function(E){var D=this._map;if(D.getMaxZoom()===D.getZoom()){if(this.options.spiderfyOnMaxZoom){E.layer.spiderfy()}}else{if(this.options.zoomToBoundsOnClick){E.layer.zoomToBounds()}}if(E.originalEvent&&E.originalEvent.keyCode===13){D._container.focus()}},_showCoverage:function(E){var D=this._map;if(this._inZoomAnimation){return }if(this._shownPolygon){D.removeLayer(this._shownPolygon)}if(E.layer.getChildCount()>2&&E.layer!==this._spiderfied){this._shownPolygon=new L.Polygon(E.layer.getConvexHull(),this.options.polygonOptions);D.addLayer(this._shownPolygon)}},_hideCoverage:function(){if(this._shownPolygon){this._map.removeLayer(this._shownPolygon);this._shownPolygon=null}},_unbindEvents:function(){var E=this.options.spiderfyOnMaxZoom,D=this.options.showCoverageOnHover,G=this.options.zoomToBoundsOnClick,F=this._map;if(E||G){this.off("clusterclick",this._zoomOrSpiderfy,this)}if(D){this.off("clustermouseover",this._showCoverage,this);this.off("clustermouseout",this._hideCoverage,this);F.off("zoomend",this._hideCoverage,this)}},_zoomEnd:function(){if(!this._map){return }this._mergeSplitClusters();this._zoom=this._map._zoom;this._currentShownBounds=this._getExpandedVisibleBounds()},_moveEnd:function(){if(this._inZoomAnimation){return }var D=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,D);this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,D);this._currentShownBounds=D;return },_generateInitialClusters:function(){var E=this._map.getMaxZoom(),D=this.options.maxClusterRadius,F=D;if(typeof D!=="function"){F=function(){return D}}if(this.options.disableClusteringAtZoom){E=this.options.disableClusteringAtZoom-1}this._maxZoom=E;this._gridClusters={};this._gridUnclustered={};for(var G=E;G>=0;G--){this._gridClusters[G]=new L.DistanceGrid(F(G));this._gridUnclustered[G]=new L.DistanceGrid(F(G))}this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(H,N){var F=this._gridClusters,D=this._gridUnclustered,M,I;if(this.options.singleMarkerMode){H.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[H]}})}for(;N>=0;N--){M=this._map.project(H.getLatLng(),N);var E=F[N].getNearObject(M);if(E){E._addChild(H);H.__parent=E;return }E=D[N].getNearObject(M);if(E){var J=E.__parent;if(J){this._removeLayer(E,false)}var K=new L.MarkerCluster(this,N,E,H);F[N].addObject(K,this._map.project(K._cLatLng,N));E.__parent=K;H.__parent=K;var G=K;for(I=N-1;I>J._zoom;I--){G=new L.MarkerCluster(this,I,G);F[I].addObject(G,this._map.project(E.getLatLng(),I))}J._addChild(G);for(I=N;I>=0;I--){if(!D[I].removeObject(E,this._map.project(E.getLatLng(),I))){break}}return }D[N].addObject(H,M)}this._topClusterLevel._addChild(H);H.__parent=this._topClusterLevel;return },_enqueue:function(D){this._queue.push(D);if(!this._queueTimeout){this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300)}},_processQueue:function(){for(var D=0;D<this._queue.length;D++){this._queue[D].call(this)}this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){this._processQueue();if(this._zoom<this._map._zoom&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())){this._animationStart();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds());this._animationZoomIn(this._zoom,this._map._zoom)}else{if(this._zoom>this._map._zoom){this._animationStart();this._animationZoomOut(this._zoom,this._map._zoom)}else{this._moveEnd()}}},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds){return this._map.getBounds()}var I=this._map,E=I.getBounds(),D=E._southWest,H=E._northEast,G=L.Browser.mobile?0:Math.abs(D.lat-H.lat),F=L.Browser.mobile?0:Math.abs(D.lng-H.lng);return new L.LatLngBounds(new L.LatLng(D.lat-G,D.lng-F,true),new L.LatLng(H.lat+G,H.lng+F,true))},_animationAddLayerNonAnimated:function(D,E){if(E===D){this._featureGroup.addLayer(D)}else{if(E._childCount===2){E._addToMap();var F=E.getAllChildMarkers();this._featureGroup.removeLayer(F[0]);this._featureGroup.removeLayer(F[1])}else{E._updateIcon()}}}});L.MarkerClusterGroup.include(!L.DomUtil.TRANSITION?{_animationStart:function(){},_animationZoomIn:function(E,D){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,E);this._topClusterLevel._recursivelyAddChildrenToMap(null,D,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(E,D){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,E);this._topClusterLevel._recursivelyAddChildrenToMap(null,D,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(D,E){this._animationAddLayerNonAnimated(D,E)}}:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationEnd:function(){if(this._map){this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")}this._inZoomAnimation--;this.fire("animationend")},_animationZoomIn:function(H,F){var G=this._getExpandedVisibleBounds(),D=this._featureGroup,E;this._topClusterLevel._recursively(G,H,0,function(M){var J=M._latlng,K=M._markers,I;if(!G.contains(J)){J=null}if(M._isSingleParent()&&H+1===F){D.removeLayer(M);M._recursivelyAddChildrenToMap(null,F,G)}else{M.setOpacity(0);M._recursivelyAddChildrenToMap(J,F,G)}for(E=K.length-1;E>=0;E--){I=K[E];if(!G.contains(I._latlng)){D.removeLayer(I)}}});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(G,F);D.eachLayer(function(I){if(!(I instanceof L.MarkerCluster)&&I._icon){I.setOpacity(1)}});this._topClusterLevel._recursively(G,H,F,function(I){I._recursivelyRestoreChildPositions(F)});this._enqueue(function(){this._topClusterLevel._recursively(G,H,0,function(I){D.removeLayer(I);I.setOpacity(1)});this._animationEnd()})},_animationZoomOut:function(E,D){this._animationZoomOutSingle(this._topClusterLevel,E-1,D);this._topClusterLevel._recursivelyAddChildrenToMap(null,D,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,E,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(D,H,E){var G=this._getExpandedVisibleBounds();D._recursivelyAnimateChildrenInAndAddSelfToMap(G,H+1,E);var F=this;this._forceLayout();D._recursivelyBecomeVisible(G,E);this._enqueue(function(){if(D._childCount===1){var I=D._markers[0];I.setLatLng(I.getLatLng());if(I.setOpacity){I.setOpacity(1)}}else{D._recursively(G,E,0,function(J){J._recursivelyRemoveChildrenFromMap(G,H+1)})}F._animationEnd()})},_animationAddLayer:function(E,G){var F=this,D=this._featureGroup;D.addLayer(E);if(G!==E){if(G._childCount>2){G._updateIcon();this._forceLayout();this._animationStart();E._setPos(this._map.latLngToLayerPoint(G.getLatLng()));E.setOpacity(0);this._enqueue(function(){D.removeLayer(E);E.setOpacity(1);F._animationEnd()})}else{this._forceLayout();F._animationStart();F._animationZoomOutSingle(G,this._map.getMaxZoom(),this._map.getZoom())}}},_forceLayout:function(){L.Util.falseFn(A.body.offsetWidth)}});L.markerClusterGroup=function(D){return new L.MarkerClusterGroup(D)};L.MarkerCluster=L.Marker.extend({initialize:function(G,F,E,D){L.Marker.prototype.initialize.call(this,E?(E._cLatLng||E.getLatLng()):new L.LatLng(0,0),{icon:this});this._group=G;this._zoom=F;this._markers=[];this._childClusters=[];this._childCount=0;this._iconNeedsUpdate=true;this._bounds=new L.LatLngBounds();if(E){this._addChild(E)}if(D){this._addChild(D)}},getAllChildMarkers:function(F){F=F||[];for(var E=this._childClusters.length-1;E>=0;E--){this._childClusters[E].getAllChildMarkers(F)}for(var D=this._markers.length-1;D>=0;D--){F.push(this._markers[D])}return F},getChildCount:function(){return this._childCount},zoomToBounds:function(){var G=this._childClusters.slice(),J=this._group._map,I=J.getBoundsZoom(this._bounds),F=this._zoom+1,H=J.getZoom(),E;while(G.length>0&&I>F){F++;var D=[];for(E=0;E<G.length;E++){D=D.concat(G[E]._childClusters)}G=D}if(I>F){this._group._map.setView(this._latlng,F)}else{if(I<=H){this._group._map.setView(this._latlng,H+1)}else{this._group._map.fitBounds(this._bounds)}}},getBounds:function(){var D=new L.LatLngBounds();D.extend(this._bounds);return D},_updateIcon:function(){this._iconNeedsUpdate=true;if(this._icon){this.setIcon(this)}},createIcon:function(){if(this._iconNeedsUpdate){this._iconObj=this._group.options.iconCreateFunction(this);this._iconNeedsUpdate=false}return this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(D,E){this._iconNeedsUpdate=true;this._expandBounds(D);if(D instanceof L.MarkerCluster){if(!E){this._childClusters.push(D);D.__parent=this}this._childCount+=D._childCount}else{if(!E){this._markers.push(D)}this._childCount++}if(this.__parent){this.__parent._addChild(D,true)}},_expandBounds:function(F){var G,E=F._wLatLng||F._latlng;if(F instanceof L.MarkerCluster){this._bounds.extend(F._bounds);G=F._childCount}else{this._bounds.extend(E);G=1}if(!this._cLatLng){this._cLatLng=F._cLatLng||E}var D=this._childCount+G;if(!this._wLatLng){this._latlng=this._wLatLng=new L.LatLng(E.lat,E.lng)}else{this._wLatLng.lat=(E.lat*G+this._wLatLng.lat*this._childCount)/D;this._wLatLng.lng=(E.lng*G+this._wLatLng.lng*this._childCount)/D}},_addToMap:function(D){if(D){this._backupLatlng=this._latlng;this.setLatLng(D)}this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(F,D,E){this._recursively(F,0,E-1,function(J){var I=J._markers,H,G;for(H=I.length-1;H>=0;H--){G=I[H];if(G._icon){G._setPos(D);G.setOpacity(0)}}},function(J){var I=J._childClusters,H,G;for(H=I.length-1;H>=0;H--){G=I[H];if(G._icon){G._setPos(D);G.setOpacity(0)}}})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(F,E,D){this._recursively(F,D,0,function(G){G._recursivelyAnimateChildrenIn(F,G._group._map.latLngToLayerPoint(G.getLatLng()).round(),E);if(G._isSingleParent()&&E-1===D){G.setOpacity(1);G._recursivelyRemoveChildrenFromMap(F,E)}else{G.setOpacity(0)}G._addToMap()})},_recursivelyBecomeVisible:function(D,E){this._recursively(D,0,E,null,function(F){F.setOpacity(1)})},_recursivelyAddChildrenToMap:function(D,F,E){this._recursively(E,-1,F,function(I){if(F===I._zoom){return }for(var H=I._markers.length-1;H>=0;H--){var G=I._markers[H];if(!E.contains(G._latlng)){continue}if(D){G._backupLatlng=G.getLatLng();G.setLatLng(D);if(G.setOpacity){G.setOpacity(0)}}I._group._featureGroup.addLayer(G)}},function(G){G._addToMap(D)})},_recursivelyRestoreChildPositions:function(H){for(var G=this._markers.length-1;G>=0;G--){var D=this._markers[G];if(D._backupLatlng){D.setLatLng(D._backupLatlng);delete D._backupLatlng}}if(H-1===this._zoom){for(var F=this._childClusters.length-1;F>=0;F--){this._childClusters[F]._restorePosition()}}else{for(var E=this._childClusters.length-1;E>=0;E--){this._childClusters[E]._recursivelyRestoreChildPositions(H)}}},_restorePosition:function(){if(this._backupLatlng){this.setLatLng(this._backupLatlng);delete this._backupLatlng}},_recursivelyRemoveChildrenFromMap:function(E,H,G){var D,F;this._recursively(E,-1,H-1,function(I){for(F=I._markers.length-1;F>=0;F--){D=I._markers[F];if(!G||!G.contains(D._latlng)){I._group._featureGroup.removeLayer(D);if(D.setOpacity){D.setOpacity(1)}}}},function(I){for(F=I._childClusters.length-1;F>=0;F--){D=I._childClusters[F];if(!G||!G.contains(D._latlng)){I._group._featureGroup.removeLayer(D);if(D.setOpacity){D.setOpacity(1)}}}})},_recursively:function(J,I,F,D,G){var H=this._childClusters,M=this._zoom,E,K;if(I>M){for(E=H.length-1;E>=0;E--){K=H[E];if(J.intersects(K._bounds)){K._recursively(J,I,F,D,G)}}}else{if(D){D(this)}if(G&&this._zoom===F){G(this)}if(F>M){for(E=H.length-1;E>=0;E--){K=H[E];if(J.intersects(K._bounds)){K._recursively(J,I,F,D,G)}}}}},_recalculateBounds:function(){var F=this._markers,E=this._childClusters,D;this._bounds=new L.LatLngBounds();delete this._wLatLng;for(D=F.length-1;D>=0;D--){this._expandBounds(F[D])}for(D=E.length-1;D>=0;D--){this._expandBounds(E[D])}},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.DistanceGrid=function(D){this._cellSize=D;this._sqCellSize=D*D;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(I,F){var E=this._getCoord(F.x),K=this._getCoord(F.y),H=this._grid,J=H[K]=H[K]||{},D=J[E]=J[E]||[],G=L.Util.stamp(I);this._objectPoint[G]=F;D.push(I)},updateObject:function(E,D){this.removeObject(E);this.addObject(E,D)},removeObject:function(E,J){var I=this._getCoord(J.x),H=this._getCoord(J.y),D=this._grid,M=D[H]=D[H]||{},K=M[I]=M[I]||[],F,G;delete this._objectPoint[L.Util.stamp(E)];for(F=0,G=K.length;F<G;F++){if(K[F]===E){K.splice(F,1);if(G===1){delete M[I]}return true}}},eachObject:function(K,E){var H,G,F,J,N,M,I,D=this._grid;for(H in D){N=D[H];for(G in N){M=N[G];for(F=0,J=M.length;F<J;F++){I=K.call(E,M[F]);if(I){F--;J--}}}}},getNearObject:function(O){var N=this._getCoord(O.x),M=this._getCoord(O.y),H,F,E,R,Q,I,G,K,P=this._objectPoint,J=this._sqCellSize,D=null;for(H=M-1;H<=M+1;H++){R=this._grid[H];if(R){for(F=N-1;F<=N+1;F++){Q=R[F];if(Q){for(E=0,I=Q.length;E<I;E++){G=Q[E];K=this._sqDist(P[L.Util.stamp(G)],O);if(K<J){J=K;D=G}}}}}}return D},_getCoord:function(D){return Math.floor(D/this._cellSize)},_sqDist:function(G,F){var E=F.x-G.x,D=F.y-G.y;return E*E+D*D}};(function(){L.QuickHull={getDistant:function(F,G){var D=G[1].lat-G[0].lat,E=G[0].lng-G[1].lng;return(E*(F.lat-G[0].lat)+D*(F.lng-G[0].lng))},findMostDistantPointFromBaseLine:function(E,J){var H=0,D=null,G=[],F,I,K;for(F=J.length-1;F>=0;F--){I=J[F];K=this.getDistant(I,E);if(K>0){G.push(I)}else{continue}if(K>H){H=K;D=I}}return{maxPoint:D,newPoints:G}},buildConvexHull:function(D,G){var F=[],E=this.findMostDistantPointFromBaseLine(D,G);if(E.maxPoint){F=F.concat(this.buildConvexHull([D[0],E.maxPoint],E.newPoints));F=F.concat(this.buildConvexHull([E.maxPoint,D[1]],E.newPoints));return F}else{return[D[0]]}},getConvexHull:function(I){var J=false,K=false,D=null,H=null,E;for(E=I.length-1;E>=0;E--){var G=I[E];if(J===false||G.lat>J){D=G;J=G.lat}if(K===false||G.lat<K){H=G;K=G.lat}}var F=[].concat(this.buildConvexHull([H,D],I),this.buildConvexHull([D,H],I));return F}}}());L.MarkerCluster.include({getConvexHull:function(){var G=this.getAllChildMarkers(),E=[],F,D;for(D=G.length-1;D>=0;D--){F=G[D].getLatLng();E.push(F)}return L.QuickHull.getConvexHull(E)}});L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied===this||this._group._inZoomAnimation){return }var H=this.getAllChildMarkers(),G=this._group,F=G._map,D=F.latLngToLayerPoint(this._latlng),E;this._group._unspiderfy();this._group._spiderfied=this;if(H.length>=this._circleSpiralSwitchover){E=this._generatePointsSpiral(H.length,D)}else{D.y+=10;E=this._generatePointsCircle(H.length,D)}this._animationSpiderfy(H,E)},unspiderfy:function(D){if(this._group._inZoomAnimation){return }this._animationUnspiderfy(D);this._group._spiderfied=null},_generatePointsCircle:function(H,K){var D=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+H),I=D/this._2PI,G=this._2PI/H,F=[],E,J;F.length=H;for(E=H-1;E>=0;E--){J=this._circleStartAngle+E*G;F[E]=new L.Point(K.x+I*Math.cos(J),K.y+I*Math.sin(J))._round()}return F},_generatePointsSpiral:function(G,K){var H=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,F=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,I=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,J=0,E=[],D;E.length=G;for(D=G-1;D>=0;D--){J+=F/H+D*0.0005;E[D]=new L.Point(K.x+H*Math.cos(J),K.y+H*Math.sin(J))._round();H+=this._2PI*I/J}return E},_noanimationUnspiderfy:function(){var I=this._group,H=I._map,E=I._featureGroup,G=this.getAllChildMarkers(),D,F;this.setOpacity(1);for(F=G.length-1;F>=0;F--){D=G[F];E.removeLayer(D);if(D._preSpiderfyLatlng){D.setLatLng(D._preSpiderfyLatlng);delete D._preSpiderfyLatlng}if(D.setZIndexOffset){D.setZIndexOffset(0)}if(D._spiderLeg){H.removeLayer(D._spiderLeg);delete D._spiderLeg}}I._spiderfied=null}});L.MarkerCluster.include(!L.DomUtil.TRANSITION?{_animationSpiderfy:function(F,I){var K=this._group,E=K._map,D=K._featureGroup,H,G,M,J;for(H=F.length-1;H>=0;H--){J=E.layerPointToLatLng(I[H]);G=F[H];G._preSpiderfyLatlng=G._latlng;G.setLatLng(J);if(G.setZIndexOffset){G.setZIndexOffset(1000000)}D.addLayer(G);M=new L.Polyline([this._latlng,J],{weight:1.5,color:"#222"});E.addLayer(M);G._spiderLeg=M}this.setOpacity(0.3);K.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}:{SVG_ANIMATION:(function(){return A.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}()),_animationSpiderfy:function(I,N){var Q=this,S=this._group,F=S._map,D=S._featureGroup,O=F.latLngToLayerPoint(this._latlng),M,H,R,P;for(M=I.length-1;M>=0;M--){H=I[M];if(H.setOpacity){H.setZIndexOffset(1000000);H.setOpacity(0);D.addLayer(H);H._setPos(O)}else{D.addLayer(H)}}S._forceLayout();S._animationStart();var E=L.Path.SVG?0:0.3,K=L.Path.SVG_NS;for(M=I.length-1;M>=0;M--){P=F.layerPointToLatLng(N[M]);H=I[M];H._preSpiderfyLatlng=H._latlng;H.setLatLng(P);if(H.setOpacity){H.setOpacity(1)}R=new L.Polyline([Q._latlng,P],{weight:1.5,color:"#222",opacity:E});F.addLayer(R);H._spiderLeg=R;if(!L.Path.SVG||!this.SVG_ANIMATION){continue}var G=R._path.getTotalLength();R._path.setAttribute("stroke-dasharray",G+","+G);var J=A.createElementNS(K,"animate");J.setAttribute("attributeName","stroke-dashoffset");J.setAttribute("begin","indefinite");J.setAttribute("from",G);J.setAttribute("to",0);J.setAttribute("dur",0.25);R._path.appendChild(J);J.beginElement();J=A.createElementNS(K,"animate");J.setAttribute("attributeName","stroke-opacity");J.setAttribute("attributeName","stroke-opacity");J.setAttribute("begin","indefinite");J.setAttribute("from",0);J.setAttribute("to",0.5);J.setAttribute("dur",0.25);R._path.appendChild(J);J.beginElement()}Q.setOpacity(0.3);if(L.Path.SVG){this._group._forceLayout();for(M=I.length-1;M>=0;M--){H=I[M]._spiderLeg;H.options.opacity=0.5;H._path.setAttribute("stroke-opacity",0.5)}}setTimeout(function(){S._animationEnd();S.fire("spiderfied")},200)},_animationUnspiderfy:function(N){var M=this._group,E=M._map,D=M._featureGroup,J=N?E._latLngToNewLayerPoint(this._latlng,N.zoom,N.center):E.latLngToLayerPoint(this._latlng),F=this.getAllChildMarkers(),I=L.Path.SVG&&this.SVG_ANIMATION,G,H,K;M._animationStart();this.setOpacity(1);for(H=F.length-1;H>=0;H--){G=F[H];if(!G._preSpiderfyLatlng){continue}G.setLatLng(G._preSpiderfyLatlng);delete G._preSpiderfyLatlng;if(G.setOpacity){G._setPos(J);G.setOpacity(0)}else{D.removeLayer(G)}if(I){K=G._spiderLeg._path.childNodes[0];K.setAttribute("to",K.getAttribute("from"));K.setAttribute("from",0);K.beginElement();K=G._spiderLeg._path.childNodes[1];K.setAttribute("from",0.5);K.setAttribute("to",0);K.setAttribute("stroke-opacity",0);K.beginElement();G._spiderLeg._path.setAttribute("stroke-opacity",0)}}setTimeout(function(){var O=0;for(H=F.length-1;H>=0;H--){G=F[H];if(G._spiderLeg){O++}}for(H=F.length-1;H>=0;H--){G=F[H];if(!G._spiderLeg){continue}if(G.setOpacity){G.setOpacity(1);G.setZIndexOffset(0)}if(O>1){D.removeLayer(G)}E.removeLayer(G._spiderLeg);delete G._spiderLeg}M._animationEnd()},200)}});L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);if(this._map.options.zoomAnimation){this._map.on("zoomstart",this._unspiderfyZoomStart,this)}this._map.on("zoomend",this._noanimationUnspiderfy,this);if(L.Path.SVG&&!L.Browser.touch){this._map._initPathRoot()}},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._unspiderfy()},_unspiderfyZoomStart:function(){if(!this._map){return }this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(D){if(L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")){return }this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._unspiderfy(D)},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(D){if(this._spiderfied){this._spiderfied.unspiderfy(D)}},_noanimationUnspiderfy:function(){if(this._spiderfied){this._spiderfied._noanimationUnspiderfy()}},_unspiderfyLayer:function(D){if(D._spiderLeg){this._featureGroup.removeLayer(D);D.setOpacity(1);D.setZIndexOffset(0);this._map.removeLayer(D._spiderLeg);delete D._spiderLeg}}})}(window,document));function loadMapControls(){var A={};$(".pgnav-map").each(function(F){var E=$(this);var D=E.parents(".bucket-process").attr("id");var C=D+"_map"+F;var B=getMapConfig(E,D,F);if(B.elementId){A[D]=getDataAndConstructMap(B,C,E)}});return A}function getMapConfig(B,A,D){var C={elementId:A,bucketWidth:$("#"+A).width(),abbreviateValues:"true",recordLimit:"200",valueOnTop:"largest",useStoplightColors:"false",subtitle:"",controlIndex:D};if(B.attr("mapImplementation")){C.mapImplementation=B.attr("mapImplementation").toUpperCase()}else{C.mapImplementation="ESRI"}if(B.attr("metricName")){C.metricName=B.attr("metricName")}if(B.attr("granularity")){C.granularity=B.attr("granularity")}if(B.attr("granularityLocation")){C.granularityLocation=B.attr("granularityLocation")}if(B.attr("useStoplightColors")){C.useStoplightColors=B.attr("useStoplightColors")==="true"?"true":"false"}if(B.attr("basemapLayer")){C.basemapLayer=B.attr("basemapLayer").toUpperCase()}if(B.attr("markerRadius")){C.markerRadius=B.attr("markerRadius")}else{C.markerRadius="7"}if(B.attr("markerOpacity")){C.markerOpacity=B.attr("markerOpacity")}else{C.markerOpacity="0.9"}if(B.attr("useClusters")){C.useClusters=B.attr("useClusters")}else{C.markerOpacity="false"}if(B.attr("recordLimit")){C.recordLimit=B.attr("recordLimit")}if(B.attr("valueOnTop")){C.valueOnTop=B.attr("valueOnTop")}if(B.attr("subtitle")){C.subtitle=B.attr("subtitle")}if(B.attr("abbreviateValues")){C.abbreviateValues=B.attr("abbreviateValues")}return C}function getDataAndConstructMap(B,C,G){var F=[];var F=getPlotData(B,C);if(!F||F.length===0){return }var D=mapBucket_Plot(B,C,F);G.append(D);F=preProcessMapData(B,F);var A="pgnavMap";if(B.popupMap){A="pgnavMapPopup"}var E={mapImplementation:B.mapImplementation,basemapLayer:B.basemapLayer||"",markerRadius:B.markerRadius,markerOpacity:B.markerOpacity,useClusters:B.useClusters};return initMap(A,F,E)}function preProcessMapData(V,O){var G=[];try{var I;if(V.granularity&&V.granularityLocation){I={tableName:V.granularityLocation,fieldNames:toJSON([V.granularity,"lat","lon"])}}var M=Workflow.call("AbCommonResources-getDataRecords",I);var K=M.data.records;if(!K||K.length===0){return }for(var S=0;S<O.length;S++){var W=O[S].barLabel;var J=O[S].pointLabel;var Q=O[S].value;var R=O[S].barClass;var P=O[S].drillDownView;var A=[];var H,D;var B=V.granularityLocation+"."+V.granularity;var E,N;A=$.grep(K,function(X){return X[B]===W&&X[E]!==""&&X[N]!==""});if(A.length>0){if(V.granularityLocation+".lat.raw" in A[0]){E=V.granularityLocation+".lat.raw";N=V.granularityLocation+".lon.raw"}else{E=V.granularityLocation+".lat";N=V.granularityLocation+".lon"}var H=A[0][E];var D=A[0][N];if(H&&D){var C=[D,H];var F={type:"Feature",geometry:{type:"Point",coordinates:C},properties:{key:W,label:J,value:Q,color:R,drillDownView:P}};G.push(F)}}}}catch(T){mapBucketErrorMessage(V,"wfrerror")}var U={type:"FeatureCollection",features:G};console.log(JSON.stringify(U));return U}function mapBucket_Plot(B,C,E){var A="pgnavMap";if(B.popupMap){A="pgnavMapPopup"}var D='<div id="'+A+'"style="width:520px; height:350px">';D+='<div id="pgnavMapMarkerTooltip" class="pgnav-map-marker-tooltip" style="position:fixed; display:none;"></div>';D+='<div id="pgnavMapError" class="pgnav-map-error" style="position:absolute; display:none;"></div>';D+="</div>";return D}function initMap(H,I,C){var A=L.map(H).fitBounds([[-76.6797,-182.8125],[76.6797,182.8125]]);if(C.mapImplementation==="GOOGLE"){var G=getBasemapLayer("GOOGLE",C.basemapLayer);var J=new L.Google(G);A.addLayer(J)}else{var D=getBasemapLayer("ESRI",C.basemapLayer);if(D=="ImageryLabels"){var K=L.layerGroup();K.addTo(A);layer=L.esri.basemapLayer("Imagery",{id:"basemap",attribution:""});K.addLayer(layer);labelsLayer=L.esri.basemapLayer("ImageryLabels",{id:"basemapLabels",attribution:""});K.addLayer(labelsLayer)}else{L.esri.basemapLayer(D).addTo(A)}}A.on("click",function(M){var N=M.target;console.log()});var B=I.features;if(!B||B.length===0){return A}var F=L.geoJson(B,{pointToLayer:function(N,O){var M={color:"white",fillColor:barClassToColor(N.properties.color),fillOpacity:C.markerOpacity,radius:parseInt(C.markerRadius),riseOnHover:true,stroke:false,title:N.properties.key+"<br><b>"+N.properties.label+"</b>"};return L.circleMarker(O,M)},onEachFeature:function(N,M){console.log();M.on("mouseover",function(P){console.log("pgnav-map-marker-mouseover");var T=P.target.options.title;var Q=(P.target.options.fillOpacity)*0.5;$(".pgnav-map-marker-tooltip").html(T);var S,R;if(P.originalEvent.clientX&&P.originalEvent.clientY){S=P.originalEvent.clientX;R=P.originalEvent.clientY}console.log("clientX:"+S+",clientY: "+R);$(".pgnav-map-marker-tooltip").css({display:"none"});$(".pgnav-map-marker-tooltip").css({left:(S+15)+"px",top:(R)+"px"});$(".pgnav-map-marker-tooltip").css({display:""});var O=P.target;O.setStyle({stroke:true,weight:3,color:"#000",fillOpacity:Q})});M.on("mouseout",function(P){console.log("pgnav-map-marker-mouseout");var Q=(P.target.options.fillOpacity)*2;$(".pgnav-map-marker-tooltip").css({display:"none"});var O=P.target;O.setStyle({stroke:false,fillOpacity:Q})});M.on("click",function(O){var Q=O.target.feature;if(Q){var P=Q.properties.drillDownView;var R=Q.properties.key;window.open("/archibus/"+P)}})}});if(C.useClusters=="true"){var E=L.markerClusterGroup({polygonOptions:{fillColor:"#000",color:"#000",weight:2,opacity:1,fillOpacity:0.25},iconCreateFunction:function(M){var N=M.getChildCount();return L.divIcon({html:'<div style="width:25px;">'+(N)+"</div>",className:"leaflet-div-cluster-marker",iconSize:[25,25]})}});E.addLayer(F);A.addLayer(E);E.bringToFront();A.fitBounds(E.getBounds())}else{A.addLayer(F);F.bringToFront();A.fitBounds(F.getBounds())}return A}function mapBucketErrorMessage(A,D){var B=(D==="wfrerror")?getLocalizedString(pageNavStrings.z_PAGENAV_NO_DATA_AVAILABLE):getLocalizedString(pageNavStrings.z_PAGENAV_BUCKET_DEF_ERROR);var C='<div id="pgnavMapError">'+B+"</div>";if(A.popupMap){$("#pgnavMapPopup").find("#pgnavMapError").html(C);$("#pgnavMapPopup").find("#pgnavMapError").css({display:""})}else{$("#pgnavMap").find("#pgnavMapError").html(C);$("#pgnavMap").find("#pgnavMapError").css({display:""})}}function getBasemapLayer(C,A){var B;if(C==="ESRI"){switch(A.toLowerCase()){case"world imagery":B="Imagery";break;case"world imagery with labels":B="ImageryLabels";break;case"world light gray canvas":B="Gray";break;case"world dark gray canvas":B="DarkGray";break;case"world street map":B="Streets";break;case"world shaded relief":B="ShadedRelief";break;case"world topographic":B="Topographic";break;case"national geographic world map":B="NationalGeographic";break;case"oceans basemap":B="Oceans";break;default:B="ImageryLabels";break}}else{if(C==="GOOGLE"){switch(A.toLowerCase()){case"satellite":B="SATELLITE";break;case"satellite with labels":B="HYBRID";break;case"road map":B="ROADMAP";break;case"terrain":B="TERRAIN";break;default:B="HYBRID";break}}}return B}function barClassToColor(A){var B="#5f5f5f";if(A=="pos"){B="#5f5f5f"}else{if(A=="neg"){B="#ff0000"}else{if(A=="red"){B="#9b3636"}else{if(A=="green"){B="#589358"}else{if(A=="yellow"){B="#dab300"}else{if(A=="black"){B="#5f5f5f"}}}}}}return B};